(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[0],{24:function(e,a,t){e.exports=t(35)},35:function(e,a,t){"use strict";t.r(a);var n=t(7),l=t(1),r=t(2),s=t(4),o=t(3),c=t(0),i=t.n(c),m=t(22),d=t(6),p=t(8),u=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){return Object(l.a)(this,t),a.apply(this,arguments)}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("nav",{className:"main-header navbar navbar-expand navbar-dark navbar-lightblue"},i.a.createElement("ul",{className:"navbar-nav"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link","data-widget":"pushmenu",href:"#end",role:"button"},i.a.createElement("i",{className:"fas fa-bars"})))),i.a.createElement("ul",{className:"navbar-nav ml-auto"},i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("a",{href:"#end",className:"nav-link","data-toggle":"dropdown"},i.a.createElement("i",{className:"far fa-comments"}),i.a.createElement("span",{className:"badge badge-danger navbar-badge"},"0")),i.a.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},i.a.createElement("a",{href:"#end",className:"dropdown-item"},i.a.createElement("div",{className:"media"},i.a.createElement("div",{className:"media-body"},i.a.createElement("h3",{className:"dropdown-item-title"},"Brad Diesel",i.a.createElement("span",{className:"float-right text-sm text-danger"},i.a.createElement("i",{className:"fas fa-star"}))),i.a.createElement("p",{className:"text-sm"},"Call me whenever you can..."),i.a.createElement("p",{className:"text-sm text-muted"},i.a.createElement("i",{className:"far fa-clock mr-1"})," 4 Hours Ago")))),i.a.createElement("div",{className:"dropdown-divider"}),i.a.createElement("a",{href:"#end",className:"dropdown-item dropdown-footer"},"See All Messages"))),i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("a",{className:"nav-link","data-toggle":"dropdown",href:"#end"},i.a.createElement("i",{className:"far fa-bell"}),i.a.createElement("span",{className:"badge badge-warning navbar-badge"},"0")),i.a.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},i.a.createElement("span",{className:"dropdown-header"},"15 Notifications"),i.a.createElement("div",{className:"dropdown-divider"}),i.a.createElement("a",{href:"#end",className:"dropdown-item"},i.a.createElement("i",{className:"fas fa-file mr-2"})," 3 new reports",i.a.createElement("span",{className:"float-right text-muted text-sm"},"2 days")),i.a.createElement("div",{className:"dropdown-divider"}),i.a.createElement("a",{href:"#end",className:"dropdown-item dropdown-footer"},"See All Notifications")))))}}]),t}(c.Component),h=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).changePage=function(a){e.props.page(a)},e.handleLogOut=function(){window.confirm("\xbfConfirma cerrar la sesion?")&&(e.props.logOut(),e.changePage("/"))},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.companyName,n=a.user,l=a.active;return i.a.createElement("aside",{className:"main-sidebar sidebar-dark-primary elevation-4"},i.a.createElement(d.b,{to:"/",className:"brand-link",onClick:function(a){e.changePage("/")}},i.a.createElement("img",{src:"/img/AdminLTELogo.png",alt:t+" logo",className:"brand-image img-circle elevation-3",style:{opacity:.8}}),i.a.createElement("span",{className:"brand-text font-weight-light text-uppercase"},t)),i.a.createElement("div",{className:"sidebar"},i.a.createElement("div",{className:"user-panel mt-3 pb-3 mb-3 d-flex"},i.a.createElement("div",{className:"image"},i.a.createElement("img",{src:"/img/avatar5.png",className:"img-circle elevation-2",alt:n.name})),i.a.createElement("div",{className:"info"},i.a.createElement("a",{href:"#end",className:"d-block text-capitalize"},n.name," ",i.a.createElement("small",{className:"text-lowercase"},"(",n.username,")"),i.a.createElement("br",null),i.a.createElement("span",{className:"badge badge-light"},n.rol>0?1===n.rol?"Ventas":"Optometrista":"Administrador")))),i.a.createElement("nav",{className:"mt-2"},i.a.createElement("ul",{className:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false"},i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/",className:"dashboard"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/")}},i.a.createElement("i",{className:"nav-icon fas fa-tachometer-alt"}),i.a.createElement("p",null,"Dashboard",i.a.createElement("i",{className:"right fas fa-angle-left"})))),i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/contactos",className:"contactos"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/contactos")}},i.a.createElement("i",{className:"nav-icon fas fa-address-book"}),i.a.createElement("p",null,"Contactos",i.a.createElement("i",{className:"right fas fa-angle-left"})))),2!==n.rol&&n.rol?null:i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/consultorio",className:"consultorio"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/consultorio")}},i.a.createElement("i",{className:"nav-icon fas fa-notes-medical"}),i.a.createElement("p",null,"Consultorio",i.a.createElement("i",{className:"right fas fa-angle-left"})))),n.rol<=1?i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/pedidos",className:"pedidos"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/pedidos")}},i.a.createElement("i",{className:"nav-icon fas fa-clipboard-list"}),i.a.createElement("p",null,"Pedidos",i.a.createElement("i",{className:"right fas fa-angle-left"})))):null,n.rol<=1?i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/notas",className:"notas"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/Ventas")}},i.a.createElement("i",{className:"nav-icon fas fa-cash-register"}),i.a.createElement("p",null,"Ventas",i.a.createElement("i",{className:"right fas fa-angle-left"})))):null,n.rol?null:i.a.createElement(i.a.Fragment,null,i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/almacen",className:"almacen"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/almacen")}},i.a.createElement("i",{className:"nav-icon fas fa-database"}),i.a.createElement("p",null,"Almacen",i.a.createElement("i",{className:"right fas fa-angle-left"})))),i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/usuarios",className:"usuarios"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/usuarios")}},i.a.createElement("i",{className:"nav-icon fas fa-user"}),i.a.createElement("p",null,"Usuarios",i.a.createElement("i",{className:"right fas fa-angle-left"})))),i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/configuraciones",className:"configuraciones"===l?"nav-link active":"nav-link",onClick:function(a){e.changePage("/configuraciones")}},i.a.createElement("i",{className:"nav-icon fas fa-tools"}),i.a.createElement("p",null,"Configuraciones",i.a.createElement("i",{className:"right fas fa-angle-left"}))))),i.a.createElement("li",{className:"nav-item has-treeview"},i.a.createElement(d.b,{to:"/",className:"nav-link",onClick:this.handleLogOut},i.a.createElement("i",{className:"nav-icon fas fa-sign-out-alt"}),i.a.createElement("p",null,"Cerrar sesion")))))))}}]),t}(c.Component),g=t(5),E=t.n(g),f=(t(10),function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={date:E()().format("LLLL")},setInterval((function(){console.log("Actualizando hora de sistema"),n.setState({date:E()().format("LLLL")})}),6e4),n}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props.title;return i.a.createElement("div",{className:"content-header"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6"},i.a.createElement("h1",{className:"m-0 text-dark text-capitalize"},e)),i.a.createElement("div",{className:"col"},i.a.createElement("h6",{className:"text-dark text-right"},this.state.date)))),i.a.createElement("hr",null))}}]),t}(c.Component)),b=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){return Object(l.a)(this,t),a.apply(this,arguments)}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("footer",{className:"main-footer d-print-none"},i.a.createElement("div",{className:"float-right d-none d-sm-inline"},"V2.0"),i.a.createElement("strong",null,"Copyright \xa9 2015-2020 ",i.a.createElement("a",{href:"#end"},"Orus"),".")," ","Todos los derechos reservados.")}}]),t}(c.Component),v=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).handleOrder=function(a){e.props.handleOrder(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.data,n=a.order,l=a.orderby,r=a.actions;return t.length?i.a.createElement("thead",{className:"thead-light"},i.a.createElement("tr",null,t.map((function(a,t){return a.filter?i.a.createElement("th",{scope:"col",key:t,onClick:function(){e.handleOrder(a.type)},style:{cursor:"desc"===n?"n-resize":"s-resize"}},a.name,l===a.type?i.a.createElement("span",{className:"ml-2"},i.a.createElement("i",{className:"fas fa-sort text-primary"})):""):i.a.createElement("th",{scope:"col",key:t},a.name)})),r?i.a.createElement("th",{className:"text-center"},"Acciones"):"")):i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col",className:"text-center"},"No hay datos de columnas")))}}]),t}(c.Component),N=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).handleChangePage=function(a){e.props.handleChangePage(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this,a=this.props.meta,t=[];if(a.total>10)for(var n=1;n<=a.last_page;n++)t.push(i.a.createElement("li",{key:n,className:a.current_page===n?"page-item disabled":"page-item"},i.a.createElement("a",{href:"#page"+n,className:a.current_page===n?"page-link text-dark":"page-link text-primary",onClick:function(a){a.preventDefault(),e.handleChangePage(1*a.target.innerHTML)}},n)));return a.total>10&&i.a.createElement("div",{className:"btn-group"},i.a.createElement("ul",{className:"pagination pagination-sm"},t))}}]),t}(c.Component),y=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("rol",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.rol;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: nombre, usuario o email",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Rol"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-address-book"}))),i.a.createElement("select",{className:"form-control",name:"rol",value:t,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"0"},"Administrador"),i.a.createElement("option",{value:"1"},"Ventas"),i.a.createElement("option",{value:"2"},"Optometrista")))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:this.props.search||this.props.rol?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),C=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).handleDelete=function(a,t){e.props.delete(a,t)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.item,n=a.edit,l=a.id;return i.a.createElement("td",{className:"text-right"},this.props.delete?i.a.createElement("a",{className:"btn-flat text-dark mr-4",href:"#delete",onClick:function(a){a.preventDefault(),e.handleDelete(l,t)}},i.a.createElement("i",{className:"fas fa-trash"})):"",n?i.a.createElement(d.b,{className:"btn-flat text-dark",to:n+l},i.a.createElement("i",{className:"fas fa-pencil-alt"})):"")}}]),t}(c.Component),x=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).changeFilters=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el usuario: "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&e&&(r.setState({load:!0}),fetch("http://"+l+"/api/users/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar el usuario",e.message),r.setState({load:!1})):(console.log("Usuario eliminado"),r.getUsers(),window.alert("Usuario eliminado con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))},r.getUsers=function(){var e=r.state,a=e.host,t=e.token,n=e.load,l="http://"+a+"/api/users",s="&orderby=".concat(r.state.orderby,"&order=").concat(r.state.order),o=r.state.search?"&search=".concat(r.state.search):"",c=r.state.rol.length>0?"&rol=".concat(r.state.rol):"",i=r.state.page>0?"?page="+r.state.page:"?page=1";n||r.setState({load:!0}),console.log("Descargando usuarios de API"),fetch(l+i+s+o+c,{method:"GET",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error en la descarga de usuarios",e.message),r.setState({load:!1})):(console.log("Almacenando usuarios"),r.setState({users:e,load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})}))};var s=JSON.parse(localStorage.getItem("OrusUsers"));return r.state={users:{data:[],meta:{}},load:!0,page:s?s.page:1,orderby:s?s.orderby:"created_at",order:s?s.order:"asc",search:s?s.search:"",rol:s?s.rol:"",host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getUsers(),E.a.locale("es"),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando usuarios y almacenando configuracion"),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol})),this.getUsers())}},{key:"render",value:function(){var e=this,a=this.state,t=a.users,n=a.load;return i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h2",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-user mr-1"}),"Usuarios registrados"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(y,{search:this.state.search,rol:this.state.rol,changeFilters:this.changeFilters,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"usuario",type:"username",filter:!0},{name:"nombre",type:"name",filter:!0},{name:"e-mail",type:"email",filter:!0},{name:"Rol",type:"rol",filter:!0},{name:"Actividad",type:"session"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"9",className:"alert alert-light text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("th",{scope:"row"},i.a.createElement("span",{className:"text-capitalize text-primary"},a.username)),i.a.createElement("td",null,i.a.createElement(d.b,{to:"/usuarios/registro/"+a.id},i.a.createElement("span",{className:"badge badge-primary text-capitalize p-1"},a.name,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",null,a.email),i.a.createElement("td",null,a.rol>0?1===a.rol?i.a.createElement("span",{className:"text-capitalize text-success"},i.a.createElement("i",{className:"fas fa-user-tag mr-2"}),"Ventas"):i.a.createElement("span",{className:"text-capitalize text-primary"},i.a.createElement("i",{className:"fas fa-user-tie mr-2"}),"Optometrista"):i.a.createElement("span",{className:"text-capitalize text-danger"},i.a.createElement("i",{className:"fas fa-user-shield mr-2"}),"Administrador")),i.a.createElement("td",null,a.session?E()(a.session.last_activity).fromNow():"--"),i.a.createElement("td",null,E()(a.updated_at).fromNow()),i.a.createElement("td",{className:"text-right"},E()(a.created_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.username,delete:e.handleDelete,edit:"/usuarios/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"8",className:"alert alert-info text-center"},i.a.createElement("i",{className:"fas fa-info mr-2"}),"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/usuarios/registro",className:"btn btn-outline-primary btn-lg"},i.a.createElement("i",{className:"fas fa-plus mr-2"}),"Nuevo usuario")))}}]),t}(c.Component),k=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).handleChange=function(e){var a=e.target.value,t={target:{name:"validUserName",value:""}};e.target.value=a.replace(/ /g,"").toLowerCase(),/^[\w]{4,16}$/.test(a)?n.validUser(e.target.value,t):a.length>4?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de usuario"}),t.target.value=!1,n.props.onChange(t)):a.length||(n.setState({bgColor:"bg-blue",validate:" border border-danger",text:"Debe de tener de 4 a 16 caracteres alfanumericos."}),t.target.value=!1,n.props.onChange(t)),n.props.onChange(e)},n.validUser=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),l="http://"+t.host+"/api/users",r="?username="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({searchUser:!0}),fetch(l+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?console.error("Error en la descarga de usuarios",t.message):t.data.length&&t.data[0].username.toLowerCase()===e?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El usuario ya esta registrado.",searchUser:!1}),a.target.value=!1,n.props.onChange(a)):(n.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),a.target.value=!0,n.props.onChange(a))})).catch((function(e){console.error(e)}))}),1e3)},n.state={bgColor:"bg-blue",validate:"",text:"Debe de tener al menos 4 caracteres.",searchUser:!1},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,a=e.col,t=e.username,n=this.state,l=n.bgColor,r=n.validate,s=n.text,o=n.searchUser;return i.a.createElement("div",{className:"col-"+a},t.length?i.a.createElement("small",null,i.a.createElement("label",null,"Usuario")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text "+l},o?i.a.createElement("i",{className:"fas fa-spinner"}):i.a.createElement("i",{className:"fas fa-user-check"}))),i.a.createElement("input",{type:"text",className:"form-control"+r,placeholder:"Usuario",name:"username",autoComplete:"off",autoFocus:"autofocus",value:t,onChange:this.handleChange,required:"required",minLength:"4",maxLength:"16",pattern:"^[\\w]{4,16}$"})),r?i.a.createElement("small",{className:"text-muted"},s):"")}}]),t}(c.Component),w=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).handleChange=function(e){var a=e.target.value,t={target:{name:"validUserEmail",value:!0}};e.target.value=a.replace(/\s/g,"").toLowerCase(),/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)?n.validEmail(e.target.value,t):a.length>8?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email"}),t.target.value=!1,n.props.onChange(t)):a.length||(n.setState({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email"}),t.target.value=!1,n.props.onChange(t)),n.props.onChange(e)},n.validEmail=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),l="http://"+t.host+"/api/users",r="?email="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({searchUser:!0}),fetch(l+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?(console.error("Error en la descarga de usuarios",t.message),n.setState({bgColor:"bg-red",validate:" border border-danger",text:"Error en la consulta",searchUser:!1})):t.data.length&&t.data[0].email.toLowerCase()===e?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El email ya esta registrado.",searchUser:!1}),a.target.value=!1,n.props.onChange(a)):(n.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),a.target.value=!0,n.props.onChange(a))})).catch((function(e){console.error(e)}))}),1e3)},n.state={bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email",searchUser:!1},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,a=e.col,t=e.email,n=this.state,l=n.bgColor,r=n.validate,s=n.text;return i.a.createElement("div",{className:"col-"+a},t.length?i.a.createElement("small",null,i.a.createElement("label",null,"Usuario")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text "+l},i.a.createElement("i",{className:"fas fa-at"}))),i.a.createElement("input",{type:"email",className:"form-control"+r,placeholder:"email",name:"email",autoComplete:"off",value:t,onChange:this.handleChange,required:"required"})),r?i.a.createElement("small",{className:"text-muted"},s):"")}}]),t}(c.Component),j=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).changePage=function(e){r.props.page(e.target.id)},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l))},r.handleSave=function(e){e.preventDefault();var a=r.state,t=a.host,n=a.token,l=a.validUserName,s=a.validUserEmail,o=a.id,c=a.name,i=a.username,m=a.rol,d=a.password,p=a.email;if(!l)return window.alert("El nombre de usuario ya esta en uso"),!1;if(!s)return window.alert("El correo ya esta en uso"),!1;if(window.confirm("\xbfEsta seguro de almacenar a este usuario?")){var u={name:c,username:i,rol:m,email:p},h=o?"http://"+t+"/api/users/"+o:"http://"+t+"/api/users",g=o?"PUT":"POST";d.length>8&&(u.password=d),r.setState({load:!0}),fetch(h,{method:g,body:JSON.stringify(u),signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){e.data?(console.log("Usuario almacenado"),window.confirm("Usuario almacenado con exito!.\n\xbfDesea cerrar este contacto?")?r.props.history.goBack():r.setState({load:!1,id:e.data.id})):(window.alert("Error al almacenar el usuario. Intentelo mas tarde"),console.log(e.message),r.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})}))}},r.getUser=function(e){var a=r.state,t=a.host,n=a.token;e>0&&(r.setState({load:!0}),fetch("http://"+t+"/api/users/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){e.message?(console.error("Error al cargar el usuario",e.message),r.setState({load:!1})):(console.log("Cargando datos de usuario"),r.setState({id:e.data.id,rol:e.data.rol,username:e.data.username,name:e.data.name,email:e.data.email,updated_at:e.data.updated_at,created_at:e.data.created_at,session:e.data.session,load:!1,validUserName:!0,validUserEmail:!0}))})).catch((function(e){console.error(e),r.setState({load:!1})})))},r.state={id:0,rol:1,username:"",validUserName:!1,name:"",email:"",validUserEmail:!1,password:"",updated_at:"",created_at:"",session:{},load:!1,host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;e&&(this.getUser(e),E.a.locale("es"))}},{key:"render",value:function(){var e=this.state,a=e.load,t=e.id,n=e.rol,l=e.username,r=e.name,s=e.email,o=e.password,c=e.updated_at,m=e.created_at,p=e.session,u=e.validUserName,h=e.validUserEmail,g=!(!a&&u&&r.length&&h);return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("form",{className:"card card-primary card-outline",onSubmit:this.handleSave},i.a.createElement("div",{className:"card-header"},i.a.createElement("h1",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-user mr-2"}),t?"Editar usuario":"Registrar nuevo usuario")),i.a.createElement("div",{className:"card-body was-validated"},a?i.a.createElement("div",{className:"alert alert-light text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mb-3"},i.a.createElement(k,{username:l,col:6,onChange:this.catchInputs}),i.a.createElement("div",{className:"col-6"},r.length?i.a.createElement("small",null,i.a.createElement("label",null,"Nombre completo")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text bg-blue"},i.a.createElement("i",{className:"fas fa-user-tag"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",autoComplete:"off",value:r,onChange:this.catchInputs,required:"required",minLength:"8",pattern:"^[a-zA-Z]{2,20}[\\s]{1}[a-zA-Z]{2,20}.*"})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},o.length||t?i.a.createElement("small",null,i.a.createElement("label",null,"Contrase\xf1a"),t?"":i.a.createElement("span",{className:"ml-2"},"De 8 a 16 caracteres, por lo menos una mayuscula, un numero y un caracter especial")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text bg-blue"},i.a.createElement("i",{className:"fas fa-lock"}))),i.a.createElement("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",value:o,onChange:this.catchInputs,required:!t,minLength:"8",maxLength:"16",pattern:"^(?=.*[A-Z])(?=.*[!@#$&\\.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$"}))),i.a.createElement(w,{email:s,col:6,onChange:this.catchInputs})),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},i.a.createElement("small",null,i.a.createElement("label",null,"Rol")),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text bg-blue"},i.a.createElement("i",{className:"fas fa-id-card"}))),i.a.createElement("select",{className:"custom-select",name:"rol",value:n,onChange:this.catchInputs},i.a.createElement("option",{value:"0"},"Administrador"),i.a.createElement("option",{value:"1"},"Ventas"),i.a.createElement("option",{value:"2"},"Optometrista"))))))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12 text-right"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement(d.b,{to:"/usuarios",className:"btn btn-dark",onClick:this.changePage,id:"/usuarios"},i.a.createElement("i",{className:"fas fa-ban mr-1"}),"Cancelar"),i.a.createElement("button",{type:"submit",className:a?"btn btn-primary disabled":"btn btn-primary",disabled:!!g},i.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar"))))))),t?i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-database mr-2"}),"Metadata")),i.a.createElement("div",{className:"card-body"},p?i.a.createElement("ul",{className:"list-group"},i.a.createElement("li",{className:"list-group-item"},i.a.createElement("h6",null,"Datos del usuario"),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("span",{className:"text-primary"},"Registrado"),i.a.createElement("p",null,E()(m).fromNow())),i.a.createElement("div",{className:"col"},i.a.createElement("span",{className:"text-primary"},"Ultima actualizacion"),i.a.createElement("p",null,E()(c).fromNow())))),i.a.createElement("li",{className:"list-group-item"},i.a.createElement("h6",null,"Actividad"),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("span",{className:"text-primary"},"IP"),i.a.createElement("p",null,p.ip_address)),i.a.createElement("div",{className:"col"},i.a.createElement("span",{className:"text-primary"},"Ultima actividad"),i.a.createElement("p",null,E()(p.last_activity).fromNow())))),i.a.createElement("li",{className:"list-group-item"},i.a.createElement("span",{className:"text-primary"},"Navegador y OS"),i.a.createElement("p",null,p.user_agent)),i.a.createElement("li",{className:"list-group-item"},i.a.createElement("span",{className:"text-primary"},"Token"),i.a.createElement("p",null,p.user_data))):i.a.createElement("p",null,"Usuario no ha registrado actividad.")))):"")}}]),t}(c.Component),S=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props.search;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: codigo o producto",value:e,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch}))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:e?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),O=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).onchangeSearch=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.changePage=function(e){r.props.page(e.target.id)},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el producto "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&e&&(r.setState({load:!0}),console.log("Solicitud de eliminaci\xf3n por API"),fetch("http://"+l+"/api/store/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("El contacto no puede ser eliminado"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar el producto",e.message),r.setState({load:!1})):(console.log("Producto eliminado"),r.getItems(),window.alert("Producto eliminado con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))};var s=JSON.parse(localStorage.getItem("OrusStore"));return r.state={items:{data:[],meta:{}},load:!0,page:s?s.page:1,orderby:s?s.orderby:"created_at",order:s?s.order:"asc",search:s?s.search:"",host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getItems(),E.a.locale("es"),localStorage.setItem("OrusContacts",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando productos"),this.getItems(),localStorage.setItem("OrusContacts",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search})))}},{key:"render",value:function(){var e=this,a=this.state,t=a.items,n=a.load;return i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-database mr-1"}),"Productos en almacen"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(S,{search:this.state.search,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Codigo",type:"code",filter:!0},{name:"Marca",type:"brand",filter:!0},{name:"Producto",type:"name",filter:!0},{name:"PS"},{name:"UND"},{name:"Precio",type:"price",filter:!0},{name:"Categoria"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"10",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,i.a.createElement("span",{className:"text-primary"},a.codigo)),i.a.createElement("td",null,a.marca),i.a.createElement("td",null,i.a.createElement(d.b,{to:"/almacen/registro/"+a.id},i.a.createElement("span",{className:"badge badge-primary text-capitalize p-1"},a.producto,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",{className:"text-right"},a.unidad),i.a.createElement("td",null,i.a.createElement("span",{className:a.cantidades>0?"text-success":"text-danger"},a.cantidades>0?a.cantidades:0)),i.a.createElement("td",{className:"text-right"},"$ ",a.precio),i.a.createElement("td",null,a.categoria.categoria),i.a.createElement("td",{className:"text-capitalize"},E()(a.updated_at).fromNow()),i.a.createElement("td",{className:"text-capitalize"},E()(a.created_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.producto,delete:e.handleDelete,edit:"/almacen/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/almacen/registro",className:"btn btn-outline-primary",onClick:this.changePage,id:"/almacen/registro"},i.a.createElement("i",{className:"fas fa-plus mr-1"}),"Nuevo producto")))}},{key:"getItems",value:function(){var e=this,a=this.state,t=a.orderby,n=a.order,l=a.search,r=a.page,s=a.host,o=a.token,c=a.load,i="http://"+s+"/api/store",m="&orderby=".concat(t,"&order=").concat(n),d=l?"&search=".concat(l):"",p=r>0?"?page="+r:"?page=1";c||this.setState({load:!0}),console.log("Descargando productos de API"),fetch(i+p+m+d,{method:"GET",signal:this.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(a){a.message?(console.error("Error en la descarga de productos",a.message),e.setState({load:!1})):(console.log("Almacenando productos"),e.setState({items:a,load:!1}))})).catch((function(a){console.error(a),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),e.setState({load:!1})}))}}]),t}(c.Component),_=t(14),I=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).handleDelete=function(e,a){e.preventDefault();var t=e.target.parentNode.parentNode.parentNode;t.classList.add("bg-danger");var l=window.confirm("\xbfEsta seguro de eliminar este lote?"),r=JSON.parse(localStorage.getItem("OrusSystem")),s=setInterval((function(){clearInterval(s),t.classList.remove("bg-danger")}),6500);l&&a&&fetch("http://"+r.host+"/api/items/"+a,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r.token}}).then((function(e){console.log("Eliminando lote"),e.ok&&204===e.status?(n.setState({load:!0,loteNew:!1}),n.handelGetLots(n.state.page),n.props.refresh()):window.alert(e.statusText)})).catch((function(e){console.log(e)}))},n.state={id:0,bill:"",cost:0,price:n.props.price,amount:0,lote:{data:[],meta:{}},loteNew:!1,load:!0,page:1},n.handleNewLote=n.handleNewLote.bind(Object(_.a)(n)),n.handleSave=n.handleSave.bind(Object(_.a)(n)),n.catchInputs=n.catchInputs.bind(Object(_.a)(n)),n.handelGetLots=n.handelGetLots.bind(Object(_.a)(n)),n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.handelGetLots(this.state.page)}},{key:"render",value:function(){var e=this,a=this.state,t=a.lote,n=a.load,l=[];if(this.state.lote.meta.total>10)for(var r=1;r<=this.state.lote.meta.last_page;r++)l.push(i.a.createElement("li",{key:r,className:this.state.lote.meta.current_page===r?"page-item disabled":"page-item"},i.a.createElement("a",{href:"#e",id:r,className:"page-link",onClick:this.handleChangePage.bind(this)},r)));return i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-list"}),"Listado de lotes"),i.a.createElement("div",{className:"card-tools"},this.state.lote.meta.total>10?i.a.createElement("div",{className:"btn-group"},i.a.createElement("ul",{className:"pagination pagination-sm"},l)):"")),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-hover table-nowrap"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Registrado"),i.a.createElement("th",{style:{width:140}},"Factura"),i.a.createElement("th",{className:"text-right",style:{width:90}},"Unidades"),i.a.createElement("th",{className:"text-right",style:{width:110}},"Costo"),i.a.createElement("th",{className:"text-right",style:{width:110}},"Precio"),i.a.createElement("th",null,"Acciones"))),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"6",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,a.created_at),i.a.createElement("td",{className:"text-uppercase"},a.factura?a.factura:"XXXX"),i.a.createElement("td",{className:"text-right"},a.cantidades),i.a.createElement("td",{className:"text-right"},"$ ",a.costo?a.costo:0),i.a.createElement("td",{className:"text-right"},"$ ",a.precio?a.precio:0),i.a.createElement("td",{className:"text-right"},i.a.createElement("a",{className:"btn-flat text-dark",href:"#delete",onClick:function(t){e.handleDelete(t,a.id)}},i.a.createElement("i",{className:"fas fa-trash"}))))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"6",className:"text-center"},"No hay datos para mostrar")),this.state.loteNew?i.a.createElement("tr",null,i.a.createElement("th",null,"Nuevo"),i.a.createElement("td",null,i.a.createElement("input",{className:"form-control text-uppercase",type:"text",name:"bill",value:this.state.bill,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:"form-control text-right",type:"number",name:"amount",value:this.state.amount,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:"form-control text-right",type:"number",name:"cost",value:this.state.cost,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:"form-control text-right",type:"number",name:"price",value:this.state.price,onChange:this.catchInputs})),i.a.createElement("td",{className:"text-right"},i.a.createElement("div",{className:"btn-group",role:"group"},i.a.createElement("button",{className:"btn btn-outline-primary btn-sm",onClick:this.handleSave},i.a.createElement("i",{className:"fas fa-save"})),i.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:this.handleNewLote},i.a.createElement("i",{className:"fas fa-undo"}))))):i.a.createElement("tr",null)))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"btn-group float-right",role:"group"},i.a.createElement("button",{className:"btn btn-primary",onClick:this.handleNewLote},"Nuevo lote"))))))}},{key:"handleChangePage",value:function(e){e.preventDefault(),this.setState({page:e.target.id}),this.handelGetLots(e.target.id)}},{key:"handleNewLote",value:function(){this.setState({loteNew:!this.state.loteNew})}},{key:"catchInputs",value:function(e){var a=e.target,t=a.name,l=a.value;this.setState(Object(n.a)({},t,l.toLowerCase()))}},{key:"validInputs",value:function(){var e=this.state,a=e.bill,t=e.price,n=e.amount;return a.length||(a="XXXX"),t||(t=1e3),!!n||(window.alert("La cantidad de articulos no puede ser cero"),!1)}},{key:"handleSave",value:function(e){var a=this;if(e.preventDefault(),!this.validInputs())return!1;if(window.confirm("\xbfEsta seguro de almacenar un nuevo lote?")){var t=JSON.parse(localStorage.getItem("OrusSystem")),n=this.state,l=n.id,r={bill:n.bill,cost:n.cost,price:n.price,amount:n.amount,store_items_id:l};fetch("http://"+t.host+"/api/items",{method:"POST",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.json()})).then((function(e){e.data?(a.setState({load:!0,loteNew:!1}),a.handelGetLots(a.state.page),a.props.refresh()):console.log(e.message)})).catch((function(e){console.log(e)}))}}},{key:"handelGetLots",value:function(e){var a=this,t=JSON.parse(localStorage.getItem("OrusSystem")),n=this.props.id,l="http://"+t.host+"/api/items?store_items_id="+n;fetch(l+"&page="+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.json()})).then((function(e){console.log("Descargando lotes"),a.setState({id:n,lote:e,load:!1})}))}}]),t}(c.Component),A=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).changePage=function(e){r.props.page(e)},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l.toLowerCase()))},r.getCategory=function(){var e=r.state,a=e.host,t=e.token;console.log("solicitando categorias al API"),fetch("http://"+a+"/api/categories",{method:"GET",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||console.error("Error al solicitar categorias"),e.json()})).then((function(e){e.data?(console.log("almacenando categorias"),r.setState({category_list:e.data})):console.error(e.message)})).catch((function(e){console.log(e)}))},r.handleSave=function(e){if(e.preventDefault(),window.confirm("\xbfEsta seguro de almacenar este producto?")){var a=r.state,t=a.id,n=a.code,l=a.codebar,s=a.brand,o=a.name,c=a.unit,i=a.cant,m=a.price,d=a.category_id,p=a.token,u=a.host,h={code:n,codebar:l,brand:s,name:o,unit:c,cant:i,price:m,category_id:d},g=t?"http://"+u+"/api/store/"+t:"http://"+u+"/api/store",E=t?"PUT":"POST";a.load||r.setState({load:!0}),fetch(g,{method:E,body:JSON.stringify(h),signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+p}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Producto almacenado"),window.confirm("Producto almacenado con exito!.\n\xbfDesea ir al listado?")?r.props.history.goBack():r.setState({load:!1,id:e.data.id})):(window.alert("Error al almacenar el contacto. Intentelo mas tarde"),console.error(e.message),r.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),r.setState({load:!1})}))}},r.getItem=function(){var e=r.props.match.params.id;if(e>0){var a=r.state,t=a.load,n=a.host,l=a.token;t||r.setState({load:!0}),fetch("http://"+n+"/api/store/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al cargar el producto",e.message),r.setState({load:!1})):(console.log("Mostrando producto"),r.setState({id:e.data.id,code:e.data.codigo,codebar:e.data.c_barra,brand:e.data.marca,name:e.data.producto,unit:e.data.unidad,cant:e.data.cantidades,price:e.data.precio,category_id:e.data.categoria.id,load:!1}))})).catch((function(e){console.error(e),r.setState({load:!1})}))}},r.state={id:0,code:"",codebar:"",grad:"",brand:"",name:"",unit:"PZ",cant:1,price:1,category_id:1,category_list:[],load:!1,host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getItem(),this.getCategory()}},{key:"render",value:function(){var e=this,a=this.state.load;return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:this.state.id?"col-5":"col-6"},i.a.createElement("form",{className:"card card-primary card-outline",onSubmit:this.handleSave},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-primary"},i.a.createElement("i",{className:"fas fa-database mr-1"}),this.state.id?"Editar producto":"Registrar nuevo producto")),i.a.createElement("div",{className:"card-body"},a?i.a.createElement("div",{className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-5"},this.state.code?i.a.createElement("small",null,i.a.createElement("label",null,"Codigo")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-code"}))),i.a.createElement("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo",name:"code",value:this.state.code,onChange:this.catchInputs,autoComplete:"off"}))),i.a.createElement("div",{className:"col-md-7"},this.state.codebar?i.a.createElement("small",null,i.a.createElement("label",null,"Codigo de barras")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-barcode"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Codigo de barras",name:"codebar",value:this.state.codebar,onChange:this.catchInputs,autoComplete:"off"})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},this.state.name?i.a.createElement("small",null,i.a.createElement("label",null,"Nombre del producto")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-archive"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Nombre del producto",name:"name",value:this.state.name,onChange:this.catchInputs,autoComplete:"off"})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-10"},this.state.brand?i.a.createElement("small",null,i.a.createElement("label",null,"Marca")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-5"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-copyright"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Marca",name:"brand",value:this.state.brand,onChange:this.catchInputs})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},this.state.unit?i.a.createElement("small",null,i.a.createElement("label",null,"Unidad de presentacion")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-balance-scale"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Unidad de presentaci\xf3n",name:"unit",value:this.state.unit,onChange:this.catchInputs}))),i.a.createElement("div",{className:"col-md-6"},i.a.createElement("small",null,i.a.createElement("label",null,"Cantidad en existencia")),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-database"}))),i.a.createElement("input",{type:"number",className:"form-control text-right",placeholder:"Cantidades en existencia",name:"cant",value:this.state.cant,onChange:this.catchInputs})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},i.a.createElement("small",null,i.a.createElement("label",null,"Precio")),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-money-bill"}))),i.a.createElement("input",{type:"number",className:"form-control text-right",placeholder:"Precio",name:"price",value:this.state.price,onChange:this.catchInputs})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("small",null,i.a.createElement("label",null,"Categoria")),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-sort-amount-down"}))),i.a.createElement("select",{className:"custom-select",name:"category_id",value:this.state.category_id,onChange:this.catchInputs},this.state.category_list.map((function(e){return null===e.depende_de?i.a.createElement("option",{value:e.id,key:e.id},e.categoria):null})))))))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"btn-group float-right",role:"group"},i.a.createElement(d.b,{to:"/almacen",className:"btn btn-dark",onClick:function(a){e.changePage("/almacen")}},i.a.createElement("i",{className:"fas fa-ban mr-1"}),"Volver"),i.a.createElement("button",{type:"submit",className:"btn btn-primary"},i.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar"))))))),this.state.id?i.a.createElement("div",{className:"col"},i.a.createElement(I,{id:this.state.id,price:this.state.price,refresh:this.getItem})):null)}}]),t}(c.Component),P=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("type",""),e.props.changeFilters("business",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.type,n=e.business;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: nombre, RFC o email",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Tipo de contacto"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-address-book"}))),i.a.createElement("select",{className:"form-control",name:"type",value:t,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"0"},"Clientes"),i.a.createElement("option",{value:"1"},"Proveedores"))),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"\xbfEs una empresa?"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-building"}))),i.a.createElement("select",{className:"form-control",name:"business",value:n,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"1"},"Si"),i.a.createElement("option",{value:"0"},"No")))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:a||t||n?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),D=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).onchangeSearch=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.changePage=function(e){r.props.page(e.target.id)},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el contacto "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&e&&(r.setState({load:!0}),console.log("Solicitud de eliminaci\xf3n por API"),fetch("http://"+l+"/api/contacts/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("El contacto no puede ser eliminado"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar el contacto",e.message),r.setState({load:!1})):(console.log("Contacto eliminado"),r.getContacts(),window.alert("Contacto eliminado con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))};var s=JSON.parse(localStorage.getItem("OrusContacts"));return r.state={contacts:{data:[],meta:{}},load:!0,page:s?s.page:1,orderby:s?s.orderby:"created_at",order:s?s.order:"asc",search:s?s.search:"",type:s?s.type:"",business:s?s.business:"",host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getContacts(),E.a.locale("es"),localStorage.setItem("OrusContacts",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,business:this.state.business}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando contactos"),this.getContacts(),localStorage.setItem("OrusContacts",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,business:this.state.business})))}},{key:"render",value:function(){var e=this,a=this.state,t=a.contacts,n=a.load;return i.a.createElement("div",{className:"card card-danger card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h2",{className:"card-title text-danger"},i.a.createElement("i",{className:"fas fa-address-book mr-1"}),"Lista de contactos"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(P,{search:this.state.search,type:this.state.type,business:this.state.business,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Nombre",type:"name",filter:!0},{name:"RFC",type:"name",filter:!0},{name:"E-mail",type:"email",filter:!0},{name:"Tipo",type:"type",filter:!0},{name:"Telefono"},{name:"Domicilio"},{name:"Cumplea\xf1os"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"10",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-danger",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,i.a.createElement(d.b,{to:"/contactos/registro/"+a.id},i.a.createElement("span",{className:"badge badge-danger text-capitalize p-1"},a.nombre,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",{className:"text-uppercase"},a.rfc?a.rfc:"--"),i.a.createElement("td",{className:"text-lowercase"},a.email?a.email:"--"),i.a.createElement("td",{className:"text-uppercase"},a.tipo?i.a.createElement("span",{className:"text-purple"},"Proveedor"):i.a.createElement("span",{className:"text-green"},"Cliente")),i.a.createElement("td",null,a.telefonos[2]?a.telefonos[2]:a.telefonos[0]?a.telefonos[0]:"--"),i.a.createElement("td",{className:"text-capitalize"},a.domicilio[0]?a.domicilio[0]:"--"),i.a.createElement("td",{className:"text-center"},a.f_nacimiento?E()(a.f_nacimiento).format("D/MMM"):"--"),i.a.createElement("td",{className:"text-capitalize"},E()(a.updated_at).fromNow()),i.a.createElement("td",{className:"text-capitalize"},E()(a.created_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.nombre,delete:e.handleDelete,edit:"/contactos/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/contactos/registro",className:"btn btn-outline-danger",onClick:this.changePage,id:"/contactos/registro"},i.a.createElement("i",{className:"fas fa-plus",id:"/contactos/registro"}),"\xa0 Nuevo contacto")))}},{key:"getContacts",value:function(){var e=this,a=this.state,t=a.host,n=a.token,l=a.order,r=a.orderby,s=a.search,o=a.page,c=a.type,i=a.business,m=a.load,d="http://"+t+"/api/contacts",p="&orderby=".concat(r,"&order=").concat(l),u=s?"&search=".concat(s):"",h=o>0?"?page="+o:"?page=1",g=""===c?"":"&type="+c,E=""===i?"":"&business="+i;m||this.setState({load:!0}),console.log("Descargando contactos de API"),fetch(d+h+p+u+g+E,{method:"GET",signal:this.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(a){a.message?(console.error("Error en la descarga de contactos",a.message),e.setState({load:!1})):(console.log("Almacenando contactos"),e.setState({contacts:a,load:!1}))})).catch((function(a){console.error(a),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),e.setState({load:!1})}))}}]),t}(c.Component),T=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).eventLoadMap=function(){var e={query:n.props.calle+","+n.props.colonia+","+n.props.municipio+","+n.props.estado+","+n.props.cp,fields:["formatted_address","geometry"]};n.service=new n.google.maps.places.PlacesService(n.map),n.service.findPlaceFromQuery(e,(function(e,a){"OK"===a&&(n.markers.length&&(n.markers[0].setMap(null),n.markers=[]),e.map((function(e){return n.marker=new n.google.maps.Marker({position:e.geometry.location,title:e.formatted_address,map:n.map}),n.marker.addListener("click",(function(){var e=n.marker.title.split(","),a=e[2].split(/(\d{5})/g);a.length||(a=e[3].split(/(\d{5})/g)),n.props.changeAddress({calle:e[0].trim(),colonia:e[1].trim(),municipio:a[2]?a[2].trim():n.props.municipio,estado:e[3].trim(),cp:a[1]?a[1].trim():n.props.cp})})),n.markers.push(n.marker),n.markers[0].setMap(n.map),n.map.setCenter(n.markers[0].position),null})))}))},n.state={load:!0},n.markers=[],n.map="",n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=setInterval((function(){if(window.google){e.google=window.google,clearInterval(a),console.log("Cargando mapa");var t=new e.google.maps.LatLng(19.2487072,-103.747381);e.map=new e.google.maps.Map(document.getElementById("gmapContainer"),{center:t,zoom:16}),e.props.calle.length>6&&(console.log("Cargando Marker"),e.eventLoadMap()),e.setState({load:!1})}}),100)}},{key:"componentDidUpdate",value:function(){this.props.calle.length>6&&(console.log("Cargando Marker"),this.eventLoadMap())}},{key:"render",value:function(){return i.a.createElement("div",{className:"card card-danger card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("i",{className:"fas fa-map-marked mr-1"}),"Mapa"),i.a.createElement("div",{className:"card-body",id:"gmapContainer",style:{height:400}}))}}]),t}(c.Component),U=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("table",{className:"table table-bordered table-hover"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"#"),i.a.createElement("th",null,"Esfera"),i.a.createElement("th",null,"Cilindro"),i.a.createElement("th",null,"Eje"),i.a.createElement("th",null,"Adici\xf3n"),i.a.createElement("th",null,"D/P"),i.a.createElement("th",null,"Altura"))),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("label",null,"D"),i.a.createElement("i",{className:"fa fa-eye"})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"esferaod",min:"-20",max:"20",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.esferaod?this.props.esferaod:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"cilindrod",min:"-20",max:"0",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.cilindrod?this.props.cilindrod:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"ejeod",min:"0",max:"180",step:"1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,placeholder:"\xb0",value:this.props.ejeod?this.props.ejeod:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"adiciond",min:"0",max:"3",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.adiciond?this.props.adiciond:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"dpod",min:"0",max:"80",step:".1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.dpod?this.props.dpod:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"alturaod",min:"0",max:"80",step:".1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.alturaod?this.props.alturaod:0,onChange:this.catchInputs}))),i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("label",null,"I"),i.a.createElement("i",{className:"fa fa-eye"})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"esferaoi",min:"-20",max:"20",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.esferaoi?this.props.esferaoi:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"cilindroi",min:"-20",max:"0",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.cilindroi?this.props.cilindroi:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"ejeoi",min:"0",max:"180",step:"1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,placeholder:"\xb0",value:this.props.ejeoi?this.props.ejeoi:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"adicioni",min:"0",max:"3",step:".25",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.adicioni?this.props.adicioni:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"dpoi",min:"0",max:"80",step:".1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.dpoi?this.props.dpoi:0,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:"alturaoi",min:"0",max:"80",step:".1",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.alturaoi?this.props.alturaoi:0,onChange:this.catchInputs}))))),i.a.createElement("ul",{className:"list-group mt-4"},i.a.createElement("li",{className:"list-group-item"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},"Lente de contacto",i.a.createElement("input",{type:"text",name:"lcmarca",maxLength:"70",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.lcmarca,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-4"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"lcgod",maxLength:"30",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.lcgod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-4"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"lcgoi",maxLength:"30",className:this.props.readOnly?"form-control disabled":"form-control",disabled:!!this.props.readOnly,value:this.props.lcgoi,onChange:this.catchInputs}))))))}}]),t}(c.Component),F=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handleClickCategory=function(e){e.preventDefault(),r.setState({category_id:0,category_id_2:0,category_id_3:0,category_list_2:[],category_list_3:[]}),r.props.onChangeInput("category_id",0)},r.handleCategoryChange=function(e){var a=e.target,t=a.name,l=a.value;"category_id"===t&&l&&r.state.category_list.map((function(e){return e.id===1*l&&r.setState({category_list_2:e.hijos}),null})),"category_id_2"===t&&l&&r.state.category_list_2.map((function(e){return e.id===1*l&&r.setState({category_list_3:e.hijos}),null})),r.setState(Object(n.a)({},t,1*l)),"category_id_3"===t&&r.props.onChangeInput("category_id",1*l)},r.getCategories=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/categories/1";"number"===typeof r.props.category_id&&r.props.category_id>0?(console.log("Descargando recomendacion"),a="http://"+e.host+"/api/categories/"+r.props.category_id,fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.log("Error: ",e)),e.json()})).then((function(e){e.data&&(console.log("Recomendacion descargada"),r.setState({category:e.data}))}))):(console.log("Descargando lista de recomendaciones"),fetch(a+"?categoryid=raiz",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.log("Error: ",e)),e.json()})).then((function(e){e.data&&(console.log("Lista de recomendaciones descargadas"),r.setState({category_list:e.data.hijos,meta:e.meta}))})))},r.state={category_list:[],meta:{},category_list_2:[],category_list_3:[],category_id:0,category_id_2:0,category_id_3:0,category:{}},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,a){e.category_id!==this.props.category_id&&(console.log("Recargando recomendacion"),this.getCategories())}},{key:"render",value:function(){return i.a.createElement("div",{className:"card card-info card-outline mt-4"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title"},i.a.createElement("i",{className:"fas fa-thumbs-up mr-1"}),"Recomendaci\xf3n")),i.a.createElement("div",{className:"card-body"},this.props.category_id?i.a.createElement(i.a.Fragment,null,i.a.createElement("h5",{className:"card-title"},this.state.category.depende_de?this.state.category.depende_de.depende_de?this.state.category.depende_de.depende_de.categoria+"/"+this.state.category.depende_de.categoria+"/":this.state.category.depende_de.categoria+"/":"",this.state.category.categoria),this.props.update?i.a.createElement("p",{className:"card-text"},i.a.createElement("button",{className:"btn btn-outline-info btn-sm card-link mt-2",onClick:this.handleClickCategory},"Cambiar")):""):this.state.category_list.length?i.a.createElement(i.a.Fragment,null,this.state.category_list.length?i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},"Tipo")),i.a.createElement("select",{name:"category_id",className:"custom-select",value:this.state.category_id,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Seleccione el tipo"),this.state.category_list.map((function(e){return i.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):"",this.state.category_list_2.length?i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},"Material")),i.a.createElement("select",{name:"category_id_2",className:"custom-select",value:this.state.category_id_2,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Seleccione el material"),this.state.category_list_2.map((function(e){return i.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):"",this.state.category_list_3.length?i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},"Tratamiento")),i.a.createElement("select",{name:"category_id_3",className:"custom-select",value:this.state.category_id_3,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Seleccione el tratamiento"),this.state.category_list_3.map((function(e){return i.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):""):i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))))}}]),t}(c.Component),L=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).handleChangeInput=function(e,a){n.props.ChangeInput(e,a)},n.handleClickDeleteExam=function(e){e.preventDefault(),window.confirm("\xbfRealmente desea cambiar de examen?")&&(n.props.ChangeInput("exam_id",0),n.props.ChangeInput("exam",{}))},n.handleClickSelect=function(e){n.props.ChangeInput("exam_id",e.id),n.props.ChangeInput("exam",e)},n.handleNewOrder=function(e){if(window.confirm("\xbfDesea agregar un pedido a este examen?")){var a=JSON.parse(localStorage.getItem("OrusSystem")),t={contact_id:n.props.paciente,exam_id:e,items:JSON.stringify([])};console.log("Enviando datos del pedido a la API"),fetch("http://"+a.host+"/api/orders",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Pedido almacenado"),n.setState({load:!0}),n.getExams()):console.log(e.message)}))}},n.handleNewExam=function(e){if(e.preventDefault(),window.confirm("\xbfDesea agregar un nuevo examen a este paciente?")){var a=JSON.parse(localStorage.getItem("OrusSystem")),t={contact_id:n.props.paciente,edad:n.props.edad};console.log("Enviando datos del examen a la API"),fetch("http://"+a.host+"/api/exams",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Examen almacenado"),n.setState({load:!0}),n.getExams()):console.log(e.message)}))}},n.changePage=function(e){n.props.page(e)},n.getExams=function(){if(n.props.paciente){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/exams",t=n.state.page>0?"?page="+n.state.page:"?page=1",l="&paciente="+n.props.paciente;console.log("Descargando examenes del contacto"),fetch(a+t+l+"&orderby=created_at&order=desc",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(n.setState({load:!1}),console.log(e)),e.json()})).then((function(e){console.log("Examenes almacenados"),n.setState({data:e.message?[]:e,load:!1})}))}else n.setState({load:!1})},n.state={id:0,data:{data:[],meta:{}},exam:{},load:!0,page:0},n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.exam&&!this.props.exam.id?this.getExams():this.setState({id:this.props.exam.id,exam:this.props.exam,load:!1})}},{key:"componentDidUpdate",value:function(e,a){this.props.exam&&!this.props.exam.id&&this.props.exam.id!==e.exam.id&&this.getExams(),this.props.exam&&this.props.exam.id!==e.exam.id&&this.setState({id:this.props.exam.id,exam:this.props.exam})}},{key:"render",value:function(){var e=this,a=this.state,t=a.data,n=a.load,l=a.id,r=a.exam;return this.props.select?i.a.createElement(i.a.Fragment,null,l?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mb-4"},i.a.createElement("div",{className:"col-2"},i.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Folio"),i.a.createElement("strong",null,l))),i.a.createElement("div",{className:"col-3"},i.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Estado"),i.a.createElement("strong",null,r.estado))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Fecha"),i.a.createElement("strong",null,E.a.utc(r.created_at).local().format("LL")))),i.a.createElement("div",{className:"col-2 text-right"},i.a.createElement("button",{className:this.props.status?"btn btn-info disabled":"btn btn-info",disabled:!!this.props.status,onClick:this.handleClickDeleteExam},"Cambiar"))),i.a.createElement(U,{esferaod:r.esferaod,esferaoi:r.esferaoi,cilindrod:r.cilindrod,cilindroi:r.cilindroi,ejeod:r.ejeod,ejeoi:r.ejeoi,adiciond:r.adiciond,adicioni:r.adicioni,dpod:r.dpod,dpoi:r.dpoi,alturaod:r.alturaod,alturaoi:r.alturaoi,lcmarca:r.lcmarca,lcgod:r.lcgod,lcgoi:r.lcgoi,readOnly:!0,onChangeInput:this.handleChangeInput}),r.category_id?i.a.createElement(F,{category_id:r.category_id,onChangeInput:this.handleChangeInput}):""):i.a.createElement("table",{className:"table table-hover table-nowrap"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Folio"),i.a.createElement("th",null,"Fecha"),i.a.createElement("th",null,"Edad"),i.a.createElement("th",null,"Estado"),i.a.createElement("th",null,"\xa0"))),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"5",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id,className:E.a.utc(new Date).isSame(E.a.utc(a.created_at),"day")?"table-success":""},i.a.createElement("td",null,i.a.createElement("span",{className:"badge badge-info"},a.id)),i.a.createElement("td",null,E.a.utc(a.created_at).local().format("L"),i.a.createElement("br",null),E()(new Date).isSame(a.created_at)),i.a.createElement("td",null,a.edad),i.a.createElement("td",null,a.estado?i.a.createElement("span",{className:"badge badge-secondary"},"Terminado"):i.a.createElement("span",{className:"badge badge-success"},"Activo")),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:function(t){t.preventDefault(),e.handleClickSelect(a)}},i.a.createElement("i",{className:"fas fa-check"}))))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"5",className:"text-center"},"Aun no tiene examenes",i.a.createElement("button",{className:"btn btn-outline-info btn-sm ml-4",onClick:this.handleNewExam},i.a.createElement("i",{className:"fas fa-plus"}))))))):i.a.createElement("div",{className:"card card-info card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("i",{className:"fas fa-notes-medical mr-1"}),"Examenes realizados"),i.a.createElement("div",{className:"card-body"},i.a.createElement("table",{className:"table table-hover table-nowrap"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Folio"),i.a.createElement("th",null,"Fecha"),i.a.createElement("th",null,"Edad"),i.a.createElement("th",null,"Estado"),i.a.createElement("th",null,"\xa0"))),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"8",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id,className:E.a.utc(new Date).isSame(E.a.utc(a.created_at),"day")?"table-success":""},i.a.createElement("td",null,i.a.createElement("span",{className:"badge badge-info"},a.id)),i.a.createElement("td",null,E.a.utc(a.created_at).local().format("L"),i.a.createElement("br",null),E()(new Date).isSame(a.created_at)),i.a.createElement("td",null,a.edad),i.a.createElement("td",null,a.estado?i.a.createElement("span",{className:"badge badge-secondary"},"Terminado"):i.a.createElement("span",{className:"badge badge-success"},"Activo")),i.a.createElement("td",{className:"float-right"},i.a.createElement(d.b,{className:"btn btn-outline-info btn-sm",to:"/consultorio/registro/"+a.id,onClick:function(a){e.changePage("/consultorio/registro/")},alt:"Ver examen"},i.a.createElement("i",{className:"fas fa-share"})),a.estado?i.a.createElement("button",{className:"btn btn-outline-warning btn-sm ml-2",alt:"Crear pedido",onClick:function(t){t.preventDefault(),e.handleNewOrder(a.id)}},i.a.createElement("i",{className:"fas fa-shopping-basket"})):""))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"5",className:"text-center"},"Aun no tiene examenes"))))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("button",{type:"button",className:"btn btn-info float-right",onClick:this.handleNewExam},i.a.createElement("i",{className:"fas fa-plus"}))))}}]),t}(c.Component),z=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).eraseTilde=function(e){return e=(e=(e=(e=(e=e.replace(new RegExp(/[\xe0\xe1\xe2\xe3\xe4\xe5]/g),"a")).replace(new RegExp(/[\xe8\xe9\xea\xeb]/g),"e")).replace(new RegExp(/[\xec\xed\xee\xef]/g),"i")).replace(new RegExp(/[\xf2\xf3\xf4\xf5\xf6]/g),"o")).replace(new RegExp(/[\xf9\xfa\xfb\xfc]/g),"u")},n.handleChange=function(e){var a=e.target.value,t={target:{name:"validName",value:"",target:""}},l=n.eraseTilde(a.toLowerCase());e.target.value=l,/^[a-z.]{2,20}[\s]{1}[a-z.]{2,20}.*/.test(a)?(n.setState({bgColor:"bg-blue",validate:""}),t.target.value=!0,n.props.onChange(t),n.validUser(e.target.value,t)):(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de nombre de persona",contacts:[]}),t.target.value=!1,n.props.onChange(t)),n.props.onChange(e)},n.validUser=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),l="http://"+t.host+"/api/contacts",r="?name="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({searchUser:!0}),fetch(l+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?(console.error("Error en la descarga de contactos",t.message),n.setState({searchUser:!1}),a.target.value=!1,n.props.onChange(a)):(t.data.map((function(t){return n.eraseTilde(t.nombre)===e&&(console.log("Contacto registrado "),n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El contacto ya esta registrado",searchUser:!1,contacts:[]}),a.target.value=!1,n.props.onChange(a)),!1})),n.setState({searchUser:!1,contacts:t.data}))})).catch((function(e){console.error(e),n.setState({searchUser:!1}),a.target.value=!1,n.props.onChange(a)}))}),1e3)},n.state={bgColor:e.validName?"bg-blue":"bg-red",validate:e.validName?"":" border border-danger",text:"Debe de tener por lo menos nombre y apellido",searchUser:!1,contacts:[]},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidUpdate",value:function(e){e.validName!==this.props.validName&&this.setState({bgColor:this.props.validName?"bg-blue":"bg-red",validate:this.props.validName?"":" border border-danger"})}},{key:"render",value:function(){var e=this,a=this.props,t=a.name,n=a.validName,l=this.state,r=l.bgColor,s=l.validate,o=l.text,c=l.searchUser,m=l.contacts;return t||(t=""),i.a.createElement(i.a.Fragment,null,t?i.a.createElement("div",{className:"ml-2 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Nombre completo"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text "+r},c?i.a.createElement("i",{className:"fas fa-spinner"}):i.a.createElement("i",{className:"fas fa-id-card-alt"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize"+s,placeholder:"Nombre completo",name:"name",value:t,onChange:this.handleChange,autoFocus:!t.length,autoComplete:"off",required:"required",pattern:"^[a-zA-Z.]{2,20}[\\s]{1}[a-zA-Z.]{2,20}.*",minLength:"8",list:"contactos_db"})),m.length?i.a.createElement("datalist",{id:"contactos_db"},m.map((function(a){return i.a.createElement("option",{key:a.id,value:e.eraseTilde(a.nombre)})}))):null,n?null:i.a.createElement("div",{className:"p-0"},i.a.createElement("small",{className:"text-danger"},o)))}}]),t}(c.Component),B=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).eraseTilde=function(e){return e=(e=(e=(e=(e=e.replace(new RegExp(/[\xe0\xe1\xe2\xe3\xe4\xe5]/g),"a")).replace(new RegExp(/[\xe8\xe9\xea\xeb]/g),"e")).replace(new RegExp(/[\xec\xed\xee\xef]/g),"i")).replace(new RegExp(/[\xf2\xf3\xf4\xf5\xf6]/g),"o")).replace(new RegExp(/[\xf9\xfa\xfb\xfc]/g),"u")},n.handleChange=function(e){var a=e.target.value,t=n.props.id,l={target:{name:"validEmail",value:"",target:""}},r=n.eraseTilde(a.toLowerCase());e.target.value=r,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)?(n.setState({bgColor:"bg-blue",validate:""}),l.target.value=!0,n.props.onChange(l),(t||n.emailOriginal!==e.target.value)&&n.validUser(e.target.value,l)):(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No es un email correcto",contacts:[]}),l.target.value=!1,n.props.onChange(l)),n.props.onChange(e)},n.validUser=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),l="http://"+t.host+"/api/contacts",r="?email="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({emailContact:!0}),fetch(l+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?(console.error("Error en la descarga de contactos",t.message),n.setState({emailContact:!1}),a.target.value=!1,n.props.onChange(a)):(t.data.map((function(t){return t.email===e&&(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El email ya esta registrado",emailContact:!1,contacts:[]}),a.target.value=!1,n.props.onChange(a)),!1})),n.setState({emailContact:!1,contacts:t.data}))})).catch((function(e){console.error(e),n.setState({emailContact:!1}),a.target.value=!1,n.props.onChange(a)}))}),1e3)},n.state={bgColor:e.validEmail?"bg-blue":"bg-red",validate:e.validEmail?"":" border border-danger",text:"No es un email correcto",emailContact:!1,contacts:[]},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n.emailOriginal=e.email,n}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidUpdate",value:function(e){e.validEmail!==this.props.validEmail&&this.setState({bgColor:this.props.validEmail?"bg-blue":"bg-red",validate:this.props.validEmail?"":" border border-danger"})}},{key:"render",value:function(){var e=this.props,a=e.email,t=e.validEmail,n=this.state,l=n.bgColor,r=n.validate,s=n.text,o=n.emailContact,c=n.contacts;return a||(a=""),i.a.createElement(i.a.Fragment,null,a?i.a.createElement("div",{className:"ml-2 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Correo electronico"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mt-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text "+l},o?i.a.createElement("i",{className:"fas fa-spinner"}):i.a.createElement("i",{className:"fas fa-at"}))),i.a.createElement("input",{type:"email",className:"form-control"+r,placeholder:"Correo electronico",name:"email",value:a,onChange:this.handleChange,autoComplete:"off",minLength:"8",list:"email_db"}),c.length?i.a.createElement("datalist",{id:"email_db"},c.map((function(e){return i.a.createElement("option",{key:e.id,value:e.email})}))):null),t?null:i.a.createElement("div",{className:"p-0"},i.a.createElement("small",{className:"text-danger"},s)))}}]),t}(c.Component),M=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){e.props.onChange(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.type,t=e.business,n=e.name,l=e.rfc,r=e.email,s=e.birthday,o=e.validName,c=e.validEmail;return i.a.createElement("div",{className:"col "},i.a.createElement("small",null,i.a.createElement("label",null,"Tipo de cliente")),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-clipboard-check"}))),i.a.createElement("select",{className:"custom-select",name:"type",value:a,onChange:this.catchInputs},i.a.createElement("option",{value:"0"},"Cliente"),i.a.createElement("option",{value:"1"},"Proveedor"))),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("input",{type:"checkbox",name:"business",className:"mr-2",checked:t,onChange:this.catchInputs}),i.a.createElement("small",null,i.a.createElement("label",null,"\xbfEs una empresa?")))),i.a.createElement(z,{name:n,validName:o,onChange:this.catchInputs}),l?i.a.createElement("div",{className:"ml-2 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"RFC"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-file-invoice-dollar"}))),i.a.createElement("input",{type:"text",className:"form-control text-uppercase",placeholder:"RFC",name:"rfc",value:l||"",onChange:this.catchInputs,required:!1,minLength:"10"})),i.a.createElement(B,{email:r,validEmail:c,onChange:this.catchInputs}),t||a?null:i.a.createElement(i.a.Fragment,null,s?i.a.createElement("div",{className:"ml-2 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Fecha de nacimiento"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-calendar-check"}))),i.a.createElement("input",{type:"date",className:"form-control",placeholder:"Fecha de nacimiento",name:"birthday",value:s||"",onChange:this.catchInputs}))))}}]),t}(c.Component),J=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){e.props.onChange(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.calle,t=e.colonia,n=e.municipio,l=e.estado,r=e.cp;return i.a.createElement("div",{className:"col"},a?i.a.createElement("small",null,i.a.createElement("label",null,"Calle y numero")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-road"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Calle y numero",name:"calle",value:a,onChange:this.catchInputs})),t?i.a.createElement("small",null,i.a.createElement("label",null,"Colonia")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-location-arrow"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Colonia",name:"colonia",value:t,onChange:this.catchInputs})),n?i.a.createElement("small",null,i.a.createElement("label",null,"Municipio")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-location-arrow"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Municipio",name:"municipio",value:n,onChange:this.catchInputs})),l?i.a.createElement("small",null,i.a.createElement("label",null,"Estado")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-map-marker"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Estado",name:"estado",value:l,onChange:this.catchInputs})),r?i.a.createElement("small",null,i.a.createElement("label",null,"Codigo postal")):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-map-marker"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Codigo Postal",name:"cp",value:r,onChange:this.catchInputs})))}}]),t}(c.Component),G=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){e.props.onChange(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.t_casa,t=e.t_oficina,n=e.t_movil,l=10===a.length||10===n.length||10===t.length;return i.a.createElement("div",{className:"col"},a?i.a.createElement("div",{className:"ml-1 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Telefono de casa"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-phone"}))),i.a.createElement("input",{type:"tel",className:"form-control",placeholder:"Telefono de casa",name:"t_casa",value:a,onChange:this.catchInputs,pattern:"^[\\d]{10}$",maxLength:"10"})),t?i.a.createElement("div",{className:"ml-1 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Telefono de oficina"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-phone-alt"}))),i.a.createElement("input",{type:"tel",className:"form-control",placeholder:"Telefono de oficina",name:"t_oficina",value:t,onChange:this.catchInputs,pattern:"^[\\d]{10}$",maxLength:"10"})),n?i.a.createElement("div",{className:"ml-1 mt-1"},i.a.createElement("small",null,i.a.createElement("label",null,"Telefono celular"))):i.a.createElement("br",null),i.a.createElement("div",{className:"input-group mb-1"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-mobile-alt"}))),i.a.createElement("input",{type:"tel",className:"form-control",placeholder:"Telefono celular",name:"t_movil",value:n,onChange:this.catchInputs,pattern:"^[\\d]{10}$",required:10!==a.length&&10!==t.length,maxLength:"10"})),l?null:i.a.createElement("div",{className:"mt-2 p-0 text-danger"},i.a.createElement("small",null,"Por lo menos capture un telefono")))}}]),t}(c.Component),R=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).changeAddress=function(e){r.setState(e)},r.changePage=function(e){r.props.page(e)},r.catchInputs=function(e){var a=e.target.name,t="checkbox"===e.target.type?e.target.checked:e.target.value;r.setState(Object(n.a)({},a,t))},r.handleSave=function(e){if(e.preventDefault(),window.confirm("\xbfEsta seguro de almacenar a este contacto?")){var a=r.state,t=a.id,n=a.name,l=a.validName,s=a.rfc,o=a.email,c=a.validEmail,i=a.type,m=a.birthday,d=a.calle,p=a.colonia,u=a.municipio,h=a.estado,g=a.cp,E=a.t_casa,f=a.t_oficina,b=a.t_movil,v=a.business,N=a.load,y=a.host,C=a.token,x={name:n,rfc:s,email:o,type:i,birthday:v?"":m,business:v,domicilio:d+","+p+","+u+","+h+","+g,telnumbers:E+","+f+","+b},k=t?"http://"+y+"/api/contacts/"+t:"http://"+y+"/api/contacts",w=t?"PUT":"POST";if(!l)return window.alert("El contacto ya esta registrado"),!1;if(!c)return window.alert("El email ya esta registrado"),!1;N||r.setState({load:!0}),console.log("Enviando datos a API para almacenar"),fetch(k,{method:w,body:JSON.stringify(x),signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+C}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Contacto almacenado"),localStorage.setItem("OrusContactNew",JSON.stringify({})),window.confirm("Contacto almacenado con exito!.\n\xbfDesea cerrar este contacto?")?r.props.history.goBack():r.setState({load:!1,id:e.data.id,validName:!0,validEmail:!0})):(window.alert("Error al almacenar el contacto. Intentelo mas tarde"),console.error(e.message),r.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),r.setState({load:!1})}))}},r.getUser=function(e){if(e>0){var a=r.state,t=a.load,n=a.host,l=a.token;t||r.setState({load:!0}),console.log("Descargando datos del contacto"),fetch("http://"+n+"/api/contacts/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json",Authorization:"Bearer "+l}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.error(e)),e.json()})).then((function(e){if(e.message)console.error("Error al cargar el usuario",e.message),r.setState({load:!1});else{var a=e.data,t=a.domicilio,n=a.telefonos;console.log("Mostrando datos del contacto"),r.setState({id:e.data.id,name:e.data.nombre,rfc:e.data.rfc,email:e.data.email,type:e.data.tipo,business:e.data.empresa,birthday:e.data.f_nacimiento,calle:t[0]?t[0].replace(/undefined/g,""):"",colonia:t[1]?t[1].replace(/undefined/g,""):"",municipio:t[2]?t[2].replace(/undefined/g,""):"",estado:t[3]?t[3].replace(/undefined/g,""):"",cp:t[4]?t[4].replace(/undefined/g,""):"",t_casa:n[0]?n[0].replace(/undefined/g,""):"",t_oficina:n[1]?n[1].replace(/undefined/g,""):"",t_movil:n[2]?n[2].replace(/undefined/g,""):"",validName:!0,validEmail:!0,load:!1})}})).catch((function(e){console.error(e),r.setState({load:!1})}))}},r.state={id:0,name:"",validName:!1,rfc:"",email:"",validEmail:!1,type:0,birthday:"",calle:"",colonia:"",municipio:"",estado:"",cp:"",t_casa:"",t_oficina:"",t_movil:"",business:!1,load:!1,host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r.timeSave=null,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id,a=JSON.parse(localStorage.getItem("OrusContactNew"));e?this.getUser(e):(a.name&&a.name.length>4&&window.confirm("Existe un registro previo de "+a.name.toUpperCase()+", \n \xbfDesea Cargar los datos?")&&this.setState({name:a.name,validName:!0,rfc:a.rfc,email:a.email,validEmail:!0,type:a.type,birthday:a.birthday,calle:a.calle,colonia:a.colonia,municipio:a.municipio,estado:a.estado,cp:a.cp,t_casa:a.t_casa,t_oficina:a.t_oficina,t_movil:a.t_movil}),localStorage.setItem("OrusContactNew",JSON.stringify({})))}},{key:"componentDidUpdate",value:function(e,a){var t=this;!this.state.id&&!this.state.load&&this.state.validName&&this.state.validEmail?(this.timeSave&&clearTimeout(this.timeSave),this.timeSave=setTimeout((function(){localStorage.setItem("OrusContactNew",JSON.stringify({name:t.state.name,rfc:t.state.rfc,email:t.state.email,type:t.state.type,birthday:t.state.birthday,calle:t.state.calle,colonia:t.state.colonia,municipio:t.state.municipio,estado:t.state.estado,cp:t.state.cp,t_casa:t.state.t_casa,t_oficina:t.state.t_oficina,t_movil:t.state.t_movil}))}),1500)):localStorage.setItem("OrusContactNew",JSON.stringify({}))}},{key:"render",value:function(){var e=this,a=this.state,t=a.id,n=a.name,l=a.rfc,r=a.email,s=a.type,o=a.birthday,c=a.calle,m=a.colonia,p=a.municipio,u=a.estado,h=a.cp,g=a.t_casa,f=a.t_oficina,b=a.t_movil,v=a.business,N=a.load,y=a.validName,C=a.validEmail;return i.a.createElement("form",{onSubmit:this.handleSave},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"card card-danger card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-danger"},i.a.createElement("i",{className:"fas fa-address-book mr-2"}),t?"Editar contacto":"Registrar nuevo contacto",y&&C?i.a.createElement("span",{className:"ml-2 text-muted"},i.a.createElement("small",null,"(Almacenado automatico)")):null)),i.a.createElement("div",{className:"card-body"},N?i.a.createElement("div",{className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))):i.a.createElement("div",{className:"row was-validated"},i.a.createElement(M,{id:t,name:n,rfc:l,email:r,type:s,birthday:o,business:v,validName:y,validEmail:C,onChange:this.catchInputs}),i.a.createElement(J,{calle:c,colonia:m,municipio:p,estado:u,cp:h,onChange:this.catchInputs}),i.a.createElement(G,{t_casa:g,t_movil:b,t_oficina:f,onChange:this.catchInputs}))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"btn-group float-right",role:"group"},i.a.createElement(d.b,{to:"/contactos",className:"btn btn-dark",onClick:function(a){e.changePage("/contactos")}},i.a.createElement("i",{className:"fas fa-ban mr-1"}),"Cancelar"),i.a.createElement("button",{type:"submit",className:y&&C&&(g||f||b)?"btn btn-danger":"btn btn-danger disabled",disabled:y&&C&&(g||f||b)?"":"disabled"},i.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar")))))))),i.a.createElement("div",{className:"row"},this.state.calle&&!this.state.type?i.a.createElement("div",{className:"col"},i.a.createElement(T,{calle:this.state.calle,colonia:this.state.colonia,municipio:this.state.municipio,estado:this.state.estado,cp:this.state.cp,changeAddress:this.changeAddress})):"",this.state.id&&!this.state.type?i.a.createElement("div",{className:"col"},i.a.createElement(L,{paciente:this.state.id,exam:{},page:this.changePage,edad:1*E()(this.state.birthday).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"")})):""))}}]),t}(c.Component),H=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handleCategoryChange=function(e){var a=e.target,t=a.name,l=a.value;"category_id"===t&&l&&r.state.category_select.map((function(e){return e.id===1*l&&r.setState({category_hijos:e.hijos}),null})),"category_id_2"===t&&l&&r.state.category_hijos.map((function(e){return e.id===1*l&&r.setState({category_hijos_3:e.hijos}),null})),r.setState(Object(n.a)({},t,l))},r.handleChangePage=function(e){r.setState({page:e})},r.handleClickDelete=function(e){if(e&&window.confirm("\xbfRealmente desea eliminar esta categoria?")){var a=JSON.parse(localStorage.getItem("OrusSystem"));console.log("Enviando peticion de eliminado al API",e),fetch("http://"+a.host+"/api/categories/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){e.ok?(console.log("Categoria eliminada"),r.getCategories(),r.setState({newItem:0,add:!1})):window.alert("Ups!\n Algo salio mal, intentelo mas tarde.")})).catch((function(e){console.log(e)}))}},r.handleClickSave=function(){if(r.state.name.length>3){if(window.confirm("\xbfDeseal almacenar esta categoria?")){var e=JSON.parse(localStorage.getItem("OrusSystem")),a={name:r.state.name,category_id:r.state.category_id_3?r.state.category_id_3:r.state.category_id_2?r.state.category_id_2:r.state.category_id};console.log("Enviando categoria al API para almacenar"),fetch("http://"+e.host+"/api/categories",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.log("Error en API",e)),e.json()})).then((function(e){e.data&&(console.log("Categoria almacenada"),r.setState({newItem:e.data.id,name:"",category_id:0,add:!1}),r.getCategories())})).catch((function(e){console.log(e)}))}}else window.alert("Debe de escribir el nombre de la categoria"),r.nameInput.focus()},r.getCategories=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/categories",t=r.state.page>0?"?page="+r.state.page:"?page=1";console.log("Descargando lista de categorias"),fetch(a+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data&&(console.log("Lista de categorias descargadas"),r.setState({category_list:e.data,meta:e.meta}))})).catch((function(e){console.log(e)})),fetch(a+t+"&categoryid=raiz",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data&&r.setState({category_select:e.data})})).catch((function(e){console.log(e)}))},r.handleClickAdd=function(){r.setState({add:!r.state.add,name:"",category_id:0,category_id_2:0,category_id_3:0,category_hijos:[],category_hijos_3:[]})},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l.toLowerCase()))},r.state={category_list:[],category_select:[],category_hijos:[],category_hijos_3:[],meta:{},add:!1,name:"",category_id:0,category_id_2:0,category_id_3:0,newItem:0,page:1},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,a){a.page!==this.state.page&&(console.log("Recargando categorias"),this.getCategories())}},{key:"render",value:function(){var e=this,a=this.state,t=a.category_list,n=a.meta,l=[],r=this.state.category_hijos,s=this.state.category_hijos_3;if(t.length&&n.total>10)for(var o=1;o<=n.last_page;o++)l.push(i.a.createElement("li",{key:o,className:n.current_page===o?"page-item disabled":"page-item"},i.a.createElement("a",{href:"#page"+o,className:"page-link",onClick:this.handleChangePage.bind(this,o)},o)));return i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title"},"Categorias"),i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Nombre"),i.a.createElement("th",null,"Padre"),i.a.createElement("th",null,"Eliminar"))),i.a.createElement("tbody",null,t.length?t.map((function(a){var t="";return null!=a.depende_de&&(null!=a.depende_de.depende_de&&(t=a.depende_de.depende_de.categoria),t=t?t+"/"+a.depende_de.categoria:a.depende_de.categoria),t=t||"--",i.a.createElement("tr",{key:a.id,className:a.id===e.state.newItem?"table-success":""},i.a.createElement("td",{className:"text-capitalize"},a.categoria),i.a.createElement("td",{className:"text-capitalize"},t),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-outline-light btn-sm",onClick:function(t){e.handleClickDelete(a.id)}},i.a.createElement("i",{className:"fas fa-trash"}))))})):i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"8",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))))),this.state.add?i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("input",{type:"text",name:"name",className:"form-control",autoComplete:"off",value:this.state.name,onChange:this.catchInputs,ref:function(a){e.nameInput=a}})),i.a.createElement("td",null,i.a.createElement("select",{name:"category_id",className:"form-control",value:this.state.category_id,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Inicial"),this.state.category_select.map((function(e){return i.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))),r.length?i.a.createElement("select",{name:"category_id_2",className:"form-control mt-2",value:this.state.category_id_2,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Raiz"),this.state.category_hijos.map((function(e){return i.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))):"",s.length?i.a.createElement("select",{name:"category_id_3",className:"form-control mt-2",value:this.state.category_id_3,onChange:this.handleCategoryChange},i.a.createElement("option",{value:"0"},"Raiz"),this.state.category_hijos_3.map((function(e){return i.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))):""),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-dark btn-sm",onClick:this.handleClickSave},i.a.createElement("i",{className:"fas fa-check"}))))):i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"3"},Object.keys(n).length&&n.total>10?i.a.createElement("div",{className:"btn-group"},i.a.createElement("ul",{className:"pagination pagination-sm"},l)):""))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.handleClickAdd},this.state.add?i.a.createElement("i",{className:"fas fa-undo"}):i.a.createElement("i",{className:"fas fa-plus"}))))}}]),t}(c.Component),$=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).clickSave=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.company=r.state.company,e.host=r.state.server,localStorage.setItem("OrusSystem",JSON.stringify(e))},r.clickSaveUser=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.email=r.state.email,e.name=r.state.name,e.username=r.state.username,localStorage.setItem("OrusSystem",JSON.stringify(e))},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l.toLowerCase()))},r.state={server:"",company:"",email:"",name:"",username:"",password:"",category_list:[]},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));this.setState({server:e.host?e.host:window.location.host.split(":")[0],company:e.company?e.company:"",email:e.email?e.email:"",name:e.name?e.name:"",username:e.username?e.username:""})}},{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6"},i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title"},"Generales"),i.a.createElement("p",null,"\xa0"),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-server"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"server",value:this.state.server,onChange:this.catchInputs})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-building"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre de la empresa",name:"company",value:this.state.company,onChange:this.catchInputs}))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickSave},"Guardar"))),i.a.createElement(H,null)),i.a.createElement("div",{className:"col-6"},i.a.createElement("div",{className:"card card-primary card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title"},"Usuario"),i.a.createElement("p",null,"\xa0"),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-at"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Email",name:"email",value:this.state.email,onChange:this.catchInputs})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-user-tag"}))),i.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",value:this.state.name,onChange:this.catchInputs})),i.a.createElement("hr",null),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-user-check"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Usuario",name:"username",value:this.state.username,onChange:this.catchInputs})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-lock"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Contrase\xf1a",name:"password",value:this.state.password,onChange:this.catchInputs}))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickSaveUser},"Guardar")))))}}]),t}(c.Component),q=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("status",""),e.props.changeFilters("date",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.status,n=e.date;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: paciente",value:a||"",onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Estado"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-toggle-on"}))),i.a.createElement("select",{className:"form-control",name:"status",value:t,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"0"},"Activo"),i.a.createElement("option",{value:"1"},"Terminado"))),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Fecha"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-calendar-alt"}))),i.a.createElement("input",{type:"date",className:"form-control",name:"date",value:n,onChange:this.changeFilters}))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:a||n||t?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),K=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handleFilter=function(){r.setState({load:!0,page:1})},r.onchangeSearch=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.changePage=function(e){r.props.page(e.target.id)},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el examen del paciente "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&(r.setState({load:!0}),fetch("http://"+l+"/api/exams/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar el examen",e.message),r.setState({load:!1})):(console.log("Examen eliminado"),r.getExams(),window.alert("Examen eliminado con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))},r.state={exams:{data:[],meta:{}},load:!0,page:1,orderby:"created_at",order:"desc",search:"",status:0,date:E.a.utc(new Date).local().format("YYYY-MM-DD"),host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getExams(),E.a.locale("es")}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando citas"),this.getExams())}},{key:"render",value:function(){var e=this,a=this.state,t=a.exams,n=a.load;return i.a.createElement("div",{className:"card card-info card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-info"},i.a.createElement("i",{className:"fas fa-notes-medical mr-2"}),"Examanes de la vista"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(q,{search:this.state.search,status:this.state.status,date:this.state.date,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Paciente",type:"name",filter:!0},{name:"Edad"},{name:"Estado"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"8",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id,className:a.estado?"table-secondary":E.a.utc(new Date).isSame(E.a.utc(a.created_at),"hour")?"table-success":""},i.a.createElement("td",null,i.a.createElement(d.b,{to:"/consultorio/registro/"+a.id},i.a.createElement("span",{className:"badge badge-danger text-capitalize p-1"},a.paciente.nombre,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",null,a.edad?a.edad:"--"),i.a.createElement("td",{className:"text-uppercase"},a.estado?i.a.createElement("span",{className:"text-secondary"},"Terminado"):i.a.createElement("span",{className:"text-success"},"Activo")),i.a.createElement("td",null,E()(a.created_at).fromNow()),i.a.createElement("td",null,E()(a.updated_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.paciente.nombre,delete:a.estado?null:e.handleDelete,edit:"/consultorio/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"8",className:"text-center"},"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/consultorio/registro",className:"btn btn-outline-info",onClick:this.changePage,id:"/consultorio/registro"},i.a.createElement("i",{className:"fas fa-plus",id:"/consultorio/registro"}),"\xa0 Nuevo examen")))}},{key:"getExams",value:function(){var e=this,a=this.state,t=a.host,n=a.token,l=a.order,r=a.orderby,s=a.search,o=a.page,c=a.status,i=a.load,m=a.date,d="http://"+t+"/api/exams",p="&orderby=".concat(r,"&order=").concat(l),u=s?"&search=".concat(s):"",h=o>0?"?page="+o:"?page=1",g=""===m?"":"&date="+m,E=""===c?"":"&status="+c;i||this.setState({load:!0}),fetch(d+h+p+E+g+u,{method:"GET",signal:this.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(a){a.message?(console.log(a.message),e.setState({load:!1})):(console.log("Examenes descargados"),e.setState({exams:a,load:!1}))})).catch((function(a){console.log(a),e.setState({load:!1})}))}}]),t}(c.Component),W=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).getContact=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.json()})).then((function(e){console.log("Descargando contacto"),r.setState({dataContact:e.data,load:!1})})).catch((function(e){console.log(e)}))},r.handleChangePage=function(e){r.props.changePage(e)},r.handleClickChange=function(e){e.preventDefault(),window.confirm("\xbfRealmente desea cambiar de paciente?")&&(r.setState({contacto:"",data:[],dataContact:{}}),r.props.getIdContact(0))},r.handleClickContact=function(e,a){e.preventDefault(),r.state.data.map((function(e){if(e.id===a){r.setState({contacto:"",data:[],dataContact:e});var t=1*E()(e.f_nacimiento).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");return r.props.getIdContact(a,t),!1}return!0}))},r.getContacts=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem")),t="http://"+a.host+"/api/contacts",n=e?"&search=".concat(e):"";console.log("Descargando contactos de la API"),fetch(t+"?page=1"+n+"&type=0",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(a){a.data&&a.data.length?(console.log("Mostrando informaci\xf3n del contacto"),r.setState({data:a.data})):r.setState({data:[{id:0,nombre:"No hay contactos para: "+e}]})}))},r.handleSearcContact=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l))},r.state={contacto:"",data:[],dataContact:{},load:!0},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.contact;e?(this.setState({load:!0}),this.getContact(e)):this.contactInput.focus()}},{key:"componentDidUpdate",value:function(e,a){a.contacto!==this.state.contacto&&(this.state.contacto.length>2?this.getContacts(this.state.contacto):this.setState({data:[]})),e.contact!==this.props.contact&&this.props.contact&&(this.setState({load:!0}),this.getContact(this.props.contact))}},{key:"render",value:function(){var e=this;if(!this.props.contact)return i.a.createElement("div",{className:"card card-danger card-outline d-print-none"},i.a.createElement("div",{className:"card-body"},i.a.createElement("label",null,"Buscar paciente"),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-user"}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Nombre del paciente",name:"contacto",autoComplete:"off",value:this.state.contacto,onChange:this.handleSearcContact,ref:function(a){e.contactInput=a}})),this.state.data.length?i.a.createElement("ul",{className:"list-group"},this.state.data.map((function(a){return i.a.createElement("li",{key:a.id,className:"list-group-item"},i.a.createElement("a",{href:"#contact",className:"text-muted text-capitalize",onClick:function(t){e.handleClickContact(t,a.id)}},i.a.createElement("i",{className:"fas fa-user mr-1"}),a.nombre),a.id?"":i.a.createElement("p",null,i.a.createElement(d.b,{to:"/contactos/registro/",className:"btn btn-primary",onClick:function(a){e.handleChangePage("/contactos/registro/")}},i.a.createElement("i",{className:"fas fa-user mr-1"}),i.a.createElement("b",null,"Agregar nuevo paciente"))))}))):""));if(this.state.load)return i.a.createElement("div",{className:"card card-danger card-outline d-print-none"},i.a.createElement("div",{className:"card-body box-profile"},i.a.createElement("div",{className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))));if(Object.keys(this.state.dataContact).length){var a=this.state.dataContact,t=a.nombre,n=a.telefonos,l=a.domicilio,r=a.id,s=a.f_nacimiento,o=this.props.edad?this.props.edad+" a\xf1os":E()(s).fromNow(!0);return i.a.createElement("div",{className:"card card-danger card-outline"},i.a.createElement("div",{className:"card-body box-profile"},i.a.createElement("div",{className:"text-center"},i.a.createElement("img",{className:"profile-user-img img-fluid img-circle",src:"https://uybor.uz/borless/uybor/img/user-images/no-avatar.png",alt:"User Avatar"})),i.a.createElement("h3",{className:"profile-username text-center text-capitalize"},t),i.a.createElement("p",{className:"text-muted text-center"},n[2]?n[2]:n[0]?n[0]:n[1]?n[1]:i.a.createElement("span",{className:"text-danger"},"Capture el telefono")),i.a.createElement("p",{className:"text-muted text-center"},l[0]?l[0]:i.a.createElement("span",{className:"text-danger"},"Capture el domicilio")),i.a.createElement("ul",{className:"list-group list-group-unbordered mb-3"},i.a.createElement("li",{className:"list-group-item"},i.a.createElement("b",null,"Edad:"),i.a.createElement("span",{className:"float-right"},s?o:"--")),i.a.createElement("li",{className:"list-group-item"},i.a.createElement("b",null,"#Contacto:"),i.a.createElement("span",{className:"float-right"},r))),this.props.status?"":i.a.createElement("div",{className:"btn-group btn-block",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:this.handleClickChange},i.a.createElement("i",{className:"fas fa-exchange-alt mr-1"}),i.a.createElement("b",null,"Cambiar")),i.a.createElement(d.b,{to:"/contactos/registro/"+r,className:"btn btn-danger",onClick:function(a){e.handleChangePage("/contactos/registro/")}},i.a.createElement("i",{className:"fas fa-edit mr-1"}),i.a.createElement("b",null,"Editar")))))}}}]),t}(c.Component),Z=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"headingOne"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"},"Generales"))),i.a.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-3"},i.a.createElement("span",{className:"label label-default"},i.a.createElement("i",{className:"fas fa-desktop"})," PC"),i.a.createElement("input",{name:"pc",type:"checkbox",checked:this.props.pc,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"pc_time",className:"form-control input-xs",value:this.props.pc_time,onChange:this.catchInputs,readOnly:this.props.pc?"":"readonly"})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("span",{className:"label label-default"},i.a.createElement("i",{className:"fas fa-tablet"})," Tablet"),i.a.createElement("input",{name:"tablet",type:"checkbox",checked:this.props.tablet,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"tablet_time",className:"form-control input-xs",value:this.props.tablet_time,onChange:this.catchInputs,readOnly:this.props.tablet?"":"readonly"})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("span",{className:"label label-default"},i.a.createElement("i",{className:"fas fa-mobile"})," Telefono"),i.a.createElement("input",{name:"movil",type:"checkbox",checked:this.props.movil,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"movil_time",className:"form-control input-xs",value:this.props.movil_time,onChange:this.catchInputs,readOnly:this.props.movil?"":"readonly"})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("span",{className:"label label-default"},i.a.createElement("i",{className:"fa fa-laptop"})," Laptop"),i.a.createElement("input",{name:"lap",type:"checkbox",checked:this.props.lap,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"lap_time",className:"form-control input-xs",value:this.props.lap_time,onChange:this.catchInputs,readOnly:this.props.lap?"":"readonly"}))),i.a.createElement("div",{className:"row mt-1"},i.a.createElement("div",{className:"col-md-6"},i.a.createElement("ul",{className:"list-group"},i.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},"Frontal",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"frontal",type:"checkbox",checked:this.props.frontal,onChange:this.catchInputs}))),i.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},"Occipita",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"occipital",type:"checkbox",checked:this.props.occipital,onChange:this.catchInputs}))),i.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},"General",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"generality",type:"checkbox",checked:this.props.generality,onChange:this.catchInputs}))),i.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},"Cefalea",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"cefalea",type:"checkbox",checked:this.props.cefalea,onChange:this.catchInputs}))))),i.a.createElement("div",{className:"col-md-6"},i.a.createElement("ul",{className:"list-group"},i.a.createElement("li",{className:"list-group-item"},"Temporal",i.a.createElement("br",null),i.a.createElement("i",{className:"fa fa-eye"})," Izquierdo",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"temporaoi",type:"checkbox",checked:this.props.temporaoi,onChange:this.catchInputs})),i.a.createElement("i",{className:"fa fa-eye"})," Derecho",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{name:"temporaod",type:"checkbox",checked:this.props.temporaod,onChange:this.catchInputs}))),i.a.createElement("li",{className:"list-group-item"},"Frecuencia",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{type:"text",name:"c_frecuencia",maxLength:"60",className:"form-control input-xs",value:this.props.c_frecuencia,onChange:this.catchInputs}))),i.a.createElement("li",{className:"list-group-item"},"Intensidad",i.a.createElement("span",{className:"badge badge-pill"},i.a.createElement("input",{type:"range",name:"c_intensidad",min:"0",max:"4",value:this.props.c_intensidad,onChange:this.catchInputs})))))))))}}]),t}(c.Component),V=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"headingThree"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#collapseThree","aria-expanded":"false","aria-controls":"collapseThree"},"Interrogatorios"))),i.a.createElement("div",{id:"collapseThree",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Interrogatorio inicial"),i.a.createElement("textarea",{name:"interrogatorio",className:"form-control",value:this.props.interrogatorio,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Cirugias oculares"),i.a.createElement("textarea",{name:"coa",className:"form-control",value:this.props.coa,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Antecedentes oculares patologicas personales"),i.a.createElement("textarea",{name:"aopp",className:"form-control",rows:"2",value:this.props.aopp,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Antecedentes oculares patologicas familiares"),i.a.createElement("textarea",{name:"aopf",className:"form-control",rows:"2",value:this.props.aopf,onChange:this.catchInputs}))))))}}]),t}(c.Component),X=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#panel_100","aria-expanded":"true","aria-controls":"panel_100"},"Keratrometria y Retinoscopia"))),i.a.createElement("div",{id:"panel_100",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6"},"Keratometria"),i.a.createElement("div",{className:"col-6"},"Retinoscopia")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},i.a.createElement("i",{className:"fas fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"keratometriaoi",maxLength:"12",className:"form-control input-xs",value:this.props.keratometriaoi,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fas fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"keratometriaod",maxLength:"12",className:"form-control input-xs",value:this.props.keratometriaod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"rsod",maxLength:"16",className:"form-control",value:this.props.rsod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"rsoi",maxLength:"16",className:"form-control",value:this.props.rsoi,onChange:this.catchInputs}))))))}}]),t}(c.Component),Y=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading4"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#caja4","aria-expanded":"false","aria-controls":"caja4"},"Diabetes"))),i.a.createElement("div",{id:"caja4",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-8"},i.a.createElement("label",null,"Diab\xe9tico")),i.a.createElement("div",{className:"col-md-4"},i.a.createElement("label",null,"Fotocoagulaci\xf3n laser"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},"Fecha"),i.a.createElement("div",{className:"col-2"},"Rango de glucosa"),i.a.createElement("div",{className:"col-3"},"Ultimo examen"),i.a.createElement("div",{className:"col-2"},i.a.createElement("i",{className:"fa fa-eye"})," Derecho"),i.a.createElement("div",{className:"col-2"},i.a.createElement("i",{className:"fa fa-eye"})," Izquierdo")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-3"},i.a.createElement("input",{type:"date",name:"d_time",className:"form-control",value:this.props.d_time,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-2"},i.a.createElement("input",{type:"text",name:"d_media",className:"form-control",value:this.props.d_media,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("input",{type:"date",name:"d_test",className:"form-control",value:this.props.d_test,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-2"},i.a.createElement("input",{name:"d_fclod",type:"checkbox",checked:this.props.d_fclod,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"d_fclod_time",className:"form-control",value:this.props.d_fclod_time,onChange:this.catchInputs,readOnly:this.props.d_fclod?"":"readonly"})),i.a.createElement("div",{className:"col-md-2"},i.a.createElement("input",{name:"d_fcloi",type:"checkbox",checked:this.props.d_fcloi,onChange:this.catchInputs}),i.a.createElement("input",{type:"time",name:"d_fcloi_time",className:"form-control",value:this.props.d_fcloi_time,onChange:this.catchInputs,readOnly:this.props.d_fcloi?"":"readonly"}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Oftalmoscopia"),i.a.createElement("textarea",{name:"oftalmoscopia",className:"form-control",value:this.props.oftalmoscopia,onChange:this.catchInputs}))))))}}]),t}(c.Component),Q=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading5"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#caja5","aria-expanded":"false","aria-controls":"caja5"},"Capacidad y agudeza visual"))),i.a.createElement("div",{id:"caja5",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},"Capacidad visual")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"cvod",maxLength:"12",className:"form-control",value:this.props.cvod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"cvoi",maxLength:"12",className:"form-control",value:this.props.cvoi,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-md-6"},"Agudeza visual (Sin lentes)"),i.a.createElement("div",{className:"col-md-6"},"Agudeza visual (con la graduaci\xf3n anterior)")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"avslod",maxLength:"12",className:"form-control",value:this.props.avslod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"avsloi",maxLength:"12",className:"form-control",value:this.props.avsloi,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"text",name:"avcgaod",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"text",name:"avcgaoi",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaoi,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"},"Agudeza visual final")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("br",null),i.a.createElement("input",{type:"text",name:"avfod",maxLength:"12",className:"form-control",value:this.props.avfod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("br",null),i.a.createElement("input",{type:"text",name:"avfoi",maxLength:"12",className:"form-control",value:this.props.avfoi,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-4"},i.a.createElement("i",{className:"fa fa-eye"}),i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Ambos"),i.a.createElement("br",null),i.a.createElement("input",{type:"text",name:"avf2o",maxLength:"25",className:"form-control",value:this.props.avf2o,onChange:this.catchInputs}))))))}}]),t}(c.Component),ee=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading6"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#caja6","aria-expanded":"false","aria-controls":"caja6"},"Diagnostico"))),i.a.createElement("div",{id:"caja6",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-6"}),i.a.createElement("div",{className:"col-md-6"},"Tensi\xf3n ocular")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-3"},"Diagnostico",i.a.createElement("select",{name:"diagnostico",className:"form-control",value:this.props.diagnostico,onChange:this.catchInputs},i.a.createElement("option",{value:"Hemetrope"},"Hem\xe9trope"),i.a.createElement("option",{value:"hipermetropia"},"Hipermetrop\xeda"),i.a.createElement("option",{value:"hipermetropia-astigmatismo"},"Hipermetrop\xeda y astigmatismo"),i.a.createElement("option",{value:"hipermetropia-miopia"},"Hipermetrop\xeda y miop\xeda"),i.a.createElement("option",{value:"astigmatismo-regla"},"Astigmatismo con la regla"),i.a.createElement("option",{value:"astigmatismo-contra-regla"},"Astigmatismo contra la regla"),i.a.createElement("option",{value:"astigmatismo-oblicuo"},"Astigmatismo oblicuo"),i.a.createElement("option",{value:"astigmatismo-miopia"},"Astigmatismo/m\xedopico"),i.a.createElement("option",{value:"miopia"},"Miop\xeda"))),i.a.createElement("div",{className:"col-md-3"},"Presbicie",i.a.createElement("br",null),i.a.createElement("input",{name:"presbicie",type:"checkbox",checked:this.props.presbicie,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Derecho"),i.a.createElement("input",{type:"number",name:"piod",min:"0",max:"40",step:"1",className:"form-control",value:this.props.piod,onChange:this.catchInputs})),i.a.createElement("div",{className:"col-md-3"},i.a.createElement("i",{className:"fa fa-eye"})," ",i.a.createElement("label",null,"Izquierdo"),i.a.createElement("input",{type:"number",name:"pioi",min:"0",max:"40",step:"1",className:"form-control",value:this.props.pioi,onChange:this.catchInputs}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",null,"Tratamiento oftalmico"),i.a.createElement("textarea",{name:"txoftalmico",className:"form-control",value:this.props.txoftalmico,onChange:this.catchInputs}))))))}}]),t}(c.Component),ae=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading8"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#caja8","aria-expanded":"false","aria-controls":"caja8"},"Observaciones"))),i.a.createElement("div",{id:"caja8",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement("textarea",{name:"observaciones",className:"form-control",value:this.props.observaciones,onChange:this.catchInputs}))))}}]),t}(c.Component),te=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handleChangeInput=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleStatus=function(){r.setState({status:!r.state.status})},r.getIdContact=function(e,a){r.setState({contact_id:e,edad:a})},r.changePage=function(e){r.props.page(e)},r.catchInputs=function(e){var a=e.target.name,t="checkbox"===e.target.type?e.target.checked:e.target.value.toLowerCase();r.setState(Object(n.a)({},a,t))},r.handleSave=function(e){if(e.preventDefault(),window.confirm("\xbfEsta seguro de realizar la accion?")){var a=r.state,t=a.load,n=a.host,l=a.token,s=r.state,o=r.state.id,c=o?"http://"+n+"/api/exams/"+o:"http://"+n+"/api/exams",i=o?"PUT":"POST";s.category_id||delete s.category_id,t||r.setState({load:!0}),console.log("Enviando datos del examen a la API"),fetch(c,{method:i,signal:r.signal,body:JSON.stringify(s),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Contacto almacenado"),window.confirm("Examen almacenado con exito!.\n\xbfDesea cerrar este contacto?")?r.props.history.goBack():r.setState({load:!1,id:e.data.id})):(window.alert("Error al almacenar el examen. Intentelo mas tarde"),console.error(e.message),r.setState({load:!1}))})).catch((function(e){console.log(e)}))}},r.getExam=function(e){if(e){var a=r.state,t=a.host,n=a.token;a.load||r.setState({load:!0}),console.log("Descargando datos del contacto"),fetch("http://"+t+"/api/exams/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al cargar el usuario",e.message),r.setState({load:!1})):(console.log("Mostrando examenes"),r.setState({contact_id:e.data.paciente.id,edad:e.data.edad,id:e.data.id,keratometriaoi:e.data.keratometriaoi,keratometriaod:e.data.keratometriaod,pantalleooi:e.data.pantalleooi,pantalleood:e.data.pantalleood,interrogatorio:e.data.interrogatorio,cefalea:e.data.cefalea,c_frecuencia:e.data.c_frecuencia,c_intensidad:e.data.c_intensidad,frontal:e.data.frontal,temporal:e.data.temporal,occipital:e.data.occipital,generality:e.data.generality,temporaoi:e.data.temporaoi,temporaod:e.data.temporaod,coa:e.data.coa,aopp:e.data.aopp,aopf:e.data.aopf,avsloi:e.data.avsloi,avslod:e.data.avslod,avcgaoi:e.data.avcgaoi,avcgaod:e.data.avcgaod,cvoi:e.data.cvoi,cvod:e.data.cvod,oftalmoscopia:e.data.oftalmoscopia,rsoi:e.data.rsoi,rsod:e.data.rsod,diagnostico:e.data.diagnostico,presbicie:e.data.presbicie,txoftalmico:e.data.txoftalmico,esferaoi:e.data.esferaoi,esferaod:e.data.esferaod,cilindroi:e.data.cilindroi,cilindrod:e.data.cilindrod,ejeoi:e.data.ejeoi,ejeod:e.data.ejeod,adicioni:e.data.adicioni,adiciond:e.data.adiciond,dpoi:e.data.dpoi,dpod:e.data.dpod,avfoi:e.data.avfoi,avfod:e.data.avfod,avf2o:e.data.avf2o,lcmarca:e.data.lcmarca,lcgoi:e.data.lcgoi,lcgod:e.data.lcgod,txoptico:e.data.txoptico,alturaoi:e.data.alturaoi,alturaod:e.data.alturaod,pioi:e.data.pioi,piod:e.data.piod,observaciones:e.data.observaciones,pc:e.data.pc,tablet:e.data.tablet,movil:e.data.movil,lap:e.data.lap,lap_time:e.data.lap_time,pc_time:e.data.pc_time,tablet_time:e.data.tablet_time,movil_time:e.data.movil_time,d_time:e.data.d_time,d_media:e.data.d_media,d_test:e.data.d_test,d_fclod:e.data.d_fclod,d_fcloi:e.data.d_fcloi,d_fclod_time:e.data.d_fclod_time,d_fcloi_time:e.data.d_fcloi_time,category_id:e.data.category_id,status:e.data.estado}))})).catch((function(e){console.log(e)}))}},r.state={id:0,edad:0,keratometriaoi:"",keratometriaod:"",pantalleooi:"",pantalleood:"",interrogatorio:"",cefalea:!1,c_frecuencia:"",c_intensidad:0,frontal:!1,temporal:!1,occipital:!1,generality:!1,temporaoi:!1,temporaod:!1,coa:"",aopp:"",aopf:"",avsloi:"",avslod:"",avcgaoi:"",avcgaod:"",cvoi:"",cvod:"",oftalmoscopia:"",rsoi:"",rsod:"",diagnostico:"Hemetrope",presbicie:!0,txoftalmico:"",esferaoi:0,esferaod:0,cilindroi:0,cilindrod:0,ejeoi:0,ejeod:0,adicioni:0,adiciond:0,dpoi:0,dpod:0,avfoi:"",avfod:"",avf2o:"",lcmarca:"",lcgoi:"",lcgod:"",txoptico:"",alturaoi:0,alturaod:0,pioi:0,piod:0,observaciones:"",pc:!1,tablet:!1,movil:!1,lap:!1,lap_time:"00:00",pc_time:"00:00",tablet_time:"00:00",movil_time:"00:00",d_time:"00:00",d_media:"",d_test:"",d_fclod:!1,d_fcloi:!1,d_fclod_time:"00:00",d_fcloi_time:"00:00",category_id:0,contact_id:0,status:0,load:!1,host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;e&&this.getExam(e)}},{key:"render",value:function(){var e=this,a=this.state.contact_id;return i.a.createElement("form",{className:"row"},i.a.createElement("div",{className:"col-md-4"},i.a.createElement(W,{contact:this.state.contact_id,edad:this.state.edad,status:this.state.status,getIdContact:this.getIdContact,changePage:this.changePage}),a?i.a.createElement(F,{category_id:this.state.category_id,onChangeInput:this.handleChangeInput,update:!0}):null),i.a.createElement("div",{className:"col-md-8"},i.a.createElement("div",{className:"card card-info card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title"},i.a.createElement("i",{className:"fas fa-notes-medical mr-1"}),this.state.id?"Examen":"Nuevo examen")),i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"accordion",id:"accordionExample"},a?i.a.createElement(i.a.Fragment,null,i.a.createElement(Z,{pc:this.state.pc,tablet:this.state.tablet,movil:this.state.movil,lap:this.state.lap,lap_time:this.state.lap_time,pc_time:this.state.pc_time,tablet_time:this.state.tablet_time,movil_time:this.state.movil_time,cefalea:this.state.cefalea,c_frecuencia:this.state.c_frecuencia,c_intensidad:this.state.c_intensidad,frontal:this.state.frontal,temporal:this.state.temporal,occipital:this.state.occipital,generality:this.state.generality,temporaoi:this.state.temporaoi,temporaod:this.state.temporaod,onChangeInput:this.handleChangeInput}),i.a.createElement(V,{interrogatorio:this.state.interrogatorio,coa:this.state.coa,aopp:this.state.aopp,aopf:this.state.aopf,onChangeInput:this.handleChangeInput}),i.a.createElement(X,{keratometriaoi:this.state.keratometriaoi,keratometriaod:this.state.keratometriaod,rsoi:this.state.rsoi,rsod:this.state.rsod,onChangeInput:this.handleChangeInput}),i.a.createElement(Y,{d_time:this.state.d_time,d_media:this.state.d_media,d_test:this.state.d_test,d_fclod:this.state.d_fclod,d_fclod_time:this.state.d_fclod_time,d_fcloi:this.state.d_fcloi,d_fcloi_time:this.state.d_fcloi_time,oftalmoscopia:this.state.oftalmoscopia,onChangeInput:this.handleChangeInput}),i.a.createElement(Q,{cvod:this.state.cvod,cvoi:this.state.cvoi,avslod:this.state.avslod,avsloi:this.state.avsloi,avcgaod:this.state.avcgaod,avcgaoi:this.state.avcgaoi,avfod:this.state.avfod,avfoi:this.state.avfoi,avf2o:this.state.avf2o,onChangeInput:this.handleChangeInput}),i.a.createElement(ee,{diagnostico:this.state.diagnostico,presbicie:this.state.presbicie,piod:this.state.piod,pioi:this.state.pioi,txoftalmico:this.state.txoftalmico,onChangeInput:this.handleChangeInput}),i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header",id:"heading7"},i.a.createElement("h2",{className:"mb-0"},i.a.createElement("button",{className:"btn btn-link btn-block text-left text-info collapsed",type:"button","data-toggle":"collapse","data-target":"#caja7","aria-expanded":"false","aria-controls":"caja7"},"Graduaci\xf3n"))),i.a.createElement("div",{id:"caja7",className:"collapse","aria-labelledby":"headingThree","data-parent":"#accordionExample"},i.a.createElement("div",{className:"card-body"},i.a.createElement(U,{esferaod:this.state.esferaod,esferaoi:this.state.esferaoi,cilindrod:this.state.cilindrod,cilindroi:this.state.cilindroi,ejeod:this.state.ejeod,ejeoi:this.state.ejeoi,adiciond:this.state.adiciond,adicioni:this.state.adicioni,dpod:this.state.dpod,dpoi:this.state.dpoi,alturaod:this.state.alturaod,alturaoi:this.state.alturaoi,lcmarca:this.state.lcmarca,lcgod:this.state.lcgod,lcgoi:this.state.lcgoi,onChangeInput:this.handleChangeInput})))),i.a.createElement(ae,{observaciones:this.state.observaciones,onChangeInput:this.handleChangeInput})):i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body text-info"},i.a.createElement("i",{className:"fas fa-exclamation-triangle mr-2"}),i.a.createElement("label",null,"Elija primero un paciente"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("div",{className:"btn-group",role:"group"},i.a.createElement(d.b,{to:"/consultorio",className:"btn btn-dark",onClick:function(a){e.changePage("/consultorio")}},i.a.createElement("i",{className:"fas fa-ban mr-1"}),i.a.createElement("strong",null,"Cancelar")),i.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:this.handleStatus},i.a.createElement("i",{className:this.state.status?"fas fa-lock-open mr-1":"fas fa-lock mr-1"}),i.a.createElement("strong",null,this.state.status?"Activar":"Terminar")),i.a.createElement("button",{type:"button",className:a?"btn btn-info":"btn btn-info disabled",onClick:this.handleSave,disabled:a?"":"disabled"},i.a.createElement("i",{className:"fas fa-save mr-1"}),i.a.createElement("strong",null,"Guardar")))))))}}]),t}(c.Component),ne=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("status",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.status;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: paciente o # de orden",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Estado"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-address-book"}))),i.a.createElement("select",{className:"form-control",name:"status",value:t,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"0"},"En proceso"),i.a.createElement("option",{value:"1"},"Laboratorio"),i.a.createElement("option",{value:"2"},"Bicelaci\xf3n"),i.a.createElement("option",{value:"3"},"Terminado"),i.a.createElement("option",{value:"4"},"Garantia"),i.a.createElement("option",{value:"5"},"Baja")))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:a?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),le=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).setStatusString=function(e){switch(e){case 0:return i.a.createElement("span",{className:"text-warning text-uppercase"},"En proceso");case 1:return i.a.createElement("span",{className:"text-info text-uppercase"},"En laboratorio");case 2:return i.a.createElement("span",{className:"text-primary text-uppercase"},"Bicelaci\xf3n");case 3:return i.a.createElement("span",{className:"text-success text-uppercase"},"Terminado");case 4:return i.a.createElement("span",{className:"text-info text-uppercase"},"Garantia");default:return i.a.createElement("span",{className:"text-secondary text-uppercase"},"Baja")}},r.handleFilter=function(){r.setState({load:!0,page:1})},r.onchangeSearch=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.changePage=function(e){r.props.page(e)},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el pedido de "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&(r.setState({load:!0}),console.log("Solicitud de eliminaci\xf3n por API"),fetch("http://"+l+"/api/orders/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar el pedido",e.message),r.setState({load:!1})):(console.log("Pedido eliminado"),r.getPedidos(),window.alert("Pedido eliminado con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))};var s=JSON.parse(localStorage.getItem("OrusOrder"));return r.state={pedidos:{data:[],meta:{}},load:!0,page:s?s.page:1,orderby:s?s.orderby:"created_at",order:s?s.order:"asc",search:s?s.search:"",status:s?s.status:"",host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getPedidos(),E.a.locale("es"),localStorage.setItem("OrusOrder",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,status:this.state.status}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando pedidos"),this.getPedidos(),localStorage.setItem("OrusOrder",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,status:this.state.status})))}},{key:"render",value:function(){var e=this,a=this.state,t=a.pedidos,n=a.load;return i.a.createElement("div",{className:"card card-warning card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-warning"},i.a.createElement("i",{className:"fas fa-clipboard-list mr-1"}),"Listado de pedidos"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(ne,{search:this.state.search,status:this.state.status,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Folio",type:"id",filter:!0},{name:"Caja"},{name:"Paciente",type:"contact_id",filter:!0},{name:"Detalles"},{name:"Estado"},{name:"Nota"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"10",className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,i.a.createElement("span",{className:"badge badge-warning text-capitalize"},a.id)),i.a.createElement("td",{className:"text-uppercase"},2===a.estado?i.a.createElement("span",null,a.caja?a.caja:"Sin asignar"):"--"),i.a.createElement("td",null,i.a.createElement(d.b,{to:"/pedidos/registro/"+a.id},i.a.createElement("span",{className:"badge badge-danger text-capitalize p-1"},a.paciente.nombre,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",{className:"text-uppercase"},1===a.estado?i.a.createElement("div",null,i.a.createElement("span",{className:"text-danger mr-1"},a.laboratorio?a.laboratorio.nombre:"Sin asignar")," ",a.laboratorio?"/ "+a.folio_lab:""):2===a.estado?i.a.createElement("small",null,a.observaciones?a.observaciones:"sin observaciones"):a.estado?"--":i.a.createElement("small",null,a.examen?"Terminado"===a.examen.estado?"Examen completado":"Examen no realizado":"Examen no asignado")),i.a.createElement("td",null,e.setStatusString(a.estado)),i.a.createElement("td",{className:"text-right"},i.a.createElement(d.b,{to:"/notas/registro/"+a.nota.id},i.a.createElement("span",{className:"badge badge-success"},a.nota.id))),i.a.createElement("td",{className:"text-capitalize"},E()(a.updated_at).fromNow()),i.a.createElement("td",{className:"text-capitalize"},E()(a.created_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.paciente.nombre,delete:e.handleDelete,edit:"/pedidos/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/pedidos/registro",className:"btn btn-outline-warning",onClick:function(a){e.changePage("/pedidos/registro")}},i.a.createElement("i",{className:"fas fa-plus mr-2"}),i.a.createElement("strong",null,"Nuevo pedido"))))}},{key:"getPedidos",value:function(){var e=this,a=this.state,t=a.search,n=a.status,l=a.page,r=a.order,s=a.orderby,o=a.host,c=a.token,i="http://"+o+"/api/orders",m="&orderby=".concat(s,"&order=").concat(r),d=t?"&search=".concat(t):"";fetch(i+(l>0?"?page="+l:"?page=1")+m+d+(n?"&status="+n:""),{method:"GET",signal:this.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(a){a.message?(console.error("Error en la descarga los pedidos",a.message),e.setState({load:!1})):(console.log("Mostrando datos del pedidos"),e.setState({pedidos:a,load:!1}))})).catch((function(a){console.error(a),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),e.setState({load:!1})}))}}]),t}(c.Component),re=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handelClickItemDb=function(e,a,t,n){e&&r.setState({id:0,store_items_id:e,producto:a,precio:t,subtotal:r.state.cantidad*t,inStorage:n>=r.state.cantidad?1:0,out:n,itemsDb:[]})},r.deleteItem=function(e){var a=r.props.items;a.splice(e,1),r.props.ChangeInput("items",a)},r.catchInputs=function(e){var a,t=e.target,l=t.name,s=t.value,o=t.type,c=0;if("cantidad"===l?c=r.state.precio*s:"precio"===l&&(c=r.state.cantidad*s),"number"===o&&(s*=1),"producto"===l&&s.length>3&&!r.state.store_items_id){var i=JSON.parse(localStorage.getItem("OrusSystem")),m="http://"+i.host+"/api/store",d="?search="+s;console.log("Descargando datos del item"),fetch(m+d,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+i.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){e.data&&e.data.length?(console.log("Almacenando datos del item del DB"),r.setState({itemsDb:e.data})):e.message&&console.log("Error al almacenar items de la DB",e.message)}))}r.setState((a={},Object(n.a)(a,l,s),Object(n.a)(a,"subtotal",c),a))},r.addItem=function(e){e.preventDefault();var a=r.props.items,t=a.find((function(e){return e.store_items_id===r.state.store_items_id})),n=r.state;if(t)for(var l=0;l<a.length;l++)a[l].store_items_id===n.store_items_id&&(n.cantidad+=a[l].cantidad,n.subtotal=n.cantidad*n.precio,a.splice(l,1));n.inStorage=n.out>=n.cantidad?1:0,n.out=n.out>=n.cantidad?0:n.cantidad-n.out,delete n.itemNew,delete n.itemsDb,delete n.items,a.push(n),r.setState({id:0,store_items_id:0,cantidad:1,producto:"",precio:0,total:0,inStorage:0,out:0,itemNew:!1}),console.log("Envio de nuevos productos",a),r.props.ChangeInput("items",a)},r.handleNewItem=function(e){e.preventDefault(),r.setState({itemNew:!r.state.itemNew,store_items_id:0,cantidad:1,producto:"",precio:0,subtotal:0,inStorage:0,out:0,itemsDb:[]})},r.state={id:0,store_items_id:0,session:"",cantidad:1,precio:0,subtotal:0,inStorage:0,producto:"",out:0,itemNew:!1,itemsDb:[]},r.total=0,r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.setState({session:this.props.session})}},{key:"componentDidUpdate",value:function(e,a){this.state.itemNew&&0===this.state.producto.length&&this.inputItem.focus()}},{key:"render",value:function(){var e=this,a=this.state,t=a.itemNew,n=a.itemsDb,l=this.props.items;return this.total=0,i.a.createElement("table",{className:"table table-sm table-striped  mt-2"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col",style:{width:64}},"Cantidad"),i.a.createElement("th",{scope:"col"},"Descripcion"),i.a.createElement("th",{scope:"col",style:{width:80}},"Precio"),i.a.createElement("th",{scope:"col",style:{width:80}},"Subtotal"),i.a.createElement("th",{scope:"col",style:{width:60}}))),i.a.createElement("tbody",null,t?i.a.createElement(i.a.Fragment,null,i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("input",{className:this.state.store_items_id?"form-control":"form-control disabled",disabled:!this.state.store_items_id,type:"number",name:"cantidad",ref:function(a){e.inputCant=a},value:this.state.cantidad,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:this.state.store_items_id?"form-control disabled":"form-control",disabled:!!this.state.store_items_id,type:"text",name:"producto",autoComplete:"off",ref:function(a){e.inputItem=a},value:this.state.producto,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:this.state.store_items_id?"form-control":"form-control disabled",disabled:!this.state.store_items_id,type:"number",name:"precio",value:this.state.precio,onChange:this.catchInputs})),i.a.createElement("td",null,i.a.createElement("input",{className:"form-control disabled",type:"number",name:"subtotal",value:this.state.subtotal,readOnly:!0})),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:this.addItem},i.a.createElement("i",{className:"fas fa-plus"})))),n.length?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"5"},i.a.createElement("div",{className:"list-group"},n.map((function(a){return i.a.createElement("a",{className:"list-group-item list-group-item-action",href:"#"+a.codigo,key:a.id,onClick:function(t){t.preventDefault(),e.handelClickItemDb(a.id,a.producto,a.precio,a.cantidades)}},"(",a.codigo,")",a.producto," / ",a.marca)}))))):i.a.createElement("tr",null)):i.a.createElement("tr",null),l.length?l.map((function(a,t){return e.total+=1*a.subtotal,i.a.createElement("tr",{key:t},i.a.createElement("td",{className:"text-right"},a.cantidad),i.a.createElement("td",null,i.a.createElement("span",{className:a.inStorage?"badge badge-primary":"badge badge-warning"},a.producto)),i.a.createElement("td",{className:"text-right"},"$ ",a.precio.toFixed(2)),i.a.createElement("td",{className:"text-right"},"$ ",a.subtotal.toFixed(2)),i.a.createElement("td",{className:"d-print-none"},i.a.createElement("button",{className:e.props.status?"btn btn-outline-light btn-sm disabled":"btn btn-outline-light btn-sm",disabled:!!e.props.status,onClick:function(a){e.props.status||e.deleteItem(t)}},i.a.createElement("i",{className:"fas fa-trash"}))))})):i.a.createElement("tr",null,i.a.createElement("td",{className:"text-center",colSpan:"5"},"No hay articulos cargados"))),i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("td",{className:"text-right",colSpan:"2"},this.props.status?"":i.a.createElement("button",{className:this.props.status?"btn btn-outline-success btn-sm disabled":"btn btn-outline-success btn-sm",disabled:!!this.props.status,onClick:this.handleNewItem},i.a.createElement("i",{className:t?"fas fa-times-circle":"fas fa-plus"}))),i.a.createElement("th",{scope:"row",className:"text-right"},"Subtotal"),i.a.createElement("td",{className:"text-right"},"$ ",this.total.toFixed(2)),i.a.createElement("td",null))))}}]),t}(c.Component),se=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).changeInput=function(e){e.preventDefault();var a=e.target,t=a.name,l=a.value;n.props.ChangeInput(t,l)},n.getContacts=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/contacts";console.log("Descargando proveedores de la API"),fetch(a+"?page=1&type=1&business=1",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data&&(console.log("Almacenado proveedores"),n.setState({supplies:e.data}))}))},n.state={supplies:[]},n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getContacts()}},{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",null,"Laboratorio"),i.a.createElement("select",{className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"lab_id",value:this.props.lab_id,onChange:this.changeInput},i.a.createElement("option",{value:"0"},"Seleccione un proveedor"),this.state.supplies.length?this.state.supplies.map((function(e){return i.a.createElement("option",{key:e.id,value:e.id},e.nombre)})):""))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",null,"Folio"),i.a.createElement("input",{type:"text",className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"npedidolab",value:this.props.npedidolab,onChange:this.changeInput}))))}}]),t}(c.Component),oe=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).changeInput=function(a){a.preventDefault();var t=a.target,n=t.name,l=t.value;l*=1,e.props.ChangeInput(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",{htmlFor:"lab"},"Estado"),i.a.createElement("select",{className:"form-control",name:"status",value:this.props.status,onChange:this.changeInput},i.a.createElement("option",{value:"0"},"En proceso"),i.a.createElement("option",{value:"1"},"Laboratorio"),i.a.createElement("option",{value:"2"},"Bicelaci\xf3n"),i.a.createElement("option",{value:"3"},"Terminado"),i.a.createElement("option",{value:"4"},"Garantia")))))}}]),t}(c.Component),ce=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).changeInput=function(a){a.preventDefault();var t=a.target,n=t.name,l=t.value;"caja"===n&&(l*=1),e.props.ChangeInput(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",{htmlFor:"lab"},"Caja"),i.a.createElement("input",{type:"text",className:this.props.status>2?"form-control disabled":"form-control",disabled:this.props.status>2,name:"ncaja",value:this.props.ncaja?this.props.ncaja:"",onChange:this.changeInput}))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",null,"Observaciones"),i.a.createElement("textarea",{name:"observaciones",className:this.props.status>2?"form-control disabled":"form-control",disabled:this.props.status>2,value:this.props.observaciones?this.props.observaciones:"",onChange:this.changeInput}))))}}]),t}(c.Component),ie=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).changeInput=function(a){a.preventDefault();var t=a.target,n=t.name,l=t.value;l*=1,e.props.ChangeInput(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2"},i.a.createElement("label",{htmlFor:"lab"},"Garantia"))))}}]),t}(c.Component),me=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).getMessengers=function(){var e=n.state,a=e.load,t=e.host,l=e.token,r=n.props,s="http://"+t+"/api/messengers",o="&table="+r.table+"&idRow="+r.idRow;a||n.setState({load:!0}),console.log("Solicitando mensajes de la API"),fetch(s+"?page=1"+o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Almacenado mensajes"),n.setState({messages:e.data,load:!1})):(console.error(e.message),n.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),n.setState({load:!1})}))},n.state={messages:[],load:!0,host:e.data.host,token:e.data.token},n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getMessengers()}},{key:"render",value:function(){var e=this.props.data,a=this.state,t=a.messages,n=a.load,l=e.idUser;return i.a.createElement("div",{className:"card direct-chat direct-chat-primary"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title"},i.a.createElement("i",{className:"fas fa-comments mr-1"}),"Chat")),n?i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"card-text text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))):t.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"direct-chat-messages"},t.map((function(e){return i.a.createElement("div",{className:e.created_user.id===l?"direct-chat-msg right":"direct-chat-msg",key:e.id},i.a.createElement("div",{className:"direct-chat-infos clearfix"},i.a.createElement("span",{className:e.created_user.id===l?"direct-chat-name float-right":"direct-chat-name float-left"},e.created_user.name),i.a.createElement("span",{className:e.created_user.id===l?"direct-chat-timestamp float-left":"direct-chat-timestamp float-right"},E()(e.updated_at).format("lll"))),i.a.createElement("img",{className:"direct-chat-img",src:1===e.created_user.id?"/img/OrusBot.png":"/img/avatar.png",alt:"message user image1"}),i.a.createElement("div",{className:"direct-chat-text"},e.mensaje))})))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("form",{action:"#",method:"post"},i.a.createElement("div",{className:"input-group"},i.a.createElement("input",{type:"text",name:"message",placeholder:"Escriba un mensaje ...",className:"form-control"}),i.a.createElement("span",{className:"input-group-append"},i.a.createElement("button",{type:"button",className:"btn btn-primary"},"Enviar")))))):i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"card-text text-center p-4"},i.a.createElement("h5",null,i.a.createElement("i",{className:"fas fa-comment-slash mr-1"}),"No hay mensajes aun"))))}}]),t}(c.Component),de=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handleChangeInput=function(e,a){r.setState(Object(n.a)({},e,a))},r.getIdContact=function(e,a){r.setState({contact_id:e,edad:a})},r.changePage=function(e){r.props.page(e)},r.handleSave=function(e){if(e.preventDefault(),window.confirm("\xbfEsta seguro de realizar la accion de guardar?")){var a=r.state,t=a.id,n=a.load,l=a.host,s=a.token,o=t?"http://"+l+"/api/orders/"+t:"http://"+l+"/api/orders",c=t?"PUT":"POST",i={},m=[];r.state.items.map((function(e){return m.push({cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,session:e.session,out:e.out,store_items_id:e.store_items_id}),!1})),i={session:r.state.session,observaciones:r.state.observaciones,npedidolab:r.state.npedidolab,ncaja:r.state.ncaja,contact_id:r.state.contact_id,status:r.state.status,items:JSON.stringify(m),mensajes:JSON.stringify(r.state.mensajes)},r.state.exam_id&&(i.exam_id=r.state.exam_id),r.state.lab_id&&(i.lab_id=r.state.lab_id),n||r.setState({load:!0}),console.log("Enviando datos a API para almacenar"),fetch(o,{method:c,body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Pedido almacenado"),window.confirm("Pedido almacenado con exito!.\n\xbfDesea cerrar este contacto?")?r.props.history.goBack():r.setState({id:e.data.id,usuario:e.data.created,date:e.data.created_at,nota:e.data.nota.id,load:!1})):(window.alert("Error al almacenar el pedido. Intentelo mas tarde"),console.error(e.message),r.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),r.setState({load:!1})}))}},r.getOrder=function(e){if(e>0){var a=r.state,t=a.host,n=a.token;console.log("Solicitando datos a la API"),fetch("http://"+t+"/api/orders/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(a){a.message?(console.error("Error al cargar el usuario",a.message),r.setState({load:!1})):(console.log("Mostrando datos del pedido"),r.setState({id:e,session:a.data.session,observaciones:a.data.observaciones,lab_id:a.data.laboratorio?a.data.laboratorio.id:0,npedidolab:a.data.folio_lab,ncaja:a.data.caja,mensajes:a.data.mensajes,items:a.data.productos,contact_id:a.data.paciente.id,status:a.data.estado,usuario:a.data.created,exam_id:null!==a.data.examen?a.data.examen.id:0,exam:null!==a.data.examen?a.data.examen:{},date:a.data.created_at,nota:a.data.nota.id}))}))}else r.setState({load:!1})},r.state={id:0,session:Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10),observaciones:"",lab_id:0,npedidolab:"",ncaja:0,mensajes:[],items:[],contact_id:0,usuario:"",edad:0,exam_id:0,exam:{},status:0,date:Date.now(),load:!1,nota:0,host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;e&&(E.a.locale("es"),this.getOrder(e))}},{key:"componentDidUpdate",value:function(e,a){a.load!==this.state.load&&this.state.load}},{key:"render",value:function(){var e=this,a=this.state,t=a.contact_id,n=a.id,l=this.props.data;return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-4"},i.a.createElement(W,{contact:this.state.contact_id,edad:this.state.edad,status:this.state.status,getIdContact:this.getIdContact,changePage:this.changePage}),t?i.a.createElement("div",{className:"card card-warning card-outline mt-4"},i.a.createElement("div",{className:"card-body"},i.a.createElement(oe,{status:this.state.status,ChangeInput:this.handleChangeInput}))):null),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"card card-warning card-outline"},i.a.createElement("div",{className:"card-body"},t?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-2"},i.a.createElement("div",{className:"border border-warning rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Folio"),i.a.createElement("strong",null,this.state.id?this.state.id:"Nuevo"))),i.a.createElement("div",{className:"col-4"},i.a.createElement("div",{className:"border border-warning rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Creador"),i.a.createElement("strong",null,this.state.usuario?this.state.usuario:this.props.data.name))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",{className:"border border-warning rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Nota"),i.a.createElement("strong",null,this.state.nota?i.a.createElement(d.b,{to:"/notas/registro/"+this.state.nota,onClick:function(a){e.changePage("/notas/registro")}},this.state.nota):"--"))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-warning rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Fecha"),i.a.createElement("strong",null,E()(this.state.date).format("LL"))))),i.a.createElement("ul",{className:"nav nav-tabs mt-4",id:"myTab",role:"tablist"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:this.state.status&&3!==this.state.status?"nav-link":"nav-link active",href:"#pedido","data-toggle":"tab"},"Nota")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#exam"},"Examen")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:1===this.state.status?"nav-link active":this.state.status?"nav-link":"nav-link disabled","data-toggle":"tab",href:"#lab"},"Laboratorio")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:2===this.state.status?"nav-link active":this.state.status?"nav-link":"nav-link disabled","data-toggle":"tab",href:"#bicelacion"},"Bicelaci\xf3n")),i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:4===this.state.status?"nav-link active":"nav-link disabled","data-toggle":"tab",href:"#garantia"},"Garantia"))),i.a.createElement("div",{className:"tab-content",id:"myTabContent"},i.a.createElement("div",{className:this.state.status&&3!==this.state.status?"tab-pane fade pt-4":"tab-pane fade pt-4 show active",id:"pedido"},i.a.createElement(re,{items:this.state.items,status:this.state.status,session:this.state.session,ChangeInput:this.handleChangeInput})),i.a.createElement("div",{className:"tab-pane fade pt-4",id:"exam"},i.a.createElement(L,{paciente:this.state.contact_id,edad:this.state.edad,exam:this.state.exam,page:this.changePage,select:!0,status:this.state.status,ChangeInput:this.handleChangeInput})),i.a.createElement("div",{className:1===this.state.status?"tab-pane fade pt-4 show active":"tab-pane fade pt-4",id:"lab"},i.a.createElement(se,{lab_id:this.state.lab_id?this.state.lab_id:0,npedidolab:this.state.npedidolab?this.state.npedidolab:"",status:this.state.status,ChangeInput:this.handleChangeInput})),i.a.createElement("div",{className:2===this.state.status?"tab-pane fade pt-4 show active":"tab-pane fade pt-4",id:"bicelacion"},i.a.createElement(ce,{ncaja:this.state.ncaja,observaciones:this.state.observaciones,status:this.state.status,ChangeInput:this.handleChangeInput})),i.a.createElement("div",{className:4===this.state.status?"tab-pane fade pt-4 show active":"tab-pane fade pt-4",id:"garantia"},i.a.createElement(ie,{status:this.state.status,ChangeInput:this.handleChangeInput})))):this.state.load?i.a.createElement("div",{className:"text-center"},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))):i.a.createElement("div",{className:"alert alert-light"},i.a.createElement("h4",{className:"alert-heading"},"Nuevo pedido"),i.a.createElement("p",null,i.a.createElement("i",{className:"fas fa-user mr-1"})," Primero seleccione al paciente!"))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("div",{className:"btn-group",role:"group"},i.a.createElement(d.b,{to:"/pedidos",className:"btn btn-dark",onClick:function(a){e.changePage("/pedidos")}},i.a.createElement("i",{className:"fas fa-ban mr-1"}),i.a.createElement("strong",null,"Cancelar")),i.a.createElement("button",{className:this.state.contact_id&&this.state.items.length?"btn btn-warning":"btn btn-warning disabled",onClick:this.handleSave,disabled:!this.state.contact_id||!this.state.items.length},i.a.createElement("i",{className:"fas fa-save mr-1"}),i.a.createElement("strong",null,"Guardar"))))),t&&n?i.a.createElement(me,{data:l,table:"orders",idRow:n}):null))}}]),t}(c.Component),pe=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("type",""),e.props.changeFilters("date",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,l=t.value;e.props.changeFilters(n,l)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.type,n=e.date;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},i.a.createElement("i",{className:"fas fa-filter"}))),i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Busquedas"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: paciente o # de venta",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Estado"),i.a.createElement("div",{className:"input-group-prepend ml-4"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-address-book"}))),i.a.createElement("select",{className:"form-control",name:"type",value:t,onChange:this.changeFilters},i.a.createElement("option",{value:""},"Todos"),i.a.createElement("option",{value:"0"},"Adeudos"),i.a.createElement("option",{value:"1"},"Pagados"))),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("label",null,"Fecha"),i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("span",{className:"input-group-text"},i.a.createElement("i",{className:"fas fa-search"}))),i.a.createElement("input",{type:"date",name:"date",className:"form-control",value:n,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch}))),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},i.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),i.a.createElement("button",{type:"button",className:a||t?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},i.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),i.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},i.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(c.Component),ue=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).handleFilter=function(){r.setState({load:!0,page:1})},r.onchangeSearch=function(e,a){r.setState(Object(n.a)({},e,a))},r.handleOrder=function(e){r.setState({orderby:e,order:"desc"===r.state.order?"asc":"desc",load:!0})},r.handleChangePage=function(e){r.setState({page:e,load:!0})},r.changePage=function(e){r.props.page(e)},r.handleDelete=function(e,a){var t=window.confirm("\xbfEsta seguro de eliminar el pedido de "+a.toUpperCase()+"?"),n=r.state,l=n.host,s=n.token;t&&(r.setState({load:!0}),console.log("Solicitud de eliminaci\xf3n por API"),fetch("http://"+l+"/api/sales/"+e,{method:"DELETE",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||(window.alert("La venta no puede ser eliminado"),console.error(e)),e.json()})).then((function(e){e.message?(console.error("Error al eliminar la venta",e.message),r.setState({load:!1})):(console.log("Venta eliminada"),r.getPedidos(),window.alert("Venta eliminada con exito"))})).catch((function(e){console.error(e),window.alert("Ups!\n Hubo un error, intentelo mas tarde"),r.setState({load:!1})})))},r.getPedidos=function(){var e=r.state,a=e.host,t=e.token,n=e.order,l=e.orderby,s=e.search,o=e.page,c=e.type,i=e.date,m=e.load,d="http://"+a+"/api/sales",p="&orderby=".concat(l,"&order=").concat(n),u=s?"&search=".concat(s):"",h=o>0?"?page="+o:"?page=1",g=""===c?"":"&type="+c,E=""===i?"":"&date="+i;m||r.setState({load:!0}),console.log("Descargando ventas de API"),fetch(d+h+p+u+g+E,{method:"GET",signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){console.log("Descargando ventas"),r.setState({pedidos:e,load:!1})}))};var s=JSON.parse(localStorage.getItem("OrusSales"));return r.state={pedidos:{data:[],meta:{}},load:!0,page:s?s.page:1,orderby:s?s.orderby:"created_at",order:s?s.order:"asc",search:s?s.search:"",type:s?s.type:"",date:s?s.date:"",host:e.data.host,token:e.data.token},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getPedidos(),E.a.locale("es"),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando pedidos"),this.getPedidos(),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date})))}},{key:"render",value:function(){var e=this,a=this.state,t=a.pedidos,n=a.load,l=a.search,r=a.type,s=a.date;return i.a.createElement("div",{className:"card card-success card-outline"},i.a.createElement("div",{className:"card-header"},i.a.createElement("h3",{className:"card-title text-success"},i.a.createElement("i",{className:"fas fa-cash-register mr-1"}),"Listado de notas"),i.a.createElement("div",{className:"card-tools"},i.a.createElement(pe,{search:l,type:r,date:s,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),i.a.createElement(N,{meta:t.meta,handleChangePage:this.handleChangePage}))),i.a.createElement("div",{className:"card-body table-responsive p-0"},i.a.createElement("table",{className:"table table-bordered table-hover table-nowrap"},i.a.createElement(v,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Folio",type:"id",filter:!0},{name:"Cliente"},{name:"Sub-total"},{name:"Descuento"},{name:"Total",type:"total",filter:!0},{name:"Abonos"},{name:"Por pagar"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),i.a.createElement("tbody",null,n?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"10",className:"text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")),i.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta"))):Object.keys(t.data).length?t.data.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,i.a.createElement("span",{className:"badge badge-success text-capitalize"},a.id)),i.a.createElement("td",{className:"text-uppercase"},i.a.createElement(d.b,{to:"/notas/registro/"+a.id},i.a.createElement("span",{className:"badge badge-danger text-capitalize p-1"},a.cliente.nombre,i.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),i.a.createElement("td",{className:"text-right"},"$ ",a.subtotal?a.subtotal:0),i.a.createElement("td",{className:"text-right"},"$ ",a.descuento?a.descuento:0),i.a.createElement("td",{className:"text-right"},"$ ",a.total?a.total:0),i.a.createElement("td",{className:"text-right"},"$ ",a.pagado),i.a.createElement("td",{className:"text-right"},a.total-a.pagado<=0?i.a.createElement("label",{className:"text-success"},i.a.createElement("i",{className:"fas fa-check"})):"$ "+(a.total-a.pagado)),i.a.createElement("td",{className:"text-capitalize"},E()(a.updated_at).fromNow()),i.a.createElement("td",{className:"text-capitalize"},E()(a.created_at).format("LL")),i.a.createElement(C,{id:a.id,item:a.cliente.nombre,delete:e.handleDelete,edit:"/notas/registro/"}))})):i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement(d.b,{to:"/notas/registro",className:"btn btn-outline-success",onClick:function(a){e.changePage("/notas/registro")}},i.a.createElement("i",{className:"fas fa-plus mr-2"}),i.a.createElement("strong",null,"Nueva nota"))))}}]),t}(c.Component),he=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).handlePay=function(e){e.preventDefault();var a=window.confirm("\xbfEsta seguro de realizar el abono?"),t=r.state;if(t.sale_id=r.props.saleId,t.contact_id=r.props.contactId,a){console.log("Enviando datos a API para almacenar abono");var n=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+n.host+"/api/payments",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Abono almacenado"),r.props.handleChange(r.state.total),r.setState({metodopago:1,total:0,banco:"",auth:""})):console.log(e.message)}))}},r.onChangeValue=function(e){var a=e.target,t=a.name,l=a.value,s=a.type;"total"===t&&((l*=1)>r.props.pay?l=r.props.pay:l<0&&(l=0)),"metodopago"!==t&&"number"!==s||(l*=1),r.setState(Object(n.a)({},t,l))},r.state={metodopago:1,total:0,banco:"",auth:""},r}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"abonos"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},"Abono"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{className:"modal-body"},i.a.createElement("div",{className:"row mb-2"},i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"Fecha"),i.a.createElement("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:E()().format("L")})),i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"Usuario"),i.a.createElement("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:this.props.user}))),i.a.createElement("div",{className:"row mb-2"},i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"Metodo de pago"),i.a.createElement("select",{name:"metodopago",className:"custom-select",value:this.state.metodopago,onChange:this.onChangeValue},i.a.createElement("option",{value:"1"},"Efectivo"),i.a.createElement("option",{value:"2"},"Tarjeta de debito"),i.a.createElement("option",{value:"3"},"Tarjeta de credito"),i.a.createElement("option",{value:"4"},"La marina"),i.a.createElement("option",{value:"5"},"Cheque"),i.a.createElement("option",{value:"6"},"Transferencia"),i.a.createElement("option",{value:"0"},"Otro"))),i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"Cantidad"),i.a.createElement("input",{type:"number",min:"0",max:this.props.pay,className:"form-control text-right",name:"total",value:this.state.total?this.state.total:"",onChange:this.onChangeValue}))),1!==this.state.metodopago?i.a.createElement("div",{className:"row mb-2"},i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"Banco"),i.a.createElement("input",{type:"text",name:"banco",className:"form-control",value:4===this.state.metodopago?"La marina":this.state.banco,disabled:4===this.state.metodopago,onChange:this.onChangeValue})),i.a.createElement("div",{className:"col"},i.a.createElement("label",null,"N. Autorizaci\xf3n"),i.a.createElement("input",{type:"text",name:"auth",className:"form-control",value:this.state.auth,onChange:this.onChangeValue}))):null),i.a.createElement("div",{className:"modal-footer"},i.a.createElement("button",{type:"button",className:"btn btn-dark","data-dismiss":"modal"},"Cancelar"),i.a.createElement("button",{type:"button",className:"btn btn-success",onClick:this.handlePay,"data-dismiss":"modal"},"Abonar")))))}}]),t}(c.Component),ge=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).getContact=function(e){if(e){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.json()})).then((function(e){console.log("Descargando contacto"),n.setState({dataContact:e.data})})).catch((function(e){console.log(e)}))}},n.state={dataContact:[]},n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getContact(this.props.contact)}},{key:"componentDidUpdate",value:function(e,a){e.contact!==this.props.contact&&this.getContact(this.props.contact)}},{key:"render",value:function(){var e=this.props.id,a=this.state.dataContact;return i.a.createElement("div",{className:"d-none d-print-block",style:{width:340},id:e},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"card m-0"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h2",{className:"text-center"},i.a.createElement("center",null,i.a.createElement("strong",null,"\xd3ptica Madero"))),i.a.createElement("h4",null,i.a.createElement("em",null,"Julio Cesar Cardenas Martinez",i.a.createElement("br",null),"Tel: 312 312 5353",i.a.createElement("br",null),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col.")),i.a.createElement("hr",null),i.a.createElement("h4",{className:"text-capitalize"},a.nombre,i.a.createElement("br",null),a.telefonos?a.telefonos[0]?a.telefonos[0]:a.telefonos[2]:"--"))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("center",null,i.a.createElement("h2",{className:"text-center"},"Abono")))))}}]),t}(c.Component),Ee=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).print=function(e,a,t){var n=document.getElementById("print_pay"),l=document.getElementById("ifmcontentstoprint").contentWindow;l.document.open(),l.document.write(n.innerHTML),l.document.write("<fieldset><h3>"),l.document.write("Fecha: "+a),l.document.write("<br/>Folio: "+t),l.document.write("<br/>Monto: $ "+e.toFixed(2)),l.document.write("</h3></fieldset>"),l.document.close(),l.focus(),l.print()},n.handleChange=function(e){n.getPayments(),n.setState({total:n.state.total+e})},n.SetMethodPayment=function(e){switch(e){case 1:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Efectivo");case 2:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Tarjeta debito");case 3:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Tarjeta Credito");case 4:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"La marina");case 5:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Cheque");case 6:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Transferencia");default:return i.a.createElement("span",{className:"badge badge-success text-uppercase"},"Otro")}},n.getPayments=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="?sale="+n.props.sale;console.log("Descargando datos de los pagos"),fetch("http://"+e.host+"/api/payments"+a+"&order=desc",{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){if(e.meta&&e.meta.total){console.log("Almacenando abonos");for(var a=0,t=0;t<e.data.length;t++)a+=e.data[t].total;n.props.handleChange("pagado",1*a),n.setState({abonos:e.data,total:a,load:!1})}else n.setState({load:!1})}))},n.state={abonos:[],total:0,load:!0},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getPayments()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this,a=this.state,t=a.abonos,n=a.total,l=a.load,r=this.props,s=r.id,o=r.date,c=r.contact;return i.a.createElement(i.a.Fragment,null,i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Fecha"),i.a.createElement("th",{scope:"col"},"Metodo de pago"),i.a.createElement("th",{scope:"col"},"Cantidad"),i.a.createElement("th",{scope:"col"},"Recibio"),i.a.createElement("th",{scope:"col"},"Acciones"))),i.a.createElement("tbody",null,t.length?i.a.createElement(i.a.Fragment,null,t.map((function(a){return i.a.createElement("tr",{key:a.id},i.a.createElement("td",null,E()(a.created_at).format("L")),i.a.createElement("td",null,e.SetMethodPayment(a.metodo),1!==a.metodo?i.a.createElement("span",{className:"ml-4"},a.banco?a.banco:"--"," /"," ",a.Autorizacion?a.Autorizacion:"--"):""),i.a.createElement("td",{className:"text-right"},"$ ",a.total.toFixed(2)),i.a.createElement("td",null,a.created_user),i.a.createElement("td",{className:"text-right"},i.a.createElement("button",{className:"btn btn-outline-light btn-sm",onClick:function(){e.print(a.total,E()(a.created_at).format("L"),a.id)}},i.a.createElement("i",{className:"fas fa-print"}))))}))):l?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"5",className:"text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")),i.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta"))):i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"5",className:"text-center"},"No hay abonos registrados"))),i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"row",colSpan:"3",className:"text-right"},this.props.pay?i.a.createElement("a",{href:"#abonos",className:this.props.pay?"btn btn-outline-success btn-sm mr-2":"btn btn-outline-success btn-sm mr-2 disabled","data-toggle":"modal","data-target":"#abonos","aria-disabled":!this.props.pay},i.a.createElement("i",{className:"fas fa-money-bill-wave-alt"})):"","Total: $ ",n.toFixed(2)),i.a.createElement("td",{colSpan:"2"})))),i.a.createElement(he,{pay:this.props.pay,user:this.props.user,saleId:this.props.sale,contactId:this.props.contact,handleChange:this.handleChange}),i.a.createElement(ge,{folio:s,date:o,contact:c,id:"print_pay"}))}}]),t}(c.Component),fe=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).getContact=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.json()})).then((function(e){console.log("Descargando contacto"),n.setState({dataContact:e.data})})).catch((function(e){console.log(e)}))},n.state={dataContact:[]},n}return Object(r.a)(t,[{key:"componentDidUpdate",value:function(e,a){e.contact!==this.props.contact&&this.getContact(this.props.contact)}},{key:"render",value:function(){var e=this.props,a=e.items,t=e.descuento,n=e.total,l=e.saldo,r=e.abonado,s=e.folio,o=e.date,c=e.id,m=0,d=this.state.dataContact;return i.a.createElement("div",{className:"d-none d-print-block",style:{width:340},id:c},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"card m-0"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h2",{className:"text-center"},i.a.createElement("center",null,i.a.createElement("strong",null,"\xd3ptica Madero"))),i.a.createElement("h4",null,i.a.createElement("em",null,"Julio Cesar Cardenas Martinez",i.a.createElement("br",null),"Tel: 312 312 5353",i.a.createElement("br",null),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col.")),i.a.createElement("h4",null,i.a.createElement("i",null,"Folio: ",s),i.a.createElement("br",null),i.a.createElement("i",null,"Fecha: ",o)),i.a.createElement("hr",null),i.a.createElement("h4",{className:"text-capitalize"},d.nombre,i.a.createElement("br",null),d.telefonos?d.telefonos[0]?d.telefonos[0]:d.telefonos[2]:"--"))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("center",null,i.a.createElement("h2",{className:"text-center"},"Pedido")))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,i.a.createElement("h4",null,"Cant")),i.a.createElement("th",null,i.a.createElement("h4",null,"Descripcion")),i.a.createElement("th",null,i.a.createElement("h4",null,"Precio")))),i.a.createElement("tbody",null,a.map((function(e){return m+=e.cantidad*e.precio,i.a.createElement("tr",{key:e.id},i.a.createElement("td",null,i.a.createElement("h5",null,e.cantidad)),i.a.createElement("td",null,i.a.createElement("h4",null,e.producto)),i.a.createElement("td",{className:"text-right"},i.a.createElement("h5",null,e.precio.toFixed(2))))}))),i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("td",{className:"text-right",colSpan:"3",style:{textAlign:"right"}},i.a.createElement("h4",null,"Subtotal: ",i.a.createElement("label",null,"$ ",m.toFixed(2))),i.a.createElement("h4",null,"Descuento: ",i.a.createElement("label",null,"$ ",t.toFixed(2))),i.a.createElement("h4",null,"Total: ",i.a.createElement("label",null,"$ ",n.toFixed(2))),i.a.createElement("h4",null,"Abonado: ",i.a.createElement("label",null,"$ ",r.toFixed(2))),i.a.createElement("h4",null,"Saldo: ",i.a.createElement("label",null,"$ ",l.toFixed(2))))))))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("hr",null),i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body text-center"},i.a.createElement("h4",null,"Armazones usados, viejos y/o resecos son responsabilidad del cliente"))))))}}]),t}(c.Component),be=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){e.props.catchInputs(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.props,a=e.pay,t=e.descuento,n=e.subtotal,l=e.total,r=e.pagado;return i.a.createElement("div",{className:"card card-success card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title mb-4"},i.a.createElement("i",{className:"fas fa-shield-alt mr-2"}),"Estado de cuenta",a?"":i.a.createElement("span",{className:"badge badge-success ml-2"},"Cuenta liquidada")),i.a.createElement("div",{className:"card-text form-group row"},i.a.createElement("label",{className:"col-6"},"Descuento"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control text-right text-success",type:"number",name:"descuento",min:"0",max:n-t,readOnly:!a,value:t?t.toFixed(2):"",onChange:this.catchInputs}))),i.a.createElement("div",{className:"card-text form-group row"},i.a.createElement("label",{className:"col-6"},"Total"),i.a.createElement("div",{className:"col"},i.a.createElement("input",{className:"form-control text-right text-success",type:"number",name:"total",value:l.toFixed(2),onChange:this.catchInputs,readOnly:!0}))),i.a.createElement("div",{className:"card-text row"},i.a.createElement("label",{className:"col-6 p-2"},"Abonado"),i.a.createElement("h2",{className:"col text-success p-2 text-right"},"$ ",r.toFixed(2))),i.a.createElement("div",{className:"card-text row"},i.a.createElement("label",{className:"col-6 p-2"},"Saldo"),i.a.createElement("h2",{className:"col text-success p-2 text-right"},"$ ",a.toFixed(2)))))}}]),t}(c.Component),ve=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).printSale=function(){var e=document.getElementById("print_sale"),a=document.getElementById("ifmcontentstoprint").contentWindow;a.document.open(),a.document.write(e.innerHTML),a.document.close(),a.focus(),a.print()},r.handleChangeInput=function(e,a){var t,l=0;if("items"===e)for(var s=0;s<a.length;s++)l+=a[s].cantidad*a[s].precio;else l=r.state.subtotal;r.setState((t={},Object(n.a)(t,e,a),Object(n.a)(t,"subtotal",l),t))},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;"number"===a.type&&(l*=1),"descuento"===t&&l>=r.state.subtotal-r.state.descuento&&(l=r.state.subtotal-1),r.setState(Object(n.a)({},t,l))},r.getIdContact=function(e,a){r.setState({contact_id:e,edad:a})},r.changePage=function(e){r.props.page(e)},r.handleSave=function(e){if(e.preventDefault(),window.confirm("\xbfEsta seguro de almacenar esta venta?")){var a,t=r.state,n=t.id,l=t.host,s=t.token,o=t.load,c=n?"http://"+l+"/api/sales/"+n:"http://"+l+"/api/sales",i=n?"PUT":"POST",m=[];r.state.items.map((function(e){return m.push({cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,out:e.out,session:e.session,store_items_id:e.store_items_id}),!1})),a={session:r.state.session,descuento:r.state.descuento,subtotal:r.state.subtotal,total:r.state.subtotal-r.state.descuento,contact_id:r.state.contact_id,order_id:r.state.order_id?r.state.order_id:"",pagado:r.state.pagado,items:JSON.stringify(m)},o||r.setState({load:!0}),console.log("Enviando datos a API"),fetch(c,{method:i,body:JSON.stringify(a),signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Pedido almacenado"),window.confirm("Venta almacenada con exito!.\n\xbfDesea cerrar esta venta?")?r.props.history.goBack():r.setState({id:e.data.id,usuario:e.data.created,date:e.data.created_at,status:1,load:!1})):(window.alert("Error al almacenar la venta. Intentelo mas tarde"),console.error(e.message),r.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),r.setState({load:!1})}))}},r.getSales=function(){var e=r.props.match.params.id;if(e>0){var a=JSON.parse(localStorage.getItem("OrusSystem"));console.log("Descargando datos de la venta"),fetch("http://"+a.host+"/api/sales/"+e,{method:"GET",signal:r.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){console.log("Almacenando datos de la venta"),r.setState({id:e.data.id,session:e.data.session?e.data.session:r.state.session,items:e.data.productos,descuento:e.data.descuento,subtotal:e.data.subtotal,total:e.data.total,contact_id:e.data.cliente.id,usuario:e.data.created,date:E()(e.data.created_at).format("LL"),status:1,order_id:e.data.pedido,pagado:e.data.pagado})}))}else r.setState({load:!1})},r.state={id:0,session:Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10),descuento:0,subtotal:0,total:0,items:[],contact_id:0,order_id:0,status:0,usuario:"",date:E()().format("LL"),load:!0,pagado:0,host:e.data.host,token:e.data.token},r.total=0,r.controller=new AbortController,r.signal=r.controller.signal,E.a.locale("es"),r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSales()}},{key:"render",value:function(){var e=this,a=this.state,t=a.contact_id,n=a.subtotal,l=a.descuento,r=a.pagado,s=a.items,o=a.status,c=a.id,m=a.session,p=a.load,u=a.date,h=n-(l+r);return this.total=n-l,h=h>0?h:0,i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row d-print-none"},i.a.createElement("div",{className:"col-4"},i.a.createElement(W,{contact:t,status:o,getIdContact:this.getIdContact,changePage:this.changePage}),t&&s.length?i.a.createElement(be,{pay:h,descuento:l,subtotal:n,total:this.total,pagado:r,catchInputs:this.catchInputs}):null),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"card card-success card-outline"},i.a.createElement("div",{className:"card-body"},t?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mb-4"},i.a.createElement("div",{className:"col-2"},i.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Folio"),i.a.createElement("strong",null,c||"Nuevo"))),i.a.createElement("div",{className:"col-4"},i.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Creador"),i.a.createElement("strong",null,this.state.usuario?this.state.usuario:this.props.data.name))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Pedido"),i.a.createElement("strong",null,this.state.order_id?i.a.createElement(d.b,{to:"/pedidos/registro/"+this.state.order_id,onClick:function(a){e.changePage("/pedidos/registro")}},this.state.order_id):"--"))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},i.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Fecha"),i.a.createElement("strong",null,u)))),i.a.createElement(re,{items:s,status:o,session:m,ChangeInput:this.handleChangeInput})):p?i.a.createElement("div",{className:"text-center p-4"},i.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")),i.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta")):i.a.createElement("div",{className:"alert alert-light"},i.a.createElement("h4",{className:"alert-heading"},"Nueva nota"),i.a.createElement("p",null,i.a.createElement("i",{className:"fas fa-user mr-1"})," Primero seleccione al cliente!"))),i.a.createElement("div",{className:"card-footer text-right"},i.a.createElement("div",{className:"btn-group",role:"group"},i.a.createElement(d.b,{to:"/notas",className:"btn btn-dark",onClick:function(a){e.changePage("/notas")}},i.a.createElement("i",{className:c?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),i.a.createElement("strong",null,c?"Regresar":"Cancelar")),i.a.createElement("button",{className:t&&s.length?"btn btn-dark":"btn btn-dark disabled",onClick:this.printSale,disabled:!t||!s.length},i.a.createElement("i",{className:"fas fa-print mr-2"}),i.a.createElement("strong",null,"Imprimir")),i.a.createElement("button",{className:t&&s.length&&h?"btn btn-success":"btn btn-success disabled",onClick:this.handleSave,disabled:!(t&&s.length&&h)},i.a.createElement("i",{className:"fas fa-save mr-2"}),i.a.createElement("strong",null,"Guardar"))))),t&&c?i.a.createElement("div",{className:"card card-success card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title mb-4"},i.a.createElement("i",{className:"fas fa-money-bill mr-2"}),"Abonos"),i.a.createElement(Ee,{abonos:1*r,sale:1*c,contact:t,pay:1*h,user:this.props.data.name,handleChange:this.handleChangeInput}))):null)),i.a.createElement(fe,{id:"print_sale",folio:c,date:u,items:s,descuento:l,total:this.total,saldo:h,abonado:r,contact:t}))}}]),t}(c.Component),Ne=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).getStockOut=function(){var e=n.state,a=e.host,t=e.token,l="http://"+a+"/api/salesItems";t&&a?(console.log("Descargando stock faltante"),fetch(l+"?stock=false",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||401===e.status||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){console.log("Almacenando datos descargados"),e.data&&n.setState({stock:e.data})}))):console.error("Datos invalidos de session")},n.state={stock:[],host:e.data.host,token:e.data.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.getStockOut()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Producto"),i.a.createElement("th",{scope:"col"},"Pedido"),i.a.createElement("th",{scope:"col"},"Faltante"))),this.state.stock.length?i.a.createElement("tbody",null,this.state.stock.map((function(e,a){return i.a.createElement("tr",{key:a},i.a.createElement("td",null,e.producto),i.a.createElement("td",null,e.pedido),i.a.createElement("td",null,e.faltante))}))):i.a.createElement("tbody",null))}}]),t}(c.Component),ye=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(){return Object(l.a)(this,t),a.apply(this,arguments)}return Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-4"},i.a.createElement("div",{className:"card card-success card-outline"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title mb-2"},"Articulos en pedido sin stock"),i.a.createElement(Ne,{data:this.props.data})))))}}]),t}(c.Component),Ce=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).verifyUser=function(){var e=n.props,a=e.data,t=e.logOut,l=a.host,r=a.isLogged,s=a.token;r&&l&&s?(console.log("Verificando usuario"),""!==s&&""!==l&&fetch("http://"+l+"/api/user",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){return e.ok||""===s||(console.error("Usuario invalido:",e.statusText),t()),e.json()})).then((function(e){e.message||console.log("Usuario valido:",e.username)}))):(console.error("La sesion ya no esta activa o se perdio el host"),t())},n.handlePage=function(e){var a=n.handleTitleSection(e);n.setState({page:a})},n.handleTitleSection=function(e){""!==(e=e||window.location.pathname)&&"undefined"!==typeof e&&"object"!==typeof e||(e="/");var a=e.split("/");return""===a[1]?"dashboard":a[1]},n.state={page:n.handleTitleSection(window.location.pathname),company:e.data.company},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=window.location.pathname,a=this.props.data.rol;1===a&&(e.match(/^\/consultorio/g)||e.match(/^\/usuarios/g)||e.match(/^\/almacen/g)||e.match(/^\/configuraciones/g))&&(window.location.href="/"),2===a&&(e.match(/^\/pedidos/g)||e.match(/^\/usuarios/g)||e.match(/^\/almacen/g)||e.match(/^\/notas/g)||e.match(/^\/configuraciones/g))&&(window.location.href="/"),this.verifyUser()}},{key:"componentDidUpdate",value:function(e,a){this.state.page!==a.page&&this.verifyUser()}},{key:"render",value:function(){var e=this,a=this.props.data;return i.a.createElement("div",{className:"wrapper"},i.a.createElement(u,null),i.a.createElement(h,{companyName:this.state.company,user:a,page:this.handlePage,logOut:this.props.logOut,active:this.state.page}),i.a.createElement("div",{className:"content-wrapper"},i.a.createElement(f,{title:this.state.page}),i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"container-fluid"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-lg-12"},i.a.createElement(p.c,null,i.a.createElement(p.a,{path:"/usuarios/registro/:id?",render:function(t){return i.a.createElement(j,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/usuarios",render:function(t){return i.a.createElement(x,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{path:"/almacen/registro/:id?",render:function(t){return i.a.createElement(A,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/almacen",render:function(t){return i.a.createElement(O,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{path:"/contactos/registro/:id?",render:function(t){return i.a.createElement(R,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/contactos",render:function(t){return i.a.createElement(D,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/consultorio/registro/:id?",render:function(t){return i.a.createElement(te,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/consultorio",render:function(t){return i.a.createElement(K,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/configuraciones",render:function(a){return i.a.createElement($,Object.assign({},a,{page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/pedidos/registro/:id?",render:function(t){return i.a.createElement(de,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/pedidos",render:function(t){return i.a.createElement(le,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/notas/registro/:id?",render:function(t){return i.a.createElement(ve,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/notas",render:function(t){return i.a.createElement(ue,Object.assign({},t,{data:a,page:e.handlePage}))}}),i.a.createElement(p.a,{extric:!0,path:"/",render:function(t){return i.a.createElement(ye,Object.assign({},t,{data:a,page:e.handlePage}))}}))))))),i.a.createElement(b,null))}}]),t}(c.Component),xe=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=a.call(this,e)).pressEnter=function(e){if("Enter"===e.key){e.preventDefault();var a=r.state.host;window.alert("La conexion al servidor fue actualizada con exito: \n"+a),r.setState({hostShow:!1}),r.props.changeState("host",a)}},r.showTools=function(e){e.preventDefault(),r.setState({hostShow:!r.state.hostShow})},r.handleLogin=function(e){e.preventDefault();var a=r.state,t=a.host,n=a.username,l=a.password;if(r.setState({load:!0}),t){var s={email:n,password:l};r.validInputs()&&(console.log("Enviado credenciales al servidor"),fetch("http://"+t+"/api/users/login",{method:"POST",body:JSON.stringify(s),signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(e){e.data?(console.log("Loggin: realizado con exito"),r.props.loginFunction(e)):(console.error("Login: Sin acceso",e),e.message&&window.alert(e.message),e.errors&&window.alert(e.errors),r.setState({username:"",password:"",load:!1}))})).catch((function(e){console.error(e)})))}else console.error("No existe un valor para host"),r.setState({hostShow:!0,load:!1})},r.catchInputs=function(e){var a=e.target,t=a.name,l=a.value;r.setState(Object(n.a)({},t,l))},r.state={username:"",password:"",host:e.host,hostShow:!1,load:!1},r.controller=new AbortController,r.signal=r.controller.signal,r}return Object(r.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.state,a=e.load,t=e.username,n=e.password,l=e.hostShow,r=e.host,s=this.props.company;return i.a.createElement("div",{className:"login-page"},i.a.createElement("div",{className:"login-box"},i.a.createElement("div",{className:"login-logo"},i.a.createElement("a",{href:"."},i.a.createElement("b",{className:"text-primary"},"Orus")," LTE")),i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body login-card-body"},i.a.createElement("p",{className:"login-box-msg"},s),i.a.createElement("form",{onSubmit:this.handleLogin},i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Usuario",name:"username",autoFocus:!l,onChange:this.catchInputs,value:t}),i.a.createElement("div",{className:"input-group-append"},i.a.createElement("div",{className:"input-group-text"},i.a.createElement("span",{className:"fas fa-user"})))),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",onChange:this.catchInputs,value:n}),i.a.createElement("div",{className:"input-group-append"},i.a.createElement("div",{className:"input-group-text"},i.a.createElement("span",{className:"fas fa-lock"})))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12 mb-4"},i.a.createElement("a",{href:"#tools",onClick:this.showTools,className:"text-muted"},i.a.createElement("i",{className:"fas fa-wifi"})," Servidor"),l?i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"host",autoComplete:"off",autoFocus:!!l,onChange:this.catchInputs,value:r,onKeyPress:this.pressEnter}),i.a.createElement("div",{className:"input-group-append"},i.a.createElement("div",{className:"input-group-text"},i.a.createElement("span",{className:"fas fa-server"})))):"")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12 text-center"},a?i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")):i.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Iniciar sesion"))))))))}},{key:"validInputs",value:function(){return this.state.username.length>4&&this.state.password.length>7||(alert("Los datos ingresados no son validos"),!1)}}]),t}(c.Component),ke=function(e){Object(s.a)(t,e);var a=Object(o.a)(t);function t(e){var r;Object(l.a)(this,t),(r=a.call(this,e)).changeState=function(e,a){r.setState(Object(n.a)({},e,a))},r.login=function(e){r.setState({isLogged:!!e.data.id,idUser:e.data.id,username:e.data.username,name:e.data.name,email:e.data.email,rol:e.data.rol,token:e.token})},r.logOut=function(){var e={isLogged:!1,token:"",idUser:0,username:"",name:"",rol:0,email:"",host:r.state.host,company:r.state.company};console.log("La session ha sido cerrada"),localStorage.setItem("OrusSystem",JSON.stringify(e)),window.location.href="/"};var s=JSON.parse(localStorage.getItem("OrusSystem"));return r.state={isLogged:!!s&&s.isLogged,token:s?s.token:"",idUser:s?s.idUser:0,username:s?s.username:"",name:s?s.name:"",rol:s?s.rol:0,email:s?s.email:"",host:s?s.host:window.location.hostname,company:s?s.company:"Optica Madero"},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){console.log("Cargando data a storage"),localStorage.setItem("OrusSystem",JSON.stringify(this.state))}},{key:"componentDidUpdate",value:function(){console.log("Actualizando data a storage"),localStorage.setItem("OrusSystem",JSON.stringify(this.state))}},{key:"render",value:function(){return i.a.createElement(d.a,null,i.a.createElement("main",null,this.state.isLogged?i.a.createElement(Ce,{data:this.state,logOut:this.logOut}):i.a.createElement(xe,{company:this.state.company,host:this.state.host,loginFunction:this.login,changeState:this.changeState})))}}]),t}(c.Component);Object(m.render)(i.a.createElement(ke,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.c688bc65.chunk.js.map