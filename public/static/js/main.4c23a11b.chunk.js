(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[0],{47:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(28),l=t(23),c=t(35),s=t(2),i="SAGA_TRY_LOGING",m="SAGA_CHECK_LOGING",d="LOGING_SUCCESS",u="LOGING_ERROR",p="LOGING_DELETE",h="SAGA_GET_NOTIFY",g="SAGA_READ_NOTIFYS",f="GET_NOTIFYS",E=localStorage.getItem("OrusSystem"),v=JSON.parse(E||"{}"),b=v.isLogged,N=void 0!==b&&b,y=v.idUser,x=void 0===y?0:y,w=v.username,S=void 0===w?null:w,C=v.name,O=void 0===C?null:C,k=v.rol,j=void 0===k?null:k,_=v.email,I=void 0===_?null:_,A=v.token,T={isLogged:N,idUser:x,username:S,name:O,rol:j,email:I,token:void 0===A?null:A,errors:{},notifications:[]},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case d:var t=localStorage.getItem("OrusSystem"),n=a.payload,r=n.data,o=n.token,l={ls:JSON.parse(t||"{}")},c=l.ls,i=void 0===c?{}:c;return i.isLogged=!0,i.idUser=r.id,i.username=r.username,i.name=r.name,i.rol=r.rol,i.email=r.email,i.token=o,localStorage.setItem("OrusSystem",JSON.stringify(i)),console.log("[Orus System] Acceso a sistema exitoso"),Object(s.a)(Object(s.a)({},e),{},{isLogged:!0,idUser:r.id,username:r.username,name:r.name,rol:r.rol,email:r.email,token:o,errors:{}});case p:var m=localStorage.getItem("OrusSystem"),h={ls:JSON.parse(m||"{}")},g=h.ls,E=void 0===g?{}:g;return delete E.isLogged,delete E.idUser,delete E.username,delete E.name,delete E.rol,delete E.email,delete E.token,localStorage.setItem("OrusSystem",JSON.stringify(E)),console.log("[Orus System] Cierre de sistema exitoso"),Object(s.a)(Object(s.a)({},e),{},{isLogged:!1,idUser:0,username:null,name:null,rol:null,email:null,token:null,errors:{}});case u:var v=a.payload;return Object(s.a)(Object(s.a)({},e),{},{errors:v});case f:var b=a.payload;return Object(s.a)(Object(s.a)({},e),{},{notifications:b});default:return Object(s.a)(Object(s.a)({},e),{},{errors:{}})}},L="CHANGE_HOST",F=localStorage.getItem("OrusSystem"),P=JSON.parse(F||"{}"),B=P.port,z=void 0===B?window.location.protocol.toString().replace(":",""):B,U=P.host,M=void 0===U?window.location.hostname:U,R=P.company,G={port:z,host:M,company:void 0===R?"optica madero":R,success:void 0},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case L:var t=localStorage.getItem("OrusSystem"),n=a.payload,r=n.host,o=void 0===r?window.location.hostname:r,l=n.port,c=void 0===l?window.location.protocol.toString().replace(":",""):l,i={ls:JSON.parse(t||"{}")},m=i.ls,d=void 0===m?{}:m;return console.log("[Orus System] cambiando datos de host:",c,o),d.port=c,d.host=o,localStorage.setItem("OrusSystem",JSON.stringify(d)),Object(s.a)(Object(s.a)({},e),{},{port:c,host:o,success:!0});default:var u=localStorage.getItem("OrusSystem"),p={ls:JSON.parse(u||"{}")},h=p.ls,g=void 0===h?{}:h;return g.port=e.port,g.host=e.host,g.company=e.company,localStorage.setItem("OrusSystem",JSON.stringify(g)),Object(s.a)(Object(s.a)({},e),{},{success:void 0})}},V=t(9),q="SAGA_GET_LIST",$="DELETE_ORDER",H="SAGA_SAVE_ORDER",Z="SET_LIST",W="SET_STATE_VAR",X="SET_ERROR",Y="SET_MESSAGE",K=localStorage.getItem("OrusSystem"),Q=JSON.parse(K||"{}").orders,ee=void 0===Q?{}:Q,ae=ee.orderBy,te=void 0===ae?"updated_at":ae,ne=ee.order,re=void 0===ne?"desc":ne,oe=ee.search,le=void 0===oe?"":oe,ce=ee.page,se=void 0===ce?1:ce,ie=ee.status,me=void 0===ie?"":ie,de=ee.itemsPage,ue={list:[],metaList:{},orderId:0,orderby:te,order:re,search:le,page:se,status:me,itemsPage:void 0===de?10:de,errors:[],messages:[],loading:!1},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case q:case $:case H:return Object(s.a)(Object(s.a)({},e),{},{loading:!0});case Z:var t=a.payload,n=localStorage.getItem("OrusSystem"),r=JSON.parse(n||"{}"),o=Object(s.a)(Object(s.a)({},r),{},{orders:Object(s.a)({},t.options)});return localStorage.setItem("OrusSystem",JSON.stringify(o)),Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},e),t.result),t.options),{},{orderId:0,messages:[],loading:!1});case W:var l=a.payload;return Object(s.a)(Object(s.a)({},e),{},Object(V.a)({},l.key,l.val));case X:var c=a.payload;return Object(s.a)(Object(s.a)({},e),{},{loading:!1,errors:c});case Y:var i=a.payload;return Object(s.a)(Object(s.a)({},e),{},{loading:!1,messages:i});default:return Object(s.a)({},e)}},he="SAGA_GET_LIST_CATEGORIES",ge="SAGE_DELETE_CATEGORY",fe="SET_LIST_CATEGORIES",Ee="SET_ERROR_CATEGORY",ve={list:[],metaList:{},orderId:0,orderby:"created_at",order:"name",search:"",page:1,loading:!1},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case he:case ge:return Object(s.a)(Object(s.a)({},e),{},{loading:!0});case fe:var t=a.payload;return Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},e),t.result),t.options),{},{loading:!1});case Ee:var n=a.payload;return Object(s.a)(Object(s.a)({},e),{},{loading:!1,errors:n});default:return Object(s.a)({},e)}},Ne="SAGA_GET_LIST_STORE",ye="SET_LIST_STORE",xe="SET_MESSAGE_STORE",we={list:[],metaList:{},orderId:0,orderby:"created_at",order:"desc",search:"",page:1,messages:[],loading:!1},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,a=arguments.length>1?arguments[1]:void 0,t=a.payload;switch(a.type){case Ne:return Object(s.a)(Object(s.a)({},e),{},{loading:!0});case ye:return Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},e),t.result),t.options),{},{messages:[],loading:!1});case xe:return Object(s.a)(Object(s.a)({},e),{},{loading:!1,messages:t});default:return Object(s.a)({},e)}},Ce={getListStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ne,payload:e}},setListStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ye,payload:e}},setMessagesStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:xe,payload:e}}},Oe=t(1),ke=t.n(Oe),je=t(8),_e=t(11);function Ie(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",t=arguments.length>2?arguments[2]:void 0,n=localStorage.getItem("OrusSystem"),r=JSON.parse(n||"{}"),o=r.port,l=void 0===o?window.location.protocol.toString().replace(":",""):o,c=r.host,s=void 0===c?window.location.hostname.toString():c,i=r.token,m=void 0===i?"":i;return fetch("".concat(l,"://").concat(s,"/api/").concat(e),{method:a,body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+m}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())}function Ae(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e,r=null;return a&&(n+="/".concat(a)),Object.keys(t).length&&(r=t=new URLSearchParams(t),n+="?".concat(r)),n}var Te=ke.a.mark(De);function De(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.options,n=a.id,r=Ae("store",n,t),l.next=7,Object(je.b)(Ie,r);case 7:return o=l.sent,l.next=10,Object(je.c)(Ce.setListStore({result:{list:o.data,metaList:o.meta},options:t}));case 10:l.next=17;break;case 12:return l.prev=12,l.t0=l.catch(1),console.error("[Orus System] Error en saga/store getList:",l.t0),l.next=17,Object(je.c)(Ce.setMessagesStore([]));case 17:case"end":return l.stop()}}),Te,null,[[1,12]])}var Le=ke.a.mark(Fe);function Fe(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de store"),e.next=3,Object(je.d)(Ne,De);case 3:case"end":return e.stop()}}),Le)}var Pe=Se,Be="SET_LIST_CONTACT",ze="SET_STATE_VAR_CONTACT",Ue="SET_MESSAGE_CONTACT",Me="SET_CONTACT",Re="SAGA_GET_LIST_CONTACTS",Ge="SAGA_DELETE_CONTACT",Je="SAGA_SAVE_CONTACT",Ve="SAGA_GET_CONTACT",qe={list:[],metaList:{},contact:{},messages:[],loading:!1},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Re:case Ge:case Je:case Ve:return Object(s.a)(Object(s.a)({},e),{},{loading:!0});case Be:var t=a.payload;return Object(s.a)(Object(s.a)(Object(s.a)({},e),t.result),{},{messages:[],loading:!1});case ze:var n=a.payload;return Object(s.a)(Object(s.a)({},e),{},Object(V.a)({},n.key,n.val));case Ue:var r=a.payload;return Object(s.a)(Object(s.a)({},e),{},{loading:!1,messages:r});case Me:var o=a.payload;return Object(s.a)(Object(s.a)({},e),{},{loading:!1,contact:o,messages:[]});default:return Object(s.a)({},e)}},He={getListContacts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Re,payload:e}},deleteContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ge,payload:e}},saveContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Je,payload:e}},setListContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Be,payload:e}},setStateVar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ze,payload:e}},setMessageContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:Ue,payload:e}},getContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ve,payload:e}},setContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Me,payload:e}}},Ze=ke.a.mark(We);function We(e){var a,t,n;return ke.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.payload,r.prev=1,t=Ae("contacts",null,a),r.next=5,Object(je.b)(Ie,t,"GET");case 5:if(!(n=r.sent).data){r.next=11;break}return r.next=9,Object(je.c)(He.setListContact({result:{list:n.data,metaList:n.meta},options:a}));case 9:r.next=13;break;case 11:return r.next=13,Object(je.c)(He.setMessageContact([{type:"error",text:"al traer datos de contactos en la API"}]));case 13:r.next=20;break;case 15:return r.prev=15,r.t0=r.catch(1),console.error("[Orus System] Error in handle getListOrder",r.t0),r.next=20,Object(je.c)(He.setMessageContact([{type:"error",text:"al traer datos de contactos, intentelo mas tarde"}]));case 20:case"end":return r.stop()}}),Ze,null,[[1,15]])}var Xe=ke.a.mark(Ye);function Ye(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.id,n=a.options,r=Ae("contacts",t),l.next=7,Object(je.b)(Ie,r,"DELETE");case 7:if(o=l.sent){l.next=16;break}return console.log("[Orus System] Contacto eliminado con exito",t),l.next=12,Object(je.c)(He.setMessageContact([{type:"success",text:"Contacto eliminado con exito"}]));case 12:return l.next=14,Object(je.c)(He.getListContact(n));case 14:l.next=24;break;case 16:if(console.error("[Orus System] Fallo al eliminar el contacto",o.message),!o.message.indexOf("[SQLSTATE[23000]]")){l.next=22;break}return l.next=20,Object(je.c)(He.setMessageContact([{type:"error",text:"No se puede eliminar un contacto que tiene registros",errnum:"SQL23000"}]));case 20:l.next=24;break;case 22:return l.next=24,Object(je.c)(He.setMessageContact([{type:"error",text:"No se puede eliminar el contacto"}]));case 24:l.next=31;break;case 26:return l.prev=26,l.t0=l.catch(1),console.error("[Orus System] Error in handle deleteOrder",l.t0),l.next=31,Object(je.c)(He.setMessageContact([{type:"error",text:"al eliminar el contacto, intentelo mas tarde"}]));case 31:case"end":return l.stop()}}),Xe,null,[[1,26]])}var Ke=ke.a.mark(Qe);function Qe(e){var a,t,n,r,o,l,c,s,i,m;return ke.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return a=e.payload,d.prev=1,t=a.data,n=void 0===t?{}:t,r=a.id,o=void 0===r?null:r,l=a.options,c=void 0===l?{}:l,s=Ae("contacts",o),i=o?"PUT":"POST",d.next=12,Object(je.b)(Ie,s,i,n);case 12:if(!(m=d.sent).message||!m.errors){d.next=24;break}if(!m.errors.name){d.next=19;break}return d.next=17,Object(je.c)(He.setMessageContact([{type:"error",text:m.errors.name[0].replace("name","Nombre")}]));case 17:d.next=22;break;case 19:if(!m.errors.email){d.next=22;break}return d.next=22,Object(je.c)(He.setMessageContact([{type:"error",text:m.errors.email[0]}]));case 22:d.next=29;break;case 24:return o?console.log("[Orus System] Contacto actualizado con exito",o):console.log("[Orus system] Contacto creado con exito",m.data.id),d.next=27,Object(je.c)(He.setMessageContact([{type:"success",text:o?"Contacto actualizado con exito":"Contacto almacenado con exito"}]));case 27:return d.next=29,Object(je.c)(He.getListContact(c));case 29:d.next=36;break;case 31:return d.prev=31,d.t0=d.catch(1),console.error("[Orus System] Error in handle save contact --",d.t0),d.next=36,Object(je.c)(He.setMessageContact([{type:"error",text:"al almacenar el contacto, intentelo mas tarde"}]));case 36:case"end":return d.stop()}}),Ke,null,[[1,31]])}var ea=ke.a.mark(aa);function aa(e){var a,t;return ke.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.payload,n.prev=1,n.next=4,Object(je.b)(Ie,"contacts/".concat(a),"GET");case 4:if(!(t=n.sent).data){n.next=10;break}return n.next=8,Object(je.c)(He.setContact(t.data));case 8:n.next=13;break;case 10:return console.error("[Orus System] Error in handle GET Contact",t),n.next=13,Object(je.c)(He.setMessageContact([{type:"error",text:"al traer datos de contacto en la API"}]));case 13:n.next=20;break;case 15:return n.prev=15,n.t0=n.catch(1),console.error("[Orus System] Error in handle GET Contact",n.t0),n.next=20,Object(je.c)(He.setMessageContact([{type:"error",text:"al traer datos de contacto, intentelo mas tarde"}]));case 20:case"end":return n.stop()}}),ea,null,[[1,15]])}var ta=ke.a.mark(na);function na(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de contacto"),e.next=3,Object(je.d)(Re,We);case 3:return e.next=5,Object(je.d)(Ge,Ye);case 5:return e.next=7,Object(je.d)(Je,Qe);case 7:return e.next=9,Object(je.d)(Ve,aa);case 9:case"end":return e.stop()}}),ta)}var ra=$e,oa="SAGA_GET_LIST_EXAM",la="SAGA_DELETE_EXAM",ca="SAGA_SAVE_EXAM",sa="SET_LIST_EXAM",ia="SET_MESSAGE_EXAM",ma={list:[],metaList:{},messages:[],loading:!1},da=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ma,a=arguments.length>1?arguments[1]:void 0,t=a.payload;switch(a.type){case oa:case la:case ca:return Object(s.a)(Object(s.a)({},e),{},{loading:!0});case sa:return Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},e),t.result),t.options),{},{messages:[],loading:!1});case ia:return Object(s.a)(Object(s.a)({},e),{},{loading:!1,messages:t});default:return Object(s.a)({},e)}},ua={getListExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:oa,payload:e}},setListExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:sa,payload:e}},setMessagesExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ia,payload:e}},deleteExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:la,payload:e}},saveExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ca,payload:e}}},pa=ke.a.mark(ha);function ha(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.options,n=a.id,r=Ae("exams",n,t),l.next=7,Object(je.b)(Ie,r);case 7:return o=l.sent,l.next=10,Object(je.c)(ua.setListExam({result:{list:o.data,metaList:o.meta},options:t}));case 10:l.next=17;break;case 12:return l.prev=12,l.t0=l.catch(1),console.error("[Orus System] Error en saga/exam getList:",l.t0),l.next=17,Object(je.c)(ua.setMessagesExam([]));case 17:case"end":return l.stop()}}),pa,null,[[1,12]])}var ga=ke.a.mark(fa);function fa(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.id,n=a.options,r=Ae("exams",t),l.next=7,Object(je.b)(Ie,r,"DELETE");case 7:if(o=l.sent){l.next=17;break}return console.log("[Orus System] Examen eliminado con exito",t),l.next=12,Object(je.c)(ua.setMessagesExam([{type:"success",text:"Examen eliminado con exito"}]));case 12:return console.log("[DEBUG] saga",n),l.next=15,Object(je.c)(ua.getListExam({options:n}));case 15:l.next=25;break;case 17:if(console.error("[Orus System] Fallo al eliminar el examen",o.message),!o.message.indexOf("[SQLSTATE[23000]]")){l.next=23;break}return l.next=21,Object(je.c)(ua.setMessagesExam([{type:"error",text:"No se puede eliminar un examen que esta asignado",errnum:"SQL23000"}]));case 21:l.next=25;break;case 23:return l.next=25,Object(je.c)(ua.setMessagesExam([{type:"error",text:"No se puede eliminar el examen"}]));case 25:l.next=32;break;case 27:return l.prev=27,l.t0=l.catch(1),console.error("[Orus System] Error in handle deleteOrder",l.t0),l.next=32,Object(je.c)(ua.setMessagesExam([{type:"error",text:"al eliminar el examen, intentelo mas tarde"}]));case 32:case"end":return l.stop()}}),ga,null,[[1,27]])}var Ea=ke.a.mark(va);function va(e){var a,t,n,r,o,l,c;return ke.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=e.payload,s.prev=1,t=a.options,n=a.id,r=a.data,o=Ae("exams",n),l=n?"PUT":"POST",s.next=9,Object(je.b)(Ie,o,l,r);case 9:if((c=s.sent).message){s.next=18;break}return console.log("[Orus System] Examen almacenado con exito",c.data.id),s.next=14,Object(je.c)(ua.setMessagesExam([{type:"success",text:n?"Examen actualizado con exito":"Examen almacenado con exito"}]));case 14:return s.next=16,Object(je.c)(ua.getListExam({options:t}));case 16:s.next=21;break;case 18:return console.error("[Orus System] Fallo al almacenar el examen",c.message),s.next=21,Object(je.c)(ua.setMessagesExam([{type:"error",text:"No se puede almacenar el examen"}]));case 21:s.next=28;break;case 23:return s.prev=23,s.t0=s.catch(1),console.error("[Orus System] Error in handle deleteOrder",s.t0),s.next=28,Object(je.c)(ua.setMessagesExam([{type:"error",text:"al almacenar el examen, intentelo mas tarde"}]));case 28:case"end":return s.stop()}}),Ea,null,[[1,23]])}var ba=ke.a.mark(Na);function Na(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de exam"),e.next=3,Object(je.d)(oa,ha);case 3:return e.next=5,Object(je.d)(la,fa);case 5:return e.next=7,Object(je.d)(ca,va);case 7:case"end":return e.stop()}}),ba)}var ya=da,xa=Object(l.b)({logging:D,default:J,order:pe,category:be,storeItem:Pe,contact:ra,exam:ya}),wa=ke.a.mark(Sa);function Sa(e){var a;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log("[Orus System] Consultando credenciales en la API"),!e.payload.email||!e.payload.password){t.next=17;break}return t.next=5,Object(je.b)(Ie,"users/login","POST",e.payload);case 5:if(!(a=t.sent).data){t.next=12;break}return console.log("[Orus System] Servidor:",a.message),t.next=10,Object(je.c)({type:d,payload:a});case 10:t.next=15;break;case 12:return console.error("[Orus System] Fallo la validacion de credenciales en servidor",a),t.next=15,Object(je.c)({type:u,payload:{errors:"Error de procesamiento, llame al administrador",result:a}});case 15:t.next=19;break;case 17:return t.next=19,Object(je.c)({type:p,payload:null});case 19:t.next=26;break;case 21:return t.prev=21,t.t0=t.catch(0),console.error("[Orus System] Error in handle loggin",t.t0),t.next=26,Object(je.c)({type:u,payload:{errors:"Error al conectarse al servidor, compruebe que tiene internet",errornum:500}});case 26:case"end":return t.stop()}}),wa,null,[[0,21]])}var Ca=ke.a.mark(Oa);function Oa(){var e,a;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("[Orus System] Consultando notificaciones en la API"),t.next=4,Object(je.b)(Ie,"user","GET");case 4:if(!(e=t.sent).data||!e.data.id){t.next=12;break}return a=e.data.unreadNotifications,console.log("[Orus System] Notificaciones encontradas:",a.length),t.next=10,Object(je.c)({type:f,payload:a});case 10:t.next=18;break;case 12:if("Unauthenticated."!==e.message){t.next=17;break}return t.next=15,Object(je.c)({type:p,payload:null});case 15:t.next=18;break;case 17:console.error("[Orus System] Error en notificaciones",e);case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.error("[Orus System] Error in handle notify user",t.t0);case 23:case"end":return t.stop()}}),Ca,null,[[0,20]])}var ka=ke.a.mark(ja);function ja(e){var a,t,n;return ke.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.payload,r.prev=1,console.log("[Orus System] Enviando notificaciones a la API"),r.next=5,Object(je.b)(Ie,"user/readAllNotifications","POST",a);case 5:if(t=r.sent,n=parseInt(a.id)<0?"Todas":1,!t.success){r.next=11;break}return console.log("[Orus System] Notificaciones marcadas leidas:",n),r.next=11,Object(je.c)({type:h,payload:{}});case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),console.error("[Orus System] Error in handle read notify user",r.t0);case 16:case"end":return r.stop()}}),ka,null,[[1,13]])}var _a=ke.a.mark(Ia);function Ia(e){var a;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log("[Orus System] Consultando loggin en la API"),!e.payload){t.next=15;break}return t.next=5,Object(je.b)(Ie,"user");case 5:if(!(a=t.sent).message||"Unauthenticated."!==a.message){t.next=12;break}return console.log("[Orus System] Token de usuario no valido"),t.next=10,Object(je.c)({type:p,payload:null});case 10:t.next=13;break;case 12:console.log("[Orus System] Verificacion de usuario correcta",a.data.username);case 13:t.next=18;break;case 15:return console.error("[Orus System] Error en el token de usuario:",e.payload),t.next=18,Object(je.c)({type:p,payload:null});case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.error("[Orus System] Error in handle check loggin",t.t0);case 23:case"end":return t.stop()}}),_a,null,[[0,20]])}var Aa=ke.a.mark(Ta);function Ta(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de usuario"),e.next=3,Object(je.d)(i,Sa);case 3:return e.next=5,Object(je.d)(m,Ia);case 5:return e.next=7,Object(je.d)(h,Oa);case 7:return e.next=9,Object(je.d)(g,ja);case 9:case"end":return e.stop()}}),Aa)}var Da=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return{type:q,payload:e,idOrder:a}},La=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Z,payload:e}},Fa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:W,payload:e}},Pa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:Y,payload:e}},Ba=ke.a.mark(za);function za(e){var a,t,n,r;return ke.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.payload,t=e.idOrder,o.prev=1,n=Ae("orders",null,a),o.next=5,Object(je.b)(Ie,n,"GET");case 5:if(!(r=o.sent).data){o.next=14;break}return o.next=9,Object(je.c)(La({result:{list:r.data,metaList:r.meta},options:a}));case 9:if(!t){o.next=12;break}return o.next=12,Object(je.c)(Fa({key:"orderId",val:t}));case 12:o.next=16;break;case 14:return o.next=16,Object(je.c)(Pa([{type:"error",text:"al traer datos de pedidos en la API"}]));case 16:o.next=23;break;case 18:return o.prev=18,o.t0=o.catch(1),console.error("[Orus System] Error in handle getListOrder",o.t0),o.next=23,Object(je.c)(Pa([{type:"error",text:"al traer datos de pedidos, intentelo mas tarde"}]));case 23:case"end":return o.stop()}}),Ba,null,[[1,18]])}var Ua=ke.a.mark(Ma);function Ma(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.id,n=a.options,r="orders/".concat(t),l.next=7,Object(je.b)(Ie,r,"DELETE");case 7:if(o=l.sent){l.next=16;break}return console.log("[Orus System] Pedido eliminado con exito",t),l.next=12,Object(je.c)(Pa([{type:"success",text:"Pedido eliminado con exito"}]));case 12:return l.next=14,Object(je.c)(Da(n));case 14:l.next=24;break;case 16:if(console.error("[Orus System] Fallo al eliminar ordern",o.message),!o.message.indexOf("[SQLSTATE[23000]]")){l.next=22;break}return l.next=20,Object(je.c)(Pa([{type:"error",text:"No se puede eliminar un pedido que tiene asignada una nota de venta",errnum:"SQL23000"}]));case 20:l.next=24;break;case 22:return l.next=24,Object(je.c)(Pa([{type:"error",text:"No se puede eliminar el pedido"}]));case 24:l.next=31;break;case 26:return l.prev=26,l.t0=l.catch(1),console.error("[Orus System] Error in handle deleteOrder",l.t0),l.next=31,Object(je.c)(Pa([{type:"error",text:"al eliminar el pedidos, intentelo mas tarde"}]));case 31:case"end":return l.stop()}}),Ua,null,[[1,26]])}var Ra=ke.a.mark(Ga);function Ga(e){var a,t,n,r,o,l,c,s,i,m;return ke.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return a=e.payload,d.prev=1,t=a.order,n=void 0===t?{}:t,r=a.id,o=void 0===r?null:r,l=a.options,c=void 0===l?{}:l,s=Ae("orders",o),i=o?"PUT":"POST",d.next=12,Object(je.b)(Ie,s,i,n);case 12:if(!(m=d.sent).message){d.next=15;break}throw new Error(m.message);case 15:return o?console.log("[Orus System] Pedido actualizado con exito",o):console.log("[Orus system] Pedido creado con exito",m.data.id),localStorage.setItem("OrusContactInUse",JSON.stringify({})),d.next=19,Object(je.c)(Pa([{type:"success",text:o?"Pedido actualizado con exito":"Pedido almacenado con exito"}]));case 19:return d.next=21,Object(je.c)(Da(c));case 21:d.next=28;break;case 23:return d.prev=23,d.t0=d.catch(1),console.error("[Orus System] Error in handle save order",d.t0),d.next=28,Object(je.c)(Pa([{type:"error",text:"al almacenar el pedido, intentelo mas tarde"}]));case 28:case"end":return d.stop()}}),Ra,null,[[1,23]])}var Ja=ke.a.mark(Va);function Va(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de ordenes"),e.next=3,Object(je.d)(q,za);case 3:return e.next=5,Object(je.d)($,Ma);case 5:return e.next=7,Object(je.d)(H,Ga);case 7:case"end":return e.stop()}}),Ja)}var qa=ke.a.mark($a);function $a(e){var a,t,n,r,o;return ke.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.payload,l.prev=1,t=a.options,n=a.id,r=Ae("categories",n,t),l.next=7,Object(je.b)(Ie,r,"GET");case 7:if(!(o=l.sent).data){l.next=13;break}return l.next=11,Object(je.c)({type:fe,payload:{result:{list:o.data,metaList:o.meta},options:a}});case 11:l.next=16;break;case 13:return console.error("[Orus System] Fallo traer categorias",o),l.next=16,Object(je.c)({type:Ee,payload:[]});case 16:l.next=23;break;case 18:return l.prev=18,l.t0=l.catch(1),console.error("[Orus System] Error en saga/category getList:",l.t0),l.next=23,Object(je.c)({type:Ee,payload:[]});case 23:case"end":return l.stop()}}),qa,null,[[1,18]])}var Ha=ke.a.mark(Za);function Za(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de categorias"),e.next=3,Object(je.d)(he,$a);case 3:case"end":return e.stop()}}),Ha)}var Wa=ke.a.mark(Xa);function Xa(){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.a)([Ta(),Va(),Za(),Fe(),na(),Na()]);case 2:case"end":return e.stop()}}),Wa)}var Ya=Object(c.a)(),Ka="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.c,Qa=Object(l.d)(xa,Ka(l.a.apply(void 0,[Ya])));Ya.run(Xa);var et=Qa,at=t(15),tt=t(3),nt=t(4),rt=t(6),ot=t(5),lt=t(13),ct=t(17),st=t(10),it=t.n(st),mt=function(e){return{type:i,payload:e}},dt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleClickRead=function(e,a){var t=n.props.readNotifyUser;-1===a&&e.preventDefault(),t({id:a})};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={rol:r.rol},n.timerNotify=null,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.isLogged&&(this.props.getNotifyUser(),this.timerNotify=setInterval((function(){e.props.getNotifyUser()}),6e4))}},{key:"componentWillUnmount",value:function(){this.timerNotify&&clearInterval(this.timerNotify)}},{key:"render",value:function(){var e=this,a=this.props.notifications,t=this.state.rol,n=a?a.length:0;return r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("a",{className:"nav-link","data-toggle":"dropdown",href:"#end"},r.a.createElement("i",{className:"far fa-bell"}),n?r.a.createElement("span",{className:"badge badge-warning navbar-badge"},n):null),r.a.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},r.a.createElement("span",{className:"dropdown-header"},n," Notificaciones"),r.a.createElement("div",{className:"dropdown-divider"}),a.map((function(a,n){var o=a.type.split("\\",3),l="general",c="fa-file",s=it()(a.created_at).fromNow(),i="#end";return!(n>10)&&("ExamNotification"===o[2]&&(2===t?(l="Examen creado",i="/consultorio/registro/"+a.data.id):(l="Examen actualizado",i="/pedidos/registro"),c="fa-file-alt"),r.a.createElement(lt.b,{to:i,className:"dropdown-item",key:a.id,onClick:function(t){e.handleClickRead(t,a.id)}},r.a.createElement("i",{className:"fas "+c+" mr-1"})," ",l,r.a.createElement("span",{className:"float-right text-sm text-muted"},s)))})),n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"dropdown-divider"}),r.a.createElement("a",{href:"#end",className:"dropdown-item dropdown-footer",onClick:function(a){a.preventDefault(),e.handleClickRead(a,-1)}},"Marcar como le\xeddo.")):null,r.a.createElement(lt.b,{to:"/notificaciones",className:"dropdown-item dropdown-footer",onClick:function(e){}},"Ver todas")))}}]),t}(n.Component),ut={getNotifyUser:function(e){return{type:h,payload:e}},readNotifyUser:function(e){return{type:g,payload:e}}},pt=Object(at.b)((function(e){return{notifications:e.logging.notifications,isLogged:e.logging.isLogged}}),ut)(dt),ht=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"main-header navbar navbar-expand navbar-dark navbar-lightblue"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link","data-widget":"pushmenu",href:"#navbar",role:"button",onClick:function(e){e.preventDefault(),window.$("#body").toggleClass("sidebar-open"),window.$("#body").toggleClass("sidebar-collapse")}},r.a.createElement("i",{className:"fas fa-bars"})))),r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("a",{href:"#end",className:"nav-link","data-toggle":"dropdown"},r.a.createElement("i",{className:"far fa-comments"})),r.a.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},r.a.createElement("span",{className:"dropdown-header"},"Sin comentarios"),r.a.createElement("div",{className:"dropdown-divider"}))),r.a.createElement(pt,null)))}}]),t}(n.Component),gt={loggin:mt},ft=Object(at.b)((function(e){return{user:{rol:e.logging.rol,name:e.logging.name,username:e.logging.username},companyName:e.default.company,active:""}}),gt)((function(e){var a=e.companyName,t=e.user,n=Object(ct.f)().pathname.replace("/",""),o="/img/avatars/avatar5.png";return 1===t.rol&&(o="/img/avatars/avatar2.png"),t.rol||(o="/img/avatars/avatar3.png"),2===t.idUser&&(o="/img/avatars/avatar4.png"),r.a.createElement("aside",{className:"main-sidebar sidebar-dark-primary"},r.a.createElement(lt.b,{to:"/",className:"brand-link"},r.a.createElement("img",{src:"/img/AdminLTELogo.png",alt:a+" logo ",className:"brand-image img-circle elevation-3",style:{opacity:.8}}),r.a.createElement("span",{className:"brand-text font-weight-light text-uppercase"},a)),r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"pb-3 mt-3 mb-3 user-panel d-flex"},r.a.createElement("div",{className:"image"},r.a.createElement("img",{src:o,className:"img-circle elevation-2",alt:t.name})),r.a.createElement("div",{className:"info"},r.a.createElement("a",{href:"#end",className:"d-block text-capitalize"},t.name,r.a.createElement("small",{className:"text-lowercase"},"(",t.username,")"),r.a.createElement("br",null),r.a.createElement("span",{className:"badge badge-light"},t.rol>0?1===t.rol?"Ventas":"Optometrista":"Administrador")))),r.a.createElement("nav",{className:"mt-2"},r.a.createElement("ul",{className:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false"},2!==t.rol?r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/",className:""===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-tachometer-alt"}),r.a.createElement("p",null,"Dashboard",r.a.createElement("i",{className:"right fas fa-angle-left"})))):null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/contactos",className:"contactos"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-address-book"}),r.a.createElement("p",null,"Contactos",r.a.createElement("i",{className:"right fas fa-angle-left"})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/consultorio",className:"consultorio"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-notes-medical"}),r.a.createElement("p",null,"Examenes",r.a.createElement("i",{className:"right fas fa-angle-left"})))),t.rol<=1?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/pedidos",className:"pedidos"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-clipboard-list"}),r.a.createElement("p",null,"Pedidos",r.a.createElement("i",{className:"right fas fa-angle-left"})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/notas",className:"notas"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-cash-register"}),r.a.createElement("p",null,"Ventas",r.a.createElement("i",{className:"right fas fa-angle-left"}))))):null,t.rol?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"almacen"===n?"nav-item has-treeview menu-open":"nav-item has-treeview "},r.a.createElement(lt.b,{to:"/almacen",className:"almacen"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-database"}),r.a.createElement("p",null,"Almacen",r.a.createElement("i",{className:"right fas fa-angle-left"})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/usuarios",className:"usuarios"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-user"}),r.a.createElement("p",null,"Usuarios",r.a.createElement("i",{className:"right fas fa-angle-left"})))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/configuraciones",className:"configuraciones"===n?"nav-link active":"nav-link"},r.a.createElement("i",{className:"nav-icon fas fa-tools"}),r.a.createElement("p",null,"Configuraciones",r.a.createElement("i",{className:"right fas fa-angle-left"}))))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(lt.b,{to:"/",className:"nav-link",onClick:function(a){a.preventDefault();var t=e.loggin;window.Swal.fire({title:"Session",text:"\xbfEsta seguro de cerrar la sesion?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Si",cancelButtonText:"Cancelar"}).then((function(e){e&&!e.dismiss&&e.value&&t({})}))}},r.a.createElement("i",{className:"nav-icon fas fa-sign-out-alt"}),r.a.createElement("p",null,"Cerrar sesion")))))))})),Et=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).state={date:it()().format("LLLL")},n.timerNotify=null,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerNotify=setInterval((function(){console.log("[Orus System] Actualizando hora de sistema"),e.setState({date:it()().format("LLLL")})}),6e4)}},{key:"componentWillUnmount",value:function(){this.timerNotify&&clearInterval(this.timerNotify)}},{key:"render",value:function(){var e=this.props,a=e.title,t=e.host,n=e.company,o=e.name,l=this.state.date;return r.a.createElement("div",{className:"content-header"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("h1",{className:"m-0 text-dark text-capitalize"},r.a.createElement("i",{className:"mr-1 fas fa-file"})," ",a)),r.a.createElement("div",{className:"text-center col"},r.a.createElement("small",{className:"p-2 badge badge-secondary text-capitalize",alt:"conectado a",title:"conectado a"},r.a.createElement("i",{className:"mr-1 fas fa-wifi text-success"}),t),r.a.createElement("small",{className:"p-2 mt-1 ml-1 badge badge-secondary text-capitalize",alt:"Almacenando en",title:"Almacenando en"},r.a.createElement("i",{className:"mr-1 fas fa-server text-success"})," ",n),r.a.createElement("small",{className:"p-2 mt-1 ml-2 badge badge-secondary text-capitalize",alt:"Usuario conectado",title:"Usuario conectado"},r.a.createElement("i",{className:"mr-1 fas fa-user text-info"})," ",o)),r.a.createElement("div",{className:"col"},r.a.createElement("h6",{className:"text-right text-muted"},r.a.createElement("i",{className:"mr-1 fas fa-calendar"})," ",l)))),r.a.createElement("hr",null))}}]),t}(n.Component),vt=Object(at.b)((function(e){return{company:e.default.company,host:e.default.host,name:e.logging.username}}))(Et),bt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{className:"main-footer d-print-none"},r.a.createElement("div",{className:"float-right d-none d-sm-inline"},"V2.0"),r.a.createElement("strong",null,"Copyright \xa9 2015-2020 ",r.a.createElement("a",{href:"#end"},"Orus"),".")," ","Todos los derechos reservados.")}}]),t}(n.Component),Nt=(t(26),function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).handleOrder=function(a){e.props.handleOrder(a)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.data,n=a.order,o=a.orderby,l=a.actions;return t.length?r.a.createElement("thead",{className:"thead-light"},r.a.createElement("tr",null,t.map((function(a,t){return a.filter?r.a.createElement("th",{scope:"col",key:t,onClick:function(){e.handleOrder(a.type)},style:{cursor:"desc"===n?"n-resize":"s-resize"}},a.name,o===a.type?r.a.createElement("span",{className:"ml-2"},r.a.createElement("i",{className:"fas fa-sort text-primary"})):""):r.a.createElement("th",{scope:"col",key:t},a.name)})),l?r.a.createElement("th",{className:"text-center"},"Acciones"):"")):r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col",className:"text-center"},"No hay datos de columnas")))}}]),t}(n.Component)),yt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).handleChangePage=function(a){e.props.handleChangePage(a)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.props.meta;return a.total>10&&r.a.createElement("div",{className:"btn-group"},r.a.createElement("ul",{className:"pagination pagination-sm"},r.a.createElement("li",{className:1===a.current_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:1===a.current_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(a){a.preventDefault(),e.handleChangePage(1)}},"Primero")),r.a.createElement("li",{className:1===a.current_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:1===a.current_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(t){t.preventDefault(),e.handleChangePage(a.current_page-1)}},r.a.createElement("i",{className:"fas fa-step-backward"}))),r.a.createElement("li",{className:"page-item"},r.a.createElement("span",{className:"page-link"},a.current_page," /"," ",Math.ceil(a.total/a.per_page).toFixed(0))),r.a.createElement("li",{className:a.current_page===a.last_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:a.current_page===a.last_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(t){t.preventDefault(),e.handleChangePage(a.current_page+1)}},r.a.createElement("i",{className:"fas fa-step-forward"}))),r.a.createElement("li",{className:a.current_page===a.last_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:a.current_page===a.last_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(t){t.preventDefault(),e.handleChangePage(a.last_page)}},"Ultimo"))))}}]),t}(n.Component),xt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("rol",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,r=t.value;e.props.changeFilters(n,r)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.rol;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"btn-group"},r.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},r.a.createElement("i",{className:"fas fa-filter"}))),r.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"},"Busquedas"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{className:"modal-body"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-search"}))),r.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: nombre, usuario o email",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("label",null,"Rol"),r.a.createElement("div",{className:"input-group-prepend ml-4"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-address-book"}))),r.a.createElement("select",{className:"form-control",name:"rol",value:t,onChange:this.changeFilters},r.a.createElement("option",{value:""},"Todos"),r.a.createElement("option",{value:"0"},"Administrador"),r.a.createElement("option",{value:"1"},"Ventas"),r.a.createElement("option",{value:"2"},"Optometrista")))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},r.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),r.a.createElement("button",{type:"button",className:this.props.search||this.props.rol?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},r.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),r.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},r.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(n.Component),wt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).handleDelete=function(a,t){e.props.delete(a,t)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.item,n=a.edit,o=a.id;return r.a.createElement("td",{className:"text-right"},this.props.delete?r.a.createElement("a",{className:"btn-flat text-dark mr-4",href:"#delete",onClick:function(a){a.preventDefault(),e.handleDelete(o,t)}},r.a.createElement("i",{className:"fas fa-trash"})):"",n?r.a.createElement(lt.b,{className:"btn-flat text-dark",to:n+o},r.a.createElement("i",{className:"fas fa-pencil-alt"})):"")}}]),t}(n.Component),St=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeFilters=function(e,a){n.setState(Object(V.a)({},e,a))},n.handleOrder=function(e){n.setState({orderby:e,order:"desc"===n.state.order?"asc":"desc",load:!0})},n.handleChangePage=function(e){n.setState({page:e,load:!0})},n.handleDelete=function(e,a){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el usuario "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a){var t=n.state,r=t.host,o=t.token;return console.log("Solicitud de eliminaci\xf3n de usuario por API"),fetch("http://"+r+"/api/users/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Usuario eliminado"),window.Swal.fire({icon:"success",title:"Usuario eliminado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getUsers()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.getUsers=function(){var e=n.state,a=e.load,t=e.host,r=e.token,o="http://"+t+"/api/users",l="&orderby=".concat(n.state.orderby,"&order=").concat(n.state.order),c=n.state.search?"&search=".concat(n.state.search):"",s=n.state.rol.length>0?"&rol=".concat(n.state.rol):"",i=n.state.page>0?"?page="+n.state.page:"?page=1";a||n.setState({load:!0}),console.log("Solicitando usuarios a la API"),fetch(o+i+l+c+s,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data?(console.log("Descargando usuarios"),n.setState({users:e,load:!1})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Al descargar usuarios","error"),n.setState({load:!1}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusUsers")),o=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={users:{data:[],meta:{}},load:!0,page:r?r.page:1,orderby:r?r.orderby:"created_at",order:r?r.order:"asc",search:r?r.search:"",rol:r?r.rol:"",host:o.host,token:o.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getUsers(),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol})),console.log("[Users] Eliminando datos de contacto en uso"),localStorage.setItem("OrusContactInUse",JSON.stringify({}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando usuarios y almacenando configuracion"),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol})),this.getUsers())}},{key:"render",value:function(){var e=this,a=this.state,t=a.users,n=a.load;return r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h2",{className:"card-title text-primary"},r.a.createElement("i",{className:"fas fa-user mr-1"}),"Usuarios registrados"),r.a.createElement("div",{className:"card-tools"},r.a.createElement(xt,{search:this.state.search,rol:this.state.rol,changeFilters:this.changeFilters,handleChangePage:this.handleChangePage}),r.a.createElement(yt,{meta:t.meta,handleChangePage:this.handleChangePage}))),r.a.createElement("div",{className:"card-body table-responsive p-0"},r.a.createElement("table",{className:"table table-sm table-bordered table-hover"},r.a.createElement(Nt,{orderby:this.state.orderby,order:this.state.order,data:[{name:"usuario",type:"username",filter:!0},{name:"nombre",type:"name",filter:!0},{name:"e-mail",type:"email",filter:!0},{name:"Rol",type:"rol",filter:!0},{name:"Actividad",type:"session"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"9",className:"alert alert-light text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("th",{scope:"row"},r.a.createElement("span",{className:"text-capitalize text-primary"},a.username)),r.a.createElement("td",null,r.a.createElement(lt.b,{to:"/usuarios/registro/"+a.id},r.a.createElement("span",{className:"badge badge-primary text-capitalize p-1"},a.name,r.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),r.a.createElement("td",null,a.email),r.a.createElement("td",null,a.rol>0?1===a.rol?r.a.createElement("span",{className:"text-capitalize text-success"},r.a.createElement("i",{className:"fas fa-user-tag mr-2"}),"Ventas"):r.a.createElement("span",{className:"text-capitalize text-primary"},r.a.createElement("i",{className:"fas fa-user-tie mr-2"}),"Optometrista"):r.a.createElement("span",{className:"text-capitalize text-danger"},r.a.createElement("i",{className:"fas fa-user-shield mr-2"}),"Administrador")),r.a.createElement("td",null,a.session?it()(a.session.last_activity).fromNow():"--"),r.a.createElement("td",null,it()(a.updated_at).fromNow()),r.a.createElement("td",{className:"text-right"},it()(a.created_at).format("ll")),r.a.createElement(wt,{id:a.id,item:a.username,delete:e.handleDelete,edit:"/usuarios/registro/"}))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"8",className:"alert alert-info text-center"},r.a.createElement("i",{className:"fas fa-info mr-2"}),"No hay datos para mostrar"))))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement(lt.b,{to:"/usuarios/registro",className:"btn btn-outline-primary btn-lg"},r.a.createElement("i",{className:"fas fa-plus mr-2"}),"Nuevo usuario")))}}]),t}(n.Component),Ct=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleChange=function(e){var a=e.target.value,t={target:{name:"validUserName",value:""}};e.target.value=a.replace(/ /g,"").toLowerCase(),/^[\w]{4,16}$/.test(a)?n.validUser(e.target.value,t):a.length>4?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de usuario"}),t.target.value=!1,n.props.onChange(t)):a.length||(n.setState({bgColor:"bg-blue",validate:" border border-danger",text:"Debe de tener de 4 a 16 caracteres alfanumericos."}),t.target.value=!1,n.props.onChange(t)),n.props.onChange(e)},n.validUser=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),r="http://"+t.host+"/api/users",o="?username="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({searchUser:!0}),fetch(r+o,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?console.error("Error en la descarga de usuarios",t.message):t.data.length&&t.data[0].username.toLowerCase()===e?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El usuario ya esta registrado.",searchUser:!1}),a.target.value=!1,n.props.onChange(a)):(n.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),a.target.value=!0,n.props.onChange(a))})).catch((function(e){console.error(e)}))}),1e3)},n.state={bgColor:"bg-blue",validate:"",text:"Debe de tener al menos 4 caracteres.",searchUser:!1},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,a=e.col,t=e.username,n=this.state,o=n.bgColor,l=n.validate,c=n.text,s=n.searchUser;return r.a.createElement("div",{className:"col-"+a},t.length?r.a.createElement("small",null,r.a.createElement("label",null,"Usuario")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text "+o},s?r.a.createElement("i",{className:"fas fa-spinner"}):r.a.createElement("i",{className:"fas fa-user-check"}))),r.a.createElement("input",{type:"text",className:"form-control"+l,placeholder:"Usuario",name:"username",autoComplete:"off",autoFocus:"autofocus",value:t,onChange:this.handleChange,required:"required",minLength:"4",maxLength:"16",pattern:"^[\\w]{4,16}$"})),l?r.a.createElement("small",{className:"text-muted"},c):"")}}]),t}(n.Component),Ot=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleChange=function(e){var a=e.target.value,t={target:{name:"validUserEmail",value:!0}};e.target.value=a.replace(/\s/g,"").toLowerCase(),/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)?n.validEmail(e.target.value,t):a.length>8?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email"}),t.target.value=!1,n.props.onChange(t)):a.length||(n.setState({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email"}),t.target.value=!1,n.props.onChange(t)),n.props.onChange(e)},n.validEmail=function(e,a){var t=JSON.parse(localStorage.getItem("OrusSystem")),r="http://"+t.host+"/api/users",o="?email="+e;n.timeFetch&&clearTimeout(n.timeFetch),n.timeFetch=setTimeout((function(){n.setState({searchUser:!0}),fetch(r+o,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(t){t.message?(console.error("Error en la descarga de usuarios",t.message),n.setState({bgColor:"bg-red",validate:" border border-danger",text:"Error en la consulta",searchUser:!1})):t.data.length&&t.data[0].email.toLowerCase()===e?(n.setState({bgColor:"bg-red",validate:" border border-danger",text:"El email ya esta registrado.",searchUser:!1}),a.target.value=!1,n.props.onChange(a)):(n.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),a.target.value=!0,n.props.onChange(a))})).catch((function(e){console.error(e)}))}),1e3)},n.state={bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email",searchUser:!1},n.controller=new AbortController,n.signal=n.controller.signal,n.timeFetch=null,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,a=e.col,t=e.email,n=this.state,o=n.bgColor,l=n.validate,c=n.text;return r.a.createElement("div",{className:"col-"+a},t.length?r.a.createElement("small",null,r.a.createElement("label",null,"Usuario")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text "+o},r.a.createElement("i",{className:"fas fa-at"}))),r.a.createElement("input",{type:"email",className:"form-control"+l,placeholder:"email",name:"email",autoComplete:"off",value:t,onChange:this.handleChange,required:"required"})),l?r.a.createElement("small",{className:"text-muted"},c):"")}}]),t}(n.Component),kt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changePage=function(e){n.props.page(e.target.id)},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value;n.setState(Object(V.a)({},t,r))},n.handleSave=function(e){e.preventDefault();var a=n.state,t=a.id,r=a.validUserName,o=a.validUserEmail;return r?o?void window.Swal.fire({title:"Almacenamiento",text:t?"\xbfEsta seguro de actualizar el usuario?":"\xbfEsta seguro de crear un nuevo usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:t?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o=a.id,l=a.name,c=a.username,s=a.rol,i=a.password,m={name:l,username:c,rol:s,email:a.email},d=o?"http://"+t+"/api/users/"+o:"http://"+t+"/api/users",u=o?"PUT":"POST";return i.length>8&&(m.password=i),console.log("Enviando datos del usuario a API"),fetch(d,{method:u,body:JSON.stringify(m),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Usuario almacenado"),window.Swal.fire({icon:"success",title:t?"Usuario actualizado con exito":"Usuario almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.props.history.goBack()}))):(window.Swal.fire("Error","al almacenar el usuario","error"),console.error("Orus res: ",a.message))}})):(window.Swal.fire({icon:"error",title:"El correo ya esta en uso",showConfirmButton:!1,timer:1500}),!1):(window.Swal.fire({icon:"error",title:"El nombre de usuario ya esta en uso",showConfirmButton:!1,timer:1500}),!1)},n.getUser=function(e){var a=n.state,t=a.host,r=a.token;e>0?fetch("http://"+t+"/api/users/"+e,{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data?(console.log("Cargando datos de usuario"),n.setState({id:e.data.id,rol:e.data.rol,username:e.data.username,name:e.data.name,email:e.data.email,updated_at:e.data.updated_at,created_at:e.data.created_at,session:e.data.session,load:!1,validUserName:!0,validUserEmail:!0})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error en el sistema, comuniquese con el administrador de sistema","error"),n.setState({load:!1}))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})})):n.setState({load:!1})};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={id:0,rol:1,username:"",validUserName:!1,name:"",email:"",validUserEmail:!1,password:"",updated_at:"",created_at:"",session:{},load:!1,host:r.host,token:r.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;e&&this.getUser(e)}},{key:"render",value:function(){var e=this.state,a=e.load,t=e.id,n=e.rol,o=e.username,l=e.name,c=e.email,s=e.password,i=e.updated_at,m=e.created_at,d=e.session,u=e.validUserName,p=e.validUserEmail,h=!(!a&&u&&l.length&&p);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("form",{className:"card card-primary card-outline",onSubmit:this.handleSave},r.a.createElement("div",{className:"card-header"},r.a.createElement("h1",{className:"card-title text-primary"},r.a.createElement("i",{className:"fas fa-user mr-2"}),t?"Editar usuario":"Registrar nuevo usuario")),r.a.createElement("div",{className:"card-body was-validated"},a?r.a.createElement("div",{className:"alert alert-light text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row mb-3"},r.a.createElement(Ct,{username:o,col:6,onChange:this.catchInputs}),r.a.createElement("div",{className:"col-6"},l.length?r.a.createElement("small",null,r.a.createElement("label",null,"Nombre completo")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text bg-blue"},r.a.createElement("i",{className:"fas fa-user-tag"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",autoComplete:"off",value:l,onChange:this.catchInputs,required:"required",minLength:"8",pattern:"^[a-zA-Z]{2,20}[\\s]{1}[a-zA-Z]{2,20}.*"})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},s.length||t?r.a.createElement("small",null,r.a.createElement("label",null,"Contrase\xf1a"),t?"":r.a.createElement("span",{className:"ml-2"},"De 8 a 16 caracteres, por lo menos una mayuscula, un numero y un caracter especial")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text bg-blue"},r.a.createElement("i",{className:"fas fa-lock"}))),r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",value:s,onChange:this.catchInputs,required:!t,minLength:"8",maxLength:"16",pattern:"^(?=.*[A-Z])(?=.*[!@#$&.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$"}))),r.a.createElement(Ot,{email:c,col:6,onChange:this.catchInputs})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("small",null,r.a.createElement("label",null,"Rol")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text bg-blue"},r.a.createElement("i",{className:"fas fa-id-card"}))),r.a.createElement("select",{className:"custom-select",name:"rol",value:n,onChange:this.catchInputs},r.a.createElement("option",{value:"0"},"Administrador"),r.a.createElement("option",{value:"1"},"Ventas"),r.a.createElement("option",{value:"2"},"Optometrista"))))))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 text-right"},r.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},r.a.createElement(lt.b,{to:"/usuarios",className:"btn btn-dark",onClick:this.changePage,id:"/usuarios"},r.a.createElement("i",{className:"fas fa-ban mr-1"}),"Cancelar"),r.a.createElement("button",{type:"submit",className:a?"btn btn-primary disabled":"btn btn-primary",disabled:!!h},r.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar"))))))),t?r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-primary"},r.a.createElement("i",{className:"fas fa-database mr-2"}),"Metadata")),r.a.createElement("div",{className:"card-body"},d?r.a.createElement("ul",{className:"list-group"},r.a.createElement("li",{className:"list-group-item"},r.a.createElement("h6",null,"Datos del usuario"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("span",{className:"text-primary"},"Registrado"),r.a.createElement("p",null,it()(m).fromNow())),r.a.createElement("div",{className:"col"},r.a.createElement("span",{className:"text-primary"},"Ultima actualizacion"),r.a.createElement("p",null,it()(i).fromNow())))),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("h6",null,"Actividad"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("span",{className:"text-primary"},"IP"),r.a.createElement("p",null,d.ip_address)),r.a.createElement("div",{className:"col"},r.a.createElement("span",{className:"text-primary"},"Ultima actividad"),r.a.createElement("p",null,it()(d.last_activity).fromNow())))),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("span",{className:"text-primary"},"Navegador y OS"),r.a.createElement("p",null,d.user_agent)),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("span",{className:"text-primary"},"Token"),r.a.createElement("p",null,d.user_data))):r.a.createElement("p",null,"Usuario no ha registrado actividad.")))):null)}}]),t}(n.Component),jt=t(21),_t=function(e){var a=e.meta,t=e.handlePagination,n=e.color,o=function(e){t(e)};return r.a.createElement("div",{className:"btn-group"},r.a.createElement("ul",{className:"pagination pagination-sm m-0 mb-1"},r.a.createElement("li",{className:1===a.current_page?"page-item disabled":"page-item test-"},r.a.createElement("a",{className:1===a.current_page?"page-link text-secondary":"page-link text-"+n,href:"#pageBefore",onClick:function(e){e.preventDefault(),o(1)}},"Primero")),r.a.createElement("li",{className:1===a.current_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:1===a.current_page?"page-link text-secondary":"page-link text-"+n,href:"#pageBefore",onClick:function(e){e.preventDefault(),o(a.current_page-1)}},r.a.createElement("i",{className:"fas fa-caret-left"}))),r.a.createElement("li",{className:"page-item"},r.a.createElement("span",{className:"page-link text-dark"},a.current_page," /",Math.ceil(a.total/a.per_page).toFixed(0))),r.a.createElement("li",{className:a.current_page===a.last_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:a.current_page===a.last_page?"page-link text-secondary":"page-link text-"+n,href:"#pageBefore",onClick:function(e){e.preventDefault(),o(a.current_page+1)}},r.a.createElement("i",{className:"fas fa-caret-right"}))),r.a.createElement("li",{className:a.current_page===a.last_page?"page-item disabled":"page-item"},r.a.createElement("a",{className:a.current_page===a.last_page?"page-link text-secondary":"page-link text-"+n,href:"#pageBefore",onClick:function(e){e.preventDefault(),o(a.last_page)}},"Ultimo"))))},It=function(e){var a=Object(n.useState)(""),t=Object(jt.a)(a,2),o=t[0],l=t[1],c=Object(n.useState)(""),s=Object(jt.a)(c,2),i=s[0],m=s[1];return Object(n.useEffect)((function(){var a;i&&clearTimeout(i),a=setTimeout((function(){e.handleSearch(o)}),1e3),m(a)}),[o]),r.a.createElement("div",{className:"card card-"+e.color+" card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-"+e.color},r.a.createElement("i",{className:e.icon?"mr-1 fas fa-"+e.icon:"mr-1 fas fa-user"}),e.title),r.a.createElement("div",{className:"card-tools"},r.a.createElement("div",{className:"input-group input-group-sm position-relative"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Buscar",value:o,onChange:function(e){var a=e.target.value;l(a)},onKeyPress:function(e){"Enter"===e.key&&console.log("[DEBUG] press enter")}}),r.a.createElement("div",{className:"position-absolute",style:{top:5,left:-20,color:"#ced4da"}},r.a.createElement("i",{className:"fas fa-search"})),o.length>2?r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"btn btn-secondary",onClick:function(){l("")}},r.a.createElement("i",{className:"fas fa-window-close"}))):null))),r.a.createElement("div",{className:"p-0 card-body"},r.a.createElement("div",{className:"mailbox-controls"},r.a.createElement("div",{className:"btn-group"},e.handleDeleteItem?r.a.createElement("button",{type:"button",className:"btn btn-default btn-sm",title:"Eliminar",disabled:!e.itemSelected,onClick:function(a){return e.handleDeleteItem()}},r.a.createElement("i",{className:"fas fa-trash-alt"})):null,e.handleEditItem?r.a.createElement("button",{type:"button",className:"btn btn-default btn-sm",title:"Editar",disabled:!e.itemSelected,onClick:function(a){return e.handleEditItem()}},r.a.createElement("i",{className:"fas fa-edit"})):null,e.handleSync?r.a.createElement("button",{type:"button",className:"btn btn-default btn-sm",title:"Recargar",onClick:function(a){return e.handleSync()}},r.a.createElement("i",{className:"fas fa-sync-alt"})):null),r.a.createElement("div",{className:"float-right"},e.meta?r.a.createElement(_t,{meta:e.meta,color:e.color,handlePagination:e.handlePagination}):null)),r.a.createElement("div",{className:"table-responsive mailbox-messages"},e.children)),e.loading?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null)},At=function(e){var a;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"card-title"},r.a.createElement("i",{className:e.icon?"mr-2 fas fa-"+e.icon:"mr-2 fas fa-ellipsis-v"}),null!==(a=e.title)&&void 0!==a?a:"Menu")),r.a.createElement("div",{className:"card-body p-0"},r.a.createElement("ul",{className:"nav nav-pills flex-column"},e.children)))},Tt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleToPrice=function(){var e=n.state,a=e.price,t=e.catid_3,r=e.load;if(a&&t){console.log("Send data to API",a,t);var o=JSON.parse(localStorage.getItem("OrusSystem")),l="http://"+o.host+"/api/store/prices?cat="+t+"&price="+a;r||n.setState({load:!0}),fetch(l,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o.token}}).then((function(e){return e.json()})).then((function(e){console.log("[Orus System] Item actualizados",e),n.setState({load:!1})}))}},n.handelChangePrice=function(e){var a=e.target.value;n.setState({price:parseInt(a)})},n.getItems=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem")),t=n.state.load,r="http://"+a.host+"/api/store?cat="+e+"&itemsPage=500";t||n.setState({load:!0}),fetch(r,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){console.log("[Orus System] Descarga de producto exitosa"),n.setState({items:e.data&&e.data.length?e.data:[],load:!1})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))},n.handleClickCat=function(e){var a=e.target,t=a.name,r=a.value,o=n.state,l=o.catData_1,c=o.catData_2,s=[],i={};"catid_1"===t?(l.map((function(e){return e.id===parseInt(r)&&(s=e.hijos,i=e.meta,!0)})),n.setState({catid_1:parseInt(r),catid_2:0,catid_3:0,catData_2:s,catData_3:[],meta:i})):"catid_2"===t&&(c.map((function(e){return e.id===parseInt(r)&&(s=e.hijos,!0)})),n.setState({catid_2:parseInt(r),catid_3:0,catData_3:s}))},n.getCategories=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/categories/1";fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&e.data.hijos.length&&(console.log("Descarga de categoria exitos"),n.setState({catData_1:e.data.hijos}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},n.state={catData_1:[],catData_2:[],catData_3:[],catid_1:0,catid_2:0,catid_3:0,load:!1,items:[],meta:{},price:0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,a){a.catid_3!==this.state.catid_3&&this.getItems(this.state.catid_3)}},{key:"render",value:function(){var e=this,a=this.state,t=a.catid_1,n=a.catData_1,o=a.catid_2,l=a.catData_2,c=a.catid_3,s=a.catData_3,i=a.load,m=a.items,d=a.meta,u=a.price,p=[],h=[],g=0;do{p.push(r.a.createElement("th",{key:g},g.toFixed(2))),g-=.25}while(g>parseFloat(d.cil)-.25);g=parseFloat(d.rangoInf);do{0===g?h.push(r.a.createElement("td",null,r.a.createElement("label",null,"0.00"))):h.push(r.a.createElement("td",null,g.toFixed(2))),g+=.25}while(g<parseFloat(d.rangoSup)+.25);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select",name:"catid_1",value:t,onChange:this.handleClickCat},r.a.createElement("option",{value:"0"},"Seleccione un tipo"),n.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.categoria)})))),t&&l.length?r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select",name:"catid_2",value:o,onChange:this.handleClickCat},r.a.createElement("option",{value:"0"},"Seleccione un material"),l.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.categoria)})))):null,o&&s.length?r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Basic example"},s.map((function(a){return r.a.createElement("button",{key:a.id,className:c===a.id?"btn btn-primary":"btn btn-secondary",onClick:function(t){e.setState({catid_3:a.id,load:!0})}},a.categoria)})))):null)),r.a.createElement("div",{className:"card-body"},c?r.a.createElement(r.a.Fragment,null,i?r.a.createElement("div",{className:"text-center"},r.a.createElement("span",{className:"text-primary"},"Cargando productos"),r.a.createElement("div",{className:"spinner-border text-primary ml-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row mb-2"},r.a.createElement("div",{className:"col"},"Total de productos: ",r.a.createElement("label",null,m.length)),r.a.createElement("div",{className:"col-6"},r.a.createElement("div",{className:"row"},r.a.createElement("label",{className:"col-4 text-right"},"Precio"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{type:"number",className:"form-control",value:u,onChange:this.handelChangePrice})),r.a.createElement("div",{className:"col"},r.a.createElement("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.handleToPrice},"Cambiar"))))),r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-sm table-bordered table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"/"),p)),r.a.createElement("tbody",null,h.map((function(e,a){var t="label"===e.props.children.type;return r.a.createElement("tr",{className:t?"table-secondary":"",key:a},e,p.map((function(a,n){var o=t?parseFloat(e.props.children.props.children).toFixed(2).replace(".",""):parseFloat(e.props.children).toFixed(2).replace(".","");return parseInt(o)>=0&&(o="+"+o),o+=parseFloat(a.props.children).toFixed(2).replace(/[-.]/g,""),r.a.createElement("td",{key:n,className:"text-center"},m.length?m.map((function(e,a){return o===e.graduacion?r.a.createElement(r.a.Fragment,null,e.cantidades?r.a.createElement("span",{key:e.id+"-"+a,className:e.cantidades>0?"badge badge-success":"badge badge-danger"},r.a.createElement(lt.b,{to:"/almacen/registro/"+e.id,className:"text-light"},e.cantidades)):null):null})):r.a.createElement(lt.b,{to:"/almacen/registro"},r.a.createElement("i",{className:"fas fa-plus text-secondary"})))})))}))))))):r.a.createElement("div",{className:"alert alert-warning text-light",role:"alert"},r.a.createElement("h4",{className:"alert-heading"},r.a.createElement("i",{className:"fas fa-exclamation"})," Seleccion."),r.a.createElement("hr",null),r.a.createElement("ul",null,t?null:r.a.createElement("li",null,"Selecciones primero el tipo de lente"),o?null:r.a.createElement("li",null,"Despues el material"),r.a.createElement("li",null,"Por ultimo el tratamiento")))))))}}]),t}(n.Component),Dt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleSetSelectOptions=function(e){var a=e.target,t=a.name,r=a.value,o=n.state.options,l=r;"itemsPage"===t&&(l=parseInt(r)),console.log("[DEBUG] manejando filtros",t,r,l),n.setState({options:Object(s.a)(Object(s.a)({},o),{},Object(V.a)({},t,l)),load:!0})},n.handleSaveContact=function(e,a){(0,n.props._saveContact)({data:a,id:e,options:n.state.options}),n.handleCloseEdit()},n.handleCloseEdit=function(){n.props.history.push("/almacen"),n.setState({newOrEdit:!1,contact:{},contactSelected:""})},n.handleSync=function(){n.getContacts()},n.handleEditTemp=function(e){n.props.history.push("/almacen/registro/".concat(e))},n.handleEditItem=function(e){var a=n.state.storeSelected,t=n.props.list,r=null!==e&&void 0!==e?e:a,o=t.filter((function(e){return e.id===r}));o.length?(console.log("[Orus System] Editar producto",r),n.setState({item:o[0],newOrEdit:!0,storeSelected:r}),n.props.history.push("/almacen/registro/".concat(r))):(n.setState({newOrEdit:!1,item:{},storeSelected:"",load:!0}),n.props.history.push("/almacen"))},n.handleChangeCheckbox=function(e){var a=e.target,t=a.value;a.checked?n.setState({storeSelected:parseInt(t)}):n.setState({storeSelected:""})},n.handleSearch=function(e){var a=n.state.options;console.log("[DEBUG] handle search",e),n.setState({options:Object(s.a)(Object(s.a)({},a),{},{search:e}),load:!0})},n.handleChangePage=function(e){var a=n.state.options;n.setState({options:Object(s.a)(Object(s.a)({},a),{},{page:e}),load:!0})},n.handleDelete=function(){var e=n.state,a=e.storeSelected,t=e.options,r=n.props._deleteContact;if(!a)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un producto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el producto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",a),r({id:a,options:t})),n.setState({storeSelected:""})}))},n.state={load:!1,item:{},newOrEdit:!1,storeSelected:"",panel:"inbox",options:{page:1,orderby:"created_at",order:"desc",search:"",itemsPage:10}},n.timeInterval=0,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.id;this.setState({load:!0}),a&&(this.timeInterval=setInterval((function(){var t=e.props.list;t.length&&(clearInterval(e.timeInterval),t.every((function(t){return t.id!==parseInt(a)||(e.handleEditItem(t),!1)})))}),1e3))}},{key:"componentDidUpdate",value:function(e,a){var t=this.state.load,n=this.props.messages;a.load!==t&&!0===t&&(console.log("[Orus System] Recargando productos"),this.getContacts()),e.messages.length!==n.length&&n.length&&n.forEach((function(e){var a=e.type,t=e.text;window.Swal.fire({icon:a,title:t,showConfirmButton:"error"===a,timer:"error"!==a?1500:9e3})}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.list,n=a.loading,o=a.meta,l=this.state,c=l.newOrEdit,s=l.storeSelected,i=l.options,m=l.panel;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 col-md-2"},r.a.createElement("button",{className:"btn bg-primary btn-block mb-3",type:"button",disabled:c,onClick:function(a){a.preventDefault(),e.props.history.push("/almacen/registro")}},r.a.createElement("i",{className:"fas fa-plus mr-1"}),"Nuevo producto"),c?null:r.a.createElement(At,{title:"Menu y filtros"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"#item",className:"nav-link",onClick:function(a){a.preventDefault(),e.props.history.push("/almacen/categorias")}},"Categorias")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"#item",className:"nav-link",onClick:function(a){a.preventDefault(),e.props.history.push("/almacen/marcas")}},"Marcas")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"#item",className:"nav-link",onClick:function(a){a.preventDefault(),e.setState({panel:"inventory"})}},"Inventario")),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"orderby"},"Ordenar por"),r.a.createElement("select",{className:"form-control ",name:"orderby",id:"orderby",value:i.orderby,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"created_at"},"Fecha de registro"),r.a.createElement("option",{value:"updated_at"},"Fecha de modificacion"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"order"},"Mostrar por"),r.a.createElement("select",{className:"form-control ",name:"order",id:"order",value:i.order,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"asc"},"Antiguos"),r.a.createElement("option",{value:"desc"},"Recientes"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"itemsPage"},"Numero de productos"),r.a.createElement("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:i.itemsPage,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"10"},"ver 10"),r.a.createElement("option",{value:"20"},"ver 20"),r.a.createElement("option",{value:"50"},"ver 50"),r.a.createElement("option",{value:"100"},"ver 100"))))),r.a.createElement("div",{className:"col-sm-12 col-md-10"},"inventory"===m?r.a.createElement(Tt,null):r.a.createElement(It,{title:"Lista de productos",icon:"id-badge",color:"primary",loading:n,meta:o,itemSelected:s,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync},r.a.createElement("table",{className:"table table-hover table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Codigo"),r.a.createElement("th",null,"Describci\xf3n"),r.a.createElement("th",null,"Marca"),r.a.createElement("th",null,"Proveedor"),r.a.createElement("th",null,"Cant"))),r.a.createElement("tbody",null,t.length?r.a.createElement(r.a.Fragment,null,t.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",{className:"icheck-primary pl-2"},r.a.createElement("input",{type:"checkbox",className:"form-check-input mt-4",value:a.id,id:"contact_"+a.id,checked:s===a.id,onChange:e.handleChangeCheckbox}),r.a.createElement("label",{htmlFor:"contact_"+a.id,className:"sr-only"})),r.a.createElement("td",{className:"icheck-primary"},r.a.createElement("div",{className:"badge badge-primary text-uppercase"},a.codigo)),r.a.createElement("td",{className:"mailbox-name text-capitalize text-truncate",onClick:function(t){return e.handleEditTemp(a.id)}},r.a.createElement("label",{style:{cursor:"pointer"}},a.producto)),r.a.createElement("td",{className:"mailbox-attachment text-uppercase text-truncate text-muted"},r.a.createElement("span",null,a.marca?a.marca.marca:"--")),r.a.createElement("td",{className:"mailbox-attachment text-capitalize text-truncate text-muted"},r.a.createElement("span",null,a.proveedor?a.proveedor.nombre:"--")),r.a.createElement("td",{className:"mailbox-date text-muted text-truncate text-right"},r.a.createElement("span",null,a.cantidades)))}))):r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center text-muted",colSpan:"6"},"No hay productos registrados")))))))}},{key:"getContacts",value:function(){(0,this.props._getListContact)({options:this.state.options}),this.setState({load:!1})}}]),t}(n.Component),Lt={_getListContact:Ce.getListStore},Ft=Object(at.b)((function(e){var a=e.storeItem;return{list:a.list,messages:a.messages,meta:a.metaList,loading:a.loading}}),Lt)(Dt),Pt=t(24),Bt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleDelete=function(e,a,t){e.preventDefault(),window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el lote "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t&&a){var r=e.target.parentNode.parentNode.parentNode;r.classList.add("bg-danger");var o=JSON.parse(localStorage.getItem("OrusSystem")),l=setInterval((function(){clearInterval(l),r.classList.remove("bg-danger")}),6500);return console.log("Solicitud de eliminaci\xf3n de lote por API"),fetch("http://"+o.host+"/api/items/"+a,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Producto eliminado"),n.setState({load:!0,loteNew:!1}),window.Swal.fire("Lote eliminado con exito","","success").then((function(e){n.handelGetLots(n.state.page),n.props.refresh()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.state={id:0,bill:"",cost:0,price:n.props.price,amount:0,lote:{data:[],meta:{}},loteNew:!1,load:!0,page:1},n.handleNewLote=n.handleNewLote.bind(Object(Pt.a)(n)),n.handleSave=n.handleSave.bind(Object(Pt.a)(n)),n.catchInputs=n.catchInputs.bind(Object(Pt.a)(n)),n.handelGetLots=n.handelGetLots.bind(Object(Pt.a)(n)),n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.handelGetLots(this.state.page)}},{key:"render",value:function(){var e=this,a=this.state,t=a.lote,n=a.load,o=[];if(this.state.lote.meta.total>10)for(var l=1;l<=this.state.lote.meta.last_page;l++)o.push(r.a.createElement("li",{key:l,className:this.state.lote.meta.current_page===l?"page-item disabled":"page-item"},r.a.createElement("a",{href:"#e",id:l,className:"page-link",onClick:this.handleChangePage.bind(this)},l)));return r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-primary"},r.a.createElement("i",{className:"fas fa-list"}),"Listado de lotes"),r.a.createElement("div",{className:"card-tools"},this.state.lote.meta.total>10?r.a.createElement("div",{className:"btn-group"},r.a.createElement("ul",{className:"pagination pagination-sm"},o)):"")),r.a.createElement("div",{className:"card-body table-responsive p-0"},r.a.createElement("table",{className:"table table-hover table-nowrap"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Registrado"),r.a.createElement("th",{style:{width:140}},"Factura"),r.a.createElement("th",{className:"text-right",style:{width:90}},"Unidades"),r.a.createElement("th",{className:"text-right",style:{width:110}},"Costo"),r.a.createElement("th",{className:"text-right",style:{width:110}},"Precio"),r.a.createElement("th",null,"Acciones"))),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"6",className:"text-center"},r.a.createElement("span",{className:"text-primary mr-4"},"Cargando lotes"),r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",null,a.created_at),r.a.createElement("td",{className:"text-uppercase"},a.factura?a.factura:"XXXX"),r.a.createElement("td",{className:"text-right"},a.cantidades),r.a.createElement("td",{className:"text-right"},"$ ",a.costo?a.costo:0),r.a.createElement("td",{className:"text-right"},"$ ",a.precio?a.precio:0),r.a.createElement("td",{className:"text-right"},r.a.createElement("a",{className:"btn-flat text-dark",href:"#delete",onClick:function(t){e.handleDelete(t,a.id,a.factura)}},r.a.createElement("i",{className:"fas fa-trash"}))))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"6",className:"text-center"},"No hay datos para mostrar")),this.state.loteNew?r.a.createElement("tr",null,r.a.createElement("th",null,"Nuevo"),r.a.createElement("td",null,r.a.createElement("input",{className:"form-control text-uppercase",type:"text",name:"bill",value:this.state.bill,onChange:this.catchInputs})),r.a.createElement("td",null,r.a.createElement("input",{className:"form-control text-right",type:"number",name:"amount",min:"1",value:this.state.amount,onChange:this.catchInputs})),r.a.createElement("td",null,r.a.createElement("input",{className:"form-control text-right",type:"number",name:"cost",value:this.state.cost,onChange:this.catchInputs})),r.a.createElement("td",null,r.a.createElement("input",{className:"form-control text-right",type:"number",name:"price",value:this.state.price,onChange:this.catchInputs})),r.a.createElement("td",{className:"text-right"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-outline-primary btn-sm",onClick:this.handleSave},r.a.createElement("i",{className:"fas fa-save"})),r.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:this.handleNewLote},r.a.createElement("i",{className:"fas fa-undo"}))))):r.a.createElement("tr",null)))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group float-right",role:"group"},r.a.createElement("button",{className:"btn btn-primary",onClick:this.handleNewLote},"Nuevo lote"))))))}},{key:"handleChangePage",value:function(e){e.preventDefault(),this.setState({page:e.target.id}),this.handelGetLots(e.target.id)}},{key:"handleNewLote",value:function(){this.setState({loteNew:!this.state.loteNew})}},{key:"catchInputs",value:function(e){var a=e.target,t=a.name,n=a.value;this.setState(Object(V.a)({},t,n.toLowerCase()))}},{key:"validInputs",value:function(){var e=this.state,a=e.bill,t=e.price,n=e.amount;return a.length||(a="XXXX"),t||(t=1e3),!!n||(window.alert("La cantidad de articulos no puede ser cero"),!1)}},{key:"handleSave",value:function(e){var a=this;if(e.preventDefault(),!this.validInputs())return!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de almacenar un nuevo lote?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=JSON.parse(localStorage.getItem("OrusSystem")),n=a.state,r=n.id,o={bill:n.bill,cost:n.cost,price:n.price,amount:n.amount,store_items_id:r};return console.log("Enviando datos del producto a API"),fetch("http://"+t.host+"/api/items",{method:"POST",body:JSON.stringify(o),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("Lote almacenada"),a.setState({load:!0,loteNew:!1}),window.Swal.fire("Lote guardado con exito","","success").then((function(e){a.handelGetLots(a.state.page),a.props.refresh()}))):(window.Swal.fire("Error","al almacenar el lote","error"),console.error("Orus res: ",t.message))}}))}},{key:"handelGetLots",value:function(e){var a=this,t=JSON.parse(localStorage.getItem("OrusSystem")),n=this.props.id,r="http://"+t.host+"/api/items?store_items_id="+n;fetch(r+"&page="+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){console.log("Descargando lotes"),a.setState({id:n,lote:e,load:!1})})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),a.setState({load:!1})}))}}]),t}(n.Component),zt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).handleChangeCategory=function(a){var t=a.target.value,n=e.props,r=n.categoryData,o=n.handleChangeCategory,l=parseInt(t),c=r.find((function(e){return e.id===l}));l||(c={id:0}),o(c)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.categoryData,t=e.categoryName,n=e.category,o=e.textSelect,l=e.categoryRef;return r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:n?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-sort-amount-down"}))),r.a.createElement("select",{className:"custom-select text-uppercase",name:t,value:n,onChange:this.handleChangeCategory,ref:l},r.a.createElement("option",{value:"0"},o),a.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.categoria?e.categoria:e.name)}))))}}]),t}(n.Component),Ut=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).getSuppliers=function(){var e=n.state,a=e.host,t=e.token;console.log("solicitando proveedores al API"),fetch("http://"+a+"/api/contacts?type=1",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){null!==e.data?(console.log("Cargando proveedores"),n.setState({suppliers_data:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar los proveedores","error"))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={suppliers_data:[],text:"",load:!1,host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.setState({suppliers_data:[]}),this.getSuppliers()}},{key:"render",value:function(){var e=this.state.suppliers_data,a=this.props,t=a.supplier,n=a.handleChangeSupplier,o=a.supplierRef;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("small",null,r.a.createElement("label",null,"Proveedor")),e.length?r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:t?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-address-book"}))),r.a.createElement("select",{className:"custom-select text-uppercase",name:"supplier",value:t,ref:o,onChange:function(e){var a=e.target.value;n(parseInt(a))}},r.a.createElement("option",{value:"0"},"Seleccione un Proveedor"),e.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.nombre)})))):r.a.createElement("div",{className:"text-left"},r.a.createElement("span",{className:"text-dark"},"Descargando proveedores"),r.a.createElement("div",{className:"spinner-border text-primary ml-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))))}}]),t}(n.Component),Mt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeCategory=function(e){var a=e.target.value;(0,n.props.handleChangeBrand)(parseInt(a))},n.getBrands=function(){var e=n.state,a=e.host,t=e.token,r=n.props.supplier;console.log("solicitando marcas al API"),fetch("http://"+a+"/api/brands?supplier="+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){null!==e.data?(console.log("descargando marcas"),n.setState({brands:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las marcas","error"))})).catch((function(e){console.error("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={brands:[],host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getBrands()}},{key:"componentDidUpdate",value:function(e,a){e.supplier!==this.props.supplier&&(this.setState({brands:[]}),this.getBrands())}},{key:"render",value:function(){var e=this.props,a=e.brandsName,t=e.brand,n=e.textSelect,o=e.brandRef,l=this.state.brands;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("small",null,r.a.createElement("label",null,"Marca")),l.length?r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:t?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-copyright"}))),r.a.createElement("select",{className:"custom-select text-uppercase",name:a,value:t,ref:o,onChange:this.handleChangeCategory},r.a.createElement("option",{value:"0"},n),l.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.nombre)})))):r.a.createElement("div",{className:"text-left"},r.a.createElement("span",{className:"text-dark"},"Descargando marcas"),r.a.createElement("div",{className:"spinner-border text-primary ml-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))))}}]),t}(n.Component);function Rt(e){switch(e){case"monofocales":return"MF";case"bifocales":return"BF";case"progresivo basico":case"progresivo-basico":return"PB";case"progresivo digital":case"progresivo-digital":return"PD";case"plastico":return"CR";case"policarbonato":return"PL";case"hi-index":case"hi index":return"HI";case"antirreflejantes":return"AR";case"photo":return"PH";case"ar & photo":case"antirreflejante-photo":return"ARPH";case"blanco":return"BL";case"polarizado":return"PO";case"bifocal invisible":case"bifocal-invisible":return"BI";case"monofocal drivesafe":case"monofocal-drivesafe":case"monofocal digital drivesafe":case"monofocal digital DriveSafe":return"MDSF";case"monofocal superb":case"monofocal-superb":case"monofocal digital superb":return"MDSU";case"monofocal individual":case"monofocal-individual":case"monofocal digital individual":return"MDIN";default:return"XX"}}var Gt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleNameLent=function(e){var a="";return a+=null!==n.category2.current?n.category2.current.options[n.category2.current.selectedIndex].text.trim():"",a+=null!==n.category3.current?" "+n.category3.current.options[n.category3.current.selectedIndex].text.trim():"",a+=null!==n.category4.current?" "+n.category4.current.options[n.category4.current.selectedIndex].text.trim():"",(a+=" "+e.toString()).toLowerCase()},n.handleCodeLent=function(e){var a=null!==n.category2.current?Rt(n.category2.current.options[n.category2.current.selectedIndex].text):"";return a+=null!==n.category3.current?Rt(n.category3.current.options[n.category3.current.selectedIndex].text):"",(a+=null!==n.category4.current?Rt(n.category4.current.options[n.category4.current.selectedIndex].text):"")+e.toString()},n.handleCodeString=function(e){var a="armazon";return a+=null!==n.category2.current?" "+n.category2.current.options[n.category2.current.selectedIndex].text.trim():"",a+=null!==n.brandRef.current?" "+n.brandRef.current.options[n.brandRef.current.selectedIndex].text.trim().replace(" ",""):"",(a+=" "+e.toString()).toLowerCase()},n.setNew=function(e){n.setState({id:0,code:"",codebar:"",grad:"",brand_id:0,name:"",unit:"PZ",cant:1,price:1,supplier:0,brand:0,category_id:0,category_id1:0,category_id2:0,category_id3:0,category_id4:0,category_list2:[],category_list3:[],category_list4:[],load:!1})},n.changePage=function(e){n.props.page(e)},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.type,o=e.target.value;"text"===r&&(o=o.toLowerCase()),"number"===r&&(o=parseInt(o)),n.setState(Object(V.a)({},t,o))},n.getCategory=function(){var e=n.state,a=e.host,t=e.token;console.log("solicitando categorias al API"),fetch("http://"+a+"/api/categories?categoryid=raiz",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){null!==e.data?(console.log("Almacenando categorias"),n.setState({category_list1:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las categorias","error"))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},n.handleSave=function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t,r,o,l,c,s,i,m,d;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t=n.state,r=t.id,o=t.category_id,l=t.category_id1,c=t.category_id2,s=t.category_id4,i=t.supplier,m=t.brand_id,d=t.code,o){e.next=7;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria primero","warning"),e.abrupt("return",!1);case 7:if(1!==l||s===o){e.next=12;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para lentes","warning"),e.abrupt("return",!1);case 12:if(2!==l||c===o){e.next=15;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para armazones","warning"),e.abrupt("return",!1);case 15:if(2!==l||i){e.next=18;break}return window.Swal.fire("Verificaci\xf3n","Selecione un PROVEEDOR valido primero","warning"),e.abrupt("return",!1);case 18:if(2!==l||m){e.next=21;break}return window.Swal.fire("Verificaci\xf3n","Selecione una MARCA valida primero","warning"),e.abrupt("return",!1);case 21:if(d||n.codeRef.current.value){e.next=24;break}return window.Swal.fire("Verificaci\xf3n","Escriba una CODIGO para este producto","warning"),e.abrupt("return",!1);case 24:window.Swal.fire({title:"Almacenamiento",text:r?"\xbfEsta seguro de actualizar el producto?":"\xbfEsta seguro de crear un nuevo producto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:r?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.id,r=a.code,o=a.codebar,l=a.brand_id,c=a.name,s=a.unit,i=a.cant,m=a.price,d=a.category_id,u=a.token,p=a.host,h=a.supplier,g=a.grad,f=t?"http://"+p+"/api/store/"+t:"http://"+p+"/api/store",E=t?"PUT":"POST",v={code:r||n.codeRef.current.value,codebar:o,name:c||n.nameRef.current.value,unit:s,cant:i,price:m,category_id:d,grad:g||"+000000",brand_id:l||"",contact_id:h||""};return console.log("Enviando datos del producto a API"),fetch(f,{method:E,body:JSON.stringify(v),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+u}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:return a.ok||(console.error("Orus res: ",t.message,t.errors),t.errors&&t.errors.code?window.Swal.fire("Validacion","El CODIGO ya esta registrado","warning"):t.errors&&t.errors.name?window.Swal.fire("Validacion","El nombre del PRODUCTO ya esta registrado","warning"):window.Swal.fire("Error","al almacenar el producto","error")),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data&&(console.log("Producto almacenado",a.data),window.Swal.fire({icon:"success",title:r?"Producto actualizado con exito":"Producto almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){r?n.props.history.push("/almacen"):(n.setState({id:a.data.id}),n.props.history.push("/almacen/registro/".concat(a.data.id)))})))}}));case 25:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),n.getItem=function(e){if(e>0){var a=n.state,t=a.host,r=a.token;console.log("Solicitando datos de producto a la API"),fetch("http://"+t+"/api/store/"+e,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t,r,o,l,c,s,i;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.data?(t=0,r=[],o=[],l=[],c=0,s=0,i=0,a.data.categoria&&a.data.categoria.depende_de?a.data.categoria.depende_de&&a.data.categoria.depende_de.depende_de?a.data.categoria.depende_de.depende_de&&a.data.categoria.depende_de.depende_de.depende_de?(t=a.data.categoria.depende_de.depende_de.depende_de.id,c=a.data.categoria.depende_de.depende_de.id,s=a.data.categoria.depende_de.id,i=a.data.categoria.id,r=a.data.categoria.depende_de.depende_de.depende_de.hijos,o=a.data.categoria.depende_de.depende_de.hijos,l=a.data.categoria.depende_de.hijos):(t=a.data.categoria.depende_de.depende_de.id,c=a.data.categoria.depende_de.id,s=a.data.categoria.id,r=a.data.categoria.depende_de.depende_de.hijos,o=a.data.categoria.depende_de.hijos):(t=a.data.categoria.depende_de.id,c=a.data.categoria.id,r=a.data.categoria.depende_de.hijos):(t=a.data.categoria.id,r=a.data.categoria.hijos),n.setState({id:a.data.id,code:a.data.codigo,codebar:a.data.c_barra,brand_id:a.data.marca?a.data.marca.id:0,grad:a.data.graduacion?a.data.graduacion:"",name:a.data.producto,unit:a.data.unidad,cant:a.data.cantidades,price:a.data.precio,category_id:a.data.categoria.id,category_id1:t,category_list2:r,category_list3:o,category_list4:l,category_id2:c,category_id3:s,category_id4:i,category_data:a.data.categoria,supplier:a.data.proveedor?a.data.proveedor.id:0,load:!1})):(console.error("[Store] add - ",a.message),window.Swal.fire("Error","Error en el sistema, comuniquese con el administrador de sistema","error"),n.setState({load:!1}));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))}else n.setState({load:!1})};var o=n.props.match.params.id,l=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={id:o||0,code:"",codebar:"",grad:"",brand_id:0,name:"",unit:"PZ",cant:1,price:1,supplier:0,category_id:0,category_data:{},category_id1:0,category_id2:0,category_id3:0,category_id4:0,category_list1:[],category_list2:[],category_list3:[],category_list4:[],load:!1,host:l.host,token:l.token},n.controller=new AbortController,n.signal=n.controller.signal,n.category1=r.a.createRef(),n.category2=r.a.createRef(),n.category3=r.a.createRef(),n.category4=r.a.createRef(),n.supplierRef=r.a.createRef(),n.brandRef=r.a.createRef(),n.codeRef=r.a.createRef(),n.nameRef=r.a.createRef(),n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.state.id;this.getItem(e),this.getCategory()}},{key:"componentDidUpdate",value:function(e,a){var t=this.state,n=t.category_list1,r=t.category_id,o=t.category_id1,l=t.category_id2,c=t.category_id3;if(a.category_id!==r){if(a.category_id1!==o&&0!==o){var s=n.find((function(e){return e.id===o}));s&&this.setState({category_list2:s.hijos})}if(a.category_id2!==l&&0!==l){var i=n.find((function(e){return e.id===l}));i&&this.setState({category_list3:i.hijos})}if(a.category_id3!==c&&0!==c){var m=n.find((function(e){return e.id===c}));m&&this.setState({category_list4:m.hijos})}}}},{key:"render",value:function(){var e=this,a=this.state,t=a.id,n=a.load,o=a.supplier,l=a.category_id,c=a.category_id1,s=a.category_id2,i=a.category_id3,m=a.category_id4,d=a.category_list1,u=a.category_list2,p=a.category_list3,h=a.category_list4,g=a.brand_id,f=a.code,E=a.name,v=a.grad,b=a.unit,N=a.cant,y=a.price,x=f,w=E;return null!==this.category1.current&&2===parseInt(this.category1.current.value)?E.length<=3&&(w=this.handleCodeString(x)):null!==this.category1.current&&1===parseInt(this.category1.current.value)&&(f.length<=3&&(x=this.handleCodeLent(v)),E.length<=3&&(w=this.handleNameLent(v))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:t?"col-5":"col-6"},r.a.createElement("form",{className:"card card-primary card-outline",onSubmit:this.handleSave},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-primary"},r.a.createElement("i",{className:"fas fa-database mr-1"}),t?"Editar producto":"Registrar nuevo producto")),r.a.createElement("div",{className:"card-body"},d&&d.length&&!n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("fieldset",null,r.a.createElement("small",{className:"mr-2"},r.a.createElement("label",null,"Categoria")),r.a.createElement(zt,{data:this.props.data,category:c,categoryName:"category_id1",categoryData:d,textSelect:"Seleciona la categoria",categoryRef:this.category1,handleChangeCategory:function(a){e.setState({category_id:a.id,category_id1:a.id,category_id2:0,category_list2:a.hijos,category_id3:0,category_list3:[],category_id4:0,category_list4:[],supplier:0})}}),c&&u&&u.length?r.a.createElement(zt,{data:this.props.data,category:s,categoryName:"category_id2",categoryData:u,textSelect:"Seleciona el tipo",categoryRef:this.category2,handleChangeCategory:function(a){e.setState({category_id:a.id,category_id2:a.id,category_id3:0,category_list3:a.hijos,category_id4:0,category_list4:[]})}}):null,s&&p&&p.length?r.a.createElement(zt,{data:this.props.data,category:i,categoryName:"category_id3",categoryData:p,textSelect:"Seleciona el material",categoryRef:this.category3,handleChangeCategory:function(a){e.setState({category_id:a.id,category_id3:a.id,category_id4:0,category_list4:a.hijos})}}):null,i&&h&&h.length?r.a.createElement(zt,{data:this.props.data,category:m,categoryName:"category_id4",categoryData:h,textSelect:"Seleciona el tratamiento",categoryRef:this.category4,handleChangeCategory:function(a){e.setState({category_id:a.id,category_id4:a.id})}}):null))),c&&1!==c?r.a.createElement(Ut,{data:this.props.data,supplier:o,textSelect:"Selecione el proveedor",supplierRef:this.supplierRef,handleChangeSupplier:function(a){e.setState({supplier:a})}}):null,c&&1!==c&&o?r.a.createElement(Mt,{data:this.props.data,brand:g,supplier:o,textSelect:"Selecione la marca",brandRef:this.brandRef,handleChangeBrand:function(a){e.setState({brand_id:a})}}):null,l?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-5"},x?r.a.createElement("small",null,r.a.createElement("label",null,"Codigo")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:x?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-code"}))),r.a.createElement("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo",name:"code",ref:this.codeRef,value:x,onChange:this.catchInputs,autoComplete:"off"}))),r.a.createElement("div",{className:"col"},r.a.createElement("small",null,r.a.createElement("label",null,"Codigo de barras")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text bg-primary"},r.a.createElement("i",{className:"fas fa-barcode"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Codigo de barras",name:"codebar",value:this.state.codebar,onChange:this.catchInputs,autoComplete:"off"})))),r.a.createElement("div",{className:"row"},1===c?r.a.createElement("div",{className:"col-3"},r.a.createElement("small",null,r.a.createElement("label",null,"Graduacion")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:v?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-glasses"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"+100100",name:"grad",value:v,onChange:this.catchInputs,autoComplete:"off"}))):null,r.a.createElement("div",{className:"col"},w?r.a.createElement("small",null,r.a.createElement("label",null,"Nombre del producto")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:w?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-archive"}))),r.a.createElement("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre del producto",name:"name",ref:this.nameRef,value:w,onChange:this.catchInputs,autoComplete:"off"})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},this.state.unit?r.a.createElement("small",null,r.a.createElement("label",null,"Unidad de presentacion")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:b?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-balance-scale"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Unidad de presentaci\xf3n",name:"unit",value:b,onChange:this.catchInputs}))),r.a.createElement("div",{className:"col"},r.a.createElement("small",null,r.a.createElement("label",null,"Cantidad en existencia")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:N?"input-group-text bg-primary":"input-group-text"},r.a.createElement("i",{className:"fas fa-database"}))),r.a.createElement("input",{type:"number",className:"form-control text-right",placeholder:"Cantidades en existencia",name:"cant",value:N,onChange:this.catchInputs}))),r.a.createElement("div",{className:"col"},r.a.createElement("small",null,r.a.createElement("label",null,"Precio")),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:y?"input-group-text bg-primary":"input-group-text bg-warning"},r.a.createElement("i",{className:"fas fa-money-bill"}))),r.a.createElement("input",{type:"number",className:"form-control text-right",placeholder:"Precio",name:"price",value:y,onChange:this.catchInputs}))))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("h6",{className:"text-warning"},"Seleccione primero una categor\xeda.")))):r.a.createElement("div",{className:"text-center"},r.a.createElement("span",{className:"text-primary"},"Cargando formulario"),r.a.createElement("div",{className:"spinner-border text-primary ml-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement(lt.b,{to:"/almacen/registro",className:"btn btn-dark",onClick:this.setNew},r.a.createElement("i",{className:"fas fa-plus mr-1"}),"Nuevo"),r.a.createElement(lt.b,{to:"/almacen",className:"btn btn-dark",onClick:function(a){e.changePage("/almacen")}},r.a.createElement("i",{className:t?"fas fa-ban mr-1":"fas fa-undo mr-1"}),t?"Cerrar":"Cancelar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},r.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar"))))))),t?r.a.createElement("div",{className:"col"},r.a.createElement(Bt,{id:t,price:this.state.price,refresh:this.getItem})):null)}}]),t}(n.Component),Jt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleChangePage=function(e){n.setState({page:e})},n.handleClickDelete=function(e,a){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la categoria "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a&&e){var t=n.state,r=t.host,o=t.token;return console.log("Solicitud de eliminaci\xf3n de categoria por API"),fetch("http://"+r+"/api/categories/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(a){a&&!a.dismiss&&a.value?(console.log("Categoria eliminado"),window.Swal.fire({icon:"success",title:"Categoria eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(a){var t=n.props.category,r=n.state.category_raiz,o=0;r.length&&(r.filter((function(a,t){return a.id===e&&(o=t),!1})),r.splice(o,1),n.setState({category_raiz:r,category_id:t}))}))):a&&!a.dismiss&&(console.log("Orus res: ",a),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.handleClickSave=function(){if(n.state.name.length<4)return window.Swal.fire("Verificaci\xf3n","Debe de escribir el nombre de la categoria","warning"),n.nameInput.focus(),!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva categoria?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o=a.category_id,l=a.name,c=n.props.category,s={name:l,category_id:parseInt(o)?parseInt(o):parseInt(c)?parseInt(c):""};return console.log("Enviando datos a API para almacenar"),fetch("http://"+t+"/api/categories",{method:"POST",body:JSON.stringify(s),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value,t=n.state,r=t.category_raiz,o=t.category_id,l=n.props.category;a.data?(console.log("Categoria almacenada"),window.Swal.fire({icon:"success",title:"Categoria almacenada con exito",showConfirmButton:!1,timer:1500}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(t){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(l)!==o){e.next=4;break}r.push(a.data),e.next=6;break;case 4:return e.next=6,r.find((function(e){return e.id===o&&(e.hijos.push(a.data),e)}));case 6:n.setState({category_raiz:r,name:"",add:!n.state.add,category_id:a.data.id});case 7:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())):(window.Swal.fire("Error","al almacenar la categoria","error"),console.error("Orus res: ",a.message))}}))},n.getCategoriesMain=function(){var e=n.props,a=e.category,t=e.CategoryData;if(void 0!==t&&t.length)n.setState({category_raiz:t||[],category_id:a,load:!1});else{var r=n.state,o=r.host,l=r.token,c=r.page,s=r.load,i="http://"+o+"/api/categories",m=a?"&categoryid="+a:"&categoryid=raiz",d=c>0?"?page="+c:"?page=1";s||n.setState({load:!0}),fetch(i+d+m,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){n.setState({category_raiz:null!==e.data?e.data:[],category_id:a,load:!1})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}},n.handleClickAdd=function(){n.setState({add:!n.state.add,name:""})},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value;n.setState(Object(V.a)({},t,r.toLowerCase()))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={meta:{},add:!1,name:"",category_raiz:[],category_id:e.category,page:1,host:r.host,token:r.token,load:!0},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getCategoriesMain()}},{key:"componentDidUpdate",value:function(e,a){var t=this.props.category;e.category!==t&&this.getCategoriesMain()}},{key:"render",value:function(){var e=this,a=this.state,t=a.category_raiz,n=a.category_id,o=a.name,l=a.add,c=a.meta,s=a.load,i=this.props,m=i.categoryName,d=i.categoryDataName,u=i.categorySelect,p=i.category,h=i.last;return r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Nombre"),r.a.createElement("th",{style:{width:16},className:"text-center"},"E"))),r.a.createElement("tbody",null,!s&&t?r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{className:n===p?"table-success":"",onClick:function(a){var t;e.setState({category_id:parseInt(p)?p:0}),u((t={},Object(V.a)(t,m,0),Object(V.a)(t,d,[]),Object(V.a)(t,"category_id",p),t))}},r.a.createElement("td",{colSpan:"2",className:"text-capitalize",style:{cursor:"pointer"}},"Raiz")),t.map((function(a){return r.a.createElement("tr",{key:a.id,className:a.id===n?"table-success":"",style:{cursor:"pointer"},onClick:function(t){var n,r;h?(e.setState({category_id:parseInt(p)?p:0}),u((n={},Object(V.a)(n,m,0),Object(V.a)(n,d,[]),Object(V.a)(n,"category_id",p),n))):(u((r={},Object(V.a)(r,m,a.id),Object(V.a)(r,d,a.hijos),Object(V.a)(r,"category_id",a.id),r)),e.setState({category_id:a.id}))}},r.a.createElement("td",{className:"text-capitalize"},r.a.createElement("a",{href:"#select!"+a.id,onClick:function(t){t.preventDefault(),e.setState({category_id:a.id})}},a.categoria)),r.a.createElement("td",null,a.hijos.length?null:r.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:function(t){e.handleClickDelete(a.id,a.categoria)}},r.a.createElement("i",{className:"fas fa-trash"}))))}))):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"8",className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))),l&&!s?r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",className:"form-control text-capitalize",autoComplete:"off",value:o,onChange:this.catchInputs,ref:function(a){e.nameInput=a}})),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-dark btn-sm",onClick:this.handleClickSave},r.a.createElement("i",{className:"fas fa-save"}))))):r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement(yt,{meta:c,handleChangePage:this.handleChangePage})))))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.handleClickAdd},this.state.add?r.a.createElement("i",{className:"fas fa-undo"}):r.a.createElement("i",{className:"fas fa-plus"}))))}}]),t}(n.Component),Vt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeState=function(e){void 0!==e.category_id1&&e.category_id1?(e.category_id2=0,e.category_id3=0,e.category_id4=0):void 0!==e.category_id2&&e.category_id2?(e.category_id3=0,e.category_id4=0):void 0!==e.category_id3&&e.category_id3&&(e.category_id4=0),n.setState(e)},n.state={category_id:0,category_id1:0,category_hijos1:[],category_id2:0,category_hijos2:[],category_id3:0,category_hijos3:[],category_id4:0,category_hijos4:[]},n}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.state,a=e.category_id1,t=e.category_hijos1,n=e.category_id2,o=e.category_hijos2,l=e.category_id3,c=e.category_hijos3;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,"Categorias de productos"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(Jt,{data:this.props.data,category:0,categoryName:"category_id1",categoryDataName:"category_hijos1",categorySelect:this.handleChangeState})),a&&t.length?r.a.createElement("div",{className:"col"},r.a.createElement(Jt,{data:this.props.data,category:a,CategoryData:t,categoryName:"category_id2",categoryDataName:"category_hijos2",categorySelect:this.handleChangeState,last:2===a})):null,n&&o.length?r.a.createElement("div",{className:"col"},r.a.createElement(Jt,{data:this.props.data,category:n,CategoryData:o,categoryName:"category_id3",categoryDataName:"category_hijos3",categorySelect:this.handleChangeState})):null,l&&c.length?r.a.createElement("div",{className:"col"},r.a.createElement(Jt,{data:this.props.data,category:l,CategoryData:c,categoryName:"category_id4",categoryDataName:"category_hijos4",categorySelect:this.handleChangeState,last:!0})):null))}}]),t}(n.Component),qt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).deleteBrand=function(e,a){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el producto "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a){var t=n.state,r=t.host,o=t.token;return console.log("Solicitud de eliminaci\xf3n de marca por API"),fetch("http://"+r+"/api/brands/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(a){a&&!a.dismiss&&a.value?(console.log("Marca eliminada"),window.Swal.fire({icon:"success",title:"Marca eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(a){var t=n.state.brands,r=0;t.length&&(t.filter((function(a,t){return a.id===e&&(r=t),!1})),t.splice(r,1),n.setState({brands:t}))}))):a&&!a.dismiss&&(console.log("Orus res: ",a),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.saveBrand=function(e){e.preventDefault();var a=n.state,t=a.name,r=a.supplier;return t.length<3?(window.Swal.fire("Error","El nombre de la marca debe de tener por lo menos 3 caracteres","error"),!1):r?void window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva marca?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.name,r=a.supplier,o=a.token,l=a.host,c={name:t,contact_id:r};return console.log("Enviando datos de la marca a API"),fetch("http://"+l+"/api/brands",{method:"POST",body:JSON.stringify(c),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Marca almacenada"),window.Swal.fire({icon:"success",title:"Marca almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){var t=n.state.brands;t.push(a.data),n.setState({brands:t,name:""})}))):(window.Swal.fire("Error","al almacenar la marca","error"),console.error("Orus res: ",a.message))}})):(window.Swal.fire("Error","Debe de elegir a un proveedor primero","error"),!1)},n.changeInput=function(e){var a=e.target,t=a.name,r=a.value;n.setState(Object(V.a)({},t,r))},n.getBrands=function(){var e=n.state,a=e.supplier,t=e.host,r=e.token;console.log("solicitando marcas al API"),fetch("http://"+t+"/api/brands?supplier="+a,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){null!==e.data?(console.log("descargando marcas"),n.setState({brands:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las marcas","error"))})).catch((function(e){console.error("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={supplier:0,brands:[],name:"",load:!1,host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidUpdate",value:function(e,a){a.supplier!==this.state.supplier&&this.state.supplier&&this.getBrands()}},{key:"render",value:function(){var e=this,a=this.state,t=a.supplier,n=a.name,o=a.brands;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,"Marcas para productos"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement(Ut,{data:this.props.data,supplier:t,handleChangeSupplier:function(a){e.setState({supplier:a})}})))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title text-primary mb-4"},t?"Listado de marcas":"Primero seleccione a un proveedor"),t?r.a.createElement("ul",{className:"card-text list-group"},o.length?o.map((function(a){return r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center",key:a.id},r.a.createElement("span",{className:"text-primary"},a.nombre),r.a.createElement("span",{className:"badge badge-dark badge-pill",style:{cursor:"pointer"},onClick:function(t){e.deleteBrand(a.id,a.nombre)}},r.a.createElement("i",{className:"fas fa-trash"})))})):r.a.createElement("li",{className:"list-group-item"},"No hay marcas registradas para este proveedor")):null),t?r.a.createElement("div",{className:"card-footer"},r.a.createElement("form",{onSubmit:this.saveBrand},r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control mr-1",name:"name",value:n,onChange:this.changeInput}),r.a.createElement("button",{className:"btn btn-dark"},r.a.createElement("i",{className:"fas fa-save"}))))):null))))}}]),t}(n.Component),$t=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target,n=t.name,r=t.type,o=t.value,l=t.checked,c=o;"checkbox"===r&&(c=l),"text"===r&&(c=o.toLowerCase()),"number"===r&&("ejeod"===n||"ejeoi"===n?c=parseInt(o):(c=(c=parseFloat(o)).toFixed(2),c=parseFloat(c))),e.props.onChangeInput(n,c)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.readOnly,t=e.cilindrod,n=e.cilindroi,o=e.esferaod,l=e.esferaoi,c=e.ejeod,s=e.ejeoi,i=e.adiciond,m=e.adicioni,d=e.adicion_media_od,u=e.adicion_media_oi,p=e.dpod,h=e.dpoi,g=e.alturaod,f=e.alturaoi,E=e.lcmarca,v=e.lcgod,b=e.lcgoi;return r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"table table-bordered table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Esfera"),r.a.createElement("th",null,"Cilindro"),r.a.createElement("th",null,"Eje"),r.a.createElement("th",null,"Adici\xf3n"),r.a.createElement("th",null,"Adici\xf3n media"),r.a.createElement("th",null,"D/P"),r.a.createElement("th",null,"Altura"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",null,"D"),r.a.createElement("i",{className:"fa fa-eye"})),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"esferaod",min:"-20",max:"20",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==o&&void 0!==o?o:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==o&&void 0!==o?o:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"cilindrod",min:"-20",max:"0",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==t&&void 0!==t?t:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==t&&void 0!==t?t:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"ejeod",min:"0",max:"180",step:"1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,placeholder:"\xb0",value:c?parseInt(c):"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},parseInt(c))),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"adiciond",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==i&&void 0!==i?i:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==i&&void 0!==i?i:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"adicion_media_od",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==d&&void 0!==d?d:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==d&&void 0!==d?d:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"dpod",min:"40",max:"80",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==p&&void 0!==p?p:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==p&&void 0!==p?p:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"alturaod",min:"0",max:"35",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==g&&void 0!==g?g:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==g&&void 0!==g?g:""))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",null,"I"),r.a.createElement("i",{className:"fa fa-eye"})),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"esferaoi",min:"-20",max:"20",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==l&&void 0!==l?l:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==l&&void 0!==l?l:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"cilindroi",min:"-20",max:"0",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==n&&void 0!==n?n:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==n&&void 0!==n?n:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"ejeoi",min:"0",max:"180",step:"1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,placeholder:"\xb0",value:s?parseInt(s):"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},parseInt(s))),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"adicioni",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==m&&void 0!==m?m:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==m&&void 0!==m?m:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"adicion_media_oi",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==u&&void 0!==u?u:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==u&&void 0!==u?u:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"dpoi",min:"40",max:"80",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==h&&void 0!==h?h:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==h&&void 0!==h?h:"")),r.a.createElement("td",{className:"text-right"},r.a.createElement("input",{type:"number",name:"alturaoi",min:"0",max:"35",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,value:null!==f&&void 0!==f?f:"",onChange:this.catchInputs}),r.a.createElement("h5",{className:"d-none d-print-block"},null!==f&&void 0!==f?f:""))))),r.a.createElement("ul",{className:"list-group d-print-none mt-4"},r.a.createElement("li",{className:"list-group-item"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},"Lente de contacto",r.a.createElement("input",{type:"text",name:"lcmarca",maxLength:"70",className:a?"form-control disabled":"form-control",disabled:!!a,value:E,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"lcgod",maxLength:"30",className:a?"form-control disabled":"form-control",disabled:!!a,value:v||"",onChange:this.catchInputs})),r.a.createElement("div",{className:"col"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"lcgoi",maxLength:"30",className:a?"form-control disabled":"form-control",disabled:!!a,value:b||"",onChange:this.catchInputs}))))))}}]),t}(n.Component),Ht=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleCodeName=function(e){var a="";return e.depende_de?e.depende_de.depende_de?(a=e.depende_de.depende_de.meta.code,a+=e.depende_de.meta.code,a+=e.meta.code):(a=e.depende_de.meta.code,a+=e.meta.code):a=e.meta.code,a},n.handleClickCategory=function(e){e.preventDefault();var a=n.props,t=a.onChangeInput,r=a.nameCategory;n.setState({category_id:0,category_id_2:0,category_id_3:0,category_list_2:[],category_list_3:[]}),t(Object(V.a)({},r,0))},n.handleCategoryChange=function(e,a,t){var r=e.target,o=r.name,l=r.value,c=n.props,s=c.onChangeInput,i=c.nameCategory;"category_id"===o&&l&&n.state.category_list.map((function(e){return e.id===parseInt(l)&&n.setState({category_id_3:0,category_list_2:e.hijos,category_list_3:[]}),null})),"category_id_2"===o&&l&&n.state.category_list_2.map((function(e){return e.id===1*l&&n.setState({category_list_3:e.hijos}),null})),n.setState(Object(V.a)({},o,parseInt(l))),"category_id_3"===o&&s(Object(V.a)({},i,parseInt(l)))},n.getCategories=function(){var e=n.state,a=e.host,t=e.token,r=n.props.category_id;r?(console.log("Descargando categoria para recomendacion"),fetch("http://"+a+"/api/categories/"+r,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){if(e.data){console.log("Recomendacion descargada");var a=n.props,t=a.category_id,r=a.esferaod,o=a.esferaoi,l=a.cilindrod,c=a.cilindroi,s=e.data,i=t&&Object.keys(s).length?n.handleCodeName(s):"XX",m="+000000",d="+000000";(l||r)&&(m=r>0?"+":"",m+=r.toFixed(2).toString().replace(".","")+l.toFixed(2).toString().replace("-","").replace(".","")),(c||o)&&(d=o>0?"+":"",d+=o.toFixed(2).toString().replace(".","")+c.toFixed(2).toString().replace("-","").replace(".","")),n.setState({category:e.data,category_id:t,codesItems:{code:i,od:m,oi:d}})}})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))):(console.log("Descargando lista de recomendaciones raiz"),fetch("http://"+a+"/api/categories/1",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&(console.log("Lista de recomendaciones descargadas"),n.setState({category_list:e.data.hijos,meta:e.meta,category_id:0}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")})))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={category_list:[],meta:{},category_list_2:[],category_list_3:[],category_id:0,category_id_2:0,category_id_3:0,category:[],codesItems:{},host:r.host,token:r.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,a){e.category_id!==this.props.category_id&&this.props.category_id&&(console.log("[DEBUG] Recargando recomendacion"),this.getCategories())}},{key:"render",value:function(){var e=this,a=this.props,t=a.category_id,o=a.title,l=a.esferaod,c=a.esferaoi,s=a.cilindrod,i=a.cilindroi,m=a.handleCodesItems,d=this.state.codesItems;return r.a.createElement("div",{className:"card border border-info rounded d-print-none"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title text-success m-2"},o),t?r.a.createElement(n.Fragment,null,d.code+d.od===d.code+d.oi?r.a.createElement("p",{className:"card-text"},r.a.createElement("label",null,"Lente"),": ",d.code+d.od):r.a.createElement("div",{className:"row card-text"},r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Lente Derecho"),r.a.createElement("br",null)," ",d.code+d.od),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Lente Izquierdo"),r.a.createElement("br",null)," ",d.code+d.oi)),m?r.a.createElement("p",{className:"card-text text-right"},r.a.createElement("button",{className:"btn btn-info",onClick:function(e){e.preventDefault(),m({code:d.code,od:d.od,oi:d.oi})}},r.a.createElement("i",{className:"fas fa-check mr-2"}),"Siguiente")):null,this.props.update?r.a.createElement("p",{className:"card-text text-right"},r.a.createElement("button",{className:"btn btn-outline-info btn-sm card-link mt-2",onClick:this.handleClickCategory},"Cambiar")):null):this.state.category_list.length?r.a.createElement(n.Fragment,null,this.state.category_list.length?r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"Tipo")),r.a.createElement("select",{name:"category_id",className:"custom-select",value:this.state.category_id,onChange:this.handleCategoryChange},r.a.createElement("option",{value:"0"},"Seleccione el tipo"),this.state.category_list.map((function(e){return!!(e.meta&&e.meta.rangoInf<=l&&l<=e.meta.rangoSup&&e.meta.rangoInf<=c&&c<=e.meta.rangoSup&&e.meta.cil<=s&&e.meta.cil<=i)&&r.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):null,this.state.category_id&&this.state.category_list_2.length?r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"Material")),r.a.createElement("select",{name:"category_id_2",className:"custom-select",value:this.state.category_id_2,onChange:this.handleCategoryChange},r.a.createElement("option",{value:"0"},"Seleccione el material"),this.state.category_list_2.map((function(e){return!!(e.meta&&e.meta.rangoInf<=l&&l<=e.meta.rangoSup&&e.meta.rangoInf<=c&&c<=e.meta.rangoSup)&&r.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):null,this.state.category_id&&this.state.category_id_2&&this.state.category_list_3.length?r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"Tratamiento")),r.a.createElement("select",{name:"category_id_3",className:"custom-select",value:this.state.category_id_3,onChange:function(a){e.handleCategoryChange(a,d.od,d.oi)}},r.a.createElement("option",{value:"0"},"Seleccione el tratamiento"),this.state.category_list_3.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.categoria)})))):null):r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))}}]),t}(n.Component),Zt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleSaveExam=function(e){var a=e.id,t=n.props,r=t.paciente,o=t.edad;delete e.id,e.contact_id=r,e.edad=o,window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de actualizar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Actualizar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t){var r=n.state,o=r.host,l=r.token;return console.log("Enviando datos a API para almacenar"),fetch("http://"+o+"/api/exams/"+a,{method:"PUT",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Examen almacenada"),window.Swal.fire({icon:"success",title:"Examen actualizado con exito",showConfirmButton:!1,timer:1500})):(window.Swal.fire("Error","al almacenar el pedido","error"),console.error("Orus res: ",a.message))}}))},n.handleDataExam=function(e,a){var t=n.state.exam;t[e]=a,n.setState({exam:t})},n.handleChangeInput=function(e,a){n.props.ChangeInput(e,a)},n.handleClickDeleteExam=function(e){e.preventDefault(),window.confirm("\xbfRealmente desea cambiar de examen?")&&(n.props.ChangeInput("exam_id",0),n.props.ChangeInput("exam",{}))},n.handleClickSelect=function(e){n.props.ChangeInput("exam_id",e.id),n.props.ChangeInput("exam",e)},n.handleNewOrder=function(e){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva orden?",icon:"info",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:function(a){if(a){var t=n.state,r=t.host,o=t.token,l={contact_id:n.props.paciente,exam_id:e,items:JSON.stringify([])};return console.log("Enviando datos del pedido a la API"),fetch("http://"+r+"/api/orders",{method:"POST",body:JSON.stringify(l),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch: ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Orden almacenada"),localStorage.setItem("OrusContactNew",JSON.stringify({})),window.Swal.fire("Orden creada con exito","","success").then((function(e){return n.getExams()}))):(window.Swal.fire("Error","al almacenar la orden","error"),console.error("Orus res: ",a.message))}}))},n.handleNewExam=function(e){e.preventDefault(),window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear un nueva examen?",icon:"info",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o=n.props,l={contact_id:o.paciente,edad:o.edad};return console.log("Enviando datos del examen a la API"),fetch("http://"+t+"/api/exams",{method:"POST",body:JSON.stringify(l),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch: ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Examen almacenado"),localStorage.setItem("OrusContactNew",JSON.stringify({})),window.Swal.fire({icon:"success",title:"Examen creado con exito",showConfirmButton:!1,timer:1500}).then((function(e){n.getExams(),n.props.ChangeInput("exam_id",a.data.id),n.props.ChangeInput("exam",a.data)}))):(window.Swal.fire("Error","al almacenar el examen","error"),console.error("Orus res: ",a.message))}}))},n.getExams=function(){var e=n.state,a=e.load,t=e.host,r=e.token,o=n.props.paciente;if(o){var l="http://"+t+"/api/exams",c=n.state.page>0?"?page="+n.state.page:"?page=1",s="&paciente="+o;a||n.setState({load:!0}),console.log("Descargando examenes del contacto"),fetch(l+c+s+"&orderby=created_at&order=desc",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){return e.ok||(n.setState({load:!1}),console.log(e)),e.json()})).then((function(e){console.log("Examenes almacenados"),n.setState({data:e.message?[]:e,load:!1})}))}else n.setState({load:!1})};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={id:0,data:{data:[],meta:{}},exam:{},examEdit:!1,load:!0,page:0,host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.props.exam?this.setState({id:this.props.exam.id,exam:this.props.exam,load:!1}):this.getExams()}},{key:"componentDidUpdate",value:function(e,a){this.props.exam&&!this.props.exam.id&&this.props.exam.id!==e.exam.id&&this.getExams(),this.props.exam&&this.props.exam.id!==e.exam.id&&this.setState({id:this.props.exam.id,exam:this.props.exam})}},{key:"render",value:function(){var e=this,a=this.state,t=a.data,n=a.load,o=a.id,l=a.exam,c=a.examEdit,s=this.props,i=s.select,m=s.datos;if(i)return r.a.createElement(r.a.Fragment,null,o?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row d-print-none mb-4"},r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Folio"),r.a.createElement("strong",null,o))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Estado"),r.a.createElement("strong",null,l.estado?"Terminado":"En proceso..."))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-info rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-info mx-2"},"Fecha"),r.a.createElement("strong",null,it.a.utc(l.created_at).local().format("LL")))),l.observaciones.length?r.a.createElement("div",{className:"col-1"},r.a.createElement("span",{className:"badge badge-pill badge-danger mx-2"},r.a.createElement("i",{className:"fas fa-eye mr-2"}),"Observaciones")):null,r.a.createElement("div",{className:"col-2 d-print-none text-right"},r.a.createElement("button",{className:this.props.status?"btn btn-info disabled":"btn btn-info",disabled:!!this.props.status,onClick:this.handleClickDeleteExam},"Cambiar"))),r.a.createElement($t,{esferaod:l.esferaod?l.esferaod:0,esferaoi:l.esferaoi?l.esferaoi:0,cilindrod:l.cilindrod?l.cilindrod:0,cilindroi:l.cilindroi?l.cilindroi:0,ejeod:l.ejeod?l.ejeod:0,ejeoi:l.ejeoi?l.ejeoi:0,adiciond:l.adiciond?l.adiciond:0,adicioni:l.adicioni?l.adicioni:0,adicion_media_od:l.adicion_media_od,adicion_media_oi:l.adicion_media_oi,dpod:l.dpod?l.dpod:0,dpoi:l.dpoi?l.dpoi:0,alturaod:l.alturaod?l.alturaod:0,alturaoi:l.alturaoi?l.alturaoi:0,lcmarca:l.lcmarca?l.lcmarca:0,lcgod:l.lcgod?l.lcgod:0,lcgoi:l.lcgoi?l.lcgoi:0,readOnly:!c,onChangeInput:this.handleDataExam}),r.a.createElement("div",{className:"row d-print-none"},r.a.createElement("div",{className:"col p-2"},r.a.createElement("div",{className:l.observaciones.length?"card border border-danger rounded":"card border border-info rounded"},r.a.createElement("div",{className:"card-body"},r.a.createElement("label",{className:"card-title"},"Observaciones"),r.a.createElement("p",{className:"card-text text-muted text-uppercase"},l.observaciones?l.observaciones:"--")))),l.category_id?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col p-2"},r.a.createElement(Ht,{category_id:l.category_id,title:"Recomendacion principal",esferaod:l.esferaod?l.esferaod:0,esferaoi:l.esferaoi?l.esferaoi:0,cilindrod:l.cilindrod?l.cilindrod:0,cilindroi:l.cilindroi?l.cilindroi:0,data:m,onChangeInput:this.handleChangeInput})),l.category_ii?r.a.createElement("div",{className:"col p-2"},r.a.createElement(Ht,{category_id:l.category_ii,title:"Recomendacion adicional",esferaod:l.esferaod?l.esferaod:0,esferaoi:l.esferaoi?l.esferaoi:0,cilindrod:l.cilindrod?l.cilindrod:0,cilindroi:l.cilindroi?l.cilindroi:0,data:m,onChangeInput:this.handleChangeInput})):null):null),r.a.createElement("div",{className:"row d-print-none"},r.a.createElement("div",{className:"col text-right pt-2"},r.a.createElement("button",{className:c?"btn btn-dark":"btn btn-info",onClick:function(a){a.preventDefault(),c&&e.handleSaveExam(l),e.setState({examEdit:!c})}},c?r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-save mr-2"})," Guardar"):r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-pencil-alt mr-2"})," Editar"))))):r.a.createElement("table",{className:"table table-hover table-nowrap"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Folio"),r.a.createElement("th",null,"Fecha"),r.a.createElement("th",null,"Edad"),r.a.createElement("th",null,"Estado"),r.a.createElement("th",null,"\xa0"))),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(a){return r.a.createElement("tr",{key:a.id,className:it.a.utc(new Date).isSame(it.a.utc(a.created_at),"day")?"table-success":""},r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-info"},a.id)),r.a.createElement("td",null,it.a.utc(a.created_at).local().format("L"),r.a.createElement("br",null),it()(new Date).isSame(a.created_at)),r.a.createElement("td",null,a.edad),r.a.createElement("td",null,a.estado?r.a.createElement("span",{className:"badge badge-secondary"},"Terminado"):r.a.createElement("span",{className:"badge badge-success"},"Activo")),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-outline-dark btn-sm",onClick:function(t){t.preventDefault(),e.handleClickSelect(a)}},r.a.createElement("i",{className:"fas fa-check"}))))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"5",className:"text-center"},"Aun no tiene examenes",r.a.createElement("button",{className:"btn btn-outline-info btn-sm ml-4",onClick:this.handleNewExam},r.a.createElement("i",{className:"fas fa-plus"})))))));var d=!1,u=!1;return r.a.createElement("div",{className:"card card-info card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("i",{className:"fas fa-notes-medical mr-1"}),"Examenes realizados"),r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-hover table-nowrap"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Folio"),r.a.createElement("th",null,"Fecha"),r.a.createElement("th",null,"Edad"),r.a.createElement("th",null,"Estado"),r.a.createElement("th",{className:"text-center"},"Acciones"))),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"8",className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):Object.keys(t.data).length?t.data.map((function(e){return d=it()(new Date).isSame(it()(e.created_at),"day"),u=!!u||d,console.log("Hoy: ",d,u),r.a.createElement("tr",{key:e.id,className:d?"table-success":""},r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-info"},e.id)),r.a.createElement("td",null,it()(e.created_at).format("L")),r.a.createElement("td",null,e.edad),r.a.createElement("td",null,e.estado?r.a.createElement("span",{className:"badge badge-secondary"},"Terminado"):r.a.createElement("span",{className:"badge badge-success"},"Activo")),r.a.createElement("td",{className:"text-right"},r.a.createElement(lt.b,{className:"btn btn-outline-info btn-sm",to:"/consultorio/registro/"+e.id,alt:"Ver examen"},r.a.createElement("i",{className:"fas fa-share"})," Ver examen")))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"5",className:"text-center"},"Aun no tiene examenes"))))),r.a.createElement("div",{className:"card-footer"},u?null:r.a.createElement("button",{type:"button",className:"btn btn-info float-right",onClick:this.handleNewExam},r.a.createElement("i",{className:"fas fa-plus"}))))}}]),t}(n.Component),Wt={_getList:He.getListContacts,_setList:He.setListContact},Xt=Object(at.b)((function(e){return{contacts:e.contact.list}}),Wt)((function(e){var a=e.type,t=e.business,o=e.name,l=e.rfc,c=e.email,s=e.birthday,i=e.handleChangeData,m=e.verification,d=e.contacts,u=e._getList,p=e._setList,h=function(e){var a=e.target,t=a.name,n=a.value,r=a.checked,o=n;"type"===t&&(o=parseInt(n)),"business"===t&&(o=r),i(t,o)},g=Object(n.useState)(null),f=Object(jt.a)(g,2),E=f[0],v=f[1];return Object(n.useEffect)((function(){var e=null;o.length>2?(E&&clearTimeout(E),e=setTimeout((function(){u({search:o})}),1e3),v(e)):p({result:{list:[],metaList:{}}})}),[o]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Tipo de contacto"),r.a.createElement("select",{className:"custom-select",name:"type",value:null!==a&&void 0!==a?a:"",onChange:h},r.a.createElement("option",{value:"0"},"Cliente"),r.a.createElement("option",{value:"1"},"Proveedor"))),r.a.createElement("div",{className:"form-group custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",name:"business",className:"custom-control-input",checked:null!==t&&void 0!==t?t:"",onChange:h,id:"business_checkbox"}),r.a.createElement("label",{htmlFor:"business_checkbox",className:"custom-control-label cursor-pointer"},r.a.createElement("small",null,"\xbfEs una empresa?"))),a?null:r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"RFC"),r.a.createElement("input",{type:"text",className:"form-control text-uppercase text-truncate",placeholder:"Para facturas",name:"rfc",value:null!==l&&void 0!==l?l:"",onChange:h,minLength:"10"}))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group position-relative"},r.a.createElement("label",null,"Nombre completo ",r.a.createElement("span",{className:"text-orange"},"*")," (",m.nameInDb,")"),r.a.createElement("input",{type:"text",className:d.length?"form-control text-capitalize text-truncate text-danger":"form-control text-capitalize text-truncate",placeholder:"Ej: Juan Perez G",name:"name",value:null!==o&&void 0!==o?o:"",onChange:h}),!o|!m.name?r.a.createElement("small",null,r.a.createElement("span",{className:"text-orange"},"Este campo es requerido")):null,d.length?r.a.createElement("div",{className:"position-absolute border rounded p-0 bg-white overflow-auto ",style:{zIndex:"50",top:"4.1rem",width:"100%",maxHeight:"8rem"}},r.a.createElement("ul",{className:"list-group"},d.map((function(e){return r.a.createElement("li",{className:"list-group-item text-truncate",key:e.id},r.a.createElement("i",{className:"fas fa-minus mr-1 text-danger"}),r.a.createElement("span",{className:"text-capitalize text-muted text-monospace text-sm"},e.nombre))})))):null),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Correo electr\xf3nico ",r.a.createElement("span",{className:"text-orange"},"*")),r.a.createElement("input",{type:"email",className:"form-control text-lowercase text-truncate",placeholder:"Ej: correo@domain.com",name:"email",value:null!==c&&void 0!==c?c:"",onChange:h}),!c|!m.email?r.a.createElement("small",null,r.a.createElement("span",{className:"text-orange"},"Este campo es requerido")):null),a?null:r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Fecha de nacimiento ",r.a.createElement("span",{className:"text-orange"},"*")),r.a.createElement("input",{type:"date",className:"form-control text-truncate",placeholder:"","data-inputmask-alias":"datetime","data-inputmask-inputformat":"dd/mm/yyyy","data-mask":"","im-insert":"false",name:"birthday",value:null!==s&&void 0!==s?s:"",onChange:h}),!s|!m.birthday?r.a.createElement("small",null,r.a.createElement("span",{className:"text-orange"},"Este campo es requerido")):null)))})),Yt=function(e){var a=e.domicilios,t=e.handleChangeData,n=a.calle,o=a.colonia,l=a.municipio,c=a.estado,s=a.cp,i=function(e){var n=e.target,r=n.name,o=n.value,l=a;"calle"===r&&(l.calle=o),"colonia"===r&&(l.colonia=o),"municipio"===r&&(l.municipio=o),"estado"===r&&(l.estado=o),"cp"===r&&(l.cp=o),t("domicilios",l)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col"},n?r.a.createElement("small",null,r.a.createElement("label",null,"Calle y numero")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-road"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Calle y numero",name:"calle",value:n,onChange:i})),o?r.a.createElement("small",null,r.a.createElement("label",null,"Colonia")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-location-arrow"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Colonia",name:"colonia",value:o,onChange:i})),l?r.a.createElement("small",null,r.a.createElement("label",null,"Municipio")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-location-arrow"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Municipio",name:"municipio",value:l,onChange:i}))),r.a.createElement("div",{className:"col"},c?r.a.createElement("small",null,r.a.createElement("label",null,"Estado")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-map-marker"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Estado",name:"estado",value:c,onChange:i})),s?r.a.createElement("small",null,r.a.createElement("label",null,"Codigo postal")):r.a.createElement("br",null),r.a.createElement("div",{className:"input-group mb-1"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-map-marker"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Codigo Postal",name:"cp",value:s,onChange:i}))))},Kt=function(e){var a=e.telefonos,t=e.handleChangeData,n=a.t_casa,o=void 0===n?"":n,l=a.t_oficina,c=void 0===l?"":l,s=a.t_movil,i=void 0===s?"":s,m=function(e){var n=e.target,r=n.name,o=n.value,l=/^\d+$/gim,c=a;"t_casa"===r&&l.test(o)&&(c.t_casa=o,c.t_movil.length<10&&(c.t_movil=o)),"t_oficina"===r&&l.test(o)&&(c.t_oficina=o),"t_movil"===r&&l.test(o)&&(c.t_movil=o),t("telefonos",c)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Telefono personal"),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-phone"}))),r.a.createElement("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_casa",value:o,onChange:m})))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Telefono para recados"),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-phone"}))),r.a.createElement("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_oficina",value:c,onChange:m})))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Numero de whatsApp"),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-phone"}))),r.a.createElement("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_movil",value:i,onChange:m})))))},Qt=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeData=function(e,a){var t=n.state.verification;switch(e){case"name":n.setState({name:a,verification:Object(s.a)(Object(s.a)({},t),{},{name:!0})});break;case"email":n.setState({email:a,verification:Object(s.a)(Object(s.a)({},t),{},{email:!0})});break;case"birthday":n.setState({birthday:a,verification:Object(s.a)(Object(s.a)({},t),{},{birthday:!0})});break;case"telefonos":n.setState({telefonos:a,verification:Object(s.a)(Object(s.a)({},t),{},{telefonos:!0})});break;default:n.setState(Object(V.a)({},e,a))}},n.handleVerificationData=function(){var e=n.state,a=e.name,t=e.email,r=e.birthday,o=e.telefonos,l=e.verification,c=e.type,i=/^\d{10}$/gim;if(!c&&!/^[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+\s[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]{2,}(\s?[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+){1,}/gim.test(a))return window.Swal.fire({title:"Verificacion",text:"El nombre del contacto es erroneo",icon:"warning"}),n.setState({verification:Object(s.a)(Object(s.a)({},l),{},{name:!1})}),!1;if(!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/gim.test(t))return window.Swal.fire({title:"Verificacion",text:"El correo electr\xf3nico del contacto es erroneo",icon:"warning"}),n.setState({verification:Object(s.a)(Object(s.a)({},l),{},{email:!1})}),!1;var m=Object.values(o),d=!0;if(m.every((function(e){return!i.test(e)||(d=!1,!1)})),!c&&d)return window.Swal.fire({title:"Verificacion",text:"El numero de contacto es erroneo",icon:"warning"}),n.setState({verification:Object(s.a)(Object(s.a)({},l),{},{telefonos:!1})}),!1;var u=new Date(r),p=(new Date).getFullYear()-u.getFullYear();return!(!c&&(!r||p<1))||(window.Swal.fire({title:"Verificacion",text:"La fecha de nacimiento es erronea",icon:"warning"}),n.setState({verification:Object(s.a)(Object(s.a)({},l),{},{birthday:!1})}),!1)},n.handleSave=function(e){e.preventDefault();var a=n.state,t=a.id,r=a.name,o=a.rfc,l=a.email,c=a.type,s=a.birthday,i=a.domicilios,m=a.telefonos,d=a.business,u=n.props.handleSave;if(!n.handleVerificationData())return!1;var p={calle:i.calle.trim(),colonia:i.colonia.trim(),municipio:i.municipio.trim(),estado:i.estado.trim(),cp:i.cp.trim()},h={name:r.trim().toLocaleLowerCase(),rfc:o.trim().toLocaleLowerCase(),email:l.trim().toLocaleLowerCase(),type:c,birthday:new Date(s),domicilio:JSON.stringify(p),telnumbers:JSON.stringify(m),business:d?1:0};window.Swal.fire({title:"Almacenamiento",text:t?"\xbfEsta seguro de actualizar al contacto?":"\xbfEsta seguro de crear un nuevo contacto?",icon:"question",showCancelButton:!0,confirmButtonText:t?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||u(t,h)}))},n.getUser=function(){var e=n.props.contact,a=e.id,t=e.domicilio,r=e.telefonos;a?n.setState({id:e.id,name:e.nombre,rfc:e.rfc,email:e.email,type:e.tipo,business:e.empresa,birthday:e.f_nacimiento,domicilios:t||{calle:"",colonia:"",municipio:"",estado:"",cp:""},telefonos:r||{t_casa:"",t_oficina:"",t_movil:""},load:!1}):n.setState({load:!1})},n.state={id:0,name:"",rfc:"",email:"",type:0,birthday:"",domicilios:{calle:"",colonia:"",municipio:"",estado:"",cp:""},telefonos:{t_casa:"",t_oficina:"",t_movil:""},business:!1,verification:{name:!0,email:!0,birthday:!0,telefonos:!0},load:!0},n.timeSave=null,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getUser()}},{key:"render",value:function(){var e=this.state,a=e.id,t=e.name,n=e.rfc,o=e.email,l=e.type,c=e.birthday,s=e.domicilios,i=e.telefonos,m=e.business,d=e.load,u=e.verification,p=this.props.handleClose;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"card card-indigo card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-indigo"},r.a.createElement("i",{className:"fas fa-address-book mr-1"}),a?r.a.createElement("label",null,"Editar contacto",r.a.createElement("span",{className:"badge bg-indigo ml-2"},a)):r.a.createElement("label",null,"Registrar nuevo contacto"))),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center"},"Datos personales"),r.a.createElement(Xt,{id:a,name:t,rfc:n,email:o,type:l,birthday:c,business:m,verification:u,handleChangeData:this.handleChangeData})),r.a.createElement("div",{className:"row mt-5 border-top pt-5"},r.a.createElement("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center"},"Medios de contacto ",r.a.createElement("span",{className:"text-orange"},"*"),(!i.t_casa&&!i.t_oficina&&!i.t_movil)|!u.telefonos?r.a.createElement("small",{className:"d-block w-100"},r.a.createElement("span",{className:"text-orange"},"Ingrese por lo menos un telefono")):null),r.a.createElement(Kt,{telefonos:i,handleChangeData:this.handleChangeData})),l?null:r.a.createElement("div",{className:"row mt-5 border-top pt-5"},r.a.createElement("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center"},"Domicilios del contacto"),r.a.createElement(Yt,{domicilios:s,handleChangeData:this.handleChangeData}))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"btn-group float-right",role:"group"},r.a.createElement("button",{className:"btn btn-default",type:"button",onClick:function(e){return p()}},r.a.createElement("i",{className:a?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),r.a.createElement("strong",null,a?"Cerrar":"Cancelar")),r.a.createElement("button",{type:"button",className:"btn bg-indigo",onClick:this.handleSave},r.a.createElement("i",{className:"fas fa-save mr-1"}),"Guardar"))))),d?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null))),a?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(Zt,{exam:"",paciente:a}))):null)}}]),t}(n.Component),en=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleSaveContact=function(e,a){(0,n.props._saveContact)({data:a,id:e,options:n.state.options}),n.handleCloseEdit()},n.handleSync=function(){n.getContacts()},n.handleCloseEdit=function(){n.setState({contact:{},contactSelected:"",newOrEdit:!1,load:!0}),n.props.history.push("/contactos")},n.handleEditItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=n.state.contactSelected,t=n.props.contacts,r=null!==e&&void 0!==e?e:a,o=t.filter((function(e){return e.id===r}));o.length?(n.setState({contact:o[0],contactSelected:r,newOrEdit:!0}),n.props.history.push("/contactos/".concat(r))):(n.setState({contact:{},contactSelected:"",newOrEdit:!1,load:!0}),n.props.history.push("/contactos"))},n.handleChangeCheckbox=function(e){var a=e.target,t=a.value;a.checked?n.setState({contactSelected:parseInt(t)}):n.setState({contactSelected:""})},n.handleSetSelectOptions=function(e){var a=e.target,t=a.name,r=a.value,o=n.state.options,l=r;"itemsPage"===t&&(l=parseInt(r)),n.setState({options:Object(s.a)(Object(s.a)({},o),{},Object(V.a)({},t,l)),load:!0})},n.handleSearch=function(e){var a=n.state.options;n.setState({options:Object(s.a)(Object(s.a)({},a),{},{search:e}),load:!0})},n.handleChangePage=function(e){var a=n.state.options;n.setState({options:Object(s.a)(Object(s.a)({},a),{},{page:e}),load:!0})},n.handleDelete=function(){var e=n.state,a=e.contactSelected,t=e.options,r=n.props._deleteContact;if(!a)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un contacto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el contacto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",a),r({id:a,options:t})),n.setState({contactSelected:""})}))},n.state={load:!1,contact:{},newOrEdit:!1,contactSelected:"",options:{page:1,orderby:"created_at",order:"desc",search:"",type:"",itemsPage:10}},n.timeInterval=0,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,a=e.match,t=e._getContact,n=a.params.id;n?t(n):this.getContacts()}},{key:"componentDidUpdate",value:function(e,a){var t=this.state.load,n=this.props,r=n.messages,o=n.contact;a.load!==t&&t&&(console.log("[Orus System] Recargando contactos"),this.getContacts()),e.contact.id!==o.id&&o.id&&(console.log("[Orus System] Cargando contacto"),this.setState({contact:o,newOrEdit:!0})),e.messages.length!==r.length&&r.length&&r.forEach((function(e){var a=e.type,t=e.text;window.Swal.fire({icon:a,title:t,showConfirmButton:"error"===a,timer:"error"!==a?1500:9e3})}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.contacts,n=a.loading,o=a.meta,l=this.state,c=l.contact,s=l.newOrEdit,i=l.contactSelected,m=l.options;return console.log("[DEBUG] Render",t),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 col-md-2"},r.a.createElement("button",{className:"btn bg-indigo btn-block mb-3",type:"button",disabled:s,onClick:function(a){a.preventDefault(),e.setState({newOrEdit:!0})}},r.a.createElement("i",{className:"fas fa-plus mr-1"}),"Nuevo contacto"),s?null:r.a.createElement(At,{title:"Filtros"},r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"type"},"Tipo"),r.a.createElement("select",{className:"form-control ",name:"type",id:"type",value:m.type,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:""},"-- Todos --"),r.a.createElement("option",{value:"0"},"Clientes"),r.a.createElement("option",{value:"1"},"Proveedores"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"orderby"},"Ordenar por"),r.a.createElement("select",{className:"form-control ",name:"orderby",id:"orderby",value:m.orderby,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"created_at"},"Fecha de registro"),r.a.createElement("option",{value:"updated_at"},"Fecha de modificacion"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"order"},"Mostrar por"),r.a.createElement("select",{className:"form-control ",name:"order",id:"order",value:m.order,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"asc"},"Antiguos"),r.a.createElement("option",{value:"desc"},"Recientes"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"itemsPage"},"Numero de contactos"),r.a.createElement("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:m.itemsPage,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"10"},"ver 10"),r.a.createElement("option",{value:"20"},"ver 20"),r.a.createElement("option",{value:"50"},"ver 50"),r.a.createElement("option",{value:"100"},"ver 100"))))),r.a.createElement("div",{className:"col-sm-12 col-md-10"},s?r.a.createElement(Qt,{contact:c,handleClose:this.handleCloseEdit,handleSave:this.handleSaveContact}):r.a.createElement(It,{title:"Lista de contactos",icon:"id-badge",color:"indigo",loading:n,meta:o,itemSelected:i,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync},r.a.createElement("table",{className:"table table-hover table-striped"},r.a.createElement("tbody",null,t.length?r.a.createElement(r.a.Fragment,null,t.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",{className:"icheck-primary pl-2"},r.a.createElement("input",{type:"checkbox",className:"form-check-input mt-4",value:a.id,id:"contact_"+a.id,checked:i===a.id,onChange:e.handleChangeCheckbox}),r.a.createElement("label",{htmlFor:"contact_"+a.id,className:"sr-only"})),r.a.createElement("td",{className:"mailbox-name text-capitalize text-truncate",style:{cursor:"pointer",maxWidth:180},onClick:function(t){return e.handleEditItem(a.id)}},r.a.createElement("label",{style:{cursor:"pointer"}},a.tipo?r.a.createElement("i",{className:"fas fa-store text-sm mr-2"}):r.a.createElement("i",{className:"fas fa-user text-sm mr-2"}),a.nombre)),r.a.createElement("td",{className:"mailbox-attachment text-lowercase text-truncate",style:{maxWidth:180}},r.a.createElement("span",null,r.a.createElement("i",{className:"fas fa-envelope text-sm mr-2"}),r.a.createElement("a",{href:"mailto:"+a.email,className:"text-muted"},a.email))),r.a.createElement("td",{className:"mailbox-date text-muted text-truncate text-right"},r.a.createElement("span",null,r.a.createElement("i",{className:"fas fa-phone text-sm mr-2"}),a.telefonos.t_movil?a.telefonos.t_movil:a.telefonos.t_casa?a.telefonos.t_casa:a.telefonos.t_oficina?a.telefonos.t_oficina:"--")))}))):r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center text-muted"},"No hay contactos registrados")))))))}},{key:"getContacts",value:function(){var e=this.props._getListContacts,a=this.state.options;e(Object(s.a)({},a)),this.setState({load:!1})}}]),t}(n.Component),an={_getListContacts:He.getListContacts,_deleteContact:He.deleteContact,_saveContact:He.saveContact,_getContact:He.getContact},tn=Object(at.b)((function(e){var a=e.contact;return{contacts:a.list,messages:a.messages,meta:a.metaList,loading:a.loading,contact:a.contact}}),an)(en),nn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleCategoryChange=function(e){var a=e.target,t=a.name,r=a.value;"category_id"===t&&r&&n.state.category_select.map((function(e){return e.id===1*r&&n.setState({category_hijos:e.hijos}),null})),"category_id_2"===t&&r&&n.state.category_hijos.map((function(e){return e.id===1*r&&n.setState({category_hijos_3:e.hijos}),null})),n.setState(Object(V.a)({},t,r))},n.handleChangePage=function(e){n.setState({page:e})},n.handleClickDelete=function(e,a){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la categoria "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a&&e){var t=n.state,r=t.host,o=t.token;return console.log("Solicitud de eliminaci\xf3n de categoria por API"),fetch("http://"+r+"/api/categories/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Categoria eliminado"),window.Swal.fire({icon:"success",title:"Categoria eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getCategories()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.handleClickSave=function(){if(n.state.name.length<4)return window.Swal.fire("Verificaci\xf3n","Debe de escribir el nombre de la categoria","warning"),n.nameInput.focus(),!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva categoria?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o={name:n.state.name,category_id:n.state.category_id_3?n.state.category_id_3:n.state.category_id_2?n.state.category_id_2:n.state.category_id};return console.log("Enviando datos a API para almacenar"),fetch("http://"+t+"/api/categories",{method:"POST",body:JSON.stringify(o),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Categoria almacenada"),window.Swal.fire({icon:"success",title:"Categoria almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){n.setState({newItem:a.data.id}),n.getCategories()}))):(window.Swal.fire("Error","al almacenar la categoria","error"),console.error("Orus res: ",a.message))}}))},n.getCategories=function(){var e=n.state,a=e.host,t=e.token,r=e.load,o="http://"+a+"/api/categories",l=n.state.page>0?"?page="+n.state.page:"?page=1";r||n.setState({load:!0}),console.log("Descargando lista de categorias"),fetch(o+l,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&(console.log("Lista de categorias descargadas"),n.setState({category_list:e.data,meta:e.meta,newItem:0,add:!1,category_id:0,name:"",load:!1}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")})),fetch(o+l+"&categoryid=raiz",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&n.setState({category_select:e.data})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},n.handleClickAdd=function(){n.setState({add:!n.state.add,name:"",category_id:0,category_id_2:0,category_id_3:0,category_hijos:[],category_hijos_3:[]})},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value;n.setState(Object(V.a)({},t,r.toLowerCase()))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={category_list:[],category_select:[],category_hijos:[],category_hijos_3:[],meta:{},add:!1,name:"",category_id:0,category_id_2:0,category_id_3:0,newItem:0,page:1,host:r.host,token:r.token,load:!0},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,a){a.page!==this.state.page&&(console.log("Recargando categorias"),this.getCategories())}},{key:"render",value:function(){var e=this,a=this.state,t=a.category_list,n=a.meta,o=a.load,l=this.state.category_hijos,c=this.state.category_hijos_3;return r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Categorias"),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Nombre"),r.a.createElement("th",null,"Padre"),r.a.createElement("th",null,"Eliminar"))),r.a.createElement("tbody",null,o?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"8",className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):t.map((function(a){var t="";return null!=a.depende_de&&(null!=a.depende_de.depende_de&&(t=a.depende_de.depende_de.categoria),t=t?t+"/"+a.depende_de.categoria:a.depende_de.categoria),t=t||"--",r.a.createElement("tr",{key:a.id,className:a.id===e.state.newItem?"table-success":""},r.a.createElement("td",{className:"text-capitalize"},a.categoria),r.a.createElement("td",{className:"text-capitalize"},t),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-outline-light btn-sm",onClick:function(t){e.handleClickDelete(a.id,a.categoria)}},r.a.createElement("i",{className:"fas fa-trash"}))))}))),this.state.add&&!o?r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",className:"form-control",autoComplete:"off",value:this.state.name,onChange:this.catchInputs,ref:function(a){e.nameInput=a}})),r.a.createElement("td",null,r.a.createElement("select",{name:"category_id",className:"form-control",value:this.state.category_id,onChange:this.handleCategoryChange},r.a.createElement("option",{value:"0"},"Inicial"),this.state.category_select.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))),l.length?r.a.createElement("select",{name:"category_id_2",className:"form-control mt-2",value:this.state.category_id_2,onChange:this.handleCategoryChange},r.a.createElement("option",{value:"0"},"Raiz"),this.state.category_hijos.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))):"",c.length?r.a.createElement("select",{name:"category_id_3",className:"form-control mt-2",value:this.state.category_id_3,onChange:this.handleCategoryChange},r.a.createElement("option",{value:"0"},"Raiz"),this.state.category_hijos_3.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.categoria)}))):""),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-dark btn-sm",onClick:this.handleClickSave},r.a.createElement("i",{className:"fas fa-save"}))))):r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement(yt,{meta:n,handleChangePage:this.handleChangePage})))))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.handleClickAdd},this.state.add?r.a.createElement("i",{className:"fas fa-undo"}):r.a.createElement("i",{className:"fas fa-plus"}))))}}]),t}(n.Component),rn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).clickSave=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.company=n.state.company,e.host=n.state.server,localStorage.setItem("OrusSystem",JSON.stringify(e))},n.clickSaveUser=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.email=n.state.email,e.name=n.state.name,e.username=n.state.username,localStorage.setItem("OrusSystem",JSON.stringify(e))},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value;n.setState(Object(V.a)({},t,r.toLowerCase()))},n.state={server:"",company:"",email:"",name:"",username:"",password:"",category_list:[]},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));this.setState({server:e.host?e.host:window.location.host.split(":")[0],company:e.company?e.company:"",email:e.email?e.email:"",name:e.name?e.name:"",username:e.username?e.username:""})}},{key:"render",value:function(){var e=this.props.data;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Generales"),r.a.createElement("p",null,"\xa0"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-server"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"server",value:this.state.server,onChange:this.catchInputs})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-building"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre de la empresa",name:"company",value:this.state.company,onChange:this.catchInputs}))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickSave},"Guardar"))),r.a.createElement(nn,{data:e})),r.a.createElement("div",{className:"col-6"},r.a.createElement("div",{className:"card card-primary card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Usuario"),r.a.createElement("p",null,"\xa0"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-at"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Email",name:"email",value:this.state.email,onChange:this.catchInputs})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-user-tag"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",value:this.state.name,onChange:this.catchInputs})),r.a.createElement("hr",null),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-user-check"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Usuario",name:"username",value:this.state.username,onChange:this.catchInputs})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-lock"}))),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Contrase\xf1a",name:"password",value:this.state.password,onChange:this.catchInputs}))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.clickSaveUser},"Guardar")))))}}]),t}(n.Component),on=function(e){var a=function(a){var t=a.target,n=t.name,r=t.type,o=t.checked,l=t.value,c="checkbox"===r?o:l.toLowerCase();e.handleGetData(n,c)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"pc",type:"checkbox",className:"custom-control-input",id:"pc",checked:e.pc,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"pc"},r.a.createElement("i",{className:"fas fa-desktop"})," PC")),r.a.createElement("input",{type:"text",name:"pc_time",className:"form-control input-xs",value:e.pc_time,onChange:a,readOnly:e.pc?"":"readonly"})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"tablet",type:"checkbox",className:"custom-control-input",id:"tablet",checked:e.tablet,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"tablet"},r.a.createElement("i",{className:"fas fa-tablet-alt"})," Tablet")),r.a.createElement("input",{type:"text",name:"tablet_time",className:"form-control input-xs",value:e.tablet_time,onChange:a,readOnly:e.tablet?"":"readonly"})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"movil",type:"checkbox",className:"custom-control-input",id:"movil",checked:e.movil,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"movil"},r.a.createElement("i",{className:"fas fa-mobile-alt"})," Telefono")),r.a.createElement("input",{type:"text",name:"movil_time",className:"form-control input-xs",value:e.movil_time,onChange:a,readOnly:e.movil?"":"readonly"})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"lap",type:"checkbox",className:"custom-control-input",id:"lap",checked:e.lap,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"lap"},r.a.createElement("i",{className:"fas fa-laptop"})," Laptop")),r.a.createElement("input",{type:"text",name:"lap_time",className:"form-control input-xs",value:e.lap_time,onChange:a,readOnly:e.lap?"":"readonly"}))),r.a.createElement("div",{className:"row mt-1"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("ul",{className:"list-group"},r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"frontal",type:"checkbox",className:"custom-control-input",id:"frontal",checked:e.frontal,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"frontal"},"Frontal"))),r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"occipital",type:"checkbox",className:"custom-control-input",id:"occipital",checked:e.occipital,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"occipital"},"Occipital"))),r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"generality",type:"checkbox",className:"custom-control-input",id:"generality",checked:e.generality,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"generality"},"General"))),r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"cefalea",type:"checkbox",className:"custom-control-input",id:"cefalea",checked:e.cefalea,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"cefalea"},"Cefalea"))))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("ul",{className:"list-group"},r.a.createElement("li",{className:"list-group-item"},"Temporal",r.a.createElement("br",null),r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"temporaod",type:"checkbox",className:"custom-control-input",id:"temporaod",checked:e.temporaod,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"temporaod"},r.a.createElement("i",{className:"fa fa-eye"})," Derecho"))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"temporaoi",type:"checkbox",className:"custom-control-input",id:"temporaoi",checked:e.temporaoi,onChange:a}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"temporaoi"},r.a.createElement("i",{className:"fa fa-eye"})," Izquierdo"))))),r.a.createElement("li",{className:"list-group-item"},"Frecuencia",r.a.createElement("span",{className:"badge badge-pill"},r.a.createElement("input",{type:"text",name:"c_frecuencia",maxLength:"60",className:"form-control input-xs",value:e.c_frecuencia,onChange:a}))),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("label",{htmlFor:"c_intensidad"},"Intensidad"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-11"},r.a.createElement("input",{type:"range",name:"c_intensidad",className:"custom-range custom-range-info",id:"c_intensidad",min:"0",max:"4",value:e.c_intensidad,onChange:a})),r.a.createElement("div",{className:"col-1"},r.a.createElement("h6",null,e.c_intensidad))))))))},ln=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Interrogatorio inicial"),r.a.createElement("textarea",{name:"interrogatorio",className:"form-control",value:this.props.interrogatorio,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Cirugias oculares"),r.a.createElement("textarea",{name:"coa",className:"form-control",value:this.props.coa,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Antecedentes oculares patologicas personales"),r.a.createElement("textarea",{name:"aopp",className:"form-control",rows:"2",value:this.props.aopp,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Antecedentes oculares patologicas familiares"),r.a.createElement("textarea",{name:"aopf",className:"form-control",rows:"2",value:this.props.aopf,onChange:this.catchInputs}))))}}]),t}(n.Component),cn=function(e){var a=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.onChangeInput(t,n)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},"Keratometria"),r.a.createElement("div",{className:"col-6"},"Retinoscopia")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fas fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"keratometriaod",maxLength:"12",className:"form-control input-xs",value:e.keratometriaod,onChange:a})),r.a.createElement("div",{className:"col-3"},r.a.createElement("i",{className:"fas fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"keratometriaoi",maxLength:"12",className:"form-control input-xs",value:e.keratometriaoi,onChange:a})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"rsod",maxLength:"16",className:"form-control",value:e.rsod,onChange:a})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"rsoi",maxLength:"16",className:"form-control",value:e.rsoi,onChange:a}))))},sn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8"},r.a.createElement("label",null,"Diab\xe9tico")),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("label",null,"Fotocoagulaci\xf3n laser"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},"Fecha"),r.a.createElement("div",{className:"col-2"},"Rango de glucosa"),r.a.createElement("div",{className:"col-3"},"Ultimo examen"),r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"d_fclod",type:"checkbox",className:"custom-control-input",id:"d_fclod",checked:this.props.d_fclod,onChange:this.catchInputs}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"d_fclod"},r.a.createElement("i",{className:"fa fa-eye"})," Derecho"))),r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"d_fcloi",type:"checkbox",className:"custom-control-input",id:"d_fcloi",checked:this.props.d_fcloi,onChange:this.catchInputs}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"d_fcloi"},r.a.createElement("i",{className:"fa fa-eye"})," Izquierdo")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("input",{type:"date",name:"d_time",className:"form-control",value:this.props.d_time,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("input",{type:"text",name:"d_media",className:"form-control",value:this.props.d_media,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("input",{type:"date",name:"d_test",className:"form-control",value:this.props.d_test,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("input",{type:"text",name:"d_fclod_time",className:"form-control",value:this.props.d_fclod_time,onChange:this.catchInputs,readOnly:this.props.d_fclod?"":"readonly"})),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("input",{type:"text",name:"d_fcloi_time",className:"form-control",value:this.props.d_fcloi_time,onChange:this.catchInputs,readOnly:this.props.d_fcloi?"":"readonly"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Oftalmoscopia"),r.a.createElement("textarea",{name:"oftalmoscopia",className:"form-control",value:this.props.oftalmoscopia,onChange:this.catchInputs}))))}}]),t}(n.Component),mn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},"Capacidad visual")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"cvod",maxLength:"12",className:"form-control",value:this.props.cvod,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"cvoi",maxLength:"12",className:"form-control",value:this.props.cvoi,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col-md-6"},"Agudeza visual (Sin lentes)"),r.a.createElement("div",{className:"col-md-6"},"Agudeza visual (con la graduaci\xf3n anterior)")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"avslod",maxLength:"12",className:"form-control",value:this.props.avslod,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"avsloi",maxLength:"12",className:"form-control",value:this.props.avsloi,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"text",name:"avcgaod",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaod,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"text",name:"avcgaoi",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaoi,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},"Agudeza visual final")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"avfod",maxLength:"12",className:"form-control",value:this.props.avfod,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"avfoi",maxLength:"12",className:"form-control",value:this.props.avfoi,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("i",{className:"fa fa-eye"}),r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Ambos"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"avf2o",maxLength:"25",className:"form-control",value:this.props.avf2o,onChange:this.catchInputs}))))}}]),t}(n.Component),dn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"}),r.a.createElement("div",{className:"col-md-6"},"Tensi\xf3n ocular")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},"Diagnostico",r.a.createElement("select",{name:"diagnostico",className:"form-control",value:this.props.diagnostico,onChange:this.catchInputs},r.a.createElement("option",{value:"Emetrope"},"Em\xe9trope"),r.a.createElement("option",{value:"hipermetropia"},"Hipermetrop\xeda"),r.a.createElement("option",{value:"hipermetropia-astigmatismo"},"Hipermetrop\xeda y astigmatismo"),r.a.createElement("option",{value:"hipermetropia-miopia"},"Hipermetrop\xeda y miop\xeda"),r.a.createElement("option",{value:"astigmatismo-regla"},"Astigmatismo con la regla"),r.a.createElement("option",{value:"astigmatismo-contra-regla"},"Astigmatismo contra la regla"),r.a.createElement("option",{value:"astigmatismo-oblicuo"},"Astigmatismo oblicuo"),r.a.createElement("option",{value:"astigmatismo-miopia"},"Astigmatismo/m\xedopico"),r.a.createElement("option",{value:"miopia"},"Miop\xeda"))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"custom-control custom-switch"},r.a.createElement("input",{name:"presbicie",type:"checkbox",className:"custom-control-input",id:"presbicie",checked:this.props.presbicie,onChange:this.catchInputs}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"presbicie"},"Presbicie"))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Derecho"),r.a.createElement("input",{type:"number",name:"piod",min:"0",max:"40",step:"1",className:"form-control",value:this.props.piod,onChange:this.catchInputs})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("i",{className:"fa fa-eye"})," ",r.a.createElement("label",null,"Izquierdo"),r.a.createElement("input",{type:"number",name:"pioi",min:"0",max:"40",step:"1",className:"form-control",value:this.props.pioi,onChange:this.catchInputs}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Tratamiento oftalmico"),r.a.createElement("textarea",{name:"txoftalmico",className:"form-control",value:this.props.txoftalmico,onChange:this.catchInputs}))))}}]),t}(n.Component),un=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){var t=a.target.name,n="checkbox"===a.target.type?a.target.checked:a.target.value.toLowerCase();e.props.onChangeInput(t,n)},e}return Object(nt.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"observaciones"},"Observaciones"),r.a.createElement("textarea",{name:"observaciones",id:"observaciones",className:"form-control",value:this.props.observaciones,onChange:this.catchInputs}))}}]),t}(n.Component),pn={_getListContacts:He.getListContacts,_setContact:He.setContact,_setListContact:He.setListContact},hn=Object(at.b)((function(e){return{contacts:e.contact.list}}),pn)((function(e){var a,t=e.contact,o=e.readOnly,l=e.title,c=void 0===l?"Contacto":l,s=e.contacts,i=e.handleChangeContact,m=e._getListContacts,d=e._setListContact,u=Object(n.useState)(""),p=Object(jt.a)(u,2),h=p[0],g=p[1],f=/.*@domain(.com)?/gim,E=new Date(null!==(a=t.f_nacimiento)&&void 0!==a?a:new Date),v=it()().diff(E,"years");return Object(n.useEffect)((function(){h.length>2&&m({type:0,search:h,itemsPage:20})}),[h]),r.a.createElement("div",{className:"input-group position-static"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text text-capitalize"},r.a.createElement("i",{className:"fas fa-user mr-2"})," ",c)),t.id?r.a.createElement("span",{className:"form-control text-capitalize bg-light"},t.nombre,t.email&&!f.exec(t.email)?r.a.createElement("span",{className:"badge badge-secondary mx-1"},r.a.createElement("i",{className:"fas fa-envelope mr-1"}),t.email):null,v>1?r.a.createElement("span",{className:"badge badge-secondary ml-1"},r.a.createElement("i",{className:"fas fa-calendar mr-1"}),v," a\xf1os"):null):r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"text",className:"form-control text-capitalize",value:t.id?t.email&&!f.exec(t.email)?t.nombre+" ["+t.email+"]":t.nombre:h,disabled:!!t.id,onChange:function(e){var a=e.target.value;g(a)}}),s.length?r.a.createElement("div",{className:"position-absolute overflow-auto",style:{top:"6.4rem",left:"8rem",height:"12rem",zIndex:"10",width:"100%",maxWidth:"20rem"}},r.a.createElement("ul",{className:"list-group"},s.map((function(e){return r.a.createElement("li",{key:e.id,className:"list-group-item text-capitalize"},r.a.createElement("a",{href:"#selected",className:"text-indigo",onClick:function(a){a.preventDefault(),i(e),d({result:{list:[],metaList:{}}}),g("")}},r.a.createElement("i",{className:"fas fa-user mr-1"}),e.nombre))})))):null),!o&&t.id?r.a.createElement("div",{className:"float-right"},r.a.createElement("div",{className:"btn-group btn-sm d-print-none"},r.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(){i({})},title:"Cambiar"},r.a.createElement("i",{className:"fas fa-exchange-alt"})),r.a.createElement(lt.b,{to:"/contactos/"+t.id,className:"btn btn-danger btn-sm",title:"Editar"},r.a.createElement("i",{className:"fas fa-edit"})))):null)})),gn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.esferaod,t=e.esferaoi,n=e.cilindrod,o=e.cilindroi,l=e.ejeod,c=e.ejeoi,s=e.adiciond,i=e.adicioni,m=e.adicion_media_od,d=e.adicion_media_oi,u=e.dpod,p=e.dpoi,h=e.alturaod,g=e.alturaoi,f=e.diagnostico,E=e.presbicie,v=e.paciente;return r.a.createElement("div",{className:"card d-none d-print-block"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("h4",null,"Optica Madero",r.a.createElement("br",null),r.a.createElement("small",null,"312 312 5353"))),r.a.createElement("div",{className:"col-3 text-right"},it()().format("LLL"))),r.a.createElement("div",{className:"row pt-4"},r.a.createElement("div",{className:"col text-left"},r.a.createElement("label",{className:"mr-2"},"Nombre del paciente"),r.a.createElement("span",{className:"text-uppercase"},v.nombre)),r.a.createElement("div",{className:"col left"},r.a.createElement("label",{className:"mr-2"},"Diagnostico:"),f),r.a.createElement("div",{className:"col-2 text-right"},r.a.createElement("label",{className:"mr-2"},"Presbicie:"),E?"SI":"NO")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement($t,{esferaod:a,esferaoi:t,cilindrod:n,cilindroi:o,ejeod:l,ejeoi:c,adiciond:s,adicioni:i,adicion_media_od:m,adicion_media_oi:d,dpod:u,dpoi:p,alturaod:h,alturaoi:g}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("p",{className:"card-text text-center mt-4 pt-4"},r.a.createElement("h4",null,"Julio C\xe1rdenas Martinez"),"Optometrista contactologo",r.a.createElement("br",null),"UAG",r.a.createElement("br",null),"CED PROF. 2413419"))))}}]),t}(n.Component),fn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).changeStatus=function(e){var a=e.target.checked;n.handleChangeInput("estado",a)},n.handleChangeInput=function(e,a){var t=n.state.exam;n.setState({exam:Object(s.a)(Object(s.a)({},t),{},Object(V.a)({},e,a))})},n.handleStatus=function(){n.setState({status:!n.state.status})},n.handleSave=function(e){e.preventDefault();var a=n.state,t=a.cilindrod,r=a.cilindroi,o=a.ejeod,l=a.ejeoi,c=a.paciente,s=a.exam.id,i=n.props.handleSave;if(t<0&&!o||r<0&&!l)return window.Swal.fire("Verificaci\xf3n","El campo CILINDRO esta vacio","error"),!1;window.Swal.fire({title:"Almacenamiento",text:s?"\xbfEsta seguro de actualizar el examen?":"\xbfEsta seguro de crear un nuevo examen?",icon:"question",showCancelButton:!0,confirmButtonText:s?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){if(!e.dismiss){var a=n.state.exam,t=it()().diff(c.f_nacimiento,"years");a.contact_id=c.id,a.edad=t<1||!t?0:t,a.status=a.estado,delete a.estado,a.category_id||delete a.category_id,a.category_ii||delete a.category_ii,i(s,a)}}))},n.getExam=function(){var e,a=n.props.exam;a.id&&(console.log("[Orus System] Procesando examen",a.id),n.setState({exam:a,paciente:null!==(e=a.paciente)&&void 0!==e?e:{id:0},load:!1}))},n.state={exam:{id:0},paciente:{id:0},panel:0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getExam()}},{key:"render",value:function(){var e,a,t,n,o,l,c,i,m,d,u,p,h,g,f,E,v,b,N,y,x,w,S,C,O,k,j,_,I,A,T,D,L,F,P,B,z,U,M,R,G,J,V,q,$,H,Z,W,X,Y,K,Q,ee,ae,te,ne,re,oe,le,ce,se,ie,me,de,ue,pe,he,ge,fe,Ee,ve,be,Ne,ye,xe,we=this,Se=this.state,Ce=Se.exam,Oe=Se.paciente,ke=Se.panel,je=this.props.handleClose;return r.a.createElement("div",{className:"card card-info card-outline"},r.a.createElement("div",{className:"card-header d-print-none"},r.a.createElement("h3",{className:"card-title text-info"},r.a.createElement("i",{className:"fas fa-notes-medical mr-1"}),Ce.id?r.a.createElement("label",null,"Examen ",r.a.createElement("span",{className:"badge badge-info"},"#",Ce.id)):"Nuevo examen")),r.a.createElement("div",{className:"card-body d-print-none"},r.a.createElement("div",{className:"form-group"},r.a.createElement(hn,{contact:Oe,readOnly:!!Ce.id,title:"paciente",handleChangeContact:function(e){return we.setState({paciente:e})}}),r.a.createElement("div",{className:"custom-control custom-switch mt-4"},r.a.createElement("input",{name:"estado",type:"checkbox",className:"custom-control-input",id:"estado",checked:Ce.estado,onChange:this.changeStatus}),r.a.createElement("label",{className:Ce.estado?"custom-control-label text-muted":"custom-control-label text-info",htmlFor:"estado"},r.a.createElement("i",{className:Ce.estado?"fas fa-folder":"fas fa-folder-open"}),Ce.estado?"Examen terminado":"Examen en proceso"))),Oe.id?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"nav flex-column nav-tabs"},r.a.createElement("a",{className:ke?"nav-link":"nav-link active",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:0})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Generales"),r.a.createElement("a",{className:1===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:1})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Interrogatorio"),r.a.createElement("a",{className:2===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:2})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Keratometria"),r.a.createElement("a",{className:3===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:3})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Diabetes"),r.a.createElement("a",{className:4===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:4})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Agudeza"),r.a.createElement("a",{className:5===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:5})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Diagnostico"),r.a.createElement("a",{className:6===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:6})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Graduaci\xf3n"),r.a.createElement("a",{className:7===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:7})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Observaciones"),r.a.createElement("a",{className:8===ke?"nav-link active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),we.setState({panel:8})}},r.a.createElement("i",{className:"fas fa-check-circle mr-1"}),"Recomendaciones"))),r.a.createElement("div",{className:"col-10"},ke?null:r.a.createElement(on,{pc:null!==(e=Ce.pc)&&void 0!==e?e:"",tablet:null!==(a=Ce.tablet)&&void 0!==a?a:"",movil:null!==(t=Ce.movil)&&void 0!==t?t:"",lap:null!==(n=Ce.lap)&&void 0!==n?n:"",lap_time:null!==(o=Ce.lap_time)&&void 0!==o?o:"",pc_time:null!==(l=Ce.pc_time)&&void 0!==l?l:"",tablet_time:null!==(c=Ce.tablet_time)&&void 0!==c?c:"",movil_time:null!==(i=Ce.movil_time)&&void 0!==i?i:"",cefalea:null!==(m=Ce.cefalea)&&void 0!==m?m:"",c_frecuencia:null!==(d=Ce.c_frecuencia)&&void 0!==d?d:"",c_intensidad:null!==(u=Ce.c_intensidad)&&void 0!==u?u:"",frontal:null!==(p=Ce.frontal)&&void 0!==p?p:"",temporal:null!==(h=Ce.temporal)&&void 0!==h?h:"",occipital:null!==(g=Ce.occipital)&&void 0!==g?g:"",generality:null!==(f=Ce.generality)&&void 0!==f?f:"",temporaoi:null!==(E=Ce.temporaoi)&&void 0!==E?E:"",temporaod:null!==(v=Ce.temporaod)&&void 0!==v?v:"",handleGetData:this.handleChangeInput}),1===ke?r.a.createElement(ln,{interrogatorio:null!==(b=Ce.interrogatorio)&&void 0!==b?b:"",coa:null!==(N=Ce.coa)&&void 0!==N?N:"",aopp:null!==(y=Ce.aopp)&&void 0!==y?y:"",aopf:null!==(x=Ce.aopf)&&void 0!==x?x:"",onChangeInput:this.handleChangeInput}):null,2===ke?r.a.createElement(cn,{keratometriaoi:null!==(w=Ce.keratometriaoi)&&void 0!==w?w:"",keratometriaod:null!==(S=Ce.keratometriaod)&&void 0!==S?S:"",rsoi:null!==(C=Ce.rsoi)&&void 0!==C?C:"",rsod:null!==(O=Ce.rsod)&&void 0!==O?O:"",onChangeInput:this.handleChangeInput}):null,3===ke?r.a.createElement(sn,{d_time:null!==(k=Ce.d_time)&&void 0!==k?k:"",d_media:null!==(j=Ce.d_media)&&void 0!==j?j:"",d_test:null!==(_=Ce.d_test)&&void 0!==_?_:"",d_fclod:null!==(I=Ce.d_fclod)&&void 0!==I?I:"",d_fclod_time:null!==(A=Ce.d_fclod_time)&&void 0!==A?A:"",d_fcloi:null!==(T=Ce.d_fcloi)&&void 0!==T?T:"",d_fcloi_time:null!==(D=Ce.d_fcloi_time)&&void 0!==D?D:"",oftalmoscopia:null!==(L=Ce.oftalmoscopia)&&void 0!==L?L:"",onChangeInput:this.handleChangeInput}):null,4===ke?r.a.createElement(mn,{cvod:null!==(F=Ce.cvod)&&void 0!==F?F:"",cvoi:null!==(P=Ce.cvoi)&&void 0!==P?P:"",avslod:null!==(B=Ce.avslod)&&void 0!==B?B:"",avsloi:null!==(z=Ce.avsloi)&&void 0!==z?z:"",avcgaod:null!==(U=Ce.avcgaod)&&void 0!==U?U:"",avcgaoi:null!==(M=Ce.avcgaoi)&&void 0!==M?M:"",avfod:null!==(R=Ce.avfod)&&void 0!==R?R:"",avfoi:null!==(G=Ce.avfoi)&&void 0!==G?G:"",avf2o:null!==(J=Ce.avf2o)&&void 0!==J?J:"",onChangeInput:this.handleChangeInput}):null,5===ke?r.a.createElement(dn,{diagnostico:null!==(V=Ce.diagnostico)&&void 0!==V?V:"",presbicie:null!==(q=Ce.presbicie)&&void 0!==q?q:"",piod:null!==($=Ce.piod)&&void 0!==$?$:"",pioi:null!==(H=Ce.pioi)&&void 0!==H?H:"",txoftalmico:null!==(Z=Ce.txoftalmico)&&void 0!==Z?Z:"",onChangeInput:this.handleChangeInput}):null,6===ke?r.a.createElement($t,{esferaod:null!==(W=Ce.esferaod)&&void 0!==W?W:0,esferaoi:null!==(X=Ce.esferaoi)&&void 0!==X?X:0,cilindrod:null!==(Y=Ce.cilindrod)&&void 0!==Y?Y:0,cilindroi:null!==(K=Ce.cilindroi)&&void 0!==K?K:0,ejeod:null!==(Q=Ce.ejeod)&&void 0!==Q?Q:0,ejeoi:null!==(ee=Ce.ejeoi)&&void 0!==ee?ee:0,adiciond:null!==(ae=Ce.adiciond)&&void 0!==ae?ae:0,adicioni:null!==(te=Ce.adicioni)&&void 0!==te?te:0,adicion_media_od:null!==(ne=Ce.adicion_media_od)&&void 0!==ne?ne:0,adicion_media_oi:null!==(re=Ce.adicion_media_oi)&&void 0!==re?re:0,dpod:null!==(oe=Ce.dpod)&&void 0!==oe?oe:0,dpoi:null!==(le=Ce.dpoi)&&void 0!==le?le:0,alturaod:null!==(ce=Ce.alturaod)&&void 0!==ce?ce:0,alturaoi:null!==(se=Ce.alturaoi)&&void 0!==se?se:0,lcmarca:null!==(ie=Ce.lcmarca)&&void 0!==ie?ie:0,lcgod:null!==(me=Ce.lcgod)&&void 0!==me?me:0,lcgoi:null!==(de=Ce.lcgoi)&&void 0!==de?de:0,onChangeInput:this.handleChangeInput}):null,7===ke?r.a.createElement(un,{observaciones:null!==(ue=Ce.observaciones)&&void 0!==ue?ue:"",onChangeInput:this.handleChangeInput}):null,8===ke?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(Ht,{category_id:parseInt(null!==(pe=Ce.category_id)&&void 0!==pe?pe:0),esferaod:null!==(he=Ce.esferaod)&&void 0!==he?he:"",esferaoi:null!==(ge=Ce.esferaoi)&&void 0!==ge?ge:"",cilindrod:null!==(fe=Ce.cilindrod)&&void 0!==fe?fe:"",cilindroi:null!==(Ee=Ce.cilindroi)&&void 0!==Ee?Ee:"",nameCategory:"category_id",nameItem:"item1",title:"Recomendacion principal",onChangeInput:function(e){"object"===typeof e&&we.setState({exam:Object(s.a)(Object(s.a)({},Ce),e)})},update:!0})),Ce.category_id?r.a.createElement("div",{className:"col"},r.a.createElement(Ht,{category_id:parseInt(null!==(ve=Ce.category_ii)&&void 0!==ve?ve:0),esferaod:null!==(be=Ce.esferaod)&&void 0!==be?be:"",esferaoi:null!==(Ne=Ce.esferaoi)&&void 0!==Ne?Ne:"",cilindrod:null!==(ye=Ce.cilindrod)&&void 0!==ye?ye:"",cilindroi:null!==(xe=Ce.cilindroi)&&void 0!==xe?xe:"",nameCategory:"category_ii",nameItem:"item2",title:"Recomendacion adicional",onChangeInput:function(e){"object"===typeof e&&we.setState({exam:Object(s.a)(Object(s.a)({},Ce),e)})},update:!0})):null):null)):null),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("div",{className:"btn-group d-print-none",role:"group"},r.a.createElement("a",{href:"#close",className:"btn btn-default",onClick:function(e){e.preventDefault(),je()}},r.a.createElement("i",{className:Ce.id?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),r.a.createElement("strong",null,Ce.id?"Cerrar":"Cancelar")),r.a.createElement("button",{className:"btn btn-default",onClick:function(e){e.preventDefault(),window.print()}},r.a.createElement("i",{className:"fas fa-print mr-2"}),"Imprimir"),r.a.createElement("button",{type:"button",className:Oe.id?"btn btn-info":"btn btn-info disabled",onClick:this.handleSave,disabled:Oe.id?"":"disabled"},r.a.createElement("i",{className:"fas fa-save mr-1"}),r.a.createElement("strong",null,"Guardar"))),r.a.createElement(gn,{esferaod:Ce.esferaod,esferaoi:Ce.esferaoi,cilindrod:Ce.cilindrod,cilindroi:Ce.cilindroi,ejeod:Ce.ejeod,ejeoi:Ce.ejeoi,adiciond:Ce.adiciond,adicioni:Ce.adicioni,adicion_media_od:Ce.adicion_media_od,adicion_media_oi:Ce.adicion_media_oi,dpod:Ce.dpod,dpoi:Ce.dpoi,alturaod:Ce.alturaod,alturaoi:Ce.alturaoi,lcmarca:Ce.lcmarca,lcgod:Ce.lcgod,lcgoi:Ce.lcgoi,diagnostico:Ce.diagnostico,paciente:Oe,presbicie:Ce.presbicie})))}}]),t}(n.Component),En=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleSaveExam=function(e,a){var t=n.state.options;(0,n.props._saveExam)({id:e,options:t,data:a}),n.handleCloseEdit()},n.handleCloseEdit=function(){n.setState({newOrEdit:!1,exam:{},examSelected:"",load:!0}),n.props.history.push("/consultorio")},n.handleEditItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=n.state.examSelected,t=n.props.exams,r=null!==e&&void 0!==e?e:a,o=t.filter((function(e){return e.id===r}));o.length?(console.log("[Orus System] Editar usuario",r),n.setState({exam:o[0],newOrEdit:!0,examSelected:r}),n.props.history.push("/consultorio/".concat(r))):(n.setState({newOrEdit:!1,exam:{},examSelected:"",load:!0}),n.props.history.push("/consultorio"))},n.handleSetSelectOptions=function(e){var a=e.target,t=a.name,r=a.value,o=n.state.options,l=r;"itemsPage"===t&&(l=parseInt(r)),"date"===t&&(l=r||""),n.setState({options:Object(s.a)(Object(s.a)({},o),{},Object(V.a)({},t,l)),load:!0})},n.handleSearch=function(){console.log("search")},n.handleChangeCheckbox=function(e){var a=e.target,t=a.value;a.checked?n.setState({examSelected:parseInt(t)}):n.setState({examSelected:""})},n.handleSearch=function(e){var a=n.state.options;n.setState({options:Object(s.a)(Object(s.a)({},a),{},{search:e}),load:!0})},n.handleChangePage=function(e){var a=n.state.options;n.setState({options:Object(s.a)(Object(s.a)({},a),{},{page:e}),load:!0})},n.handleSync=function(){n.getExams()},n.handleDelete=function(e,a){var t=n.state,r=t.examSelected,o=t.options,l=n.props._deleteExam;if(!r)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un contacto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",r),l({id:r,options:o})),n.setState({examSelected:""})}))},n.state={newOrEdit:!1,load:!1,options:{page:1,orderby:"created_at",order:"desc",search:"",status:"",itemsPage:10,date:""},examSelected:"",exam:{}},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getExams()}},{key:"componentDidUpdate",value:function(e,a){var t=this.state.load,n=this.props.messages;a.load!==t&&!0===t&&(console.log("[Orus System] Recargando examenes"),this.getExams()),e.messages.length!==n.length&&n.length&&n.forEach((function(e){var a=e.type,t=e.text;window.Swal.fire({icon:a,title:t,showConfirmButton:"error"===a,timer:"error"!==a?1500:9e3})}))}},{key:"render",value:function(){var e=this,a=this.props,t=a.meta,n=a.loading,o=a.exams,l=this.state,c=l.newOrEdit,i=l.options,m=l.examSelected,d=l.exam;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12 col-md-2 d-print-none"},r.a.createElement("button",{className:"btn bg-info btn-block mb-3",type:"button",disabled:c,onClick:function(a){var t=e.props._setListContact;e.setState({newOrEdit:!0}),t({result:{list:[],metaList:{}}}),e.props.history.push("/consultorio/new")}},r.a.createElement("i",{className:"fas fa-plus mr-1"}),"Nuevo examen"),c?null:r.a.createElement(At,{title:"Filtros"},r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"orderby"},"Ordenar por"),r.a.createElement("select",{className:"form-control ",name:"orderby",id:"orderby",value:i.orderby,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"created_at"},"Fecha de registro"),r.a.createElement("option",{value:"updated_at"},"Fecha de modificacion"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"date"},"Fecha"),r.a.createElement("input",{type:"date",id:"date",name:"date",value:i.date?it()(i.date).format("YYYY-MM-DD"):"",className:"form-control",onChange:this.handleSetSelectOptions}),r.a.createElement("button",{type:"button",className:"btn btn-info btn-block text-bold",onClick:function(a){var t=e.state.options;e.setState({options:Object(s.a)(Object(s.a)({},t),{},{date:""}),load:!0})}},r.a.createElement("i",{className:"fas fa-trash mr-1"}),"Borrar")),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"order"},"Mostrar por"),r.a.createElement("select",{className:"form-control ",name:"order",id:"order",value:i.order,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"asc"},"Antiguos"),r.a.createElement("option",{value:"desc"},"Recientes"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"itemsPage"},"Numero de examenes"),r.a.createElement("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:i.itemsPage,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"10"},"ver 10"),r.a.createElement("option",{value:"20"},"ver 20"),r.a.createElement("option",{value:"50"},"ver 50"),r.a.createElement("option",{value:"100"},"ver 100"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"status"},"Estado"),r.a.createElement("select",{className:"form-control ",name:"status",id:"status",value:i.status,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:""},"-- Todos --"),r.a.createElement("option",{value:"1"},"Solo terminados"),r.a.createElement("option",{value:"0"},"En proceso"))))),r.a.createElement("div",{className:"col-sm-12 col-md-10"},c?r.a.createElement(fn,{exam:d,handleClose:this.handleCloseEdit,handleSave:this.handleSaveExam}):r.a.createElement(It,{title:"Lista de examenes",icon:"notes-medical",color:"info",loading:n,meta:t,itemSelected:m,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync},r.a.createElement("table",{className:"table table-hover table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Nombre"),r.a.createElement("th",null,"Estado"),r.a.createElement("th",null,"ESF"),r.a.createElement("th",null,"CIL"),r.a.createElement("th",null,"EJE"),r.a.createElement("th",null,"ADC"),r.a.createElement("th",null,"MED"),r.a.createElement("th",null,"DP"),r.a.createElement("th",null,"ALT"),r.a.createElement("th",null,"Realizado"))),r.a.createElement("tbody",null,o.length?r.a.createElement(r.a.Fragment,null,o.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",{className:"icheck-primary pl-2"},r.a.createElement("input",{type:"checkbox",className:"form-check-input mt-4",value:a.id,id:"exam_"+a.id,checked:m===a.id,onChange:e.handleChangeCheckbox,disabled:a.estado}),r.a.createElement("label",{htmlFor:"exam_"+a.id,className:"sr-only"})),r.a.createElement("td",{className:"mailbox-name text-capitalize text-truncate"},r.a.createElement("a",{href:"#edit",onClick:function(t){t.preventDefault(),e.handleEditItem(a.id)}},r.a.createElement("span",{className:a.estado?"text-muted":"text-dark text-bold"},r.a.createElement("i",{className:"fas fa-user text-sm mr-2"}),a.paciente.nombre))),r.a.createElement("td",{className:"text-center",style:{cursor:"pointer"},onClick:function(t){return e.handleSaveExam(a.id,{contatc_id:a.paciente.id,status:!a.estado})}},a.estado?r.a.createElement("i",{className:"fas fa-clipboard-check text-muted",title:"Terminado"}):r.a.createElement("i",{className:"fas fa-clipboard text-info",title:"En proceso"})),r.a.createElement("td",null,a.esferaod,"/",a.esferaoi),r.a.createElement("td",null,a.cilindrod,"/",a.cilindroi),r.a.createElement("td",null,a.ejeod,"/",a.ejeoi),r.a.createElement("td",null,a.adiciond,"/",a.adicioni),r.a.createElement("td",null,a.adicion_media_od,"/",a.adicion_media_oi),r.a.createElement("td",null,a.dpod,"/",a.dpoi),r.a.createElement("td",null,a.alturaod,"/",a.alturaoi),r.a.createElement("td",null,it()(a.created_at).fromNow()))}))):r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center text-muted",colSpan:"12"},"No hay examenes registrados")))))))}},{key:"getExams",value:function(){(0,this.props._getListExams)({options:this.state.options}),this.setState({load:!1})}}]),t}(n.Component),vn={_getListExams:ua.getListExam,_deleteExam:ua.deleteExam,_setListContact:He.setListContact,_saveExam:ua.saveExam},bn=Object(at.b)((function(e){var a=e.exam;return{exams:a.list,messages:a.messages,meta:a.metaList,loading:a.loading}}),vn)(En),Nn=function(e){switch(e.status){case 0:return r.a.createElement("span",{className:"text-warning text-uppercase"},"En proceso");case 1:return r.a.createElement("span",{className:"text-info text-uppercase"},"En laboratorio");case 2:return r.a.createElement("span",{className:"text-primary text-uppercase"},"Bicelaci\xf3n");case 3:return r.a.createElement("span",{className:"text-success text-uppercase"},"Terminado");case 4:return r.a.createElement("span",{className:"text-info text-uppercase"},"Entregado");default:return r.a.createElement("span",{className:"text-secondary text-uppercase"},"Garantia")}},yn=function(e){var a=e.pedidos,t=e.editId,n=e.handleDeleteOrder,o=e.handleSelectOrder;return r.a.createElement("table",{className:"table table-hover table-striped"},r.a.createElement("tbody",null,a.length?a.map((function(e){return r.a.createElement("tr",{key:e.id,className:t.length&&t.indexOf(e.id)>=0?"table-dark":""},r.a.createElement("td",null,r.a.createElement("div",{className:"icheck-primary"},e.nota?null:r.a.createElement("button",{className:"btn btn-default btn-sm",onClick:function(a){a.preventDefault(),n(e.id)}},r.a.createElement("i",{className:"fas fa-trash"})))),r.a.createElement("td",{className:"mailbox-name",style:{cursor:"pointer"}},r.a.createElement("a",{href:"#edit",onClick:function(a){a.preventDefault(),o(e.id)}},r.a.createElement("div",{className:"w-100"},r.a.createElement("span",{className:"badge badge-warning"},e.id)),r.a.createElement("label",{className:"p-1 text-dark text-capitalize",style:{cursor:"pointer"}},e.paciente.nombre,r.a.createElement("i",{className:"ml-1 fas fa-pencil-alt text-secondary"})))),r.a.createElement("td",{className:"mailbox-subject text-uppercase"},r.a.createElement(Nn,{status:e.estado}),r.a.createElement("br",null),1===e.estado?r.a.createElement("div",null,r.a.createElement("span",{className:"mr-1 text-dark"},e.laboratorio?e.laboratorio.nombre:"Sin asignar"),e.laboratorio?"/ "+e.folio_lab:""):2===e.estado?r.a.createElement("small",null,e.caja?"CAJA: "+e.caja:"Caja no asignada"):e.estado?e.estado>=3?r.a.createElement("small",null,"Perdido terminado"):"--":r.a.createElement("small",null,e.examen?"Terminado"===e.examen.estado?"Examen completado":"Examen no realizado":"Examen no asignado")),r.a.createElement("td",{className:"mailbox-attachment"},r.a.createElement("label",{className:"w-100 m-0 p-0"},"Nota: "),e.nota?r.a.createElement(lt.b,{to:"/notas/registro/"+e.nota.id},r.a.createElement("span",{className:"badge badge-success"},e.nota.id)):"--"),r.a.createElement("td",{className:"mailbox-date"},r.a.createElement("label",null,"Registrado:"),r.a.createElement("br",null),it()(e.created_at).format("ll")))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))},xn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleSearchErase=function(){(0,n.props.handleSearchOrdes)(""),n.setState({search:""})},n.handleSearchOrder=function(){var e=n.props.handleSearchOrdes,a=n.state.search;n.timeSearch&&clearTimeout(n.timeSearch),e(a)},n.handleChangeSearchInput=function(e){var a=e.target.value;n.setState({search:a})},n.state={search:""},n.timeSearch=null,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.searchText;e&&this.setState({search:e})}},{key:"componentDidUpdate",value:function(e,a){var t=this,n=this.state.search;a.search!==n&&n.length>3&&(this.timeSearch&&clearTimeout(this.timeSearch),this.timeSearch=setTimeout((function(){t.handleSearchOrder()}),1e3))}},{key:"render",value:function(){var e=this,a=this.props,t=a.editId,n=a.orders,o=void 0===n?[]:n,l=a.meta,c=void 0===l?{}:l,s=a.loading,i=a.handlePageOrder,m=a.handleDeleteOrder,d=a.handleSelectOrder,u=this.state.search;return r.a.createElement("div",{className:"card card-warning card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title"},r.a.createElement("i",{className:"mr-1 fas fa-clipboard-list"}),"Listado de pedidos"),r.a.createElement("div",{className:"card-tools"},r.a.createElement("div",{className:"input-group input-group-sm position-relative"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Buscar pedido",value:u,onChange:this.handleChangeSearchInput,onKeyPress:function(a){"Enter"===a.key&&e.handleSearchOrder()}}),r.a.createElement("div",{className:"position-absolute",style:{top:5,left:-20,color:"#ced4da"}},r.a.createElement("i",{className:"fas fa-search"})),u.length>2?r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"btn btn-secondary",onClick:this.handleSearchErase},r.a.createElement("i",{className:"fas fa-window-close"}))):null))),r.a.createElement("div",{className:"p-0 card-body table-responsive"},r.a.createElement("div",{className:"mailbox-controls"},r.a.createElement("div",{className:"float-right"},r.a.createElement(yt,{meta:c,handleChangePage:i}))),r.a.createElement(yn,{pedidos:o,editId:t,handleDeleteOrder:m,handleSelectOrder:d})),s?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null)}}]),t}(n.Component),wn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeValue=function(e){var a=e.target,t=a.name,r=a.value,o=a.type,l=r;console.log(t,r),"text"!==o&&"email"!==o||(l=r.toLowerCase()),n.setState(Object(V.a)({},t,l))},n.handleSave=function(e){e.preventDefault();var a=n.state,t=a.name,r=a.t_movil;return console.log("Verificacion",t.length,r.length),t.length<5?(window.Swal.fire("Verificacion","El nombre del paciente no es correcto","warning"),!1):10!==r.length?(window.Swal.fire("Verificacion","El numero telefonico no es correcto","warning"),!1):void window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear un nuevo contacto?",icon:"question",showCancelButton:!0,confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.name,r=a.birthday,o=a.t_movil,l=a.email,c=a.host,s=a.token,i={name:t,email:l||t.replace(/\s/g,"")+r.replace(/-/g,"").replace(/\//g,"")+"@domain",type:0,birthday:r,business:0,domicilio:JSON.stringify({calle:"",colonia:"",municipio:"Colima",estado:"Colima",cp:"28000"}),telnumbers:JSON.stringify({t_casa:"",t_oficina:"",t_movil:o})},m="http://"+c+"/api/contacts";return console.log("Enviando datos del contacto a la API"),fetch(m,{method:"POST",body:JSON.stringify(i),signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch: ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Contacto almacenado"),localStorage.setItem("OrusContactNew",JSON.stringify({})),localStorage.setItem("OrusContactInUse",JSON.stringify({id:a.data.id})),window.Swal.fire({icon:"success",title:"Contacto almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){n.props.setContac(a.data.id,a.data.birthday)}))):(window.Swal.fire("Error","al almacenar el contacto","error"),console.error("Orus res: ",a.message))}}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={name:"",t_movil:"",birthday:"",email:"",host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.name;e&&this.setState({name:e})}},{key:"componentDidUpdate",value:function(e,a){e.name!==this.props.name&&this.props.name!==this.state.name&&this.setState({name:this.props.name})}},{key:"render",value:function(){var e=this.state,a=e.name,t=e.t_movil,n=e.birthday,o=e.email;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Nuevo paciente"),r.a.createElement("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre del paciente",name:"name",autoComplete:"off",required:"required",pattern:"^[a-zA-Z.]{2,20}[\\s]{1}[a-zA-Z.]{2,20}.*",minLength:"8",value:a,onChange:this.changeValue})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Telefono celular"),r.a.createElement("input",{type:"tel",placeholder:"Telefono celular",className:"form-control",name:"t_movil",pattern:"^[\\d]{10}$",maxLength:"10",value:t,onChange:this.changeValue})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"E-mail"),r.a.createElement("input",{type:"email",className:"form-control",name:"email",value:o,onChange:this.changeValue})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Fecha de naciemiento"),r.a.createElement("input",{type:"date",className:"form-control",name:"birthday",value:n,onChange:this.changeValue})),r.a.createElement("div",{className:"form-group text-right"},r.a.createElement("button",{className:"btn btn-danger",onClick:this.handleSave},"Registrar")))}}]),t}(n.Component),Sn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).getContact=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){console.log("Descargando contacto"),n.setState({dataContact:e.data,load:!1})})).catch((function(e){console.log(e)}))},n.handleClickChange=function(e){e.preventDefault(),window.confirm("\xbfEsta seguro?")&&(n.setState({contacto:"",data:[],dataContact:{}}),console.log("[Contact][search] Eliminando datos local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),n.props.getIdContact(0))},n.handleClickContact=function(e,a){e&&e.preventDefault(),n.state.data.map((function(e){if(e.id===a){n.setState({contacto:"",data:[],dataContact:e});var t=1*it()(e.f_nacimiento).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");return n.props.getIdContact(a,t),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({id:a})),!1}return!0}))},n.getContacts=function(e){n.state.load||n.setState({load:!0}),n.timeSave&&clearTimeout(n.timeSave),n.timeSave=setTimeout((function(){var a=JSON.parse(localStorage.getItem("OrusSystem")),t="http://"+a.host+"/api/contacts",r=e?"&search=".concat(e):"";console.log("Descargando contactos de la API"),fetch(t+"?page=1&itemsPage=4"+r+"&type=0",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(a){a.data&&a.data.length?(console.log("Mostrando informaci\xf3n del contacto"),n.setState({data:a.data,load:!1})):(n.setState({data:[{id:0,nombre:"No hay contactos para: "+e}],load:!1}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({name:e.toLowerCase()})))})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}),1500)},n.handleSearcContact=function(e){var a=e.target,t=a.name,r=a.value,o=a.type,l=r;"number"===o&&(l=parseInt(r)),"text"===o&&(l=r.toLowerCase()),n.setState(Object(V.a)({},t,l))},n.state={contacto:"",data:[],dataContact:{},load:!1,edad:0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.contact;e?this.getContact(e):this.contactInput.focus()}},{key:"componentDidUpdate",value:function(e,a){a.contacto!==this.state.contacto&&(this.state.contacto.length>2?this.getContacts(this.state.contacto):this.setState({data:[]})),e.contact!==this.props.contact&&this.props.contact&&(this.setState({load:!0}),this.getContact(this.props.contact))}},{key:"render",value:function(){var e=this,a=this.state.load;if(this.props.contact){if(this.state.dataContact&&this.state.dataContact.id){var t=this.state.dataContact,n=t.nombre,o=t.id,l=t.email;return r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-user mr-2"})," Paciente:")),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",value:l&&!/.*@domain(.com)?/gim.exec(l)?n+" ["+l+"]":n,readOnly:!0}),r.a.createElement("div",{className:"float-right"},this.props.status?null:r.a.createElement("div",{className:"btn-group btn-sm d-print-none"},r.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:this.handleClickChange,title:"Cambiar"},r.a.createElement("i",{className:"fas fa-exchange-alt"})),r.a.createElement(lt.b,{to:"/contactos/registro/"+o,className:"btn btn-danger btn-sm",title:"Editar"},r.a.createElement("i",{className:"fas fa-edit"})))))}return r.a.createElement("div",{className:"callout callout-danger"},r.a.createElement("h5",null,r.a.createElement("i",{className:"fas fa-danger"})," Error:"),"Se perdio el identificardo del cliente")}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-user mr-2"})," Paciente:")),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre del paciente",name:"contacto",autoComplete:"off",value:this.state.contacto,onChange:this.handleSearcContact,ref:function(a){e.contactInput=a}}),a?r.a.createElement("div",{className:"float-right ml-4"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):null),this.state.data.length?r.a.createElement("ul",{className:"list-group"},this.state.data.map((function(a){return r.a.createElement("li",{key:a.id,className:"list-group-item"},r.a.createElement("a",{href:"#contact",className:a.id?"text-muted text-capitalize":"text-danger text-capitalize",onClick:function(t){e.handleClickContact(t,a.id)}},r.a.createElement("i",{className:"fas fa-user mr-1"}),a.nombre),a.id?null:r.a.createElement(wn,{name:e.state.contacto,setContac:function(a,t){var n=1*it()(t).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");e.setState({contacto:"",data:[],dataContact:{}}),console.log("[searchContactLine] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),e.props.getIdContact(a,n)}}))}))):null)}}]),t}(n.Component),Cn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleClickSelect=function(e){var a=n.props.ChangeInput;console.log("[listExamsCustomer] Selecionado examen: "),a("exam",e)},n.handleNewExam=function(e){e.preventDefault(),window.Swal.fire({title:"Consultorio",text:"\xbfEsta seguro de crear un nuevo examen?",icon:"info",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o=n.props,l=o.paciente,c=o.edad,s={contact_id:l,edad:parseInt(c)};return console.log("[listExamsCustomer] Enviando datos del examen a la API"),fetch("http://"+t+"/api/exams",{method:"POST",body:JSON.stringify(s),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("[listExamsCustomer] Orus fetch: ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("[listExamsCustomer] Examen almacenado con exito"),localStorage.setItem("OrusContactNew",JSON.stringify({})),window.Swal.fire({icon:"success",title:"Examen creado con exito",showConfirmButton:!1,timer:1500}).then((function(e){n.getExams()}))):(window.Swal.fire("Error","al almacenar el examen","error"),console.error("[Orus res] ",a.message))}}))},n.getExams=function(){var e=n.state,a=e.load,t=e.host,r=e.token,o=n.props.paciente;if(o){var l="http://"+t+"/api/exams",c=n.state.page>0?"?page="+n.state.page:"?page=1",s="&paciente="+o;a||n.setState({load:!0}),console.log("[listExamsCustomer] Descargando examenes del paciente"),fetch(l+c+s+"&orderby=created_at&order=desc",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){return e.ok||(n.setState({load:!1}),console.log(e)),e.json()})).then((function(e){if(e.data){var a=!1;console.log("[listExamsCustomer] Examenes descargados con exito",e.meta.total);for(var t=0;t<e.data.length;t++){var r=e.data[t];it()(new Date).isSame(it()(r.created_at),"day")&&(a=!0)}n.setState({exams:e,load:!1,addExam:a})}}))}else n.setState({load:!1})};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={exams:{data:[],meta:{}},addExam:!1,load:!0,page:0,host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getExams()}},{key:"componentDidUpdate",value:function(e,a){a.exams&&a.exams.meta&&a.exams.meta.total!==this.state.exams.meta.total&&this.getExams()}},{key:"render",value:function(){var e=this,a=this.state,t=a.exams,n=a.load,o=a.addExam;return r.a.createElement("div",{className:"card bg-info"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",null,r.a.createElement("i",{className:"fas fa-notes-medical mr-2"})," Examenes del paciente")),r.a.createElement("div",{className:"card-body table-responsive p-0"},r.a.createElement("table",{className:"table m-0"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"\xa0"),r.a.createElement("th",{scope:"col"},"Folio"),r.a.createElement("th",{scope:"col"},"Registro"),r.a.createElement("th",{scope:"col"},"Estado"))),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):t.meta&&t.meta.total?t.data.map((function(a){return r.a.createElement("tr",{key:a.id,className:it()(new Date).isSame(it()(a.created_at),"day")?"table-active":""},r.a.createElement("td",null,r.a.createElement("div",{className:"icheck-primary"},r.a.createElement("input",{type:"checkbox",name:"exam_"+a.id,id:"exam_"+a.id,onChange:function(t){return e.handleClickSelect(a)},disabled:!a.estado}),r.a.createElement("label",{htmlFor:"exam_"+a.id}))),r.a.createElement("th",{scope:"row"},r.a.createElement("span",{className:"text"},"#",a.id)),r.a.createElement("td",null,r.a.createElement("i",{className:"fas fa-clock mr-2"}),it()(a.created_at).fromNow()),r.a.createElement("td",null,a.estado?r.a.createElement("span",{className:"badge badge-success"},r.a.createElement("i",{className:"fas fa-check"})," Terminado"):r.a.createElement("span",{className:"badge badge-secondary"},r.a.createElement("i",{className:"fas fa-hourglass"})," Activo")))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"5",className:"text-center"},r.a.createElement("i",{className:"fas fa-info-circle mr-2"}),"Paciente sin examenes encontrados"))))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"btn btn-default btn-sm",onClick:this.getExams},r.a.createElement("i",{className:"fas fa-sync mr-1"})," Recargar"),r.a.createElement("button",{className:"btn btn-default btn-sm",onClick:function(a){return e.props.ChangeInput("exam",{id:0})}},r.a.createElement("i",{className:"fas fa-file-excel mr-1"})," Sin examen"),r.a.createElement("button",{className:"btn btn-default btn-sm",onClick:this.handleNewExam,disabled:o},r.a.createElement("i",{className:"fas fa-file-alt mr-1"})," Nuevo"))))}}]),t}(n.Component),On=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleDataExam=function(e,a){var t=n.state.exam;t[e]=a,n.setState({exam:t}),(0,n.props.ChangeInput)("codes",{})},n.handelChangeExam=function(){(0,n.props.ChangeInput)("examEdit",!1)},n.handelChangeCode=function(e){(0,n.props.ChangeInput)("codes",e)},n.handleSaveExam=function(){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de actualizar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Actualizar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.host,r=a.token,o=n.state.exam,l={esferaod:o.esferaod,esferaoi:o.esferaoi,cilindrod:o.cilindrod,cilindroi:o.cilindroi,ejeod:o.ejeod,ejeoi:o.ejeoi,adiciond:o.adiciond,adicioni:o.adicioni,adicion_media_od:o.adicion_media_od,adicion_media_oi:o.adicion_media_oi,dpod:o.dpod,dpoi:o.dpoi,alturaod:o.alturaod,alturaoi:o.alturaoi,lcmarca:o.lcmarca,lcgod:o.lcgod,lcgoi:o.lcgoi};return console.log("[examCustomer] Enviando datos del examen"),fetch("http://"+t+"/api/exams/"+o.id,{method:"PUT",body:JSON.stringify(l),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("[Orus fetch]",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value,t=n.props.ChangeInput;a.data?(console.log("[examCustomer] Examen almacenado con exito"),window.Swal.fire({icon:"success",title:"Examen actualizado con exito",showConfirmButton:!1,timer:1500}).then((function(e){t("examEdit",!1)}))):(window.Swal.fire("Error","al almacenar el pedido","error"),console.error("[Orus res] ",a.message))}}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={id:e.id?e.id:0,exam:{},load:!0,examEdit:!e.examEdit||e.examEdit,host:r.host,token:r.token},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,a=e.exam,t=e.examEdit;this.setState({exam:a,examEdit:t,load:!1})}},{key:"componentDidUpdate",value:function(e,a){e.id,this.props.id}},{key:"render",value:function(){var e=this.state,a=e.load,t=e.id,n=e.exam,o=e.examEdit;return n.id?r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body card-info"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("b",null,"Folio ",r.a.createElement("br",null),"#",n.id)),r.a.createElement("div",{className:"col"},r.a.createElement("b",null,"Fecha:"),r.a.createElement("br",null),r.a.createElement("i",{className:"fas fa-calendar mr-2"}),it()(n.created_at).format("L")),r.a.createElement("div",{className:"col"},r.a.createElement("b",null,"Estado:"),r.a.createElement("br",null),n.estado?r.a.createElement("span",{className:"badge badge-success"},r.a.createElement("i",{className:"fas fa-check"})," Terminado"):r.a.createElement("span",{className:"badge badge-secondary"},r.a.createElement("i",{className:"fas fa-hourglass"})," Activo"))),n.observaciones?r.a.createElement("div",{className:"form-group mt-2"},r.a.createElement("div",{className:"callout callout-info"},r.a.createElement("h5",{className:"text-info text-bold"},r.a.createElement("i",{className:"fas fa-info"})," Observaciones:"),n.observaciones)):null,r.a.createElement("div",{className:"row mt-2"},r.a.createElement("div",{className:"col"},r.a.createElement($t,{esferaod:n.esferaod?n.esferaod:0,esferaoi:n.esferaoi?n.esferaoi:0,cilindrod:n.cilindrod?n.cilindrod:0,cilindroi:n.cilindroi?n.cilindroi:0,ejeod:n.ejeod?n.ejeod:0,ejeoi:n.ejeoi?n.ejeoi:0,adiciond:n.adiciond?n.adiciond:0,adicioni:n.adicioni?n.adicioni:0,adicion_media_od:n.adicion_media_od,adicion_media_oi:n.adicion_media_oi,dpod:n.dpod?n.dpod:0,dpoi:n.dpoi?n.dpoi:0,alturaod:n.alturaod?n.alturaod:0,alturaoi:n.alturaoi?n.alturaoi:0,lcmarca:n.lcmarca?n.lcmarca:0,lcgod:n.lcgod?n.lcgod:0,lcgoi:n.lcgoi?n.lcgoi:0,readOnly:!o,onChangeInput:this.handleDataExam}))),o?r.a.createElement("div",{className:"text-right mt-2"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"btn btn-secondary",onClick:this.handelChangeExam},r.a.createElement("i",{className:"fas fa-times mr-1"})," Cerrar"),r.a.createElement("button",{className:"btn btn-info",onClick:this.handleSaveExam},r.a.createElement("i",{className:"fas fa-save mr-1"})," Guardar"))):null)):a?r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"text-info"},r.a.createElement("i",{className:"fas fa-info mr-2"}),"Examen [",t,"] no encontrado.")))}}]),t}(n.Component);var kn={getListStore:Ce.getListStore,setListStore:Ce.setListStore},jn=Object(at.b)((function(e){return{items:e.storeItem.list,loading:e.storeItem.loading}}),kn)((function(e){var a=e.items,t=e.loading,o=e.handleAddItem,l=e.getListStore,c=e.setListStore,i=e.handleCloseModal,m=Object(n.useState)({id:0,producto:"",cantidad:1,precio:0,out:0,inStorage:0,subtotal:0,store_items_id:0,descripcion:""}),d=Object(jt.a)(m,2),u=d[0],p=d[1],h=Object(n.useState)(""),g=Object(jt.a)(h,2),f=g[0],E=g[1],v=function(){c({result:{list:[],metaList:{}}}),p({id:0,producto:"",precio:0,out:0,cantidad:1,inStorage:0,subtotal:0,store_items_id:0,descripcion:""})},b=function(e){v(),i()},N=null;return Object(n.useEffect)((function(){!f&&N&&N.focus()})),r.a.createElement("div",{className:"modal",tabIndex:"-1",style:{display:"block"}},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title text-primary text-bold"},r.a.createElement("i",{className:"fas fa-plus mr-1"}),"Agregar producto"),r.a.createElement("button",{type:"button",className:"close",onClick:function(e){return b()}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col position-relative"},r.a.createElement("label",null,"Producto",t?r.a.createElement("small",{className:"position-absolute ml-2",style:{zIndex:"101",top:"0"}},"Buscando..."):null),r.a.createElement("input",{className:"form-control text-uppercase text-truncate",type:"text",placeholder:"Buscar produccto",autoComplete:"off",ref:function(e){N=e},value:f,onChange:function(e){var a=e.target.value;E(a.toLocaleLowerCase()),a.length>2?l({options:{page:1,orderby:"name",order:"ASC",search:a,itemsPage:25}}):a.length||v()}}),a.length&&!u.store_items_id?r.a.createElement("div",{className:"position-absolute shadow p-0 pt-2 pl-1 bg-white rounded w-100 mh-50 overflow-auto",style:{maxHeight:"18rem",zIndex:"100"}},r.a.createElement("div",{className:"list-group m-0 list-group-flush"},a.map((function(e){var a=e.cantidades>0?e.cantidades:0;return r.a.createElement("a",{key:e.id,className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(a){a.preventDefault(),p(Object(s.a)(Object(s.a)({},u),{},{store_items_id:parseInt(e.id),producto:e.producto.toString(),precio:parseFloat(e.precio),out:parseInt(e.cantidades)})),E(e.producto)}},r.a.createElement("span",{className:"text-truncate text-uppercase text-primary text-bold"},e.producto),r.a.createElement("span",{className:a?"badge badge-primary badge-pill":"badge badge-warning badge-pill"},a))})))):null),u.store_items_id?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-2"},r.a.createElement("label",null,"Cantidad"),r.a.createElement("input",{type:"number",className:"form-control",placeholder:"Cantidad",value:u.cantidad,onChange:function(e){e.preventDefault();var a=e.target.value;p(Object(s.a)(Object(s.a)({},u),{},{cantidad:parseInt(a)}))}})),r.a.createElement("div",{className:"col-3"},r.a.createElement("label",null,"Precio"),r.a.createElement("input",{type:"number",className:"form-control text-right",placeholder:"Precio",value:u.precio,onChange:function(e){e.preventDefault();var a=e.target.value;p(Object(s.a)(Object(s.a)({},u),{},{precio:parseFloat(a)}))}}))):null)),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(e){return b()}},r.a.createElement("i",{className:"fas fa-undo mr-1"}),"Cerrar"),r.a.createElement("button",{type:"button",className:"btn btn-warning btn-sm",disabled:!(u.store_items_id&&u.cantidad&&u.precio),onClick:function(e){if(e.preventDefault(),!function(){var e=!0;return u.cantidad||(e=!1,window.alert("La cantidad debe de ser un valor valido")),u.store_items_id||(e=!1,window.alert("No se selecciono un producto valido")),u.precio||(e=!1,window.alert("El precio no es valido")),e}())return!1;u.inStorage=u.out>=u.cantidad,u.out=u.out>=u.cantidad?0:u.cantidad-u.out,u.subtotal=parseFloat(u.cantidad*u.precio),o(u),b()}},r.a.createElement("i",{className:"fas fa-save mr-1"}),"Agregar"))))))})),_n=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).deleteItem=function(e){var a=n.props.items.filter((function(a){return a.store_items_id!==e}));n.props.ChangeInput("items",a)},n.handleAddItem=function(e){if(e){var a=n.props.items,t=a.findIndex((function(a){return a.store_items_id===e.store_items_id}));if(-1!==t){var r=a[t].cantidad+e.cantidad,o=e.precio,l=a[t].precio*r;a[t].precio===o?(a[t].cantidad=r,a[t].subtotal=l):a.push(e)}else a.push(e);console.log("[DEBUG] show item before add finish",e,a,t),n.props.ChangeInput("items",a)}},n.state={id:0,itemNew:!1,itemsDb:[],load:!1},n.total=0,n}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.state,t=a.itemNew,n=a.load,o=this.props,l=o.items,c=o.codes,s=o.session,i=o.status,m=void 0===i||i;return this.total=0,r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title"},r.a.createElement("i",{className:"fas fa-shopping-cart"})," Pedido"),r.a.createElement("div",{className:"card-tools"},s&&!t?r.a.createElement("button",{className:m?"btn btn-too btn-primary text-bold":"btn btn-too btn-outline-secondary disabled",disabled:!m,onClick:function(a){e.setState({itemNew:!e.state.itemNew})}},r.a.createElement("i",{className:"fas fa-plus mr-1"})," Agregar"):null)),r.a.createElement("div",{className:"card-body table-responsive p-0"},r.a.createElement("table",{className:"table table-sm m-0"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col",style:{width:64}},"Cantidad"),r.a.createElement("th",{scope:"col"},"Descripcion"),r.a.createElement("th",{scope:"col",className:"text-center",style:{width:120}},"Precio"),r.a.createElement("th",{scope:"col",className:"text-center",style:{width:120}},"Subtotal"),r.a.createElement("th",{scope:"col",style:{minWidth:"4rem",maxWidth:"8rem"}},r.a.createElement("span",{className:"sr-only"},"acciones")))),r.a.createElement("tbody",null,l.length?l.map((function(a,t){return e.total+=1*a.subtotal,r.a.createElement("tr",{key:t},r.a.createElement("td",{className:"text-right"},a.cantidad),r.a.createElement("td",{className:"text-truncate"},a.inStorage?null:r.a.createElement("i",{className:"text-warning fas fa-circle mr-1"}),a.producto,a.descripcion?" ("+a.descripcion+")":null),r.a.createElement("td",{className:"text-right"},"$ ",parseFloat(a.precio).toFixed(2)),r.a.createElement("td",{className:"text-right"},"$ ",a.subtotal.toFixed(2)),r.a.createElement("td",{className:"d-print-none text-right"},r.a.createElement("button",{className:e.props.status?"btn btn-outline-secondary btn-sm disabled":"btn btn-outline-danger btn-sm",disabled:!!e.props.status,onClick:function(t){e.props.status||e.deleteItem(a.store_items_id)}},r.a.createElement("i",{className:"fas fa-trash"}))))})):r.a.createElement("tr",null,r.a.createElement("td",{className:"text-center",colSpan:"5"},"No hay articulos cargados"))),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"text-right",colSpan:"2"}),r.a.createElement("th",{scope:"row",className:"text-right"},"Total"),r.a.createElement("td",{className:"text-right text-primary"},r.a.createElement("label",null,"$ ",this.total.toFixed(2))),r.a.createElement("td",null))))),c&&c.code?r.a.createElement("div",{className:"card-footer"},c.od===c.oi?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("label",{className:"m-2"},r.a.createElement("i",{className:"fas fa-eye"})," Graduacion"),r.a.createElement("span",{className:"text"},c.code+c.od))):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("label",{className:"m-2"},r.a.createElement("i",{className:"fas fa-eye"})," Graduacion ojo derecho"),r.a.createElement("span",{className:"text"},c.code+c.od)),r.a.createElement("div",{className:"col"},r.a.createElement("label",{className:"m-2"},r.a.createElement("i",{className:"fas fa-eye"})," Graduacion ojo izquierdo"),r.a.createElement("span",{className:"text"},c.code+c.oi)))):null,n?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null,t?r.a.createElement(jn,{handleAddItem:this.handleAddItem,handleCloseModal:function(a){e.setState({itemNew:!1})}}):null)}}]),t}(n.Component),In=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeInput=function(e,a){var t=n.props.handleGetCategories;"exam"===e&&(a.category_id&&t(a.category_id),a.id?n.setState({exam_id:a.id,exam:a,codes:{}}):n.setState({exam_id:0,exam:{},codes:{}})),"codes"===e?n.setState({codes:a}):n.setState(Object(V.a)({},e,a))},n.getCategories=function(e,a){var t=a.category_id,r=a.esferaod,o=a.esferaoi,l=a.cilindrod,c=a.cilindroi,s=a.id;console.log("[Asistent order] Recomendacion descargada");var i=t&&e.id?n.handleCodeName(e):"XX",m="+000000",d="+000000";(l||r)&&(m=r>0?"+":"",m+=r.toFixed(2).toString().replace(".","")+l.toFixed(2).toString().replace("-","").replace(".","")),(c||o)&&(d=o>0?"+":"",d+=o.toFixed(2).toString().replace(".","")+c.toFixed(2).toString().replace("-","").replace(".","")),n.setState({exam_id:s,exam:a,codes:{code:i,od:m,oi:d}})},n.handleCodeName=function(e){var a="";return e.depende_de?e.depende_de.depende_de?(a=e.depende_de.depende_de.meta.code,a+=e.depende_de.meta.code,a+=e.meta.code):(a=e.depende_de.meta.code,a+=e.meta.code):a=e.meta.code,a},n.getIdContact=function(e,a){n.setState({contact_id:e,edad:a})},n.handleSave=function(e){var a=n.props.handleSaveOrder;e.preventDefault(),window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear un nuevo pedido?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t={},r=[];n.state.items.map((function(e){return r.push({cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,session:e.session,out:e.out,descripcion:e.descripcion,store_items_id:e.store_items_id}),!1})),t={session:n.state.session,contact_id:n.state.contact_id,items:JSON.stringify(r),status:0},n.state.exam_id&&(t.exam_id=parseInt(n.state.exam_id)),a(t)}}})};var r=JSON.parse(localStorage.getItem("OrusContactInUse"));return console.log("[OrderAsitent] Contacto en uso: ",r&&r.id?"Si":"No"),n.state={session:Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10),contact_id:r&&r.id?r.id:0,items:[],codes:{},edad:0,exam_id:null,exam:{},examEdit:!1,load:!0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){localStorage.setItem("OrusContactInUse",JSON.stringify({}))}},{key:"componentDidUpdate",value:function(e,a){var t=this.props.categories;e.categories.id!==t.id&&this.getCategories(t,this.state.exam)}},{key:"render",value:function(){var e=this,a=this.state,t=a.contact_id,n=a.items,o=a.edad,l=a.exam_id,c=a.exam,s=a.examEdit,i=a.codes,m=a.session,d=this.props.loading;return r.a.createElement("div",{className:"card card-warning card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title"},r.a.createElement("i",{className:"fas fa-clipboard-list mr-1"}),"Nuevo pedido")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement(Sn,{contact:t,edad:parseInt(o),getIdContact:this.getIdContact,status:null!==l})),t?r.a.createElement(r.a.Fragment,null,null!==l?r.a.createElement(r.a.Fragment,null,s?r.a.createElement("div",{className:"form-group"},r.a.createElement(On,{id:l,examEdit:!0,exam:c,ChangeInput:this.handleChangeInput})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-notes-medical mr-1"})," ","Examen:")),r.a.createElement("input",{type:"text",className:l?c.observaciones?"form-control text-right pr-2 bg-info text-bold":"form-control text-right pr-2":"form-control text-center",value:l?c.observaciones?l+" [Revise las observaciones]":l:"Sin examen",readOnly:!0}),r.a.createElement("div",{className:"float-right"},r.a.createElement("div",{className:"btn-group btn-sm"},r.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(a){return e.handleChangeInput("exam_id",null)}},r.a.createElement("i",{className:"fas fa-exchange-alt"})),c.id?r.a.createElement("button",{type:"button",className:"btn btn-info btn-sm",onClick:function(a){return e.handleChangeInput("examEdit",!0)},disabled:s},r.a.createElement("i",{className:"fas fa-edit"})):null)))),r.a.createElement(_n,{items:n,session:m,codes:i,ChangeInput:this.handleChangeInput}))):r.a.createElement("div",{className:"form-group"},r.a.createElement(Cn,{paciente:t,edad:o,ChangeInput:this.handleChangeInput}))):null),s?null:r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"mailbox-controls text-right"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("a",{href:"#close",className:"btn btn-dark btn-sm",onClick:function(a){var t=e.props.handleChangeInput;a.preventDefault(),e.setState({contact_id:0,items:[],codes:{},edad:0,exam_id:null,exam:{},examEdit:!1}),localStorage.setItem("OrusContactInUse",JSON.stringify({})),t("panel",0)}},r.a.createElement("i",{className:"fas fa-arrow-left mr-1"}),t?"Cancelar":"Cerrar"),r.a.createElement("button",{className:t&&null!==l&&n.length?"btn btn-warning btn-sm":"btn btn-warning btn-sm disabled",onClick:this.handleSave,disabled:!t||null===l||!n.length},r.a.createElement("i",{className:"fas fa-save mr-1"})," Guardar")))),d?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null)}}]),t}(n.Component),An=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).changeInput=function(e){e.preventDefault();var a=e.target,t=a.name,r=a.value;n.props.ChangeInput(t,r)},n.getContacts=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+e.host+"/api/contacts";console.log("Descargando proveedores de la API"),fetch(a+"?page=1&type=1&business=1",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data&&(console.log("Almacenado proveedores"),n.setState({supplies:e.data}))}))},n.state={supplies:[]},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getContacts()}},{key:"render",value:function(){return r.a.createElement("div",{className:"row m-2"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-warning rounded p-2"},r.a.createElement("label",null,"Laboratorio"),r.a.createElement("select",{className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"lab_id",value:this.props.lab_id,onChange:this.changeInput},r.a.createElement("option",{value:"0"},"Seleccione un proveedor"),this.state.supplies.length?this.state.supplies.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.nombre)})):""))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-warning rounded p-2"},r.a.createElement("label",null,"Folio"),r.a.createElement("input",{type:"text",className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"npedidolab",value:this.props.npedidolab?this.props.npedidolab:"",onChange:this.changeInput}))))}}]),t}(n.Component),Tn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).changeInput=function(a){a.preventDefault();var t=a.target,n=t.name,r=t.value;"caja"===n&&(r=parseInt(r)),e.props.ChangeInput(n,r)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.status,t=e.ncaja,n=e.observaciones;return r.a.createElement("div",{className:"row m-2"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-warning rounded p-2"},r.a.createElement("label",{htmlFor:"lab"},"Caja"),r.a.createElement("input",{type:"text",className:a>2?"form-control disabled":"form-control",disabled:a>2,name:"ncaja",value:t||"",onChange:this.changeInput}))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-warning rounded p-2"},r.a.createElement("label",null,"Observaciones"),r.a.createElement("textarea",{name:"observaciones",className:a>2?"form-control disabled":"form-control",disabled:a>2,value:n||"",onChange:this.changeInput}))))}}]),t}(n.Component),Dn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleWhachExam=function(){n.setState({examShow:!n.state.examShow})},n.handleChangeInput=function(e,a){n.setState(Object(V.a)({},e,a))},n.handleSave=function(e){e.preventDefault(),window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de actualizar el pedido?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Actualizar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=n.state,t=a.id,r=a.npedidolab,o=a.ncaja,l=a.status,c=a.lab_id,i=a.observaciones,m=a.items,d=n.props.handleSaveOrder,u={},p=[];if(m.forEach((function(e){p.push(Object(s.a)(Object(s.a)({},e),{},{cant:e.cantidad,price:e.precio}))})),u={npedidolab:r,ncaja:o,status:l,observaciones:i,items:JSON.stringify(p)},c&&(u.lab_id=c),1===l&&!c&&toString(r).length)return window.Swal.fire("Verificaci\xf3n","Los campos de laboratorio estan vacios","error"),!1;if(2===l&&!o)return window.Swal.fire("Verificaci\xf3n","El numero de caja esta vacio","error"),!1;d(u,t)}}})},n.state={id:0,paciente:{},session:null,lab_id:0,npedidolab:"",observaciones:"",ncaja:0,items:[],exam:{},codes:{},status:0,created_at:null,nota:0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e,a,t,n=this.props.order;this.setState({id:n.id,paciente:n.paciente,session:n.session,lab_id:null!==(e=n.examen&&n.examen.id)&&void 0!==e?e:0,npedidolab:n.folio_lab,observaciones:n.observaciones,ncaja:n.caja,items:n.productos,exam:null!==(a=n.examen)&&void 0!==a?a:{},status:n.estado,created_at:n.created_at,nota:null!==(t=n.nota&&n.nota.id)&&void 0!==t?t:0,examShow:!1})}},{key:"render",value:function(){var e=this,a=this.state,t=a.id,n=a.paciente,o=a.session,l=a.lab_id,c=a.npedidolab,s=a.ncaja,i=a.observaciones,m=a.items,d=a.exam,u=a.codes,p=a.nota,h=a.status,g=a.created_at,f=a.examShow,E=this.props,v=E.handleDeleteOrder,b=E.loading,N=E.userRole,y=new Date(n.f_nacimiento)<new Date?it()(n.f_nacimiento):null;return r.a.createElement("div",{className:"card card-warning card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title"},r.a.createElement("i",{className:"mr-1 fas fa-clipboard-list"}),"Pedido",r.a.createElement("span",{className:"ml-1 badge badge-pill badge-warning"},t)),r.a.createElement("div",{className:"card-tools"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:0===h?"btn btn-primary btn-sm":"btn btn-default btn-sm",onClick:function(a){0!==h&&e.setState({status:0})}},"En proceso"),r.a.createElement("button",{className:1===h?"btn btn-primary btn-sm":"btn btn-default btn-sm",onClick:function(a){1!==h&&e.setState({status:1})}},"Laboratorio"),r.a.createElement("button",{className:2===h?"btn btn-primary btn-sm":"btn btn-default btn-sm",onClick:function(a){2!==h&&e.setState({status:2})}},"Bicelacion"),r.a.createElement("button",{className:3===h?"btn btn-primary btn-sm":"btn btn-default btn-sm",onClick:function(a){3!==h&&e.setState({status:3})}},"Terminado"),r.a.createElement("button",{className:4===h?"btn btn-primary btn-sm":"btn btn-default btn-sm",onClick:function(a){4!==h&&e.setState({status:4})}},"Entregado")))),r.a.createElement("div",{className:"p-0 card-body"},r.a.createElement("div",{className:"mailbox-read-info"},r.a.createElement("h5",null,r.a.createElement("i",{className:"mr-1 fas fa-user"}),r.a.createElement("span",{className:"text-capitalize"},n.nombre),N?null:r.a.createElement("span",{className:"float-right mailbox-read-time"},"Fecha de nacimiento:"," ",y?r.a.createElement(r.a.Fragment,null,y.format("LL"),r.a.createElement("label",{className:"ml-1"},"(",it()().diff(y,"years")," a\xf1os)")):"NO REGISTRADO")),r.a.createElement("h6",null,n.email?r.a.createElement("span",null,r.a.createElement("i",{className:"mr-1 fas fa-envelope"}),n.email):null,r.a.createElement("span",{className:"float-right mailbox-read-time"},"Pedido registrado ",it()(g).fromNow()))),r.a.createElement("div",{className:"text-center mailbox-controls with-border"},r.a.createElement("div",{className:"btn-group"},p?r.a.createElement(lt.b,{to:"/notas/registro/"+p,type:"button",className:"btn btn-default btn-sm text-success",title:"Ver nota: "+p},r.a.createElement("i",{className:"fas fa-cash-register"})):r.a.createElement("button",{type:"button",className:"btn btn-default btn-sm",title:"Delete",onClick:function(e){return v(t)}},r.a.createElement("i",{className:"far fa-trash-alt"})),n.telefonos&&n.telefonos.t_movil?r.a.createElement("a",{target:"_blank",href:"https://wa.me/52"+n.telefonos.t_movil,type:"button",className:"btn btn-default btn-sm",title:"Abrir WhatsApp",rel:"noopener noreferrer"},r.a.createElement("i",{className:"fas fa-mobile-alt"})):null,d.id?r.a.createElement("button",{type:"button",className:d.observaciones?"btn btn-default btn-sm text-danger":"btn btn-default btn-sm",title:f?"Cerrar examen":"Ver examen: "+it()(d.created_at).fromNow(),onClick:this.handleWhachExam},r.a.createElement("i",{className:"fas fa-notes-medical"})):null)),f?r.a.createElement("div",{className:"p-2 mailbox-read-message"},r.a.createElement(On,{id:d.id,examEdit:!1,exam:d})):null,r.a.createElement("div",{className:"p-0 mailbox-read-message"},0===h?r.a.createElement(_n,{items:m,codes:u,session:o,ChangeInput:this.handleChangeInput}):null,1===h?r.a.createElement(An,{lab_id:l,npedidolab:c,status:h,ChangeInput:this.handleChangeInput}):null,2===h?r.a.createElement(Tn,{ncaja:s,observaciones:i,status:h,ChangeInput:this.handleChangeInput}):null,h>=3?r.a.createElement("div",{className:"m-2 border rounded card border-warning"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Estado de la entrega"),r.a.createElement("div",{className:"ml-1 icheck-success d-inline"},r.a.createElement("input",{type:"checkbox",checked:3!==h,id:"checkboxSuccess1",onChange:function(a){e.handleChangeInput("status",3===h?4:3)}}),r.a.createElement("label",{htmlFor:"checkboxSuccess1"})))):null)),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"text-right mailbox-controls"},r.a.createElement("div",{className:"btn-group"},r.a.createElement("a",{href:"#close",className:"btn btn-secondary btn-sm",onClick:function(a){var t=e.props.handleChangeInput;a.preventDefault(),t("panel",0)}},r.a.createElement("i",{className:"mr-1 fas fa-undo"}),m.length?"Cerrar":"Cancelar"),r.a.createElement("button",{className:"btn btn-warning btn-sm",onClick:this.handleSave},r.a.createElement("i",{className:"mr-1 fas fa-save"})," Guardar")))),b?r.a.createElement("div",{className:"overlay dark"},r.a.createElement("i",{className:"fas fa-2x fa-sync-alt fa-spin"})):null)}}]),t}(n.Component),Ln=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleMessege=function(e){var a=e.target,t=a.value,r=a.name;n.setState(Object(V.a)({},r,t.toLowerCase()))},n.sendMessenger=function(){var e=n.state,a=e.message,t=e.load,r=e.host,o=e.token,l=n.props,c="http://"+r+"/api/messengers",s={table:l.table,idRow:l.idRow,user:"",message:a};t||n.setState({load:!0}),console.log("Enviando mensajes a la API"),fetch(c,{method:"POST",body:JSON.stringify(s),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Almacenado mensajes"),n.getMessengers()):(console.error(e.message),n.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),n.setState({load:!1})}))},n.getMessengers=function(){var e=n.state,a=e.load,t=e.host,r=e.token,o=n.props,l="http://"+t+"/api/messengers",c="&table="+o.table+"&idRow="+o.idRow;a||n.setState({load:!0}),console.log("Solicitando mensajes de la API"),fetch(l+"?page=1"+c,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Almacenado mensajes"),n.setState({messages:e.data,message:"",load:!1})):(console.error(e.message),n.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),n.setState({load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={messages:[],message:"",load:!0,host:r.host,token:r.token,user:r.idUser},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getMessengers()}},{key:"componentDidUpdate",value:function(e,a){e.pagado!==this.props.pagado&&(console.log("Recargando chat"),this.getMessengers())}},{key:"render",value:function(){var e=this.state,a=e.messages,t=e.load,n=e.message,o=e.user,l=this.props.idRow;return r.a.createElement("div",{className:"card direct-chat direct-chat-primary d-print-none"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title"},r.a.createElement("i",{className:"fas fa-comments mr-1"}),"Chat",r.a.createElement("span",{className:"badge badge-pill badge-secondary ml-1"},l))),t?r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"card-text text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):a.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"direct-chat-messages",id:"boxchat"},a.map((function(e){var a="/img/avatars/avatar5.png";return 1===e.created_user.rol&&(a="/img/avatars/avatar2.png"),e.created_user.rol||(a="/img/avatars/avatar3.png"),2===e.created_user.id&&(a="/img/avatars/avatar4.png"),r.a.createElement("div",{className:e.created_user.id===o?"direct-chat-msg right":"direct-chat-msg",key:e.id},r.a.createElement("div",{className:"direct-chat-infos clearfix"},r.a.createElement("span",{className:e.created_user.id===o?"direct-chat-name float-right":"direct-chat-name float-left"},e.created_user.name),r.a.createElement("span",{className:e.created_user.id===o?"direct-chat-timestamp float-left":"direct-chat-timestamp float-right"},it()(e.updated_at).format("lll"))),r.a.createElement("img",{className:"direct-chat-img",src:1===e.created_user.id?"/img/avatars/OrusBot.png":a,alt:"message user image1"}),r.a.createElement("div",{className:"direct-chat-text"},e.mensaje))}))))):r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"card-text text-center p-4"},r.a.createElement("h5",null,r.a.createElement("i",{className:"fas fa-comment-slash mr-1"}),"No hay mensajes aun"))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",name:"message",placeholder:"Escriba un mensaje ...",className:"form-control",value:n,onChange:this.handleMessege}),r.a.createElement("span",{className:"input-group-append"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.sendMessenger,disabled:!(n.length>5)},"Enviar")))))}}]),t}(n.Component),Fn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeInput=function(e,a){n.setState(Object(V.a)({},e,a))},n.handleSetSelectOptions=function(e){var a,t=e.target,r=n.props.getListOrder,o=n.state.options,l=t.value,c=t.name,i=l;"itemsPage"===c&&(i=parseInt(i)),"status"===c&&""!==i&&(i=parseInt(i)),r(Object(s.a)(Object(s.a)({},o),{},(a={},Object(V.a)(a,c,i),Object(V.a)(a,"page",1),a)))},n.handleSaveOrder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=n.props.saveOrder,r=n.state.options;t({order:e,id:a,options:r})},n.handleGetCategories=function(e){(0,n.props.getListCategories)({options:{},id:e})},n.handleSearchOrdes=function(e){var a=n.props.getListOrder,t=n.state.options;a(Object(s.a)(Object(s.a)({},t),{},{search:e,page:1}))},n.handlePageOrder=function(e){var a=n.props.getListOrder,t=n.state.options;a(Object(s.a)(Object(s.a)({},t),{},{page:e}))},n.handleSelectOrder=function(e){(0,n.props.setStateVar)({key:"orderId",val:parseInt(e)})},n.handleDeleteOrder=function(e){var a=n.props.deleteOrder,t=n.state.options;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el pedido numero "+e+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(n){n&&a({id:e,options:t})}})},n.handleShowPanel=function(e,a){e.preventDefault(),n.setState({panel:a})},n.state={panel:0,order:{},update:!1,editId:[],options:{page:1,orderby:"updated_at",order:"desc",search:"",status:"",itemsPage:10}},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.options,a=this.props,t=a.getListOrder,n=a.match.params.id;t(e,parseInt(n))}},{key:"componentDidUpdate",value:function(e,a){var t=this.props,n=t.orderId,r=t.status,o=t.page,l=t.search,c=t.orderby,s=t.order,i=t.itemsPage,m=t.orders,d=t.errors,u=t.messages,p=t.getListOrder,h=t.setStateVar,g=this.state,f=g.options,E=g.panel;if(a.panel!==E)switch(E){case 1:case 2:break;case 3:this.props.history.push("/pedidos/".concat(n));break;default:e.status===r&&e.search===l&&e.orderby===c&&e.page===o&&e.order===s&&p(f),n&&(h({key:"orderId",val:0}),this.props.history.push("/pedidos"))}if(e.orderId!==n&&n&&m.length){var v={};m.forEach((function(e){e.id===n&&(v=e)})),v.id&&this.setState({panel:3,order:v})}(e.orderId!==n&&!n||e.messages.length!==u.length&&u.length&&!d.length)&&this.setState({panel:0}),e.messages.length!==u.length&&u.length&&u.forEach((function(e){var a=e.type,t=e.text;window.Swal.fire({icon:a,title:t,showConfirmButton:"error"===a,timer:"error"!==a?1500:9e3})})),e.status===r&&e.search===l&&e.orderby===c&&e.page===o&&e.order===s&&e.itemsPage===i||this.setState({options:{page:o,orderby:c,order:s,search:l,status:r,itemsPage:i}})}},{key:"render",value:function(){var e=this,a=this.state,t=a.panel,o=a.update,l=a.editId,c=a.options,s=a.order,i=this.props,m=i.orderId,d=i.search,u=i.orders,p=i.meta,h=i.loading,g=i.categories,f=void 0===g?{}:g,E=i.userRole,v=void 0===E?null:E,b=null;switch(t){case 1:b=r.a.createElement("div",{className:"text-center"},"Cargando examenes");break;case 2:b=r.a.createElement(In,{categories:f,loading:h,handleChangeInput:this.handleChangeInput,handleGetCategories:this.handleGetCategories,handleSaveOrder:this.handleSaveOrder});break;case 3:b=r.a.createElement(Dn,{orderId:m,order:s,loading:h,userRole:v,handleSaveOrder:this.handleSaveOrder,handleChangeInput:this.handleChangeInput,handleDeleteOrder:this.handleDeleteOrder});break;default:b=r.a.createElement(xn,{orders:u,meta:p,update:o,editId:l,options:c,searchText:d,loading:h,handleSearchOrdes:this.handleSearchOrdes,handlePageOrder:this.handlePageOrder,handleDeleteOrder:this.handleDeleteOrder,handleSelectOrder:this.handleSelectOrder})}return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-2 col-sm-12"},r.a.createElement("a",{href:"#new",className:2===t?"disabled mb-3 btn btn-secondary btn-block":"mb-3 btn btn-warning btn-block",onClick:function(a){a.preventDefault(),e.handleShowPanel(a,2)},disabled:2===t},r.a.createElement("i",{className:"mr-2 fas fa-plus"}),"Pedido nuevo"),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"card-title text-dark"},r.a.createElement("i",{className:"mr-2 fas fa-ellipsis-v"}),"Menu y filtros")),r.a.createElement("div",{className:"p-0 card-body"},r.a.createElement("ul",{className:"nav nav-pills flex-column"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"#item",className:1===t?"nav-link active":"nav-link",onClick:function(a){a.preventDefault(),e.handleShowPanel(a,1)}},r.a.createElement("i",{className:"mr-2 fas fa-notes-medical"})," Examenes sin pedido")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{href:"#item",className:t?"nav-link":"nav-link active",onClick:function(a){return e.handleShowPanel(a,0)}},r.a.createElement("i",{className:"mr-2 fas fa-clipboard-list"})," Pedidos")),t?null:r.a.createElement(n.Fragment,null,r.a.createElement("li",{className:"nav-item"},"\xa0"),r.a.createElement("li",{className:"p-2 nav-item"},r.a.createElement("label",{htmlFor:"status"},"Estado del pedido"),r.a.createElement("select",{className:"form-control ",name:"status",id:"status",value:c.status,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:""},"-- Todos --"),r.a.createElement("option",{value:"0"},"En proceso"),r.a.createElement("option",{value:"1"},"Laboratorio"),r.a.createElement("option",{value:"2"},"Bicelaci\xf3n"),r.a.createElement("option",{value:"3"},"Terminado"),r.a.createElement("option",{value:"4"},"Entregado"),r.a.createElement("option",{value:"5"},"Garantia"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"orderby"},"Ordenar por"),r.a.createElement("select",{className:"form-control ",name:"orderby",id:"orderby",value:c.orderby,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"created_at"},"Fecha de registro"),r.a.createElement("option",{value:"updated_at"},"Fecha de modificacion"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"order"},"Mostrar por"),r.a.createElement("select",{className:"form-control ",name:"order",id:"order",value:c.order,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"asc"},"Antiguos"),r.a.createElement("option",{value:"desc"},"Recientes"))),r.a.createElement("li",{className:"nav-item p-2"},r.a.createElement("label",{htmlFor:"itemsPage"},"Numero de pedidos"),r.a.createElement("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:c.itemsPage,onChange:this.handleSetSelectOptions},r.a.createElement("option",{value:"10"},"ver 10"),r.a.createElement("option",{value:"20"},"ver 20"),r.a.createElement("option",{value:"50"},"ver 50"),r.a.createElement("option",{value:"100"},"ver 100"))))))),3===t?r.a.createElement(Ln,{table:"orders",idRow:m}):null),r.a.createElement("div",{className:"col-md-10 col-sm-12"},b))}}]),t}(n.Component),Pn={setStateVar:Fa,getListOrder:Da,deleteOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:$,payload:e}},getListCategories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:he,payload:e}},saveOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:H,payload:e}}},Bn=Object(at.b)((function(e){var a=e.order,t=e.category,n=e.logging;return{orders:a.list,meta:a.metaList,orderId:a.orderId,status:a.status,page:a.page,search:a.search,orderby:a.orderby,order:a.order,itemsPage:a.itemsPage,loading:a.loading,categories:t.list,messages:a.messages,errors:a.errors,userRole:n.rol}}),Pn)(Fn),zn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).onKeyPressSearch=function(a){"Enter"===a.key&&(a.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("type",""),e.props.changeFilters("date",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(a){var t=a.target,n=t.name,r=t.value;e.props.changeFilters(n,r)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.search,t=e.type,n=e.date;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"btn-group"},r.a.createElement("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters"},r.a.createElement("i",{className:"fas fa-filter"}))),r.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"},"Busquedas"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{className:"modal-body"},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-search"}))),r.a.createElement("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: paciente o # de venta",value:a,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("label",null,"Estado"),r.a.createElement("div",{className:"input-group-prepend ml-4"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-address-book"}))),r.a.createElement("select",{className:"form-control",name:"type",value:t,onChange:this.changeFilters},r.a.createElement("option",{value:""},"Todos"),r.a.createElement("option",{value:"0"},"Adeudos"),r.a.createElement("option",{value:"1"},"Pagados"))),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("label",null,"Fecha"),r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-search"}))),r.a.createElement("input",{type:"date",name:"date",className:"form-control",value:n,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("div",{className:"btn-group btn-group-lg",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal"},r.a.createElement("i",{className:"fas fa-window-close mr-2"}),"Cancelar"),r.a.createElement("button",{type:"button",className:a||t?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean},r.a.createElement("i",{className:"fas fa-eraser mr-2"}),"Limpiar"),r.a.createElement("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal"},r.a.createElement("i",{className:"fas fa-search mr-2"}),"Buscar")))))))}}]),t}(n.Component),Un=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleFilter=function(){n.setState({load:!0,page:1})},n.onchangeSearch=function(e,a){n.setState(Object(V.a)({},e,a))},n.handleOrder=function(e){n.setState({orderby:e,order:"desc"===n.state.order?"asc":"desc",load:!0})},n.handleChangePage=function(e){n.setState({page:e,load:!0})},n.changePage=function(e){n.props.page(e)},n.handleDelete=function(e,a){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la venta de "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a){var t=n.state,r=t.host,o=t.token;return console.log("Solicitud de eliminaci\xf3n de venta por API"),fetch("http://"+r+"/api/sales/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Venta eliminada"),window.Swal.fire({icon:"success",title:"Venta eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getPedidos()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.getPedidos=function(){var e=n.state,a=e.host,t=e.token,r=e.order,o=e.orderby,l=e.search,c=e.page,s=e.type,i=e.date,m=e.load,d="http://"+a+"/api/sales",u="&orderby=".concat(o,"&order=").concat(r),p=l?"&search=".concat(l):"",h=c>0?"?page="+c:"?page=1",g=""===s?"":"&type="+s,f=""===i?"":"&date="+i;m||n.setState({load:!0}),console.log("Descargando ventas de API"),fetch(d+h+u+p+g+f,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){console.log("Descargando ventas"),n.setState({ventas:e,load:!1})}))};var r=JSON.parse(localStorage.getItem("OrusSales")),o=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={ventas:{data:[],meta:{}},load:!0,page:r?r.page:1,orderby:r?r.orderby:"created_at",order:r?r.order:"desc",search:r?r.search:"",type:r?r.type:"",date:r?r.date:"",host:o.host,token:o.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getPedidos(),console.log("[Sales] Eliminando datos de contacto en uso"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date}))}},{key:"componentDidUpdate",value:function(e,a){!1===a.load&&!0===this.state.load&&(console.log("Recargando pedidos"),this.getPedidos(),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date})))}},{key:"render",value:function(){var e=this,a=this.state,t=a.ventas,n=a.load,o=a.search,l=a.type,c=a.date;return r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-success"},r.a.createElement("i",{className:"fas fa-cash-register mr-1"}),"Listado de ventas"),r.a.createElement("div",{className:"card-tools"},r.a.createElement(lt.b,{to:"/notas/registro",className:"btn btn-outline-dark",onClick:function(a){e.changePage("/notas/registro")}},r.a.createElement("i",{className:"fas fa-plus"})),r.a.createElement(zn,{search:o,type:l,date:c,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),r.a.createElement(yt,{meta:t.meta,handleChangePage:this.handleChangePage}))),r.a.createElement("div",{className:"card-body table-responsive p-0"},r.a.createElement("table",{className:"table table-sm table-bordered table-hover"},r.a.createElement(Nt,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Folio",type:"id",filter:!0},{name:"Pedido",type:"pedido",filter:!1},{name:"Cliente"},{name:"Total",type:"total",filter:!0},{name:"Abonado"},{name:"Por pagar"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),r.a.createElement("tbody",null,n?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"10",className:"text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta"))):Object.keys(t.data).length?t.data.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-success text-capitalize"},a.id)),r.a.createElement("td",null,a.pedido?r.a.createElement("span",{className:"badge badge-warning text-capitalize"},a.pedido):"--"),r.a.createElement("td",{className:"text-uppercase"},r.a.createElement(lt.b,{to:"/notas/registro/"+a.id},r.a.createElement("span",{className:"badge badge-danger text-capitalize p-1"},a.cliente.nombre,r.a.createElement("i",{className:"fas fa-pencil-alt ml-1"})))),r.a.createElement("td",{className:"text-right"},"$ ",a.total.toFixed(2)),r.a.createElement("td",{className:"text-right"},"$ ",a.pagado.toFixed(2)),r.a.createElement("td",{className:"text-right"},a.total-a.pagado<=0?r.a.createElement("label",{className:"text-success"},r.a.createElement("i",{className:"fas fa-check"})):"$ "+(a.total-a.pagado).toFixed(2)),r.a.createElement("td",null,it()(a.updated_at).fromNow()),r.a.createElement("td",null,it()(a.created_at).format("ll")),r.a.createElement(wt,{id:a.id,item:a.cliente.nombre,delete:a.pagado?null:e.handleDelete,edit:"/notas/registro/"}))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"10",className:"text-center"},"No hay datos para mostrar"))))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement(lt.b,{to:"/notas/registro",className:"btn btn-outline-success",onClick:function(a){e.changePage("/notas/registro")}},r.a.createElement("i",{className:"fas fa-plus mr-2"}),r.a.createElement("strong",null,"Nueva venta"))))}}]),t}(n.Component),Mn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).getContact=function(e){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){console.log("Descargando contacto"),n.setState({dataContact:e.data,load:!1}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify(e.data))})).catch((function(e){console.log(e)}))},n.handleChangePage=function(e){n.props.changePage(e)},n.handleClickChange=function(e){e.preventDefault(),window.confirm("\xbfEsta seguro?")&&(n.setState({contacto:"",data:[],dataContact:{}}),console.log("[Contact][search] Eliminando datos local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),n.props.getIdContact(0))},n.handleClickContact=function(e,a){e&&e.preventDefault(),n.state.data.map((function(e){if(e.id===a){n.setState({contacto:"",data:[],dataContact:e});var t=1*it()(e.f_nacimiento).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");return n.props.getIdContact(a,t),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({id:a})),!1}return!0}))},n.getContacts=function(e){n.state.load||n.setState({load:!0}),n.timeSave&&clearTimeout(n.timeSave),n.timeSave=setTimeout((function(){var a=JSON.parse(localStorage.getItem("OrusSystem")),t="http://"+a.host+"/api/contacts",r=e?"&search=".concat(e):"";console.log("Descargando contactos de la API"),fetch(t+"?page=1&itemsPage=4"+r+"&type=0",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(a){a.data&&a.data.length?(console.log("Mostrando informaci\xf3n del contacto"),n.setState({data:a.data,load:!1})):(n.setState({data:[{id:0,nombre:"No hay contactos para: "+e}],load:!1}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({name:e.toLowerCase()})))})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}),1500)},n.handleSearcContact=function(e){var a=e.target,t=a.name,r=a.value,o=a.type,l=r;"number"===o&&(l=parseInt(r)),"text"===o&&(l=r.toLowerCase()),n.setState(Object(V.a)({},t,l))},n.state={contacto:"",data:[],dataContact:{},load:!1,edad:0},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.contact;e?this.getContact(e):this.contactInput.focus()}},{key:"componentDidUpdate",value:function(e,a){a.contacto!==this.state.contacto&&(this.state.contacto.length>2?this.getContacts(this.state.contacto):this.setState({data:[]})),e.contact!==this.props.contact&&this.props.contact&&(this.setState({load:!0}),this.getContact(this.props.contact))}},{key:"render",value:function(){var e=this,a=this.state.load;if(this.props.contact){if(a)return r.a.createElement("div",{className:"card card-danger card-outline d-print-none"},r.a.createElement("div",{className:"card-body box-profile"},r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))));if(Object.keys(this.state.dataContact).length){var t=this.state.dataContact,n=t.nombre,o=t.telefonos,l=t.domicilio,c=t.id,s=t.f_nacimiento,i=t.email,m=t.rfc,d=this.props.edad?this.props.edad+" a\xf1os":s?it()(s).fromNow():0;return console.log("[searchContactCard] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({id:c,nombre:n})),r.a.createElement("div",{className:"card card-danger card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"profile-username text-center text-capitalize"},n),"XAXX010101000"!==m?r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",{className:"text-muted text-center"},o.t_movil?r.a.createElement("span",null,"Movil: ",o.t_movil):o.t_casa?r.a.createElement("span",null,"Casa: ",o.t_casa):o.t_oficina?r.a.createElement("span",null,"Oficina: ",o.t_oficina):r.a.createElement("span",{className:"text-danger"},"Capture el telefono")),r.a.createElement("p",{className:"text-muted text-center"},l&&l.calle.length>6?l.calle:null)):null,"XAXX010101000"!==m?r.a.createElement("ul",{className:"list-group list-group-unbordered mb-3"},r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("b",{className:"mr-4"},"Edad:"),d?r.a.createElement("span",{className:"badge badge-primary badge-pill"},d.replace("hace","")):r.a.createElement("span",{className:"badge badge-warning badge-pill"},r.a.createElement("i",{className:"fas fa-ban mr-2"})," No capturado")),s?r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("b",null,"Fecha de nacimiento:"),r.a.createElement("span",{className:"badge badge-primary badge-pill"},it()(s).format("L"))):null,r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("b",null,"E-mail:"),i&&!/.*@domain(.com)?/gim.exec(i)?r.a.createElement("span",{className:"badge badge-primary badge-pill"},i):r.a.createElement("span",{className:"badge badge-warning badge-pill"},r.a.createElement("i",{className:"fas fa-ban mr-2"})," No capturado")),m.length?r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("b",null,"RFC:"),r.a.createElement("span",{className:"badge badge-primary badge-pill"},m)):null):null,this.props.status?null:r.a.createElement("div",{className:"btn-group btn-block d-print-none",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:this.handleClickChange},r.a.createElement("i",{className:"fas fa-exchange-alt mr-1"}),r.a.createElement("b",null,"Cambiar")),r.a.createElement(lt.b,{to:"/contactos/registro/"+c,className:"btn btn-danger",onClick:function(a){e.handleChangePage("/contactos/registro/")}},r.a.createElement("i",{className:"fas fa-edit mr-1"}),r.a.createElement("b",null,"Editar")))))}return null}return r.a.createElement("div",{className:"card card-danger card-outline d-print-none"},r.a.createElement("div",{className:"card-body"},r.a.createElement("label",null,"Buscar paciente"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},r.a.createElement("i",{className:"fas fa-user"}))),r.a.createElement("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre del paciente",name:"contacto",autoComplete:"off",value:this.state.contacto,onChange:this.handleSearcContact,ref:function(a){e.contactInput=a}})),this.state.data.length?r.a.createElement("ul",{className:"list-group"},this.state.data.map((function(a){return r.a.createElement("li",{key:a.id,className:"list-group-item"},r.a.createElement("a",{href:"#contact",className:a.id?"text-muted text-capitalize":"text-danger text-capitalize",onClick:function(t){e.handleClickContact(t,a.id)}},r.a.createElement("i",{className:"fas fa-user mr-1"}),a.nombre),a.id?null:r.a.createElement(wn,{name:e.state.contacto,setContac:function(a,t){var n=1*it()(t).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");e.setState({contacto:"",data:[],dataContact:{}}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),e.props.getIdContact(a,n)}}))}))):a?r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):null))}}]),t}(n.Component),Rn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).getBaks=function(){var e=n.state,a=e.host,t=e.token;console.log("[Add pay]Descargando listado de bancos"),fetch("http://"+a+"/api/config?name=bank",{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+t}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){e.meta&&e.meta.total&&(console.log("[Add pay] Listado de bancos descargado"),n.setState({listBank:e.data}))})).catch((function(e){console.error("[Orus system] ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},n.handlePay=function(e){e.preventDefault(),window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de realizar el abono?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a={metodopago:n.state.metodopago,total:n.state.total,bank_id:n.state.bank_id,auth:n.state.auth,details:n.state.details,sale_id:n.props.saleId,contact_id:n.props.contactId,order_id:n.props.order},t=JSON.parse(localStorage.getItem("OrusSystem")),r="http://"+t.host+"/api/payments";return a.bank_id||delete a.bank_id,console.log("Enviando datos del pago a API para almacenar"),fetch(r,{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(a.statusText+"("+t.message+")");case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("[abonodAdd] Abono almacenado"),n.props.handleChange(n.state.total),n.setState({metodopago:1,total:0,bank_id:0,banco:"",auth:"",details:""}),window.Swal.fire({icon:"success",title:"Abono almacenado con exito",showConfirmButton:!1,timer:1500})):(window.Swal.fire("Error","al almacenar el abono","error"),console.error("Orus res: ",a.message))}}))},n.onChangeValue=function(e){var a=e.target,t=a.name,r=a.value,o=a.type;"total"===t&&((r=parseInt(r))>n.props.pay?r=n.props.pay:r<0&&(r=0)),"metodopago"!==t&&"number"!==o||(r=parseInt(r)),"metodopago"===t&&1===r?n.setState({metodopago:1,bank_id:0,auth:"",details:""}):n.setState(Object(V.a)({},t,r))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={metodopago:1,total:0,bank_id:0,auth:"",details:"",listBank:[],token:r.token,host:r.host},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getBaks()}},{key:"componentDidUpdate",value:function(e,a){void 0!==this.state.listBank&&this.state.listBank.length||this.getBaks()}},{key:"render",value:function(){var e=this.state,a=e.listBank,t=e.metodopago,n=e.total,o=e.bank_id,l=e.auth,c=e.details;return r.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"abonos"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"},"Abono"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{className:"modal-body"},r.a.createElement("div",{className:"row mb-2"},r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Fecha"),r.a.createElement("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:it()().format("L")})),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Usuario"),r.a.createElement("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:this.props.user}))),r.a.createElement("div",{className:"row mb-2"},r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Metodo de pago"),r.a.createElement("select",{name:"metodopago",className:"custom-select",value:t,onChange:this.onChangeValue},r.a.createElement("option",{value:"1"},"Efectivo"),r.a.createElement("option",{value:"2"},"Tarjeta de debito"),r.a.createElement("option",{value:"3"},"Tarjeta de credito"),r.a.createElement("option",{value:"4"},"La marina"),r.a.createElement("option",{value:"5"},"Cheque"),r.a.createElement("option",{value:"6"},"Transferencia"),r.a.createElement("option",{value:"0"},"Otro"))),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Cantidad"),r.a.createElement("input",{type:"number",min:"0",max:this.props.pay,className:"form-control text-right",name:"total",value:n||"",onChange:this.onChangeValue}))),1!==t?r.a.createElement("div",{className:"row mb-2"},r.a.createElement("div",{className:"col"},t&&4!==t&&a&&a.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Banco"),r.a.createElement("select",{name:"bank_id",className:"custom-select text-uppercase",value:o,onChange:this.onChangeValue},r.a.createElement("option",{value:"0"},"Seleccione un banco"),a.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id,className:"text-uppercase"},e.name)})))):t?r.a.createElement("h4",null,"LA MARINA"):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Espesifique"),r.a.createElement("input",{type:"text",name:"details",className:"form-control",value:c,onChange:this.onChangeValue}))),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"N. Autorizaci\xf3n"),r.a.createElement("input",{type:"text",name:"auth",className:"form-control",value:l,onChange:this.onChangeValue}))):null),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-dark","data-dismiss":"modal"},"Cancelar"),r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:this.handlePay,"data-dismiss":"modal"},"Abonar")))))}}]),t}(n.Component),Gn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.id,t=e.client;return r.a.createElement("div",{className:"d-none d-print-block",style:{width:340},id:a},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card m-0"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h1",{className:"text-center"},r.a.createElement("center",null,r.a.createElement("strong",null,"\xd3ptica Madero"))),r.a.createElement("h3",null,r.a.createElement("em",null,"Julio Cesar Cardenas Martinez",r.a.createElement("br",null),"Tel: 312 312 5353",r.a.createElement("br",null),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col.")),r.a.createElement("hr",null),r.a.createElement("h4",{className:"text-uppercase"},t&&t.nombre?t.nombre.toUpperCase():null,r.a.createElement("br",null),t.telefonos?t.telefonos[0]?t.telefonos[0]:t.telefonos[2]:"--"))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("center",null,r.a.createElement("h2",{className:"text-center"},"Abono")))))}}]),t}(n.Component),Jn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).delete=function(e){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el abono?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a&&e){var t=JSON.parse(localStorage.getItem("OrusSystem"));return console.log("Solicitud de eliminaci\xf3n de venta por API"),fetch("http://"+t.host+"/api/payments/"+e,{method:"DELETE",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Abono eliminado"),window.Swal.fire({icon:"success",title:"Abono eliminado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getPayments()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.print=function(e,a,t){var n=document.getElementById("print_pay"),r=document.getElementById("ifmcontentstoprint").contentWindow;r.document.open(),r.document.write(n.innerHTML),r.document.write("<fieldset><h3>"),r.document.write("Fecha: "+a),r.document.write("<br/>Folio: "+t),r.document.write("<br/>Monto: $ "+e.toFixed(2)),r.document.write("</h3></fieldset>"),r.document.close(),r.focus(),r.print()},n.handleLoad=function(e){n.setState({load:e})},n.handleChange=function(e){n.setState({total:n.state.total+e}),n.getPayments()},n.SetMethodPayment=function(e){switch(e){case 1:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Efectivo");case 2:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Tarjeta debito");case 3:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Tarjeta Credito");case 4:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"La marina");case 5:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Cheque");case 6:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Transferencia");default:return r.a.createElement("span",{className:"badge badge-success text-uppercase"},"Otro")}},n.getPayments=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a="?sale="+n.props.sale;n.state.load||n.setState({load:!0}),console.log("Descargando datos de los pagos"),fetch("http://"+e.host+"/api/payments"+a+"&order=desc",{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){if(e.meta&&e.meta.total){console.log("[Payments] Almacenando abonos");for(var a=0,t=0;t<e.data.length;t++)a+=e.data[t].total;n.props.handleChange("pagado",1*a),n.setState({abonos:e.data,total:a,load:!1})}else n.setState({load:!1})}))},n.state={abonos:[],total:0,load:!0},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getPayments()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this,a=this.state,t=a.abonos,n=a.total,o=a.load,l=this.props,c=l.id,s=l.date,i=l.contact,m=l.order,d=l.pay,u=l.user,p=l.sale,h=l.cliente,g=l.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Fecha"),r.a.createElement("th",{scope:"col"},"Metodo de pago"),r.a.createElement("th",{scope:"col"},"Cantidad"),r.a.createElement("th",{scope:"col"},"Recibio"),r.a.createElement("th",{scope:"col"},"Acciones"))),r.a.createElement("tbody",null,t.length&&!o?r.a.createElement(r.a.Fragment,null,t.map((function(a){return r.a.createElement("tr",{key:a.id},r.a.createElement("td",null,it()(a.created_at).format("L")),r.a.createElement("td",null,e.SetMethodPayment(a.metodo),1!==a.metodo?r.a.createElement("span",{className:"ml-4"},a.banco?a.banco:"--"," /"," ",a.Autorizacion?a.Autorizacion:"--"):null),r.a.createElement("td",{className:"text-right"},"$ ",a.total.toFixed(2)),r.a.createElement("td",null,a.created_user),r.a.createElement("td",{className:"text-right"},it()(new Date).isSame(a.created_at,"day")?r.a.createElement("button",{className:"btn btn-black btn-sm",onClick:function(){e.delete(a.id)}},r.a.createElement("i",{className:"fas fa-trash"})):null,r.a.createElement("button",{className:"btn btn-outline-light btn-sm",onClick:function(){e.print(a.total,it()(a.created_at).format("L"),a.id)}},r.a.createElement("i",{className:"fas fa-print"}))))}))):o?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta"))):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"text-center"},"No hay abonos registrados"))),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"row",colSpan:"3",className:"text-right"},this.props.pay?r.a.createElement("a",{href:"#abonos",className:this.props.pay?"btn btn-outline-success btn-sm mr-2":"btn btn-outline-success btn-sm mr-2 disabled","data-toggle":"modal","data-target":"#abonos","aria-disabled":!this.props.pay},r.a.createElement("i",{className:"fas fa-money-bill-wave-alt"})):null,"Total: $ ",n.toFixed(2)),r.a.createElement("td",{colSpan:"2"})))),r.a.createElement(Rn,{pay:d,user:u,saleId:p,contactId:i,order:m,data:g,handleChange:this.handleChange,handleLoad:this.handleLoad}),r.a.createElement(Gn,{folio:c,date:s,contact:i,client:h,id:"print_pay"}))}}]),t}(n.Component),Vn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).getContact=function(a){var t=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+t.host+"/api/contacts/"+a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.json()})).then((function(a){console.log("Descargando contacto: data",a),e.setState({dataContact:a.data})})).catch((function(e){console.log(e)}))},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.items,t=e.descuento,n=e.total,o=e.saldo,l=e.abonado,c=e.folio,s=e.date,i=e.id,m=0,d=this.props.cliente;return r.a.createElement("div",{className:"d-none d-print-block",style:{width:340},id:i},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card m-0"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h4",{className:"text-right",style:{fontSize:28,fontFamily:"sans-serif"}},r.a.createElement("i",null,"Folio: ",r.a.createElement("strong",null,c))),r.a.createElement("h6",{className:"text-right mb-2",style:{fontSize:18,fontFamily:"sans-serif"}},r.a.createElement("strong",null,it()(s).format("LL"))),r.a.createElement("h2",{className:"text-center",style:{fontSize:54,fontFamily:"sans-serif"}},r.a.createElement("center",null,r.a.createElement("strong",null,"\xd3ptica Madero"))),r.a.createElement("h4",{className:"text-center mb-4",style:{fontSize:22,fontFamily:"sans-serif"}},r.a.createElement("em",null,"Julio Cesar Cardenas Martinez",r.a.createElement("br",null),"Tel: 312 312 5353",r.a.createElement("br",null),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col.")),r.a.createElement("h4",{className:"text-uppercase text-center mb-1",style:{fontSize:20,fontFamily:"sans-serif"}},d&&d.nombre?d.nombre:"Venta de mostrador",r.a.createElement("br",null),r.a.createElement("strong",null,r.a.createElement("em",{style:{fontSize:24}},d&&d.telefonos?d.telefonos.t_movil?d.telefonos.t_movil:d.telefonos.t_casa?d.telefonos.t_casa:d.telefonos.t_oficina:"--"))))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col text-center"},r.a.createElement("h2",{style:{fontSize:36,fontFamily:"sans-serif"}},r.a.createElement("strong",null,"Pedido")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{fontSize:26,fontFamily:"sans-serif"}},"Cant"),r.a.createElement("th",{style:{fontSize:26,fontFamily:"sans-serif"}},"Descripcion"),r.a.createElement("th",{style:{fontSize:26,fontFamily:"sans-serif"}},"Total"))),r.a.createElement("tbody",null,a.map((function(e,a){var t=parseFloat(e.cantidad*e.precio);return m+=t,r.a.createElement("tr",{key:a,className:"text-capitalize"},r.a.createElement("td",{style:{fontSize:22,fontFamily:"sans-serif"}},e.cantidad),r.a.createElement("td",{style:{fontSize:22,fontFamily:"sans-serif"}},e.producto),r.a.createElement("td",{className:"text-right",style:{fontSize:24,fontFamily:"sans-serif"}},t.toFixed(2)))}))),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"text-right",colSpan:"3"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{style:{fontSize:26,fontFamily:"sans-serif"}},"Subtotal: ",r.a.createElement("label",null,"$ ",m.toFixed(2))),r.a.createElement("h4",{style:{fontSize:26,fontFamily:"sans-serif"}},"Descuento: ",r.a.createElement("label",null,"$ ",t.toFixed(2)))):null,r.a.createElement("h4",{style:{fontSize:26,fontFamily:"sans-serif"}},"Total: ",r.a.createElement("label",null,"$ ",n.toFixed(2))),l?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{style:{fontSize:26,fontFamily:"sans-serif"}},"Abonado: ",r.a.createElement("label",null,"$ ",l.toFixed(2))),r.a.createElement("h4",{style:{fontSize:26,fontFamily:"sans-serif"}},"Saldo: ",r.a.createElement("label",null,"$ ",o.toFixed(2)))):null)))))),r.a.createElement("div",{className:"text-center"},r.a.createElement("em",{style:{fontSize:22,fontFamily:"sans-serif"}},"Armazones usados, viejos y/o resecos son responsabilidad del cliente")))}}]),t}(n.Component),qn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){var e;Object(tt.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).catchInputs=function(a){e.props.catchInputs(a)},e}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.pay,t=e.descuento,n=e.subtotal,o=e.total,l=e.pagado;return r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title mb-4"},r.a.createElement("i",{className:"fas fa-shield-alt mr-2"}),"Estado de cuenta",a?"":r.a.createElement("span",{className:"badge badge-success ml-2"},"Cuenta liquidada")),r.a.createElement("div",{className:"card-text form-group row"},r.a.createElement("label",{className:"col-6"},"Descuento"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:l?"form-control text-right text-success disabled":"form-control text-right text-success",type:"number",name:"descuento",min:"0",max:n-t,readOnly:!(a&&!l),value:t?parseInt(t):"",onChange:this.catchInputs}))),r.a.createElement("div",{className:"card-text form-group row"},r.a.createElement("label",{className:"col-6"},"Total"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control text-right text-success",type:"number",name:"total",value:o.toFixed(2),onChange:this.catchInputs,readOnly:!0}))),r.a.createElement("div",{className:"card-text row"},r.a.createElement("label",{className:"col-6 p-2"},"Abonado"),r.a.createElement("h3",{className:"col text-success p-2 text-right"},"$ ",l.toFixed(2))),r.a.createElement("div",{className:"card-text row"},r.a.createElement("label",{className:"col-6 p-2"},"Saldo"),r.a.createElement("h3",{className:"col text-success p-2 text-right"},"$ ",a.toFixed(2)))))}}]),t}(n.Component),$n=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleChangeInput=function(e,a){var t,r=0;if("items"===e)for(var o=0;o<a.length;o++)r+=a[o].cantidad*a[o].precio;else r=n.state.subtotal;n.setState((t={},Object(V.a)(t,e,a),Object(V.a)(t,"subtotal",r),t))},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value;"number"===a.type&&(r*=1),"descuento"===t&&r>=n.state.subtotal-n.state.descuento&&(r=n.state.subtotal-1),n.setState(Object(V.a)({},t,r))},n.getIdContact=function(e,a){n.setState({contact_id:e,edad:a})},n.changePage=function(e){n.props.page(e)},n.handleSave=function(e){e.preventDefault();var a=n.state.id;window.Swal.fire({title:"Almacenamiento",text:a?"\xbfEsta seguro de actualizar la venta?":"\xbfEsta seguro de crear una nueva venta?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:a?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t,r=n.state,o=r.host,l=r.token,c=a?"http://"+o+"/api/sales/"+a:"http://"+o+"/api/sales",s=a?"PUT":"POST",i=[];return n.state.items.map((function(e){return i.push({cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,out:e.out,session:e.session,store_items_id:e.store_items_id,descripcion:e.descripcion}),!1})),t={session:n.state.session,descuento:n.state.descuento,subtotal:n.state.subtotal,total:n.state.subtotal-n.state.descuento,contact_id:n.state.contact_id,order_id:n.state.order_id?n.state.order_id:"",pagado:n.state.pagado,items:JSON.stringify(i)},console.log("Enviando datos a API para almacenar"),fetch(c,{method:s,body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("Venta almacenada"),window.Swal.fire({icon:"success",title:a?"Venta actualizada con exito":"Venta almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){n.setState({id:t.data.id}),n.props.history.push("/notas/registro/".concat(t.data.id))}))):(window.Swal.fire("Error","al almacenar la venta","error"),console.error("Orus res: ",t.message))}}))},n.getSales=function(e){if(e>0){var a=n.state,t=a.host,r=a.token;console.log("Solicitando datos de pedido a la API"),fetch("http://"+t+"/api/sales/"+e,{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){if(e.message)console.error("Orus: ",e.message),window.Swal.fire("Error",e.message,"error"),n.setState({load:!1});else{var a=n.props.data.rol;console.log("Mostrando datos del pedido"),n.setState({id:e.data.id,session:e.data.session?e.data.session:n.state.session,items:e.data.productos,descuento:e.data.descuento,subtotal:e.data.subtotal,total:e.data.total,contact_id:e.data.cliente.id,cliente:e.data.cliente,usuario:e.data.created,date:e.data.created_at,status:a?1:0,order_id:e.data.pedido,pagado:e.data.pagado,load:!1})}})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),n.setState({load:!1})}))}else n.setState({load:!1})};var r=JSON.parse(localStorage.getItem("OrusContactInUse")),o=n.props.match.params.id,l=o?0:2,c=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={id:o,session:Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10),descuento:0,subtotal:0,total:0,items:[],contact_id:r&&r.id?r.id:l,cliente:{},order_id:0,status:0,usuario:"",date:Date.now(),load:!0,pagado:0,host:c.host,token:c.token},n.total=0,n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.state.id;this.getSales(e),localStorage.setItem("OrusContactInUse",JSON.stringify({}))}},{key:"render",value:function(){var e=this,a=this.state,t=a.contact_id,n=a.cliente,o=a.subtotal,l=a.descuento,c=a.pagado,s=a.items,i=a.status,m=a.id,d=a.session,u=a.load,p=a.date,h=a.order_id,g=o-(l+c),f=this.props.data,E=h?r.a.createElement(Ln,{data:f,table:"orders",idRow:h,pagado:c}):r.a.createElement(Ln,{data:f,table:"sales",idRow:m,pagado:c});return this.total=o-l,g=g>0?g:0,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row d-print-none"},r.a.createElement("div",{className:"col-3"},r.a.createElement(Mn,{contact:t,status:i,getIdContact:this.getIdContact,changePage:this.changePage})),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-body p-0"},t&&!u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row mx-2 my-4"},r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Venta"),r.a.createElement("strong",null,m||"Nuevo"))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Creador"),r.a.createElement("strong",null,this.state.usuario?this.state.usuario:this.props.data.name))),h?r.a.createElement("div",{className:"col-2"},r.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-warning mx-2"},"Pedido"),r.a.createElement("strong",null,h?r.a.createElement(lt.b,{to:"/pedidos/"+h,onClick:function(a){e.changePage("/pedidos/registro")}},h):null))):null,r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center"},r.a.createElement("span",{className:"badge badge-pill badge-success mx-2"},"Fecha"),r.a.createElement("strong",null,it()(p).format("ll"))))),r.a.createElement(_n,{items:s,status:!1,session:d,ChangeInput:this.handleChangeInput,addCancel:!!h})):u?r.a.createElement("div",{className:"text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de la venta")):r.a.createElement("div",{className:"alert alert-light"},r.a.createElement("h4",{className:"alert-heading"},"Nueva nota"),r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-user mr-1"})," Primero seleccione al cliente!"))),r.a.createElement("div",{className:"card-footer text-right"},r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement(lt.b,{to:"/notas",className:"btn btn-dark",onClick:function(a){e.changePage("/notas")}},r.a.createElement("i",{className:m?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),r.a.createElement("strong",null,m?"Regresar":"Cancelar")),r.a.createElement("button",{className:t&&s.length?"btn btn-dark":"btn btn-dark disabled",onClick:function(e){window.print()},disabled:!t||!s.length},r.a.createElement("i",{className:"fas fa-print mr-2"}),r.a.createElement("strong",null,"Imprimir")),r.a.createElement("button",{className:t&&s.length&&g?"btn btn-success":"btn btn-success disabled",onClick:this.handleSave,disabled:!(t&&s.length&&g)},r.a.createElement("i",{className:"fas fa-save mr-2"}),r.a.createElement("strong",null,"Guardar"))))),t&&m&&s.length?r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title mb-4"},r.a.createElement("i",{className:"fas fa-money-bill mr-2"}),"Ultimos Abonos"),r.a.createElement(Jn,{abonos:parseInt(c),sale:parseInt(m),contact:t,cliente:n,pay:parseInt(g),order:parseInt(h),data:f,user:this.props.data.name,handleChange:this.handleChangeInput}))):null),m&&t?r.a.createElement("div",{className:"col-3 d-print-none"},s.length?r.a.createElement(qn,{pay:g,descuento:l,subtotal:o,total:this.total,pagado:c,catchInputs:this.catchInputs}):null,E):null),r.a.createElement(Vn,{id:"print_sale",folio:h?"P-"+h:"V-"+m,date:p,items:s,descuento:l,total:this.total,saldo:g,abonado:c,contact:t,cliente:n}))}}]),t}(n.Component),Hn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).getSaleDay=function(){var e=n.state,a=e.host,t=e.token,r=e.page,o=n.props,l=o.date,c=o.user,s="http://"+a+"/api/payments",i="?date="+l,m=r>0?"&page="+r:"&page=1",d=c?"&user="+c:"";t&&a&&(console.log("[ReportPaymentsDetails] Solicitando datos a la API"),n.setState({load:!0}),fetch(s+i+d+"&itemsPage=10"+m,{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+t}}).then((function(e){if(!e.ok)throw console.log(e),new Error(e);return e.json()})).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.message){e.next=5;break}console.log("[ReportPayments] Almacenando datos de la venta del dia"),a.data&&n.setState({payments:a.data,meta:a.meta,load:!1}),e.next=6;break;case 5:throw new Error(a.message);case 6:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de procesamiento, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"}),n.setState({load:!1})})))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={host:r.host,rol:r.rol,token:r.token,payments:[],meta:{},page:1,load:!1},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay()}},{key:"componentDidUpdate",value:function(e,a){e.date===this.props.date&&e.user===this.props.user&&a.page===this.state.page||(console.log("[reportPaymentsDetails] Recarga datos"),this.getSaleDay())}},{key:"render",value:function(){var e=this,a=this.props.data,t=this.state,n=t.payments,o=t.meta,l=t.page,c=t.load;return r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-success"},a.rol?"Mis pagos del dia [Detallado]":"Pagos del dia [Detallado]")),r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Metodo"),r.a.createElement("th",null,"Cliente"),r.a.createElement("th",null,"Nota"),r.a.createElement("th",null,"Total"))),r.a.createElement("tbody",null,c?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"4",className:"text-center p-4"},r.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de pagos"))):n.length?n.map((function(e){return r.a.createElement("tr",{key:e.id,className:1===e.metodo?"text-success":""},r.a.createElement("th",{className:"text-uppercase"},e.metodoname),r.a.createElement("td",{className:"text-capitalize"},e.sale.cliente.nombre),r.a.createElement("td",null,r.a.createElement("span",{className:"badge badge-primary",alt:"Cobrado por: "+e.created_user,title:"Cobrado por: "+e.created_user},e.sale.id)),r.a.createElement("td",{className:"text-right"},"$ ",e.total.toFixed(2)))})):r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"4",className:"text-center"},r.a.createElement("h6",{className:"text-warning"},r.a.createElement("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia")))))),o.total?r.a.createElement("div",{className:"card-footer"},1===o.current_page?r.a.createElement("a",{href:"#next",onClick:function(e){return e.preventDefault()}},r.a.createElement("i",{className:"fas fa-step-backward text-dark"})):r.a.createElement("a",{href:"#next",onClick:function(a){a.preventDefault(),e.setState({page:l-1})}},r.a.createElement("i",{className:"fas fa-step-backward"}))," "+l+" / "+o.last_page+" ",o.current_page===o.last_page?r.a.createElement("a",{href:"#next",onClick:function(e){return e.preventDefault()}},r.a.createElement("i",{className:"fas fa-step-forward text-dark"})):r.a.createElement("a",{href:"#next",onClick:function(a){a.preventDefault(),e.setState({page:l+1})}},r.a.createElement("i",{className:"fas fa-step-forward"}))):null)}}]),t}(n.Component),Zn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeState=function(e){var a=e.target,t=a.value,r=a.name;"user"===r&&(t*=1),n.setState(Object(V.a)({},r,t))},n.getSaleDay=function(){var e=n.state,a=e.host,t=e.token,r=n.props,o=r.date,l=r.user,c="http://"+a+"/api/saleday",s="?date="+o,i=l?"&user="+l:"";t&&a&&(console.log("[ReportPay] Solicitando datos a la API"),fetch(c+s+i,{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error al descargar las ventas",icon:"error",confirmButtonText:"Ok"}),console.log(e)),e.json()})).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t,r,o,l,c,s,i;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.$("#donutChart").get(0).getContext("2d"),r={maintainAspectRatio:!0,responsive:!0},o=[],l=[],c=0,s=0,i={},n.char&&n.char.destroy(),a.message){e.next=14;break}if(console.log("[ReportPay] Almacenando datos de la venta del dia"),!a||!a.length){e.next=9;break}return e.next=7,a.map((function(e){return o.push(n.SetMethodPayment(e.metodopago)),l.push(e.total.toFixed(2)),1===e.metodopago&&(n.props.changeState("ventas",e.total),s=e.total),c+=e.total,null}));case 7:e.next=11;break;case 9:o=["No hay datos"],l=[100];case 11:n.setState({total:c,efectivo:s}),e.next=17;break;case 14:console.error("[ORUS] Error al cargar la venta del dia",a.message),o=["No hay datos"],l=[100];case 17:i={labels:o,datasets:[{data:l,backgroundColor:["#f56954","#00a65a","#f39c12","#00c0ef","#3c8dbc","#d2d6de","#000"]}]},n.char=new window.Chart(t,{type:"pie",data:i,options:r});case 19:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de usuario, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"})})))},n.SetMethodPayment=function(e){switch(e){case 1:return"Efectivo";case 2:return"Tarjeta debito";case 3:return"Tarjeta de credito";case 4:return"La marina";case 5:return"Cheque";case 6:return"Transferencia";default:return"Otro"}};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={host:r.host,rol:r.rol,token:r.token,total:0,efectivo:0},n.char=null,n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay()}},{key:"componentDidUpdate",value:function(e,a){e.date===this.props.date&&e.user===this.props.user||(console.log("[reportPays] Recarga datos de char"),this.getSaleDay())}},{key:"render",value:function(){var e=this.state,a=e.total,t=e.efectivo,n=e.rol,o=this.props.data;return r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-success"},o.rol?"Mis ventas del dia por metodo de pago":"Ventas del dia por metodo de pago")),r.a.createElement("div",{className:"card-body"},r.a.createElement("canvas",{id:"donutChart"}),r.a.createElement("p",null,n?null:r.a.createElement(r.a.Fragment,null,"Venta: ",r.a.createElement("strong",null,"$ ",a.toFixed(2)),r.a.createElement("br",null)),"Efectivo: ",r.a.createElement("strong",null,"$ ",t.toFixed(2)))))}}]),t}(n.Component),Wn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeState=function(e){var a=e.target,t=a.value,r=a.name;"user"===r&&(t*=1),n.setState(Object(V.a)({},r,t))},n.getSaleDay=function(){var e=n.state,a=e.host,t=e.token,r=n.props,o=r.date,l=r.user,c="http://"+a+"/api/bankdetails",s="?date="+o,i=l?"&user="+l:"";t&&a&&(console.log("Solicitando datos a la API"),n.setState({load:!0}),fetch(c+s+i,{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+t}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.message){e.next=5;break}console.log("[reportBank] Almacenando detalles bancarios",a.data),n.setState({data:a,load:!1}),e.next=6;break;case 5:throw new Error(a.message);case 6:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("[reportBank] "+e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error en la consulta, revise la conexion",icon:"error",confirmButtonText:"Ok"}),n.setState({load:!1})})))},n.getBaks=function(){var e=n.state,a=e.host,t=e.token;console.log("[reportBank] Descargando listado de bancos"),fetch("http://"+a+"/api/config?name=bank",{method:"GET",signal:n.signal,headers:{Accept:"application/json",Authorization:"Bearer "+t}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){e.meta&&e.meta.total&&(console.log("[reportBank] Listado de bancos descargado"),n.setState({listBank:e.data}))})).catch((function(e){console.error("[Orus system] ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={host:r.host,token:r.token,listBank:[],data:[],load:!1},n.char=null,n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay(),this.getBaks()}},{key:"componentDidUpdate",value:function(e,a){e.date===this.props.date&&e.user===this.props.user||(console.log("[ReportBank] Recarga datos de char"),this.getSaleDay())}},{key:"render",value:function(){var e=this.state,a=e.listBank,t=e.data,n=e.load;return r.a.createElement("div",{className:"card card-success card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-success"},"Detallado de pagos bancarios")),r.a.createElement("div",{className:"card-body"},n?r.a.createElement("div",null,r.a.createElement("div",{className:"spinner-border text-primary mr-4",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),r.a.createElement("span",{className:"font-weight-light font-italic"},"Espere cargando datos de banco")):r.a.createElement("ul",{className:"list-group"},t.length?t.map((function(e){return r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center",key:e.bank_id},r.a.createElement("label",{className:"text-uppercase"},a.map((function(a){return a.id===e.bank_id?a.name:null}))),r.a.createElement("span",{className:"badge badge-primary badge-pill"},"$ ",e.total.toFixed(2)))})):r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center"},r.a.createElement("h6",{className:"text-warning"},r.a.createElement("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia")))))}}]),t}(n.Component),Xn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).deleteAtm=function(e,a,t){t=t>0?t:-1*t,a=a?"la ENTRADA":"el EGRESO",window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar "+a+" de "+t+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){var r=n.state,o=r.host,l=r.token;if(a&&t)return console.log("Enviando datos ATM a API"),fetch("http://"+o+"/api/atms/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Entrada eliminada"),window.Swal.fire({icon:"success",title:"Entrada eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getAtms()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},n.changeState=function(e){var a=e.target,t=a.value,r=a.name;"tipo"===r&&(t*=1),n.setState(Object(V.a)({},r,t))},n.sendAtm=function(){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de agregar un movimiento a la caja?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){var a=n.state,t=a.host,r=a.token,o=a.efectivo,l=a.tipo,c={efectivo:l?o:-1*o,type:l},s="http://"+t+"/api/atms";if(e&&o)return console.log("Enviando datos ATM a API"),fetch(s,{method:"POST",body:JSON.stringify(c),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("ATM almacenado"),window.Swal.fire({icon:"success",title:"Movimiento almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return n.getAtms()}))):(window.Swal.fire("Error","al almacenar el movimiento","error"),console.error("Orus res: ",a.message))}}))},n.getAtms=function(){var e=n.state,a=e.host,t=e.token,r=n.props,o=r.date,l=r.user,c="http://"+a+"/api/atms",s="?date="+o,i=l?"&user="+l:"";console.log("Descargando datos de efectivo"),fetch(c+s+i,{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||401===e.status||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error, intentelo mas tarde",icon:"error"}),console.log(e)),e.json()})).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Almacenando datos de efectivo"),a.message){e.next=7;break}return t=0,e.next=5,a.data.map((function(e){return t+=e.efectivo,null}));case 5:n.props.changeState("caja",t),n.setState({atms:a.data,efectivo:0});case 7:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error, intentelo mas tarde",icon:"error"})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={atms:[],efectivo:0,tipo:1,host:r.host,token:r.token},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){this.getAtms()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidUpdate",value:function(e,a){e.date===this.props.date&&e.user===this.props.user||this.getAtms()}},{key:"render",value:function(){var e=this,a=this.state,t=a.atms,n=a.efectivo,o=a.tipo,l=0;return r.a.createElement("div",{className:"card card-dark card-outline"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-title text-dark"},"Movimientos de caja")),r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Hora"),r.a.createElement("th",null,"Usuario"),r.a.createElement("th",null,"Tipo"),r.a.createElement("th",null,"Monto"),r.a.createElement("th",null,"D"))),r.a.createElement("tbody",null,t.length?t.map((function(a){return l+=a.efectivo,r.a.createElement("tr",{key:a.id,className:a.efectivo>0?"text-success":"text-danger"},r.a.createElement("td",null,it()(a.created_at).format("LT")),r.a.createElement("td",null,a.created_user),r.a.createElement("td",null,a.tipo?"Ingreso":"Egreso"),r.a.createElement("td",null,"$",a.efectivo>0?a.efectivo.toFixed(2):(-1*a.efectivo).toFixed(2)),r.a.createElement("th",{className:"text-right"},r.a.createElement("a",{href:"#delete",className:"text-dark",onClick:function(t){t.preventDefault(),e.deleteAtm(a.id,a.tipo,a.efectivo.toFixed(2))}},r.a.createElement("i",{className:"fas fa-trash"}))))})):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"text-center"},"No hay datos"))),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},r.a.createElement("label",null,"Total")),r.a.createElement("td",{className:"text-right"},"$ ",l.toFixed(2)),r.a.createElement("td",null))))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-4 col-form-label"},"Efectivo"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"form-control",name:"tipo",value:o,onChange:this.changeState},r.a.createElement("option",{value:"1"},"Ingresos"),r.a.createElement("option",{value:"0"},"Egreso"))),r.a.createElement("div",{className:"col"},r.a.createElement("input",{type:"number",name:"efectivo",className:"form-control text-right",min:"0",max:"10000",value:n,onChange:this.changeState})),r.a.createElement("div",{className:"col"},r.a.createElement("button",{className:"btn btn-dark",onClick:this.sendAtm,disabled:!(n>0)},"Enviar")))))}}]),t}(n.Component),Yn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeState=function(e){var a=e.target,t=a.value,r=a.name;n.setState(Object(V.a)({},r,t)),n.props.changeState(r,t)},n.getUsers=function(){var e=n.state,a=e.host,t=e.token,r="http://"+a+"/api/users";console.log("Descargando usuarios de API"),fetch(r+"?page=1&orderby=username&order=asc&rol=10",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.ok||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error al descargar usuarios de sistema",icon:"error",confirmButtonText:"Ok"}),console.error(e)),e.json()})).then((function(e){e.message?console.error("Error en la descarga de usuarios",e.message):(console.log("Almacenando usuarios"),n.setState({users:e.data}))})).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de usuario, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"})}))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={host:r.host,token:r.token,date:it()().format("YYYY-MM-DD"),user:e.data.rol?e.data.idUser:0,users:[]},n.controller=new AbortController,n.signal=n.controller.signal,n}return Object(nt.a)(t,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this.state,a=e.date,t=e.user,n=e.users;return r.a.createElement("div",{className:"card border border-info rounded"},r.a.createElement("div",{className:"card-body bg-light"},r.a.createElement("div",{className:"row mb-4"},r.a.createElement("h5",{className:"card-title text-secondary"},"Filtros")),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col col-form-label"},"Fecha"),r.a.createElement("div",{className:"col"},r.a.createElement("input",{type:"date",name:"date",className:"form-control",value:a,onChange:this.changeState})),r.a.createElement("label",{className:"col col-form-label"},"Usuario"),r.a.createElement("div",{className:"col"},r.a.createElement("select",{name:"user",className:"form-control",value:t,onChange:this.changeState},r.a.createElement("option",{value:"0"},"Todos"),n.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})))))))}}]),t}(n.Component),Kn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.props,a=e.caja,t=e.ventas,n=a+t;return r.a.createElement("div",{className:"card border border-info rounded"},r.a.createElement("div",{className:"card-body bg-light text-right"},r.a.createElement("h5",{className:"card-title text-secondary"},"Corte de caja"),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"caja:"),r.a.createElement("br",null)," ",r.a.createElement("span",{className:"text-success"},"$",a.toFixed(2))),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Efectivo:"),r.a.createElement("br",null)," ",r.a.createElement("span",{className:"text-success"},"$",t.toFixed(2))),r.a.createElement("div",{className:"col"},r.a.createElement("label",null,"Total:"),r.a.createElement("br",null)," ",r.a.createElement("span",{className:"text-success"},"$",n.toFixed(2))))))}}]),t}(n.Component),Qn=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).changeState=function(e,a){n.setState(Object(V.a)({},e,a))};var r=JSON.parse(localStorage.getItem("OrusSystem"));return n.state={host:r.host,token:r.token,user:e.data.rol?e.data.idUser:"",date:it()().format("YYYY-MM-DD"),caja:0,ventas:0},n}return Object(nt.a)(t,[{key:"render",value:function(){var e=this.state,a=e.user,t=e.date,n=e.caja,o=e.ventas,l=this.props.data;return r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(Xn,{data:l,user:a,date:t,changeState:this.changeState})),r.a.createElement("div",{className:"col col-md-3 col-lg-3"},r.a.createElement("div",{className:"row"},l.rol?null:r.a.createElement("div",{className:"col"},r.a.createElement(Yn,{data:l,changeState:this.changeState})),r.a.createElement("div",{className:"col"},r.a.createElement(Kn,{caja:n,ventas:o}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col col-md-4 col-lg-4"},r.a.createElement(Wn,{data:l,user:a,date:t,changeState:this.changeState}),r.a.createElement(Zn,{data:l,user:a,date:t,changeState:this.changeState})),r.a.createElement("div",{className:"col"},r.a.createElement(Hn,{data:l,user:a,date:t,changeState:this.changeState}))))}}]),t}(n.Component),er=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;Object(tt.a)(this,t),(n=a.call(this,e)).handleClickViewNotify=function(e,a,t){var r=n.props.page,o=a.split("/");e.preventDefault();var l=JSON.parse(localStorage.getItem("OrusSystem")),c=l.host,s=l.token;console.log("[Orus System] Enviando datos de leidos"),fetch("http://"+c+"/api/user/readAllNotifications",{method:"POST",body:JSON.stringify({id:t}),signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){e.success?console.log("[Orus] Notificaciones leeidas"):console.log("[Orus] Sin notificaciones"),r(o[1]),a&&n.props.history.push(a)})).catch((function(e){console.error("[Orus] Notify error \n",e),window.Swal.fire("Notificaciones","Verifique la conexion al servidor","error")}))},n.checkNotify=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),a=e.host,t=e.token;""!==t&&""!==a&&fetch("http://"+a+"/api/user",{method:"GET",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}).then(function(){var e=Object(_e.a)(ke.a.mark((function e(a){var t;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},204===a.status){e.next=5;break}return e.next=4,a.json();case 4:t=e.sent;case 5:if(a.ok){e.next=7;break}throw new Error(t.message);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()).then((function(e){n.setState({notifications:e.data?e.data.notifications:[],rol:e.data.rol,load:!1})})).catch((function(e){console.error("[Orus] User session in API error \n",e),n.setState({load:!1}),window.Swal.fire("Notificaciones","Verifique la conexion al servidor","error")}))};var r=JSON.parse(localStorage.getItem("OrusNotify"));return n.state={notifications:r.notifications.length?r.notifications:[],rol:r?r.rol:-1,count:r?r.count:0,load:!1},n}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.state,t=a.notifications,n=a.load;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"card-title"},r.a.createElement("i",{className:"fas fa-bell mr-2"}),r.a.createElement("label",null,"Mis notificaciones"))),r.a.createElement("div",{className:"card-body"},n?r.a.createElement("div",{className:"card-text text-center"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):r.a.createElement(r.a.Fragment,null,t.length?r.a.createElement("div",{className:"list-group"},t.map((function(a){var t=a.type.split("\\"),n="";return 3===t.length&&"ExamNotification"===t[2]&&(n="/consultorio/registro/"+a.data.id),r.a.createElement("a",{href:n,className:a.read_at?"list-group-item list-group-item-action flex-column align-items-start":"list-group-item list-group-item-action flex-column align-items-start active",key:a.id,onClick:function(t){return e.handleClickViewNotify(t,n,a.id)}},r.a.createElement("div",{className:"d-flex w-100 justify-content-between"},r.a.createElement("h5",{className:"mb-1"},(t[2],"")),r.a.createElement("small",null,it()(a.created_at).fromNow())),r.a.createElement("p",{className:"mb-1 text-capitalize"},r.a.createElement("strong",null,a.data.paciente)),r.a.createElement("small",{className:"text-capitalize"},a.data.user))}))):r.a.createElement("p",{className:"card-text"},"Sin notificaciones"))))}}]),t}(n.Component),ar=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).handlePage=function(e){var a=n.handleTitleSection(e);n.setState({page:a})},n.handleTitleSection=function(e){""!==(e=e||window.location.pathname)&&"undefined"!==typeof e&&"object"!==typeof e||(e="/");var a=e.split("/");return""===a[1]?"dashboard":a[1]},n.state={page:n.handleTitleSection(window.location.pathname),company:e.data.company},n}return Object(nt.a)(t,[{key:"render",value:function(){var e=this,a=this.props,t=a.data,n=a.logOut,o=this.state.page;return r.a.createElement(lt.a,null,r.a.createElement("div",{className:"wrapper"},r.a.createElement(ht,{logOut:n,data:t,page:this.handlePage}),r.a.createElement(ft,{companyName:this.state.company,user:t,page:this.handlePage,logOut:n,active:o}),r.a.createElement("div",{className:"content-wrapper"},r.a.createElement(vt,{title:o}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-12"},r.a.createElement(ct.c,null,r.a.createElement(ct.a,{path:"/usuarios/registro/:id?",render:function(a){return r.a.createElement(kt,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/usuarios",render:function(a){return r.a.createElement(St,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{path:"/almacen/registro/:id?",render:function(a){return r.a.createElement(Gt,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/almacen/categorias",render:function(a){return r.a.createElement(Vt,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/almacen/marcas",render:function(a){return r.a.createElement(qt,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/almacen/inventario",render:function(a){return r.a.createElement(Tt,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/almacen",render:function(a){return r.a.createElement(Ft,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/contactos/:id?",render:function(a){return r.a.createElement(tn,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/consultorio/:id?",render:function(e){return r.a.createElement(bn,e)}}),r.a.createElement(ct.a,{extric:!0,path:"/configuraciones",render:function(a){return r.a.createElement(rn,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/pedidos/:id?",render:function(e){return r.a.createElement(Bn,e)}}),r.a.createElement(ct.a,{extric:!0,path:"/notas/registro/:id?",render:function(a){return r.a.createElement($n,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/notas",render:function(a){return r.a.createElement(Un,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/notificaciones",render:function(a){return r.a.createElement(er,Object.assign({},a,{data:t,page:e.handlePage}))}}),r.a.createElement(ct.a,{extric:!0,path:"/",render:function(a){return r.a.createElement(Qn,Object.assign({},a,{data:t,page:e.handlePage}))}}))))))),r.a.createElement(bt,null)))}}]),t}(n.Component),tr=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(e){var n;return Object(tt.a)(this,t),(n=a.call(this,e)).pressEnter=function(e){if(e.preventDefault(),"Enter"===e.key){var a=n.state.txtHost.split("://"),t=a[0],r=a[1],o=n.props.changeHost;n.setState({load:!0}),t&&r?o({host:r,port:t}):t&&!r&&o({host:t,port:void 0})}else e.target&&""!==e.target.name&&n.catchInputs(e)},n.catchInputs=function(e){var a=e.target,t=a.name,r=a.value,o=e.key,l="";o?("txtHost"===t&&(l=n.state.txtHost),l+=o):l=r,n.setState(Object(V.a)({},t,l))},n.showTools=function(e){e.preventDefault(),n.setState({hostShow:!n.state.hostShow})},n.handleLogin=function(e){e.preventDefault(),console.log("[Orus System] Validando integracion de credenciales");var a=n.state,t=a.username,r=a.password,o=a.load,l=n.props.loggin,c={email:t.toString().replace(/\s/g,"").trim().toLocaleLowerCase(),password:r.toString().trim()};o||n.setState({load:!0,error:{}});var s=n.validInputs(c);s.isValid?(console.log("[Orus System] enviando credenciales a _LOGGINGPROCESS"),l(c)):n.setState({load:!1,error:s})},n.state={username:"",password:"",txtHost:"",error:{},hostShow:!1,load:!1},n}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.host;e&&this.setState({txtHost:e})}},{key:"componentDidUpdate",value:function(e,a){var t=e.errors,n=void 0===t?{}:t,r=e.changeHostStatus,o=this.props,l=o.errors,c=void 0===l?{}:l,s=o.changeHostStatus;n.errors!==c.errors&&c.errors&&c.errors.toString().length&&this.setState({load:!1}),r!==s&&s&&this.setState({load:!1})}},{key:"render",value:function(){var e=this.state,a=e.load,t=e.username,n=e.password,o=e.txtHost,l=e.hostShow,c=e.error,s=this.props,i=s.company,m=s.errors,d=s.changeHostStatus,u=void 0===d?null:d,p=s.host;return r.a.createElement("div",{className:"login-page"},r.a.createElement("div",{className:"login-box"},r.a.createElement("div",{className:"login-logo"},r.a.createElement("a",{href:"#logo",onClick:function(e){return e.preventDefault()}},r.a.createElement("b",{className:"text-primary"},"Orus")," LTE")),m&&m.errors&&!a?r.a.createElement("div",{className:"alert alert-danger"},r.a.createElement("span",null,r.a.createElement("i",{className:"mx-2 fas fa-info"})," ",m.errors.toString())):u?r.a.createElement("div",{className:"alert alert-success"},r.a.createElement("span",null,r.a.createElement("i",{className:"mx-2 fas fa-info"})," Direccion de servidor cambiada con exito [",p,"]")):null,r.a.createElement("div",{className:"rounded shadow-lg card"},r.a.createElement("div",{className:"card-body login-card-body"},r.a.createElement("p",{className:"login-box-msg text-uppercase"},r.a.createElement("span",{className:"p-2 badge badge-secondary"},i)),r.a.createElement("form",{onSubmit:this.handleLogin},r.a.createElement("div",{className:c.input&&"email"===c.input?"mb-0 input-group":"mb-3 input-group"},r.a.createElement("input",{type:"email",className:"form-control",placeholder:"Usuario",name:"username",autoFocus:!l,onChange:this.catchInputs,value:t}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},r.a.createElement("span",{className:"fas fa-user"}))),c.input&&"email"===c.input?r.a.createElement("span",{className:"text-center text-danger text-wrap font-weight-bold text-monospace"},r.a.createElement("small",null,r.a.createElement("i",{className:"mx-2 fas fa-info"}),"Los datos son errones")):null),r.a.createElement("div",{className:c.input&&"password"===c.input?"mb-0 input-group":"mb-3 input-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",onChange:this.catchInputs,value:n}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},r.a.createElement("span",{className:"fas fa-lock"})))),c.input&&"password"===c.input?r.a.createElement("span",{className:"mb-3 text-center text-danger text-wrap font-weight-bold text-monospace"},r.a.createElement("small",null,r.a.createElement("i",{className:"mx-2 fas fa-info"}),"Los datos son errones")):null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"mb-4 col-12"},r.a.createElement("a",{href:"#tools",onClick:this.showTools,className:"text-muted"},r.a.createElement("i",{className:"mx-1 fas fa-wifi"})," Servidor"),l?r.a.createElement("div",{className:"mb-3 input-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"txtHost",autoComplete:"off",autoFocus:!!l,onChange:this.catchInputs,value:o,onKeyPress:this.pressEnter}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},r.a.createElement("span",{className:"fas fa-server"})))):null)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"text-center col-12"},r.a.createElement("button",{type:a?"button":"submit",className:a?"btn btn-outline-secondary btn-block":"btn btn-primary btn-block"},a?r.a.createElement("div",{className:"spinner-border text-secondary"},r.a.createElement("span",{className:"sr-only"},"Loading...")):"Iniciar session"))))))))}},{key:"validInputs",value:function(e){var a=e.email,t=e.password;return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)?/^(?=.*[A-Z])(?=.*[!@#$&.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$/.test(t)?{isValid:!0}:(console.error("[Orus System] Fallo validacion de password"),{isValid:!1,msg:"Los datos introducidos no son validos",input:"password"}):(console.error("[Orus System] Fallo validacion de email"),{isValid:!1,msg:"Los datos introducidos no son validos",input:"email"})}}]),t}(n.Component),nr={loggin:mt,changeHost:function(e){return{type:L,payload:e}}},rr=Object(at.b)((function(e){return{company:e.default.company,host:e.default.host,errors:e.logging.errors,changeHostStatus:e.default.success}}),nr)(tr),or=function(e){Object(rt.a)(t,e);var a=Object(ot.a)(t);function t(){return Object(tt.a)(this,t),a.apply(this,arguments)}return Object(nt.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,a=e.checkLogging,t=e.token;e.isLogged&&a(t)}},{key:"render",value:function(){var e=this.props.isLogged;return r.a.createElement("main",null,e?r.a.createElement(ar,{data:this.props}):r.a.createElement(rr,null))}}]),t}(n.Component),lr={checkLogging:function(e){return{type:m,payload:e}}},cr=Object(at.b)((function(e){return{isLogged:e.logging.isLogged,token:e.logging.token}}),lr)(or),sr=function(){return r.a.createElement(at.a,{store:et},r.a.createElement(cr,null))};Object(o.render)(r.a.createElement(sr,null),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.4c23a11b.chunk.js.map