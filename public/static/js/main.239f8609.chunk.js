(this.webpackJsonporussystem=this.webpackJsonporussystem||[]).push([[0],{163:function(e,t,a){"use strict";a.r(t);var c=a(40),n=a(11),s=a(8),r=a(1),i=a(3),l=a(5),o=a.n(l),d=a(2),j=a.n(d),u=a(12),b=a(76),m=a.n(b);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(n,s){var r=localStorage.getItem("OrusSystem"),i=sessionStorage.getItem("OrusSystemLogin"),l=JSON.parse(r||"{}"),o=l.protocol,d=void 0===o?window.location.protocol:o,j=l.host,u=void 0===j?window.location.hostname:j,b=l.port,h=void 0===b?window.location.port:b,O=JSON.parse(i||"{}").token,x=void 0===O?"":O,p={method:t,url:"".concat(d,"://").concat(u,":").concat(h,"/api/").concat(e),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+x}};["POST","PUT"].includes(t.toUpperCase())&&a&&(p.data=JSON.stringify(a)),c&&(p.signal=c.signal),m()(p).then((function(e){return n(e.data)})).catch((function(t){var a;return console.error("[Orus System] Query API failer:",e),console.error("[Orus System] Query API code:",null===t||void 0===t?void 0:t.code),console.error("[Orus System] Query API message:",null===t||void 0===t?void 0:t.message),s(null===(a=t.response)||void 0===a?void 0:a.data)}))}))}function O(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=e,n=null,s=Object.keys(a);return t&&(c+="/".concat(t)),"object"!==typeof a||Array.isArray(a)||s&&(s.map((function(e){return null!==a[e]&&""!==a[e]||delete a[e],null})),s.length&&(n=new URLSearchParams(a),c+="?".concat(n))),c}var x=a(0),p=Object(d.createContext)(null),f=function(){return Object(d.useContext)(p)};function v(e){var t=e.children,a=Object(u.f)(),c=sessionStorage.getItem("OrusSystemLogin"),n={isLogged:!1,idUser:0,username:"",name:"",rol:null,email:"",token:"",branch:"",roles:"",permissions:[]},l=Object(d.useState)((function(){return c&&"undefined"!==c&&(n=JSON.parse(c)),n})),j=Object(i.a)(l,2),b=j[0],m=j[1],f=function(e){var t,a;if(e){var c={isLogged:null!==(t=e.isLogged)&&void 0!==t?t:b.isLogged,idUser:e.id,username:e.username.toLowerCase(),name:e.name.toLowerCase(),rol:2,email:e.email,token:null!==(a=e.token)&&void 0!==a?a:b.token,branch:Object(r.a)(Object(r.a)({},e.branch.data),{},{id:e.branch.id}),roles:e.roles[0],permissions:e.permissions};m(c),sessionStorage.setItem("OrusSystemLogin",JSON.stringify(c))}},v=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.email,c=t.password,a&&c){e.next=3;break}return e.abrupt("return",{status:!1,message:"The fields user or passwors are required"});case 3:return e.next=5,h("user/login","POST",t).then((function(e){if(!e.status)return{status:!1,data:e};var t=e.data;return f(Object(r.a)(Object(r.a)({},t),{},{token:e.token,isLogged:!0})),{status:!0,message:e.message}})).catch((function(e){return{status:!1,message:"Error en el servidor: "+(null===e||void 0===e?void 0:e.message)}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("user/logout","POST").then((function(){return m(n),sessionStorage.setItem("OrusSystemLogin","{}"),!0})).catch((function(e){return console.error("[Server] When close session:",e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("user").then((function(e){return e.data})).catch((function(e){var t;"Unauthenticated."!==(null===e||void 0===e?void 0:e.message)?console.log("[Orus System] Responses:",e):"/login"!==(null===(t=a.location)||void 0===t?void 0:t.pathname)&&(m(n),sessionStorage.setItem("OrusSystemLogin",JSON.stringify(n)),a.push("/login"))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().catch((function(){return null}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",t.unreadNotifications);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return",{status:!1,message:"Payload should be object"});case 2:return e.next=4,h("user/readAllNotifications","POST",t).then((function(e){var a=parseInt(t.id)<0?"Todas":1;return!!e.success&&(console.log("[Orus System] Notificaciones marcadas leidas:",a),!0)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("users",b.idUser),c={branch_id:t,name:b.name,username:b.username},e.next=4,h(a,"PUT",c).then((function(e){return!(!e.data||e.message)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){N().then((function(e){e&&(console.log("[Orus system] Session was created"),f(Object(r.a)(Object(r.a)({},e),{},{isLogged:!0})))}))}),[b.isLogged]),Object(x.jsx)(p.Provider,{value:{auth:b,setSession:v,outSession:g,getNotifications:y,setNotifications:w,setBranch:C},children:t})}var g=a(10);function N(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("users",null,t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("users",t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("users",t),e.next=3,h(a,"DELETE",null);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t,a){var c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return c=O("users",a),e.next=4,h(c,"PUT",t);case 4:case 10:return e.abrupt("return",e.sent);case 7:return n=O("users"),e.next=10,h(n,"POST",t);case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return{getListUsers:e,getUserById:t,deleteUser:a,saveUser:c}}var y=Object(d.createContext)(null),w=function(){return Object(d.useContext)(y)},C={data:[],meta:{},branches:[],banks:[],server:JSON.parse(localStorage.getItem("OrusSystem"))};function _(e){var t=e.children,a=Object(d.useState)(C),c=Object(i.a)(a,2),n=c[0],l=c[1],j=function(e){if("object"!==typeof e)return!1;var t=Object(r.a)(Object(r.a)({},n.server),e);return l(Object(r.a)(Object(r.a)({},n),{},{server:t})),localStorage.setItem("OrusSystem",JSON.stringify(t)),!0},u=function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,c,s,i,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("config?itemsPage=100","GET").then((function(e){return e}));case 2:c=e.sent,s=null===(t=c.data)||void 0===t?void 0:t.filter((function(e){return"bank"===e.name})),i=null===(a=c.data)||void 0===a?void 0:a.filter((function(e){return"branches"===e.name})),d=i.map((function(e){return Object(r.a)(Object(r.a)({},e.data),{},{id:e.id})})),l(Object(r.a)(Object(r.a)({},n),{},{data:c.data,meta:c.meta,branches:d,banks:s,setStorage:j}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){u()}),[]),Object(x.jsx)(y.Provider,{value:n,children:t})}function S(e){var t=N(),a=Object(d.useRef)(!0),c=Object(d.useState)({bgColor:"bg-blue",validate:"",text:"Debe de tener al menos 4 caracteres.",searchUser:!1}),n=Object(i.a)(c,2),s=n[0],l=n[1],o=e.onChange,j=e.handleValidate;return Object(d.useEffect)((function(){return function(){a.current=!1}})),Object(x.jsxs)("div",{className:"col-"+e.col,children:[e.username.length?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Usuario"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text "+s.bgColor,children:s.searchUser?Object(x.jsx)("i",{className:"fas fa-spinner"}):Object(x.jsx)("i",{className:"fas fa-user-check"})})}),Object(x.jsx)("input",{type:"text",className:"form-control"+s.validate,placeholder:"Usuario",autoComplete:"off",autoFocus:"autofocus",defaultValue:e.username,onChange:function(e){return function(e){var t=e.value;o({name:"username",value:t.toLowerCase()})}(e.target)},onBlur:function(){if(a.current){var c=e.username.replace(/\s/g,"");/^[\w]{4,16}$/.test(c)?(l(Object(r.a)(Object(r.a)({},s),{},{searchUser:!0})),k(c,e.userId,t).then((function(e){a.current&&(e?(l(Object(r.a)(Object(r.a)({},s),{},{bgColor:"bg-red",validate:" border border-danger",text:"El usuario ya esta registrado.",searchUser:!1})),j({name:"validUserName",value:!1})):(l(Object(r.a)(Object(r.a)({},s),{},{bgColor:"bg-blue",validate:"",text:"",searchUser:!1})),j({name:"validUserName",value:!0})))}))):c.length>4?(l(Object(r.a)(Object(r.a)({},s),{},{bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de usuario"})),j({name:"validUserName",value:!1})):c.length||(l(Object(r.a)(Object(r.a)({},s),{},{bgColor:"bg-red",validate:" border border-danger",text:"Debe de tener de 4 a 16 caracteres alfanumericos."})),j({name:"validUserName",value:!1}))}},required:"required",minLength:"4",maxLength:"16",pattern:"^[\\w]{4,16}$"})]}),s.validate?Object(x.jsx)("small",{className:"text-muted",children:s.text}):""]})}var k=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:null,c=s.length>2?s[2]:void 0,e.next=4,c.getListUsers({username:t,userId:a,deleted:0});case 4:if(!(n=e.sent).data||!n.data.length){e.next=9;break}if(n.data[0].username.toLowerCase()!==t){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function E(e){var t=Object(d.useState)({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email",searchEmail:!1}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=N(),l=e.col,o=e.email,j=e.userId,u=e.onChange,b=c.bgColor,m=c.validate,h=c.text,O=c.searchEmail;return Object(x.jsxs)("div",{className:"col-"+l,children:[o.length?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Email"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text "+b,children:O?Object(x.jsx)("i",{className:"fas fa-spinner"}):Object(x.jsx)("i",{className:"fas fa-at"})})}),Object(x.jsx)("input",{type:"email",className:"form-control"+m,placeholder:"email",name:"email",autoComplete:"off",defaultValue:o,onChange:function(e){return function(e){var t=e.name,a=e.value;u({name:t,value:a.toLowerCase()})}(e.target)},onBlur:function(){var e=o.replace(/\s/g,"");/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)?(n(Object(r.a)(Object(r.a)({},c),{},{searchUser:!0})),B(e,j,s).then((function(e){e?(n({bgColor:"bg-red",validate:" border border-danger",text:"El usuario ya esta registrado.",searchUser:!1}),u({name:"validUserEmail",value:!1})):(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-blue",validate:"",text:""})),u({name:"validUserEmail",value:!0}))}))):e.length>8?(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email valido"})),u({name:"validUserEmail",value:!1})):e.length||(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-red",validate:" border border-danger",text:"Escriba un email valido"})),u({name:"validUserEmail",value:!1}))},required:"required"})]}),m?Object(x.jsx)("small",{className:"text-muted",children:h}):""]})}var B=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:null,c=s.length>2?s[2]:void 0,e.next=4,c.getListUsers({username:t,userId:a,deleted:0});case 4:if(!(n=e.sent).data||!n.data.length){e.next=9;break}if(n.data[0].username.toLowerCase()!==t){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=a(7),D=a.n(I);function L(e){var t,a,c,n,s,r=e.data;return Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title text-primary",children:[Object(x.jsx)("i",{className:"fas fa-database mr-2"}),"Metadata"]})}),Object(x.jsx)("div",{className:"card-body",children:null!==(t=r.data)&&void 0!==t&&t.session?Object(x.jsxs)("ul",{className:"list-group",children:[Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("h6",{children:"Datos del usuario"}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("span",{className:"text-primary",children:"Registrado"}),Object(x.jsx)("p",{children:D()(r.data.created_at).fromNow()})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("span",{className:"text-primary",children:"Ultima actualizacion"}),Object(x.jsx)("p",{children:D()(r.data.updated_at).fromNow()})]})]})]}),Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("h6",{children:"Actividad"}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("span",{className:"text-primary",children:"IP"}),Object(x.jsx)("p",{children:null!==(a=r.data.session)&&void 0!==a&&a.ip_address?r.data.session.last_activity:"--"})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("span",{className:"text-primary",children:"Ultima actividad"}),Object(x.jsx)("p",{children:null!==(c=r.data.session)&&void 0!==c&&c.last_activity?D()(r.data.session.last_activity).fromNow():"--"})]})]})]}),Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("span",{className:"text-primary",children:"Navegador y OS"}),Object(x.jsx)("p",{children:null!==(n=r.data.session)&&void 0!==n&&n.user_agent?r.data.session.user_agent:"--"})]}),Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("span",{className:"text-primary",children:"Token"}),Object(x.jsx)("p",{children:null!==(s=r.data.session)&&void 0!==s&&s.user_data?r.data.session.user_data:"--"})]})]}):Object(x.jsx)("p",{children:"Usuario no ha registrado actividad."})}),r.data.session&&Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){},children:[Object(x.jsx)("i",{className:"fas fa-sign-out-alt mr-1"}),"Cerrar session"]})})]})}function P(e){var t,a,c=e.data;return Object(x.jsxs)("div",{className:"card card-primary card-outline mt-4",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h5",{className:"card-title text-primary",children:"Tipo y permisos"})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("span",{className:"badge badge-dark m-1",children:c.role}),null===(t=c.data)||void 0===t||null===(a=t.permissions)||void 0===a?void 0:a.map((function(e,t){return Object(x.jsx)("span",{className:"badge badge-primary m-1",children:e},t)}))]})]})}function F(e){return Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-muted text-bold w-100 mb-4 text-left",children:[Object(x.jsx)("i",{className:"fas fa-bars mr-1"}),"Actividad"]}),e.data.map((function(e,t){var a,c=e.data,n=e.type;return Object(x.jsxs)("p",{className:"card-text border-bottom text-left",children:[Object(x.jsx)("span",{className:"deleted"!==n?"created"===n?"badge badge-success text-uppercase":"badge badge-primary text-uppercase":"badge badge-danger text-uppercase",children:n}),Object(x.jsx)("span",{className:"mx-2 text-uppercase",children:D()(c.datetime).format("DD-MMMM-YYYY HH:mm")}),Object(x.jsx)("span",{className:"text-bold text-capitalize",children:null===(a=c.user)||void 0===a?void 0:a.name.toLowerCase()}),Boolean(Object.keys(c.inputs).length)&&Object(x.jsx)("span",{className:"px-2",children:Object.keys(c.inputs).map((function(e,t){return Object(x.jsxs)("span",{className:"badge badge-light text-uppercase mx-1",children:[e," / ",c.inputs[e]]},t)}))})]},t)}))]})})}var T={id:0,role:"ventas",password:"",username:"",name:"",email:"",branch_id:12,data:{session:{},roles:[],permissions:[],load:!1,validUserName:!1,validUserEmail:!1,created_at:"",updated_at:"",activities:[]}};function z(e){var t=e.match.params.id,a=e.handleNewOrEdit,c=N(),n=w().data,s=Object(d.useState)(T),l=Object(i.a)(s,2),o=l[0],j=l[1],b=Object(u.f)(),m=!(o.name.length&&!o.data.load&&o.data.validUserName&&o.data.validUserEmail);var h=function(e){var t=e.name,a=e.value;"text"===e.type&&(a=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")),j(Object(r.a)(Object(r.a)({},o),{},Object(g.a)({},t,a)))};return Object(d.useEffect)((function(){t&&c.getUserById(t).then((function(e){e&&function(e){e&&j({id:e.id,role:e.roles[0],username:e.username,name:e.name,email:e.email,password:"",branch_id:e.branch.id,data:{session:e.session?e.session:{},permissions:e.permissions,roles:e.roles,load:!!e.load&&e.load,validUserName:!0,validUserEmail:!0,created_at:e.created_at,updated_at:e.updated_at,activities:e.activity}})}(e.data)}))}),[t]),Object(x.jsxs)("div",{className:"row",style:{height:"100vh"},children:[Object(x.jsxs)("div",{className:"col-".concat(t?8:12),children:[Object(x.jsxs)("form",{className:"card card-primary card-outline",autoComplete:"off",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h1",{className:"card-title text-primary",children:[Object(x.jsx)("i",{className:"fas fa-user mr-2"}),t?"Editar usuario":"Registrar nuevo usuario"]})}),Object(x.jsx)("div",{className:"card-body was-validated",children:o.load?Object(x.jsx)("div",{className:"alert alert-light text-center p-4",children:Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})})}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row mb-3",children:[Object(x.jsx)(S,{username:o.username,userId:t||"",col:6,onChange:h,handleValidate:function(e){var t=e.name,a=e.value;j(Object(r.a)(Object(r.a)({},o),{},{data:Object(r.a)(Object(r.a)({},o.data),{},Object(g.a)({},t,a))}))}}),Object(x.jsxs)("div",{className:"col-6",children:[o.name.length?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Nombre completo"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-blue",children:Object(x.jsx)("i",{className:"fas fa-user-tag"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",autoComplete:"off",defaultValue:o.name,onChange:function(e){var t=e.target;return h(t)},required:"required",minLength:"8",pattern:"^[a-zA-Z]{2,20}[\\s]{1}[a-zA-Z]{2,20}.*"})]})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-6",children:[o.password.length||t?Object(x.jsxs)("small",{children:[Object(x.jsx)("label",{children:"Contrase\xf1a"}),!t&&Object(x.jsx)("span",{className:"ml-2 text-muted",children:"De 8 a 16 caracteres, por lo menos una mayuscula, un numero y un caracter especial"})]}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-blue",children:Object(x.jsx)("i",{className:"fas fa-lock"})})}),Object(x.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",defaultValue:o.password,onChange:function(e){var t=e.target;return h(t)},required:!t,minLength:"8",maxLength:"16",pattern:"^(?=.*[A-Z])(?=.*[!@#$&.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$"})]})]}),Object(x.jsx)(E,{email:o.email,userId:t||"",col:6,onChange:h})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-6",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Tipo de usuario"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-blue",children:Object(x.jsx)("i",{className:"fas fa-id-card"})})}),Object(x.jsxs)("select",{className:"custom-select",name:"role",value:o.role,onChange:function(e){var t=e.target;return h(t)},children:[Object(x.jsx)("option",{value:"admin",children:"Administrador"}),Object(x.jsx)("option",{value:"ventas",children:"Ventas"}),Object(x.jsx)("option",{value:"doctor",children:"Optometrista"})]})]})]}),Object(x.jsxs)("div",{className:"col-md-6",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Sucursal"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-blue",children:Object(x.jsx)("i",{className:"fas fa-store"})})}),Object(x.jsx)("select",{className:"custom-select text-uppercase",name:"branch_id",value:o.branch_id,onChange:function(e){var t=e.target;return h(t)},children:n.map((function(e){return"bank"!==e.name?Object(x.jsx)("option",{value:e.id,children:e.data.name},e.id):null}))})]})]})]})]})}),Object(x.jsx)("div",{className:"card-footer",children:Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-md-12 text-right",children:Object(x.jsxs)("div",{className:"btn-group btn-group-lg",role:"group",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-dark",onClick:function(){b.push("/usuarios"),a()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:o.load?"btn btn-primary disabled":"btn btn-primary",disabled:!!m,onClick:function(){var e=o.id,t=o.name,n=o.username,s=o.role,r=o.password,i=o.email,l=o.branch_id;if(!o.data.validUserName)return window.Swal.fire({icon:"error",title:"El nombre de usuario ya esta en uso",showConfirmButton:!1,timer:1500}),!1;if(!o.data.validUserEmail)return window.Swal.fire({icon:"error",title:"El correo ya esta en uso",showConfirmButton:!1,timer:1500}),!1;var d={name:t,username:n,role:s,email:i,branch_id:l};r.length>=8&&(d.password=r),c.saveUser(d,e).then((function(t){t&&window.Swal.fire({title:"Usuarios",text:e?"Usuario actualizado correctamente":"Usuario guardado correctamente",icon:"success",showCancelButton:!1,confirmButtonText:"Hecho!",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||(b.push("/usuarios"),a())}))}))},children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),t?"Actualizar":"Guardar"]})]})})})})]}),Object(x.jsx)(P,{data:o})]}),t&&Object(x.jsxs)("div",{className:"col-4",children:[Object(x.jsx)(L,{data:o}),Object(x.jsx)(F,{data:o.data.activities})]})]})}var V=Object(d.createContext)(null),A=function(){return Object(d.useContext)(V)};function M(e){var t;return Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h5",{className:"card-title",children:[Object(x.jsx)("i",{className:e.icon?"mr-2 fas fa-"+e.icon:"mr-2 fas fa-ellipsis-v"}),null!==(t=e.title)&&void 0!==t?t:"Menu"]})}),Object(x.jsx)("div",{className:"card-body p-0",children:Object(x.jsx)("ul",{className:"list-group nav list-group-flush",children:e.children})})]})}function U(e){var t,a,c,n,s,r,i,l,o=e.showIcon,d=void 0===o||o;return Object(x.jsxs)("div",{className:"input-group mb-3",children:[d&&Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:e.value?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(x.jsx)("i",{className:"fas fa-".concat(null!==(t=e.icon)&&void 0!==t?t:"sort-amount-down")})})}),Object(x.jsxs)("select",{className:"custom-select text-uppercase",value:null!==(a=e.value)&&void 0!==a?a:"",disabled:null!==(c=e.load)&&void 0!==c&&c,onChange:function(t){var a=t.target;e.handleChange&&e.handleChange(parseInt(a.value))},children:[e.load?Object(x.jsx)("option",{value:"",children:null!==(n=e.loadText)&&void 0!==n?n:"Cargando opciones"}):Object(x.jsx)(x.Fragment,{children:Boolean(null===(s=e.options)||void 0===s?void 0:s.length)?Object(x.jsxs)("option",{value:"0",children:["--",null!==(i=e.text)&&void 0!==i?i:"Seleccione uno","--"]}):Object(x.jsx)("option",{value:"",children:null!==(r=e.emptyText)&&void 0!==r?r:"No hay opciones"})}),null===(l=e.options)||void 0===l?void 0:l.map((function(e,t){return Object(x.jsx)("option",{value:e.id,id:t,children:e.name},e.id)}))]})]})}function R(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("store",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){return console.error("[Orus System] Catch when get items list in hook:",e.message),e.response.data}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("store",t),e.next=5,h(a,"GET").then((function(e){return e.data})).catch((function(e){throw console.error("[Orus System] Catch when get item in hook:",e.message),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("store",t),e.next=5,h(a,"DELETE").then((function(){return!0})).catch((function(e){throw console.error("[Orus System] Catch when delete item in hook:",e.message),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a=O("store/bylist"),e.next=5,h(a,"POST",{items:t}).then((function(e){return e})).catch((function(e){throw console.error("[Orus System] Catch when save items by list in hook:",e.message),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,c=O("store",a),n=a?"PUT":"POST",e.next=5,h(c,n,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(delete t.readyToSave,0!==(a=t.id)){e.next=10;break}return c=O("branches"),"POST",e.next=7,h(c,"POST",t);case 7:case 14:return e.abrupt("return",e.sent);case 10:return n=O("branches",a),"PUT",e.next=14,h(n,"PUT",t);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.productCategoryId,c=O("categories/setprice/".concat(a)),"POST",delete t.productCategoryId,delete t.branchSelected,e.next=7,h(c,"POST",t);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.product_id,c=O("store/setcant/".concat(a)),"POST",e.next=5,h(c,"POST",t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("brands",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){throw console.error("[Orus System] Catch when get brands list in hook:",e.message),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("brands",t),e.next=5,h(a,"GET").then((function(e){return e.data})).catch((function(e){throw console.error("[Orus System] Catch when get brands in hook:",e.message),e}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("brands"),e.next=3,h(a,"POST",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("brands",t),e.next=3,h(a,"DELETE",null).then((function(){return!0})).catch((function(e){throw console.error("[Orus System] Catch when delete item in hook:",e.message),e}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getItems:e,getItem:t,deleteItem:a,saveItem:n,saveItemByList:c,saveQantityandPrice:r,saveGlobalPrice:i,getBrands:d,getBrand:j,saveBrand:u,deleteBrand:b,saveQantity:l}}function q(e){var t=Object(d.useState)({brands:[],load:!0}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=R();return Object(d.useEffect)((function(){s.getBrands({supplier:e.supplier}).then((function(e){e?n(Object(r.a)(Object(r.a)({},c),{},{brands:e.data,load:!1})):console.error("Error al obetner las marcas")}))}),[e.supplier]),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Marca"})}),Object(x.jsx)(U,{options:c.brands,value:e.brand,text:"Seleccione una marca",icon:"copyright",emptyText:"No hay marcas para este proveedor",load:c.load,loadText:"Cargando marcas",handleChange:function(t){e.handleChangeBrand&&e.handleChangeBrand(t,function(e){return c.brands.filter((function(t){return t.id===e}))[0].name}(t))}})]})})}function Y(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("contacts",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){return console.error("[Orus System] Catch when get contacts list in hook:",e.message),null}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("contacts",t),e.next=5,h(a,"GET").then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when get contact in hook:",e.message),{}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("contacts",t),e.next=5,h(a,"DELETE").then((function(){return!0})).catch((function(e){return console.error("[Orus System] Catch when delete contact in hook:",e.message),!1}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a=t.id,delete t.id,!a){e.next=11;break}return c=O("contacts",a),e.next=8,h(c,"PUT",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when save contact in hook:",e.message),null}));case 8:case 14:return e.abrupt("return",e.sent);case 11:return n=O("contacts"),e.next=14,h(n,"POST",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when save contact in hook:",e.message),null}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getContacts:e,getContact:t,deleteContact:a,saveContact:c}}function G(e){var t,a=Y(),c=Object(d.useState)({suppliers:[],load:!0}),n=Object(i.a)(c,2),s=n[0],r=n[1];return Object(d.useEffect)((function(){a.getContacts({type:1,orderby:"name",order:"asc"}).then((function(e){r({suppliers:e.data,load:!1})}))}),[]),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Proveedor"})}),Object(x.jsx)(U,{options:s.suppliers,value:null!==(t=e.supplier)&&void 0!==t?t:"",text:"Seleccione un provedor",icon:"address-book",load:s.load,handleChange:function(t){e.handleChangeSupplier&&e.handleChangeSupplier(t)}})]})})}function $(){var e,t,a,c,n,s,i,l,o=A(),d=Object(u.f)(),j=function(e){var t=e.name,a=e.value,c=e.checked;"itemsPage"===t&&(a=parseInt(a)),"supplier"===t&&a>0&&(a=parseInt(a)),"zero"===t&&(a=c?"true":"false"),o.set(Object(r.a)(Object(r.a)({},o),{},{options:Object(r.a)(Object(r.a)({},o.options),{},Object(g.a)({},t,a))}))};return Object(x.jsxs)(M,{title:"inbox"===o.panel?"Menu y filtros":"Menu",children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)("a",{href:"#item",className:"inbox"===o.panel?"nav-link  disabled":"nav-link",onClick:function(e){e.preventDefault(),o.set(Object(r.a)(Object(r.a)({},o),{},{panel:"inbox"})),d.push("/almacen")},children:[Object(x.jsx)("i",{className:"inbox"===o.panel?"fas fa-check text-success mr-1":"fas fa-plus mr-1"}),"Productos"]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)("a",{href:"#item",className:"category"===o.panel?"nav-link disabled":"nav-link ",onClick:function(e){e.preventDefault(),o.set(Object(r.a)(Object(r.a)({},o),{},{panel:"category"})),d.push("/almacen/categorias")},children:[Object(x.jsx)("i",{className:"category"===o.panel?"fas fa-check text-success mr-1":"fas fa-plus mr-1"}),"Categorias"]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)("a",{href:"#item",className:"brands"===o.panel?"nav-link disabled":"nav-link",onClick:function(e){e.preventDefault(),o.set(Object(r.a)(Object(r.a)({},o),{},{panel:"brands"})),d.push("/almacen/marcas")},children:[Object(x.jsx)("i",{className:"brands"===o.panel?"fas fa-check text-success mr-1":"fas fa-plus mr-1"}),"Marcas"]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)("a",{href:"#item",className:"inventory"===o.panel?"nav-link disabled":"nav-link",onClick:function(e){e.preventDefault(),o.set(Object(r.a)(Object(r.a)({},o),{},{panel:"inventory"})),d.push("/almacen/inventario")},children:[Object(x.jsx)("i",{className:"inventory"===o.panel?"fas fa-check text-success mr-1":"fas fa-plus mr-1"}),"Inventario"]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)("a",{href:"#item",className:"entries"===o.panel?"nav-link disabled":"nav-link",onClick:function(e){e.preventDefault(),o.set(Object(r.a)(Object(r.a)({},o),{},{panel:"entries"})),d.push("/almacen/entradas")},children:[Object(x.jsx)("i",{className:"entries"===o.panel?"fas fa-check text-success mr-1":"fas fa-plus mr-1"}),"Entrada armazon"]})}),"inbox"===o.panel&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item p-1",children:Object(x.jsx)(G,{supplier:null===(e=o.options)||void 0===e?void 0:e.supplier,showIcon:!1,handleChangeSupplier:function(e){return function(e){o.set(Object(r.a)(Object(r.a)({},o),{},{options:Object(r.a)(Object(r.a)({},o.options),{},{brand:"",supplier:e})}))}(e)}})}),(null===(t=o.options)||void 0===t?void 0:t.supplier)&&Object(x.jsx)("li",{className:"nav-item p-1",children:Object(x.jsx)(q,{supplier:null===(a=o.options)||void 0===a?void 0:a.supplier,brand:null===(c=o.options)||void 0===c?void 0:c.brand,showIcon:!1,handleChangeBrand:function(e){j({name:"brand",value:e})}})}),Object(x.jsx)("li",{className:"nav-item p-1",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"zero",type:"checkbox",className:"custom-control-input",id:"zero",checked:"true"===(null===(n=o.options)||void 0===n?void 0:n.zero),onChange:function(e){var t=e.target;return j(t)}}),Object(x.jsx)("label",{className:"custom-control-label font-weight-normal",htmlFor:"zero",children:"Cantidades en cero"})]})}),Object(x.jsxs)("li",{className:"nav-item p-1",children:[Object(x.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(x.jsxs)("select",{className:"custom-select text-uppercase",name:"orderby",id:"orderby",value:null===(s=o.options)||void 0===s?void 0:s.orderby,onChange:function(e){var t=e.target;return j(t)},children:[Object(x.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(x.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-1",children:[Object(x.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(x.jsxs)("select",{className:"custom-select text-uppercase",name:"order",id:"order",value:null===(i=o.options)||void 0===i?void 0:i.order,onChange:function(e){var t=e.target;return j(t)},children:[Object(x.jsx)("option",{value:"asc",children:"Antiguos"}),Object(x.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-1",children:[Object(x.jsx)("label",{htmlFor:"itemsPage",children:"Numero de productos"}),Object(x.jsxs)("select",{className:"custom-select text-uppercase",name:"itemsPage",id:"itemsPage",value:null===(l=o.options)||void 0===l?void 0:l.itemsPage,onChange:function(e){var t=e.target;return j(t)},children:[Object(x.jsx)("option",{value:"25",children:"ver 25"}),Object(x.jsx)("option",{value:"50",children:"ver 50"}),Object(x.jsx)("option",{value:"75",children:"ver 75"}),Object(x.jsx)("option",{value:"100",children:"ver 100"})]})]})]})]})}function H(e){var t=e.meta,a=e.color,c=e.handlePagination,n=function(e){c?c(e):console.error("[OrusSystem] Funcion de paginador no definida")};return Object(x.jsx)("div",{className:"btn-group",children:Object(x.jsxs)("ul",{className:"pagination pagination-sm m-0 mb-1",children:[Object(x.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item test-",children:Object(x.jsx)("a",{className:1===t.current_page?"page-link text-secondary":"page-link text-"+a,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(1)},children:"Primero"})}),Object(x.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item",children:Object(x.jsx)("a",{className:1===t.current_page?"page-link text-secondary":"page-link text-"+a,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.current_page-1)},children:Object(x.jsx)("i",{className:"fas fa-caret-left"})})}),Object(x.jsx)("li",{className:"page-item",children:Object(x.jsx)("span",{className:"page-link text-dark",children:t.current_page&&t.last_page?Object(x.jsxs)(x.Fragment,{children:[t.current_page," /",t.last_page]}):"..."})}),Object(x.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(x.jsx)("a",{className:t.current_page===t.last_page?"page-link text-secondary":"page-link text-"+a,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.current_page+1)},children:Object(x.jsx)("i",{className:"fas fa-caret-right"})})}),Object(x.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(x.jsx)("a",{className:t.current_page===t.last_page?"page-link text-secondary":"page-link text-"+a,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.last_page)},children:"Ultimo"})})]})})}var Z=function(e){var t=e.defaultSearch,a=void 0===t?"":t,c=Object(d.useState)(a),n=Object(i.a)(c,2),s=n[0],r=n[1],l=Object(d.useState)(""),o=Object(i.a)(l,2),j=o[0],u=o[1],b=Object(d.useRef)(),m=Object(d.useContext)(p).auth;return Object(d.useEffect)((function(){var t=null;e.handleSearch&&(s.length?(j&&clearTimeout(j),t=setTimeout((function(){e.handleSearch(s)}),1e3),u(t)):e.handleSearch(""))}),[s]),Object(x.jsxs)("div",{className:"card card-"+e.color+" card-outline",children:[Object(x.jsxs)("div",{className:"card-header",children:[Object(x.jsxs)("h3",{className:"card-title text-"+e.color,children:[Object(x.jsx)("i",{className:e.icon?"mr-1 fas fa-"+e.icon:"mr-1 fas fa-user"}),e.title]}),Object(x.jsx)("div",{className:"card-tools",children:e.handleSearch&&Object(x.jsxs)("div",{className:"input-group input-group-sm position-relative",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Buscar",defaultValue:s,ref:b,onChange:function(e){var t=e.target.value;r(t)},onKeyPress:function(t){"Enter"===t.key&&(j&&clearTimeout(j),e.handleSearch(s))}}),Object(x.jsx)("div",{className:"position-absolute",style:{top:5,left:-20,color:"#ced4da"},children:Object(x.jsx)("i",{className:"fas fa-search"})}),s.length>2?Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("div",{className:"btn btn-secondary",onClick:function(e){b.current.value="",r("")},children:Object(x.jsx)("i",{className:"fas fa-window-close"})})}):null]})})]}),Object(x.jsxs)("div",{className:"p-0 card-body",children:[e.handleDeleteItem||e.handleEditItem||e.handleStatus||e.handleSync||e.meta||e.handleDownload?Object(x.jsxs)("div",{className:"mailbox-controls",children:[Object(x.jsxs)("div",{className:"btn-group",children:[e.handleDeleteItem?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm text-danger",title:"Eliminar",disabled:!e.itemSelected||e.itemSelected===m.idUser,onClick:function(t){return e.handleDeleteItem()},children:Object(x.jsx)("i",{className:"fas fa-trash-alt"})}):null,e.handleEditItem?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Editar",disabled:!e.itemSelected,onClick:function(t){return e.handleEditItem()},children:Object(x.jsx)("i",{className:"fas fa-edit"})}):null,e.handleStatus?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Estado",disabled:!e.itemSelected,onClick:function(t){return e.handleStatus()},children:Object(x.jsx)("i",{className:"fas fa-check-circle"})}):null,e.handleSync?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Recargar",onClick:function(t){return e.handleSync()},children:Object(x.jsx)("i",{className:"fas fa-sync-alt"})}):null,e.handlePrint?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Imprimir",onClick:function(t){return e.handlePrint()},children:Object(x.jsx)("i",{className:"fas fa-print"})}):null,e.handleDownload?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Exportar",onClick:function(t){return e.handleDownload()},children:Object(x.jsx)("i",{className:"fas fa-file-csv"})}):null]}),Object(x.jsx)("div",{className:"float-right",children:e.meta&&Object(x.jsx)(H,{meta:e.meta,color:e.color,handlePagination:e.handlePagination})})]}):null,Object(x.jsx)("div",{className:"table-responsive mailbox-messages",children:e.children})]}),e.loading?Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})};function J(e){var t,a=A(),c=R(),n=Object(u.f)(),l=Object(d.useState)({itemSelected:{},items:[],meta:{},loading:!1}),j=Object(i.a)(l,2),b=j[0],m=j[1],p=function(e,t){a.options[e]!==t&&a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},Object(g.a)({},e,t))}))},f=function(e,t){var a;e&&e.preventDefault(),null!==t&&void 0!==t&&t.id?n.push("/almacen/".concat(t.id)):null!==(a=b.itemSelected)&&void 0!==a&&a.id&&n.push("/almacen/".concat(b.itemSelected.id))},v=function(){var e=Object(s.a)(o.a.mark((function e(){var t,c,n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(Object(r.a)(Object(r.a)({},b),{},{loading:!0})),t=Object(r.a)(Object(r.a)({},a.options),{},{responseType:"csv"}),console.log("[Orus Sytem] Start donwload csv"),c=O("store",null,t),e.next=6,h(c);case 6:(n=e.sent)?(console.log("[Orus Sytem] Process data csv"),s=new Blob([n],{type:"text/csv"}),window.open(URL.createObjectURL(s)),console.log("[Orus Sytem] Donwload is ok"),m(Object(r.a)(Object(r.a)({},b),{},{loading:!1})),window.Swal.fire({title:"Descargas",text:"El archivo CSV fue generado correctamente",icon:"success",showConfirmButton:!1,timer:1500})):(m(Object(r.a)(Object(r.a)({},b),{},{loading:!1})),window.Swal.fire({title:"Descargas",text:"El archivo CSV no se genero correctamente",icon:"error",showConfirmButton:!1,timer:3e3}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){m(Object(r.a)(Object(r.a)({},b),{},{loading:!0})),c.getItems(a.options).then((function(e){e&&m(Object(r.a)(Object(r.a)({},b),{},{items:e.data,meta:e.meta,loading:!1}))}))};return Object(d.useEffect)((function(){N()}),[a.options]),Object(x.jsx)(Z,{title:"Lista de productos",icon:"id-badge",color:"primary",loading:b.loading,meta:b.meta,itemSelected:null===(t=b.itemSelected)||void 0===t?void 0:t.id,defaultSearch:a.options.search,handlePagination:function(e){return p("page",e)},handleSearch:function(e){return p("search",e)},handleDeleteItem:function(){window.Swal.fire({title:"Productos",text:"Desea eliminar el producto seleccionado?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||c.deleteItem(b.itemSelected.id).then((function(e){!0===e&&window.Swal.fire({title:"Productos",text:"Producto eliminado correctamente",icon:"success",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||(m(Object(r.a)(Object(r.a)({},b),{},{itemSelected:{}})),m(Object(r.a)(Object(r.a)({},b),{},{loading:!0})),c.getItems(a.options).then((function(e){e&&m(Object(r.a)(Object(r.a)({},b),{},{items:e.data,meta:e.meta,loading:!1}))})))}))}))}))},handleEditItem:f,handleDownload:v,handleSync:N,children:Object(x.jsxs)("table",{className:"table table-hover table-striped",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"Codigo"}),Object(x.jsx)("th",{children:"Describci\xf3n"}),Object(x.jsx)("th",{children:"Proveedor"}),Object(x.jsx)("th",{children:"Marca"}),Object(x.jsx)("th",{children:"Cant"})]})}),Object(x.jsx)("tbody",{children:b.items.length?Object(x.jsx)(x.Fragment,{children:b.items.map((function(e){var t;return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(x.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:e.id,id:"item_"+e.id,checked:(null===(t=b.itemSelected)||void 0===t?void 0:t.id)===e.id,onChange:function(t){return function(e,t){var a=e.checked;m(Object(r.a)(Object(r.a)({},b),{},{itemSelected:a?t:{}}))}(t.target,e)}}),Object(x.jsx)("label",{htmlFor:"item_"+e.id,className:"sr-only"})]}),Object(x.jsx)("td",{className:"icheck-primary",children:Object(x.jsx)("div",{className:"badge badge-dark text-uppercase",children:e.code})}),Object(x.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",children:Object(x.jsx)("a",{href:"\xb7link",onClick:function(t){return f(t,e)},className:"text-bold",children:e.name})}),Object(x.jsx)("td",{className:"mailbox-attachment text-capitalize text-truncate text-muted",children:Object(x.jsx)("span",{children:e.supplier?e.supplier.name:"--"})}),Object(x.jsx)("td",{className:"mailbox-attachment text-uppercase text-truncate text-muted",children:Object(x.jsx)("span",{children:e.brand?e.brand.name:"--"})}),Object(x.jsx)("td",{className:"mailbox-date text-muted text-truncate text-right",children:Object(x.jsx)("span",{children:e.cant_total})})]},e.id)}))}):Object(x.jsx)("tr",{children:Object(x.jsx)("th",{className:"text-center text-muted",colSpan:"6",children:"No hay productos registrados"})})})]})})}var K=function(e){switch(e){case"monofocales":return"MF";case"bifocales":return"BF";case"progresivo basico":case"progresivo-basico":return"PB";case"progresivo digital":case"progresivo-digital":return"PD";case"plastico":return"CR";case"policarbonato":return"PL";case"hi-index":case"hi index":return"HI";case"antirreflejantes":return"AR";case"photo":return"PH";case"ar & photo":case"antirreflejante-photo":return"ARPH";case"blanco":return"BL";case"polarizado":return"PO";case"bifocal invisible":case"bifocal-invisible":return"BI";case"monofocal drivesafe":case"monofocal-drivesafe":case"monofocal digital drivesafe":case"monofocal digital DriveSafe":return"MDSF";case"monofocal superb":case"monofocal-superb":case"monofocal digital superb":return"MDSU";case"monofocal individual":case"monofocal-individual":case"monofocal digital individual":return"MDIN";default:return"XX"}},W={verifyItem:function(e){return e.cant<=0?(window.Swal.fire({title:"Verificacion",text:"La cantidad debe de ser un valor valido",icon:"warning"}),!1):e.store_items_id?!!e.price||(window.Swal.fire({title:"Verificacion",text:"El precio no es valido",icon:"warning"}),!1):(window.Swal.fire({title:"Verificacion",text:"No se selecciono un producto valido",icon:"warning"}),!1)},handleDeleteItem:function(e,t,a,c){if(e.id)return c||(c="\xbfEsta seguro de eliminar el producto ".concat(e.code,"?")),window.Swal.fire({text:c,icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(c){if(!c.dismiss&&a)return a({id:e.id,options:t}),!0})),!1},handleVerifyData:function(e,t){var a=e.category_id,c=e.category_id1,n=e.category_id2,s=e.category_id4,r=e.supplier,i=e.brand_id,l=e.code;if(!a)return window.Swal.fire("Verificaci\xf3n","Selecione una categoria primero","warning"),!1;if(a){if(1===c&&s!==a)return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para lentes","warning"),!1;if(2===c&&n!==a)return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para armazones","warning"),!1}return 2!==c||r?2!==c||i?!(!l&&!t.current.value)||(window.Swal.fire("Verificaci\xf3n","Escriba una CODIGO para este producto","warning"),!1):(window.Swal.fire("Verificaci\xf3n","Selecione una MARCA valida primero","warning"),!1):(window.Swal.fire("Verificaci\xf3n","Selecione un PROVEEDOR valido primero","warning"),!1)},handleSaveItem:function(e,t,a,c,n,s){s||(s=e?"\xbfEsta seguro de actualizar el producto?":"\xbfEsta seguro de crear un nuevo producto?"),window.Swal.fire({title:"Almacenamiento",text:s,icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:e?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(s){!s.dismiss&&c&&(c({id:e,data:t,options:a}),n&&n())}))},handleCatOne:function(e){return{category_id:e.id,category_id1:e.id,category_id2:0,category_list2:e.hijos,category_id3:0,category_list3:[],category_id4:0,category_list4:[],supplier:0}},handleCatTwo:function(e){return{category_id:e.id,category_id2:e.id,category_id3:0,category_list3:e.hijos,category_id4:0,category_list4:[]}},handleCatTree:function(e){return{category_id:e.id,category_id3:e.id,category_id4:0,category_list4:e.hijos}},handleCodeString:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"armazon",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return e+=null!==t?" "+t.trim():"",e+=null!==a?" "+a.trim().replace(/\s/gim,""):"",c&&(e+=" "+c.replace(/[\s]+/gm,"")),e.toLowerCase()},handleCodeLent:function(e,t,a,c){if(!t||!a||!c)return"";var n=null!==t?K(t.trim().toLowerCase()):"";return n+=null!==a?K(a.trim().toLowerCase()):"",(n+=null!==c?K(c.trim().toLowerCase()):"")+e.toString().trim().replace(/\s/gim,"")},codeLentString:K,handleNameLent:function(e,t,a,c){if(!t||!a||!c)return"";var n="";return n+=null!==t?t.trim():"",n+=null!==a?" "+a.trim():"",n+=null!==c?" "+c.trim():"",(n+=" "+e.toString()).toLowerCase()}},X=W;function Q(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("categories",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){return console.error("[Orus System] Catch when get categories list in hook:",e.message),null}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("categories",t),e.next=5,h(a,"GET").then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when get category in hook:",e.message),{}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("categories",t),e.next=5,h(a,"DELETE").then((function(){return!0})).catch((function(e){return console.error("[Orus System] Catch when delete category in hook:",e.message),!1}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a=t.id,delete t.id,!a){e.next=11;break}return c=O("categories",a),e.next=8,h(c,"PUT",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when save category in hook:",e.message),null}));case 8:case 14:return e.abrupt("return",e.sent);case 11:return n=O("categories"),e.next=14,h(n,"POST",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when save category in hook:",e.message),null}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getCategories:e,getCategory:t,deleteCategory:a,saveCategory:c}}function ee(e){var t,a,c,n,s,l,o=Q(),j=Object(d.useState)({categories:[],cat1:0,cat2:0,cat3:0,cat4:0,catNameSelect:[],load:!0}),u=Object(i.a)(j,2),b=u[0],m=u[1],h=b.categories.filter((function(e){return e.id===b.cat1}))[0],O=null===h||void 0===h||null===(t=h.sons)||void 0===t?void 0:t.filter((function(e){return e.id===b.cat2}))[0],p=null===O||void 0===O||null===(a=O.sons)||void 0===a?void 0:a.filter((function(e){return e.id===b.cat3}))[0],f=null===p||void 0===p||null===(c=p.sons)||void 0===c?void 0:c.filter((function(e){return e.id===b.cat4}))[0],v=function(t,a){var c=t.filter((function(e){return e.id===a}))[0];null!==c&&void 0!==c&&c.codeName&&c.codeName.length&&e.handleSetCatName(c.codeName)};return Object(d.useEffect)((function(){b.categories.length||o.getCategories({categoryid:"raiz"}).then((function(e){var t=e.data;m(Object(r.a)(Object(r.a)({},b),{},{categories:t,load:!1}))})),function(){var t,a,c;!b.cat1||!h||null!==(t=h.sons)&&void 0!==t&&t.length?!e.category||!b.cat1||b.cat2||b.cat3||b.cat4?!b.cat2||!O||null!==(a=O.sons)&&void 0!==a&&a.length?e.category&&b.cat1&&b.cat2&&!b.cat3&&!b.cat4?e.handleChange(0,[]):!b.cat3||!p||null!==(c=p.sons)&&void 0!==c&&c.length?e.category&&b.cat1&&b.cat2&&b.cat3&&!b.cat4?e.handleChange(0,[]):b.cat4&&e.handleChange(b.cat4,null===f||void 0===f?void 0:f.code):e.handleChange(b.cat3,p.code):e.handleChange(b.cat2,O.code):e.handleChange(0,[]):e.handleChange(b.cat1,h.code)}()}),[b]),Object(d.useEffect)((function(){var t;b.categories.length&&e.category&&(t=e.category,o.getCategory(t).then((function(e){b.cat1===parseInt(e.code[0])&&b.cat2===parseInt(e.code[1])&&b.cat3===parseInt(e.code[2])&&b.cat4===parseInt(e.code[3])||m(Object(r.a)(Object(r.a)({},b),{},{cat1:parseInt(e.code[0]),cat2:parseInt(e.code[1]),cat3:parseInt(e.code[2]),cat4:parseInt(e.code[3]),load:!1}))})))}),[b.categories,e.category]),Object(x.jsxs)("div",{children:[Object(x.jsx)(U,{text:"Seleccione una categoria principal",options:b.categories,value:b.cat1,load:b.load,handleChange:function(e){v(b.categories,e),m(Object(r.a)(Object(r.a)({},b),{},{cat1:e,cat2:0,cat3:0,cat4:0}))}}),Boolean(b.cat1)&&Boolean(null===h||void 0===h||null===(n=h.sons)||void 0===n?void 0:n.length)&&Object(x.jsx)(U,{text:"Seleccione una categoria para ".concat(h.name),options:h.sons,value:b.cat2,handleChange:function(e){v(h.sons,e),m(Object(r.a)(Object(r.a)({},b),{},{cat2:e,cat3:0,cat4:0}))}}),Boolean(b.cat2)&&Boolean(null===O||void 0===O||null===(s=O.sons)||void 0===s?void 0:s.length)&&Object(x.jsx)(U,{text:"Seleccione una categoria para ".concat(O.name),options:O.sons,value:b.cat3,handleChange:function(e){v(O.sons,e),m(Object(r.a)(Object(r.a)({},b),{},{cat3:e,cat4:0}))}}),Boolean(b.cat2)&&Boolean(null===p||void 0===p||null===(l=p.sons)||void 0===l?void 0:l.length)&&Object(x.jsx)(U,{text:"Seleccione una categoria para ".concat(p.name),options:p.sons,value:b.cat4,handleChange:function(e){v(p.sons,e),m(Object(r.a)(Object(r.a)({},b),{},{cat4:e}))}})]})}function te(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("store",null,{search:t}),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("store",t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t,a){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=O("store",null,{code:t,id:a}),e.next=3,h(c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.id,c=O("store"),!a){e.next=8;break}return e.next=5,h(c,"PUT",t);case 5:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,h(c,"POST",t);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getProducts:e,getProductById:t,getProductByCode:a,saveProduct:c}}function ae(e){var t=te(),a=Object(d.useState)({codeMessage:"",codeStatus:"empty",rendered:!1}),c=Object(i.a)(a,2),n=c[0],s=c[1];Object(d.useEffect)((function(){if(e.code.length){if(n.rendered)return null;l()}else s(Object(r.a)(Object(r.a)({},n),{},{codeMessage:"C\xf2digo vacio",codeStatus:"empty"}))}),[e.code]),Object(d.useEffect)((function(){e.onChangeStatusCode(n.codeStatus)}),[n.codeStatus]);var l=function(){s(Object(r.a)(Object(r.a)({},n),{},{codeMessage:"Validando c\xf3digo . . .",codeStatus:"validating"})),t.getProductByCode(e.code,e.id).then((function(e){e.data.length?s(Object(r.a)(Object(r.a)({},n),{},{codeMessage:"C\xf2digo ya en uso",codeStatus:"inUse",rendered:!0})):s(Object(r.a)(Object(r.a)({},n),{},{codeMessage:"C\xf2digo disponible",codeStatus:"available",rendered:!0}))})).catch((function(e){return console.log(e)}))};return Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"empty"===n.codeStatus||"inUse"===n.codeStatus?"input-group-text bg-warning":"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-code"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo",name:"code",value:e.code,onChange:function(t){var a=t.target.value;e.onChangeProductCode(a)},onBlur:function(){"lentes"===e.type?l():(l(),e.createName())},autoComplete:"off",maxLength:"18"}),Object(x.jsx)("span",{className:"text-muted text-xs d-block w-100",children:n.codeMessage})]})}function ce(e){var t=e.branch_default,a=e.showIcon,c=void 0===a||a,n=e.setBranchId,s=Object(d.useContext)(y).data.filter((function(e){return"branches"===e.name}));return Object(x.jsxs)("div",{className:"input-group mb-3",children:[c&&Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-store-alt"})})}),Object(x.jsxs)("select",{className:"custom-select text-uppercase",name:"branch_id",value:t,onChange:function(e){var t=e.target;return n(t)},children:[Object(x.jsx)("option",{value:"0",children:"-- Ninguna --"}),s.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.data.name},e.id)}))]})]})}function ne(e){var t=e.inBranch,a=e.branchID,c=e.storeItemID,n=R(),s=Object(d.useState)({id:0,cant:0,price:1,store_item_id:0,branch_id:0,readyToSave:!1}),l=Object(i.a)(s,2),o=l[0],j=l[1],u=function(e){var a=e.name,c=e.value,n=!1;c="cant"===a?parseInt(c):parseFloat(c),t[a]!==c&&(n=!0),j(Object(r.a)(Object(r.a)({},o),{},Object(g.a)({readyToSave:n},a,c)))};return Object(d.useEffect)((function(){j({id:t.id?t.id:0,cant:t.cant?t.cant:0,price:t.price?t.price:0,readyToSave:!1,store_item_id:c,branch_id:a})}),[t]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Cantidad en existencia"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-database"})})}),Object(x.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Cantidades en existencia",name:"cant",onChange:function(e){var t=e.target;return u(t)},value:o.cant,min:0})]})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Precio"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-money-bill"})})}),Object(x.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Precio",name:"price",onChange:function(e){var t=e.target;return u(t)},value:o.price,min:0})]})]})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col text-right",children:Object(x.jsxs)("button",{className:o.readyToSave?"btn btn-success":"btn btn-secondary",type:"button",onClick:function(){n.saveQantityandPrice(o).then((function(e){e||console.error("Error al guardar la informacion")})),j(Object(r.a)(Object(r.a)({},o),{},{readyToSave:!1}))},disabled:!o.readyToSave,children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"})," Guardar"]})})})]})}function se(e){var t=e.branches,a=e.storeItemID,c=e.defaultBranch,n=Object(d.useContext)(y).data.filter((function(e){return"branches"===e.name}));return Object(x.jsx)("form",{children:0===c?n.map((function(e){var c,n=t.filter((function(t){return t.branch_id===e.id}));return Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h5",{className:"card-title text-primary text-capitalize",children:[Object(x.jsx)("i",{className:"fas fa-store-alt mr-1"})," ",e.data.name]})}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)(ne,{inBranch:null!==(c=n[0])&&void 0!==c?c:{},branchID:e.id,storeItemID:a})})]},e.id)})):n.map((function(e){var n,s=t.filter((function(t){return t.branch_id===e.id}));return e.id===c?Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h5",{className:"card-title text-primary text-capitalize",children:[Object(x.jsx)("i",{className:"fas fa-store-alt mr-1"})," ",e.data.name]})}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)(ne,{inBranch:null!==(n=s[0])&&void 0!==n?n:{},branchID:e.id,storeItemID:a})})]},e.id):null}))})}var re={id:0,code:"",codebar:"",grad:"",brand_id:0,name:"",unit:"PZ",cant:1,price:1,supplier_id:0,category_id:0,branch_default:0,data:{category:"",categories:[],branches:[],codes:[],category_code:[],activity:[],codenames:[],brandname:""},codeStatus:"empty",loading:!1,readyToSave:!1};function ie(e){var t=Object(d.useContext)(V),a=e.match.params.id,c=Object(d.useState)(re),s=Object(i.a)(c,2),l=s[0],o=s[1],j=R(),b=l.code,m=l.loading,h=Object(u.f)(),O=!1;O="lentes"===l.data.codenames[0]?!!(l.category_id&&l.code&&"available"===l.codeStatus&&l.name.length):!!(l.category_id&&l.supplier_id&&l.brand_id&&l.code&&"available"===l.codeStatus&&l.name.length),Object(d.useEffect)((function(){a&&j.getItem(a).then((function(e){var t,a,c,n;o(Object(r.a)(Object(r.a)({},l),{},{id:e.id?e.id:0,name:e.name?e.name:"",category_id:null===(t=e.category)||void 0===t?void 0:t.id,supplier_id:null===(a=e.supplier)||void 0===a?void 0:a.id,brand_id:null===(c=e.brand)||void 0===c?void 0:c.id,branch_default:null!==(n=e.branch_default)&&void 0!==n?n:0,code:e.code?e.code:"",codebar:e.barcode?e.barcode:"",data:Object(r.a)(Object(r.a)({},l.data),{},{category:e.category?e.category:[],inBranches:e.inBranches?e.inBranches:"",branches:e.branches?e.branches:[],activity:e.activity?e.activity:[]}),loading:!1}))}))}),[a]);var p=function(e,t){var a=l.code,c=l.grad,n=l.data.codenames;if("lentes"!==n[0]){var s=null!==n[0]?n[0].trim().replace(/\s/gim,"").slice(0,7):"",i=X.handleCodeString("varios"===s?"":s,n[1],t,a);o(Object(r.a)(Object(r.a)({},l),{},{brand_id:e,name:i,data:Object(r.a)(Object(r.a)({},l.data),{},{brandname:t})}))}else{var d=X.handleNameLent(c,n[1],n[2],n[3]),j=X.handleCodeLent(c,n[1],n[2],n[3]);l.grad?o(Object(r.a)(Object(r.a)({},l),{},{name:d,code:j})):o(Object(r.a)(Object(r.a)({},l),{},{name:d}))}};return Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title text-primary text-bold",children:[Object(x.jsx)("i",{className:"fas fa-database mr-1"}),a?"Editar producto (".concat(b,")"):"Registrar nuevo producto"]})}),Object(x.jsxs)("form",{className:"card-body",autoComplete:"off",children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("fieldset",{children:[Object(x.jsx)("small",{className:"mr-2",children:Object(x.jsx)("label",{children:"Categoria"})}),Object(x.jsx)(ee,{category:l.category_id,handleChange:function(e,t,a){o(Object(r.a)(Object(r.a)({},l),{},{category_id:e,data:Object(r.a)(Object(r.a)({},l.data),{},{category_code:t})}))},handleSetCatName:function(e){o(Object(r.a)(Object(r.a)({},l),{},{data:Object(r.a)(Object(r.a)({},l.data),{},{codenames:e}),loading:!1}))}})]})})}),Boolean(l.data.category_code.length)&&!l.data.category_code.includes("1")&&Object(x.jsx)(G,{supplier:l.supplier_id,handleChangeSupplier:function(e){o(Object(r.a)(Object(r.a)({},l),{},{supplier_id:e,brand_id:0}))}}),Boolean(l.supplier_id)&&Object(x.jsx)(q,{brand:l.brand_id,supplier:l.supplier_id,textSelect:"Selecione la marca",handleChangeBrand:function(e,t){o(Object(r.a)(Object(r.a)({},l),{},{brand_id:e,data:Object(r.a)(Object(r.a)({},l.data),{},{brandname:t})}))}}),l.category_id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[l.data.category_code.includes("1")&&Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Graduacion"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-glasses"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"+100100",defaultValue:l.grad,onChange:function(e){var t=e.target;return o(Object(r.a)(Object(r.a)({},l),{},{grad:t.value}))},onBlur:function(){p()},maxLength:"7",autoComplete:"off"})]})]}),Object(x.jsxs)("div",{className:"col",children:[l.unit?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Unidad de presentacion"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:l.unit?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(x.jsx)("i",{className:"fas fa-balance-scale"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Unidad de presentaci\xf3n",defaultValue:l.unit,onChange:function(e){var t=e.target;return o(Object(r.a)(Object(r.a)({},l),{},{unit:t.value}))},maxLength:"4"})]})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-5",children:[l.code?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Codigo"})}):Object(x.jsx)("br",{}),Object(x.jsx)(ae,{code:l.code,id:l.id,type:l.data.codenames[0],createName:function(){return p(l.brand_id,l.data.brandname)},onChangeStatusCode:function(e){o(Object(r.a)(Object(r.a)({},l),{},{codeStatus:e}))},onChangeProductCode:function(e){(null===e||void 0===e?void 0:e.length)>18||o(Object(r.a)(Object(r.a)({},l),{},{code:e.replace(" ","")}))}})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Codigo de barras"})}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text bg-primary",children:Object(x.jsx)("i",{className:"fas fa-barcode"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Codigo de barras",name:"codebar",defaultValue:l.codebar,onChange:function(e){var t=e.target;o(Object(r.a)(Object(r.a)({},l),{},{codebar:t.value}))},autoComplete:"off",maxLength:"100"})]})]})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col",children:[l.name?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Nombre del producto"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:l.name?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(x.jsx)("i",{className:"fas fa-archive"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre",name:"name",defaultValue:l.name,onChange:function(e){var t=e.target;o(Object(r.a)(Object(r.a)({},l),{},{name:t.value}))},maxLength:"149"})]})]})})]}):Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("h6",{className:"text-warning",children:"Seleccione primero una categor\xeda."})})})]}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-md-12",children:Object(x.jsxs)("div",{className:"btn-group",role:"group",children:[Object(x.jsxs)(n.b,{to:"/almacen",className:"btn btn-default",onClick:function(){t.set(Object(r.a)(Object(r.a)({},t),{},{panel:"inbox"}))},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),a?"Cerrar":"Cancelar"]}),Object(x.jsxs)("button",{type:"button",onClick:function(){!function(){var e=Object(r.a)({},l);e.brand_id||delete e.brand_id,e.supplier_id||delete e.supplier_id,j.saveItem(e).then((function(e){if(e){var t=e.data.id;window.Swal.fire({title:"Productos",text:"Producto guardado correctamente",icon:"success",showConfirmButton:!1,timerProgressBar:!0,showLoaderOnConfirm:!0,timer:3e3}).then((function(){h.push("/almacen/".concat(t))}))}})).catch((function(e){window.Swal.fire({title:"Error al guardar el producto",text:e.errors.name[0],icon:"info",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"Cambiar nombre",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0})}))}()},className:"btn btn-primary",disabled:!O,children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),"Guardar"]})]})})})}),m&&Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})}),a?Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h5",{className:"card-title text-primary",children:"Sucursal por defecto"})}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)(ce,{branch_default:l.branch_default,showIcon:!1,setBranchId:function(e){var t=e.value;o(Object(r.a)(Object(r.a)({},l),{},{branch_default:parseInt(t)}))}})})]})})}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(se,{branches:l.data.branches,storeItemID:l.id,defaultBranch:l.branch_default})})})]}):null,l.data.activity.length?Object(x.jsx)("div",{className:"col-lg-12",children:Object(x.jsx)(F,{data:l.data.activity})}):null]})}function le(e){var t=Q(),a=JSON.parse(localStorage.getItem("OrusSystem")),c=Object(d.useContext)(V),n=Object(d.useState)({id:0,meta:{},dd:!1,name:"",category_raiz:[],category_id:e.category,page:1,host:a.host,token:a.token,load:!1}),s=Object(i.a)(n,2),l=s[0],o=s[1],u=l.category_raiz,b=l.category_id,m=l.name,h=l.add,O=e.loading;Object(d.useEffect)((function(){var t=e.categoryData,a=void 0===t?[]:t;a&&o(Object(r.a)(Object(r.a)({},l),{},{category_raiz:a}))}),[e]);return Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("div",{className:"card-body",children:Object(x.jsxs)("table",{className:"table",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{style:{width:48}})]})}),Object(x.jsx)("tbody",{children:u.length?Object(x.jsx)(j.a.Fragment,{children:u.map((function(a){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-capitalize",children:Object(x.jsx)("a",{href:"#select!"+a.id,onClick:function(t){t.preventDefault(),function(t){var a=e.last,c=e.categorySelect,n=l.category_raiz;!a&&!(!t.sons||t.sons&&!t.sons.length)&&(c({category_id:t.id,category_data:n}),o(Object(r.a)(Object(r.a)({},l),{},{category_id:t.id})))}(a)},className:a.sons&&a.sons.length?"text-primary":"text-dark",children:a.name})}),Object(x.jsxs)("td",{className:"btn-group",children:[Object(x.jsx)("button",{type:"button",className:"btn btn-default",disabled:!0,title:"Proximamente",children:Object(x.jsx)("i",{className:"fas fa-edit"})}),Object(x.jsx)("button",{type:"button",title:"Eliminar",className:a.hijos&&a.hijos.length?"btn btn-outline-secondary btn-sm":"btn btn-outline-danger btn-sm",onClick:function(e){var n;n=a.id,a.name,n&&t.deleteCategory(n).then((function(e){e?window.Swal.fire({title:"Categorias",text:"Categoria eliminada correctamente",icon:"success",showCancelButton:!1,confirmButtonText:"OK",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||c.set(Object(r.a)(Object(r.a)({},c),{},{panel:"inbox"}))})):window.Swal.fire({title:"Categorias",text:"Error al eliminar la categoria",icon:"error",showCancelButton:!1,confirmButtonText:"OK",showLoaderOnConfirm:!0})}))},disabled:a.hijos&&a.hijos.length,children:Object(x.jsx)("i",{className:"fas fa-trash"})})]})]},a.id)}))}):Object(x.jsx)("tr",{children:Object(x.jsxs)("td",{colSpan:"8",className:"text-center",children:[Object(x.jsx)("span",{className:"mr-3",children:"Cargando categorias "}),Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Cargando ..."})})]})})}),h&&!O?Object(x.jsx)("tfoot",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)("input",{type:"text",name:"name",className:"form-control text-uppercase",autoComplete:"off",value:m,onChange:function(e){var t=e.target,a=t.name,c=t.value;o(Object(r.a)(Object(r.a)({},l),{},Object(g.a)({},a,c.toLowerCase())))},ref:function(e){}})}),Object(x.jsx)("td",{children:Object(x.jsx)("button",{className:"btn btn-dark btn-sm",onClick:function(){if(l.name.length<4)return window.Swal.fire("Verificaci\xf3n","Debe de escribir el nombre de la categoria","warning"),!1;var e=l.category_id,a={name:l.name,category_id:e};t.saveCategory(a).then((function(e){e?window.Swal.fire({title:"Categorias",text:"Categoria guardada correctamente",icon:"success",showCancelButton:!1,confirmButtonText:"OK",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||c.set(Object(r.a)(Object(r.a)({},c),{},{panel:"inbox"}))})):window.Swal.fire("Categorias","Error al guardar la categoria","error")}))},disabled:m.length<3,title:"Guardar categoria",children:Object(x.jsx)("i",{className:"fas fa-save"})})})]})}):null]})}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("button",{className:h?"btn btn-secondary btn-sm text-bold":"btn btn-primary btn-sm",onClick:function(){o(Object(r.a)(Object(r.a)({},l),{},{add:!l.add,name:""}))},disabled:!b,title:h?"Cancelar":"Crear nueva categoria",children:h?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),"Agregar"]})})})]})}function oe(){var e,t=Q(),a=Object(d.useState)({category_id:0,category_data:[]}),c=Object(i.a)(a,2),n=c[0],s=c[1],l=n.category_id,o=n.category_data,j=o,u={};if(l){var b=o.filter((function(e){return e.id===l}));b.length&&(u=b[0])&&u.sons&&(j=u.sons)}return Object(d.useEffect)((function(){t.getCategories({categoryid:"raiz"}).then((function(e){e?s(Object(r.a)(Object(r.a)({},n),{},{category_data:e.data})):console.error("Error al obtener la lista de categorias")}))}),[]),Object(x.jsx)("div",{className:"row",style:{minHeight:"100vh"},children:Object(x.jsxs)("div",{className:"col-8",children:[Object(x.jsx)("nav",{children:Object(x.jsx)("ol",{className:"breadcrumb",children:n.category_id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:Object(x.jsx)("a",{href:"#link",onClick:function(e){e&&e.preventDefault(),t.getCategories({categoryid:"raiz"}).then((function(e){e?s({category_data:e.data,category_id:null}):console.error("Error al obtener la lista de categorias")}))},children:"Raiz"})}),u.id?Object(x.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:u.name}):null]}):Object(x.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Seleccione una categoria para ver su contenido"})})}),Object(x.jsx)(le,{category:l,categoryData:null!==(e=j)&&void 0!==e?e:[],categorySelect:function(e){s(e)}})]})})}function de(e){var t=e.brands,a=e.handleEdit,c=void 0===a?null:a,n=e.handleDelete,s=void 0===n?null:n;return Object(x.jsx)("ul",{className:"card-text list-group",children:t.length?t.map((function(e){return Object(x.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(x.jsxs)("span",{className:"text-dark text-uppercase text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-thumbtack mr-1"}),e.name]}),Object(x.jsxs)("div",{children:[c&&Object(x.jsx)("span",{className:"badge badge-dark badge-pill py-1 mr-2",style:{cursor:"pointer"},title:"Editar",onClick:function(){return c(e)},children:Object(x.jsx)("i",{className:"fas fa-edit"})}),s&&Object(x.jsx)("span",{className:"badge badge-danger badge-pill py-1",style:{cursor:"pointer"},title:"Eliminar",onClick:function(){return s(e)},children:Object(x.jsx)("i",{className:"fas fa-trash"})})]})]},e.id)})):Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("p",{className:"text-danger",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"No exiten marcas para este proveedor!"]})})})}function je(){var e=R(),t=Object(d.useContext)(V),a=Object(d.useState)({id:null,supplier:0,brands:[],name:"",loading:!1}),c=Object(i.a)(a,2),n=c[0],s=c[1];Object(d.useEffect)((function(){l()}),[n.supplier]);var l=function(){var t=n.supplier;t&&e.getBrands({supplier:t,order:"name"}).then((function(e){e?s(Object(r.a)(Object(r.a)({},n),{},{brands:e.data})):console.error("Error al obtener la lista de marcas")}))},o=n.id,j=n.supplier,u=n.name,b=n.loading;return Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsx)("div",{className:j?"col-lg-6":"col-lg-12",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("h5",{className:"card-title mt-2 ml-2 text-bold",children:"Marcas para productos"}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)(G,{supplier:j,handleChangeSupplier:function(e){s(Object(r.a)(Object(r.a)({},n),{},{supplier:e,brands:e?n.brands:[]}))}}),!n.brands.length&&Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Para iniciar, primero seleccione a un proveedor"]})]})]})}),j?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title text-dark mb-4 text-bold",children:"Listado de marcas"}),Object(x.jsx)(de,{brands:n.brands,handleEdit:function(e){return function(e){s(Object(r.a)(Object(r.a)({},n),{},{name:e.nombre,id:e.id}))}(e)},handleDelete:function(a){!function(a,c){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la marca "+c.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(c){c.dismiss||(e.deleteBrand(a).then((function(e){!0===e?window.Swal.fire({title:"Marcas",text:"Marca eliminada correctamente",icon:"success",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}):window.Swal.fire({title:"Marcas",text:"Error al eliminar la marca",icon:"error",showCancelButton:!1,confirmButtonColor:"#d33",confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0})})),t.set(Object(r.a)(Object(r.a)({},t),{},{panel:"inbox"})))}))}(a.id,a.name)}})]}),Object(x.jsx)("div",{className:"card-footer",children:Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("input",{type:"text",className:"form-control mr-1",name:"name",value:u,onChange:function(e){return function(e){var t=e.name,a=e.value;s(Object(r.a)(Object(r.a)({},n),{},Object(g.a)({},t,a.toLowerCase())))}(e.target)}}),Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsx)("button",{type:"button",className:"btn btn-default",disabled:!u,onClick:function(){s(Object(r.a)(Object(r.a)({},n),{},{name:"",id:null}))},children:Object(x.jsx)("i",{className:"fas fa-eraser"})}),Object(x.jsx)("button",{type:"button",className:o?"btn btn-success":"btn btn-primary",onClick:function(a){a.preventDefault();var c=n.name,i=n.supplier,l={name:c,contact_id:i};return c.length<3?(window.Swal.fire("Error","El nombre de la marca debe de tener por lo menos 3 caracteres","error"),!1):i?void window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de CREAR un nuevo producto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(a){a.dismiss||(e.saveBrand(l).then((function(e){e?window.Swal.fire({title:"Almacenamiento",text:"Producto almacenado correctamente",icon:"success",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}):console.error("Error al guardar la data enviada")})),t.set(Object(r.a)(Object(r.a)({},t),{},{panel:"inbox"})),s(Object(r.a)(Object(r.a)({},n),{},{name:"",id:null})))})):(window.Swal.fire("Error","Debe de elegir a un proveedor primero","error"),!1)},disabled:!u,children:Object(x.jsx)("i",{className:"fas fa-save"})})]})]})}),b?Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})}):null]})}var ue=a(26);var be=function(e){var t=e.item,a=e.handleClose,c=(e.handleUpdateItems,Object(d.useState)(0)),n=Object(i.a)(c,2),s=n[0],r=n[1],l=R();return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Asignar Cantidad"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:a,children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsxs)("div",{className:"modal-body p-2",children:[Object(x.jsx)("h5",{className:"text-center mt-2 mb-3",children:Object(x.jsx)("span",{class:"badge badge-info",children:t.name.toUpperCase()})}),Object(x.jsxs)("h6",{className:"text-center font-weight-bold",children:["Cantidad actual: ",Object(x.jsx)("span",{className:"font-weight-normal",children:t.cant})]}),Object(x.jsxs)("div",{className:"",children:[Object(x.jsx)("label",{children:"Cantidad"}),Object(x.jsx)("input",{name:"price",type:"number",defaultValue:0,className:"form-control",placeholder:"Cantidad",onChange:function(e){return r(e.target.value)}})]})]}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:a,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsx)("button",{type:"button",className:"btn btn-success",disabled:s<=0||"0"===s||!s,onClick:function(){var e={product_id:t.id,cant:s};l.saveQantity(e).then((function(e){e?a(e.data):console.error("Error al guardar la cantidad")}))},children:"Asignar"})]})]})})})};function me(e){var t=e.header,a=e.body,c=e.itemsProp,s=Object(d.useState)({item:{},showModal:!1,items:[]}),l=Object(i.a)(s,2),o=l[0],j=l[1];return Object(d.useEffect)((function(){j(Object(r.a)(Object(r.a)({},o),{},{items:c}))}),[]),Object(x.jsxs)("div",{className:"table-responsive",style:{height:"100vh"},children:[Object(x.jsxs)("table",{className:"table table-sm table-bordered table-hover",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"/"}),t]})}),Object(x.jsx)("tbody",{children:a.map((function(e,a){var c="label"===e.props.children.type;return Object(x.jsxs)("tr",{className:c?"table-secondary":"",children:[e,t.map((function(t,a){var s=c?parseFloat(e.props.children.props.children).toFixed(2).replace(".",""):parseFloat(e.props.children).toFixed(2).replace(".","");return parseInt(s)>=0&&(s="+"+s),s+=parseFloat(t.props.children).toFixed(2).replace(/[-.]/g,""),Object(x.jsx)("td",{className:"text-center",children:o.items.length?o.items.map((function(e,t){return s===e.grad?Object(x.jsx)("div",{children:e.cant_total?Object(x.jsx)("span",{onClick:function(){j(Object(r.a)(Object(r.a)({},o),{},{item:e,showModal:!0}))},style:{cursor:"pointer"},title:e.grad,className:e.cant>0?"badge badge-success":"badge badge-danger",children:e.cant},e.id+t):null},t):null})):Object(x.jsx)(n.b,{to:"/almacen/registro",children:Object(x.jsx)("i",{className:"fas fa-plus text-secondary"})})},s+a)}))]},a)}))})]}),o.showModal?Object(x.jsx)(be,{item:o.item,handleClose:function(e){var t=Object(ue.a)(o.items);t.forEach((function(t){t.id===e.id&&(t.cant=e.cant)})),j(Object(r.a)(Object(r.a)({},o),{},{items:t,showModal:!1}))}}):null]})}var he=function(e){var t=e.category,a=e.handleSave,c=e.handleClose,n=Object(d.useState)(!1),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(d.useState)(0),j=Object(i.a)(o,2),u=j[0],b=j[1];return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Asignar Precio"}),Object(x.jsx)("button",{onClick:c,type:"button",className:"close",children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:r?Object(x.jsxs)("div",{className:"text-center",children:[Object(x.jsx)("h4",{className:"text-primary",children:"Asignando precios "}),Object(x.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Cargando ..."})})]}):Object(x.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[Object(x.jsx)("h5",{className:"text-center mt-2 mb-3",children:Object(x.jsx)("span",{className:"badge badge-info",children:t.toUpperCase()})}),Object(x.jsx)("label",{children:"Precio"}),Object(x.jsx)("input",{onChange:function(e){var t=e.target.value;b(t)},name:"price",type:"number",defaultValue:u,className:"form-control",placeholder:"Precio"})]})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:c,disabled:!!r,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsx)("button",{disabled:!(!r&&u&&"0"!==u),type:"button",className:"btn btn-success",onClick:function(){a(u),l(!0)},children:"Asignar"})]})]})})})};function Oe(){var e=Object(d.useState)({catData_1:[],catData_2:[],catData_3:[],catid_1:0,catid_2:0,catid_3:0,load:!1,items:[],meta:{},price:0}),t=Object(i.a)(e,2),a=t[0],c=t[1],n=Object(d.useState)(!1),l=Object(i.a)(n,2),u=l[0],b=l[1],m=Q(),h=R(),O=[],p=[],f=0;do{O.push(Object(x.jsx)("th",{children:f.toFixed(2)},f)),f-=.25}while(f>parseFloat(a.meta.cil)-.25);f=parseFloat(a.meta.rangoInf);do{0===f?p.push(Object(x.jsx)("td",{children:Object(x.jsx)("label",{children:"0.00"})})):p.push(Object(x.jsx)("td",{children:f.toFixed(2)})),f+=.25}while(f<parseFloat(a.meta.rangoSup)+.25);var v=0===a.items.length,g=function(){b(!u)},N=function(){var e=Object(s.a)(o.a.mark((function e(t){var n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.load,s={cat:t,itemsPage:500},n||c(Object(r.a)(Object(r.a)({},a),{},{load:!0})),h.getItems(s).then((function(e){if(e){var n=e.data.filter((function(e){return"+000000"!==e.grad}));c(Object(r.a)(Object(r.a)({},a),{},{items:n||[],catid_3:t,load:!1}))}else console.error("Error al obtener la lista de productos"),c(Object(r.a)(Object(r.a)({},a),{},{load:!1}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){m.getCategories({categoryid:"raiz"}).then((function(e){e&&e.data?c(Object(r.a)(Object(r.a)({},a),{},{catid_1:5,meta:e.data[0].meta,catData_1:e.data[0].sons,catData_2:e.data[0].sons[0].sons})):(console.error("Error al descargar categor\xedas"),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"))}))}),[]),Object(x.jsx)("div",{className:"row",style:{height:"1000px"},children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("div",{className:"d-flex justify-content-around align-items-center",children:[Object(x.jsx)("div",{className:"col-lg-3",children:Object(x.jsxs)("select",{className:"custom-select",name:"catid_2",value:a.catid_2,onChange:function(e){var t=e.target,n=t.name,s=t.value,i=a.catData_1,l=a.catData_2,o=[],d={};"catid_1"===n?(i.map((function(e){return e.id===parseInt(s)&&(o=e.sons,d=e.meta,!0)})),c(Object(r.a)(Object(r.a)({},a),{},{catid_1:parseInt(s),catid_2:0,catid_3:0,catData_2:o,catData_3:[],meta:d}))):"catid_2"===n&&(l.map((function(e){return e.id===parseInt(s)&&(o=e.sons,!0)})),c(Object(r.a)(Object(r.a)({},a),{},{catid_2:parseInt(s),catid_3:0,catData_3:o})))},children:[Object(x.jsx)("option",{value:"0",children:"Seleccione un material"}),a.catData_2.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})}),a.catid_2&&a.catData_3.length?Object(x.jsxs)("div",{className:"col-lg-9 d-flex justify-content-around align-items-center",children:[Object(x.jsx)("div",{className:"btn-group col-lg-8",role:"group","aria-label":"Basic example",style:{height:"3rem"},children:a.catData_3.map((function(e){return Object(x.jsx)("button",{className:a.catid_3===e.id?"btn btn-primary":"btn btn-secondary",onClick:function(t){N(e.id),c(Object(r.a)(Object(r.a)({},a),{},{catid_3:e.id,load:!0}))},children:e.name},e.id)}))}),Object(x.jsxs)("div",{className:"col-lg-4 d-flex flex-column align-items-center justify-content-center",children:[Object(x.jsxs)("p",{children:["Total de productos: ",a.items.length]}),Object(x.jsxs)("button",{disabled:v,className:"btn btn-success bg-success",onClick:g,children:["Asignar Precio",Object(x.jsx)("i",{className:"fas fa-money-bill ml-2"})]})]})]}):null]})}),Object(x.jsx)("div",{className:"card-body",children:a.catid_3?Object(x.jsx)(j.a.Fragment,{children:a.load?Object(x.jsxs)("div",{className:"text-center",children:[Object(x.jsx)("span",{className:"text-primary",children:"Cargando productos"}),Object(x.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Cargando ..."})})]}):Object(x.jsxs)(j.a.Fragment,{children:[Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsx)("div",{className:"col mt-2"}),Object(x.jsx)("div",{className:"col"}),Object(x.jsx)("div",{className:"col-6",children:Object(x.jsx)("div",{className:"row"})})]}),u&&Object(x.jsx)(he,{handleClose:g,handleSave:function(e){h.saveGlobalPrice({price:e,productCategoryId:a.catid_3}).then((function(e){g(),e?window.Swal.fire({title:"Productos",text:"Precio asignado correctamente",icon:"success",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"OK",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||console.log("[DEBUG] Show message ok")})):(console.error("Error en la cosulta"),window.Swal.fire({title:"Productos",text:"Erro al guardar el precio global",icon:"error",showCancelButton:!1,confirmButtonColor:"#007bff",confirmButtonText:"OK",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||console.log("[DEBUG] Show message failer")})))}))},category:function(){var e=a.catData_1.filter((function(e){return e.id===a.catid_1})),t=a.catData_2.filter((function(e){return e.id===a.catid_2})),c=a.catData_3.filter((function(e){return e.id===a.catid_3})),n="".concat(e[0].name," / ").concat(t[0].name," / ").concat(c[0].name);return"".concat(n)}()}),Object(x.jsx)(me,{header:O,body:p,itemsProp:a.items})]})}):Object(x.jsxs)("div",{className:"alert alert-warning text-light",role:"alert",children:[Object(x.jsxs)("h4",{className:"alert-heading",children:[Object(x.jsx)("i",{className:"fas fa-exclamation"})," Seleccion."]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("ul",{children:[a.catid_2?null:Object(x.jsx)("li",{children:"Seleccione el material"}),Object(x.jsx)("li",{children:"Por ultimo el tratamiento"})]})]})})]})})})}function xe(e){var t,a,c,n,s,l,o,j,u,b,m=e.state,h=e.setState,O=e.brands,p=e.itemSearch,f=e.searchFn,v=A(),g=Object(d.useState)({status:!1,class:"danger",message:""}),N=Object(i.a)(g,2),y=N[0],w=N[1],C=Object(d.useState)({status:!1,branch_id:null}),_=Object(i.a)(C,2),S=_[0],k=_[1],E=function(e){if(null!==p&&void 0!==p&&p.id){var t=p.branch_default?p.branch_default:m.branch_id,a=p.branches.filter((function(e){return e.branch_id===t}))[0];if(a&&a.price)if("armazones"===p.category.code.codeNameCategory[0]){console.log("[Orus System] set price from branch:",a.price);var c=Object(r.a)(Object(r.a)({},m),{},{price:parseFloat(a.price)});e&&!m.name&&(c.name=e),h(c)}}else e&&h(Object(r.a)(Object(r.a)({},m),{},{name:e}))};return Object(d.useEffect)((function(){if(p){var e,t=Object(r.a)(Object(r.a)({},m),{},{name:p.name,used:!1});if(console.log("[DEBUG] Search:",p),p.barcode&&(t.codeBar=p.barcode),p.brand)t.brand_id=null!==(e=p.brand.id)&&void 0!==e?e:"";if(p.branch_default&&!S.status&&(k({status:!0,branch_id:p.branch_default}),t.branch_id=p.branch_default),m.price&&m.cost&&m.cost>m.price)return w({status:!0,message:"El costo no puede se mayor al precio."}),void h(Object(r.a)(Object(r.a)({},m),{},{used:!0}));if(m.category_id)if("armazones"!==p.category.code.codeNameCategory[0])return w({status:!0,message:"Este codigo esta siendo usado en otra categoria.",class:"danger"}),void h(Object(r.a)(Object(r.a)({},m),{},{used:!0}));if(m.supplier_id)if(p.supplier.id!==m.supplier_id)return w({status:!0,message:"Este CODIGO de armazon esta asignado a otro proveedor",class:"warning"}),void h(Object(r.a)(Object(r.a)({},m),{},{used:!1}));w({status:!1,message:"",class:"danger"}),h(t)}}),[null===p||void 0===p?void 0:p.id,null===p||void 0===p?void 0:p.barcode,m.category_id,m.cost]),Object(d.useEffect)((function(){m.codeBar&&m.codeBar.length<10?w({status:!0,message:"El codigo de barras no puede ser menor a 10 digitos"}):w({status:!1,message:""})}),[m.codeBar]),Object(x.jsxs)(x.Fragment,{children:[y.status&&Object(x.jsx)("div",{className:"alert alert-"+(null!==(t=y.class)&&void 0!==t?t:"danger")+" w-100",children:Object(x.jsxs)("h6",{children:[Object(x.jsx)("i",{className:"fas fa-exclamation-triangle mr-1"}),y.message]})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"form-group col-4",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Codigo"}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo del producto",value:null!==(a=m.code)&&void 0!==a?a:"",maxLength:"18",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{code:t.toLowerCase().replace(" ","")}))}})]}),Object(x.jsxs)("div",{className:"form-group col-8",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Codigo de barras"}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo de barras",defaultValue:null!==(c=m.codeBar)&&void 0!==c?c:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{codeBar:t.toLowerCase()}))}})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"form-group col",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Categoria"}),Object(x.jsxs)("select",{className:"form-control text-uppercase",defaultValue:null!==(n=m.category_id)&&void 0!==n?n:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{category_id:parseInt(t)}))},disabled:function(){var e,t;return!(m.codeBar&&(null===(e=m.codeBar)||void 0===e?void 0:e.length)>10)&&!((null===(t=m.code)||void 0===t?void 0:t.length)>3)}(),onBlur:function(){var e=(Math.random()+1).toString(36).substring(7);m.code||h(Object(r.a)(Object(r.a)({},m),{},{code:e})),f(m.code?m.code:e)},children:[Object(x.jsx)("option",{children:"-- Seleccione uno --"}),v.cats.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(x.jsxs)("div",{className:"form-group col",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Marca"}),Object(x.jsxs)("select",{className:"form-control text-uppercase",defaultValue:null!==(s=m.brand_id)&&void 0!==s?s:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{brand_id:parseInt(t)}))},disabled:!m.category_id,onBlur:function(){var e,t;if(m.code&&m.brand_id&&m.category_id){var a="Armazon "+v.cats.filter((function(e){return e.id===m.category_id}))[0].name+" "+(null!==(e=null===(t=O.filter((function(e){return e.id===m.brand_id}))[0])||void 0===t?void 0:t.name)&&void 0!==e?e:"")+" "+m.code;console.log("[Orus System] Set name:",a),E(a)}},children:[Object(x.jsxs)("option",{children:["--",O.length?"Seleccione una marca":"Primero seleccione un proveedor","--"]}),O.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"form-group col-5",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Sucrusal"}),Object(x.jsxs)("select",{className:"form-control text-uppercase",value:S.status?S.branch_id:null!==(l=m.branch_id)&&void 0!==l?l:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{branch_id:parseInt(t)}))},disabled:!m.brand_id||S.status,onBlur:function(){return E()},children:[Object(x.jsx)("option",{children:"-- Seleccione uno --"}),v.branches.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(x.jsxs)("div",{className:"form-group col-7",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Descripcion"}),Object(x.jsx)("input",{type:"text",min:1,className:"form-control text-uppercase",placeholder:"Descripcion del producto",value:null!==(o=m.name)&&void 0!==o?o:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{name:t.toLowerCase()}))},disabled:!m.brand_id})]})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"form-group col-3",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Cantidad"}),Object(x.jsx)("input",{type:"number",min:1,className:"form-control text-uppercase",placeholder:"Cantidad inicial",defaultValue:null!==(j=m.cant)&&void 0!==j?j:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{cant:parseInt(t)}))},disabled:!m.branch_id})]}),Object(x.jsxs)("div",{className:"form-group col-3",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Precio"}),Object(x.jsx)("input",{type:"number",min:1,className:"form-control text-uppercase",placeholder:"Cantidad inicial",value:null!==(u=m.price)&&void 0!==u?u:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{price:parseFloat(t)}))},disabled:!m.branch_id})]}),Object(x.jsxs)("div",{className:"form-group col-3",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Costo"}),Object(x.jsx)("input",{type:"text",min:1,className:"form-control text-uppercase",placeholder:"Descripcion del producto",defaultValue:null!==(b=m.cost)&&void 0!==b?b:"",onChange:function(e){var t=e.target.value;return h(Object(r.a)(Object(r.a)({},m),{},{cost:parseFloat(t)}))},disabled:!m.price,onBlur:function(){}})]})]})]})}function pe(e){var t=e.handleCancel,a=e.handleAdd,c=e.supplier_id,n=A(),s=f().auth,l=R(),o=Object(d.useState)([]),j=Object(i.a)(o,2),u=j[0],b=j[1],m=Object(d.useState)(!1),h=Object(i.a)(m,2),O=h[0],p=h[1],v=Object(d.useState)(!1),g=Object(i.a)(v,2),N=g[0],y=g[1],w=Object(d.useState)(null),C=Object(i.a)(w,2),_=C[0],S=C[1],k=Object(d.useState)({id:Date.now(),code:"",codeBar:"",category_id:"",brand_id:"",branch_id:s.branch.id,cant:1,name:"",price:0,cost:0,saved:!1,cantAdd:!1,used:!1}),E=Object(i.a)(k,2),B=E[0],I=E[1];return Object(d.useEffect)((function(){if(console.log("[Orus System] Selected supplier id:",c),console.log("[Orus System] Branch id default:",s.branch.id),c){var e=n.suppliers.filter((function(e){return e.id===c}));if(e&&!e.length)return console.log("[Orus System] Not found supplier from list:",e),void b([]);var t=e[0].brands;b(t)}else b([])}),[]),Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title text-dark text-bold text-capitalize",children:"Agregar nuevo armazon"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:t,children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body",children:Object(x.jsx)(xe,{state:B,setState:I,brands:u,itemSearch:_,searchFn:function(e){return y(!0),l.getItems({search:e}).then((function(e){var t=e.data.find((function(e){return e.code.toLowerCase()===B.code.toLowerCase()}));return S(t),y(!1),t}))}})}),Object(x.jsx)("div",{className:"modal-footer",children:O?Object(x.jsx)("div",{className:"alert alert-warning w-100",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-9",children:["El ",Object(x.jsx)("strong",{children:"codigo"})," ya se encuentra registrado."," ",Object(x.jsx)("br",{}),Object(x.jsx)("strong",{children:"\xbfDesea agregar las cantidades a este Armazon?"})]}),Object(x.jsx)("div",{className:"col-3 text-rigth",children:Object(x.jsx)("button",{className:"btn btn-dark",onClick:function(){return a(B)},children:"Confirmar"})})]})}):Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsxs)("button",{className:"btn btn-dark",onClick:function(){return t()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{className:"btn btn-primary",onClick:function(){if(y(!0),_){var e=_.branches.filter((function(e){return e.branch_id===B.branch_id}));if(e.length?e[0]:null)return console.log("[Orus System] Sent confirm"),I(Object(r.a)(Object(r.a)({},B),{},{saved:!0})),p(!0),y(!1),_}console.log("[Orus System] Add new item"),a(B)},disabled:!!(N||B.codeBar&&B.codeBar.length<10||!B.brand_id||!B.branch_id||!B.cant||B.cant<1||!B.name||B.name.length<8||B.price<1||B.used)||B.price<B.cost,children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),N?"Guardando...":"Agregar"]})]})})]})})})}function fe(e){var t,a,c=e.item,n=e.newRow,s=e.supplier_id,r=e.handleDelete,i=A(),l=i.cats.filter((function(e){return e.id===c.category_id}))[0],o=i.suppliers.filter((function(e){return e.id===s}))[0].brands.filter((function(e){return e.id===c.brand_id}))[0],d=i.branches.filter((function(e){return e.id===c.branch_id}))[0];return Object(x.jsxs)("tr",{className:n&&n===c.id?"bg-info":"",children:[Object(x.jsxs)("td",{children:[c.code.toUpperCase(),c.codeBar&&Object(x.jsxs)(x.Fragment,{children:[" ","/ ",Object(x.jsx)("i",{className:"fas fa-barcode"})," ",c.codeBar.toUpperCase()]})]}),Object(x.jsx)("td",{className:n&&n===c.id?"small":c.saved?"text-warning small":"text-secondary small",children:c.name.toUpperCase()}),Object(x.jsx)("td",{className:c.cantAdd?"font-weight-bold":"",children:c.cant}),Object(x.jsxs)("td",{children:["$ ",c.price]}),Object(x.jsx)("td",{className:"text-capitalize",children:l.name}),Object(x.jsx)("td",{className:"text-capitalize",children:null!==(t=null===o||void 0===o?void 0:o.name)&&void 0!==t?t:""}),Object(x.jsx)("td",{className:"text-capitalize",children:null!==(a=null===d||void 0===d?void 0:d.name)&&void 0!==a?a:""}),Object(x.jsx)("td",{children:Object(x.jsx)("i",{className:"fas fa-trash text-danger",onClick:function(){return r(c.id)}})})]})}function ve(e){var t,a,c=e.state,n=e.setState,s=A(),l=Object(d.useState)(!0),o=Object(i.a)(l,2),j=o[0],u=o[1],b=function(){c.invoice&&c.supplier_id?(n(Object(r.a)(Object(r.a)({},c),{},{showList:!0})),u(!1)):j&&u(!0)};return Object(d.useEffect)((function(){c.invoice&&c.supplier_id||u(!0)}),[c.invoice,c.supplier_id]),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"form-group col",children:[Object(x.jsx)("label",{className:"mr-2",htmlFor:"code",children:"N\xfamero de factura"}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Ej: FAC2023001",id:"code",value:null!==(t=c.invoice)&&void 0!==t?t:"",maxLength:"50",onChange:function(e){var t=e.target.value;return n(Object(r.a)(Object(r.a)({},c),{},{invoice:t.toLowerCase()}))},onBlur:b,onKeyPress:function(e){return"Enter"===e.key&&b}})]}),Object(x.jsxs)("div",{className:"form-group col",children:[Object(x.jsx)("label",{htmlFor:"code",children:"Proveedor"}),Object(x.jsxs)("select",{className:"form-control text-uppercase",value:null!==(a=c.supplier_id)&&void 0!==a?a:"",onChange:function(e){var t=e.target.value;return n(Object(r.a)(Object(r.a)({},c),{},{supplier_id:parseInt(t)}))},onBlur:b,disabled:!j,children:[Object(x.jsx)("option",{children:"-- Seleccione uno --"}),s.suppliers.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),j&&Object(x.jsx)("div",{className:"form-group col-2 pt-4",children:Object(x.jsx)("button",{className:"btn btn-dark mt-1",children:"Empezar"})})]})}function ge(){var e={invoice:"",supplier_id:"",items:[],showList:!1,btnStatus:!1,showModal:!1,showLoader:!1},t=R(),a=Object(d.useState)(Object(r.a)({},e)),c=Object(i.a)(a,2),n=c[0],s=c[1],l=Object(d.useState)(null),o=Object(i.a)(l,2),j=o[0],u=o[1],b=function(e){var t;if(e){var a={code:e.code,name:e.name,cant:null!==(t=e.cant)&&void 0!==t?t:0,category_id:e.category_id,brand_id:e.brand_id,branch_id:e.branch_id,price:e.price,cost:e.cost,supplier_id:n.supplier_id,invoice:n.invoice};return e.codeBar&&(a.codebar=e.codeBar),a}};return Object(d.useEffect)((function(){var e=!0,t=n.items.filter((function(e){return e.id&&e.branch_id&&e.cant&&e.price&&e.price>=e.cost}));Boolean(n.invoice)||(e=!1),t.length||(e=!1),n.btnStatus!==e&&s(Object(r.a)(Object(r.a)({},n),{},{btnStatus:e}))}),[n.items,n.invoice]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"row",style:{height:"100vh"},children:Object(x.jsx)("div",{className:"col-12",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h5",{className:"card-title mt-2 ml-2 text-bold",children:"Entradas de armazones por lote"})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)(ve,{state:n,setState:s}),n.showList&&Object(x.jsxs)("table",{className:"table table-sm",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Codigos"}),Object(x.jsx)("th",{children:"Descripcion"}),Object(x.jsx)("th",{children:"Cant"}),Object(x.jsx)("th",{children:"Precio"}),Object(x.jsx)("th",{children:"Categoria"}),Object(x.jsx)("th",{children:"Marca"}),Object(x.jsx)("th",{children:"Suc"}),Object(x.jsx)("th",{children:""})]})}),Object(x.jsx)("tbody",{children:n.items.map((function(e){return Object(x.jsx)(fe,{item:e,newRow:j,supplier_id:n.supplier_id,handleDelete:function(e){window.Swal.fire({title:"Almacen",text:"Realmente desea eliminar este articulo",icon:"question",showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(t){if("cancel"===t.dismiss)return!1;var a=n.items.filter((function(t){return t.id!==e}));s(Object(r.a)(Object(r.a)({},n),{},{items:a}))}))}},e.id)}))})]})]}),n.showList&&Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsxs)("button",{className:"btn btn-dark",alt:"Agregar una linea nueva",onClick:function(){return s(Object(r.a)(Object(r.a)({},n),{},{showModal:!0}))},children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"})," Armazon"]}),Object(x.jsxs)("button",{className:"btn btn-secondary",alt:"Agregar una linea nueva",onClick:function(){return s(Object(r.a)({},e))},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"})," Cancelar"]}),Object(x.jsxs)("button",{className:"btn btn-success",onClick:function(){window.Swal.fire({title:"Almacen",html:"Se va a guardar los datos de la factura: <strong>".concat(n.invoice.toUpperCase(),"</strong><br/> \xbfRealmente desea realizar esta acci\xf3n?"),icon:"question",showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){if("cancel"===e.dismiss)return!1;for(var a=[],c=0;c<n.items.length;c++){var i=b(Object(r.a)({},n.items[c]));i&&a.push(i)}s(Object(r.a)(Object(r.a)({},n),{},{showLoader:!0})),t.saveItemByList(a).then((function(){window.Swal.fire({title:"Almacen",text:"Productos almacenados con exito",icon:"success",timer:2500}),console.log("[DEBUG] Send items",a),s({numFactura:"",btnStatus:!1,showList:!1,items:[],showLoader:!1})})).catch((function(e){console.error("Error when save items:",e.message),window.Swal.fire({text:"Tenemos un error al almacenar por lista. Revise la consola.",icon:"error",timer:2500}),s(Object(r.a)(Object(r.a)({},n),{},{showLoader:!1}))}))}))},disabled:!n.btnStatus,children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),"Enviar"]})]})}),(n.showLoader||n.showModal)&&Object(x.jsx)("div",{className:"overlay",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})})}),n.showModal&&Object(x.jsx)(pe,{supplier_id:n.supplier_id,handleCancel:function(){return s(Object(r.a)(Object(r.a)({},n),{},{showModal:!1}))},handleAdd:function(e){var t=Object(ue.a)(n.items);t.filter((function(t){return t.code===e.code&&t.branch_id===e.branch_id})).length?(console.log("[Orus System] Update item"),t.forEach((function(t){t.code===e.code&&t.branch_id===e.branch_id&&(t.cant+=e.cant,t.cantAdd=!t.cantAdd)}))):(console.log("[Orus System] Add new item"),t.push(e)),u(e.id),setTimeout((function(){return u(null)}),1e3),s(Object(r.a)(Object(r.a)({},n),{},{items:t,showModal:!1}))}})]})}var Ne={page:1,orderby:"created_at",order:"desc",search:"",itemsPage:25,supplier:"",brand:"",zero:"false"};function ye(e){var t=Object(d.useState)({panel:"",cats:[],suppliers:[],branches:[],options:Ne}),a=Object(i.a)(t,2),c=a[0],n=a[1],l=Q(),j=Y(),u=function(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("config",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){return console.error("[Orus System] Catch when get Configs list in hook:",e.message),null}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{get:e}}(),b=e.match.params.id,m=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getCategories({search:"armazones"}).then((function(e){return e.data.filter((function(e){return"armazones"===e.name}))[0].sons}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getContacts({type:1,business:0}).then((function(e){return e.data.filter((function(e){return e.brands&&e.brands.length}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.get({itemsPage:100}).then((function(e){return e.data.filter((function(e){return"branches"===e.name})).map((function(e){return Object(r.a)(Object(r.a)({},e.data),{},{id:e.id})}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return a=e.sent,e.next=5,p();case 5:return s=e.sent,e.next=8,f();case 8:i=e.sent,n(Object(r.a)(Object(r.a)({},c),{},{cats:a,suppliers:s,panel:t,branches:i}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){var e="inbox";if(b)if(isNaN(b))switch(null===b||void 0===b?void 0:b.toLowerCase()){case"categorias":e="category";break;case"marcas":e="brands";break;case"inventario":e="inventory";break;case"entradas":e="entries";break;default:e="inbox"}else e="neworedit";v(e)}),[b]),Object(x.jsx)(V.Provider,{value:Object(r.a)(Object(r.a)({},c),{},{set:n}),children:Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsxs)("div",{className:"col-sm-12 col-md-2",children:[Object(x.jsxs)("button",{className:"btn bg-primary btn-block mb-3",type:"button",disabled:"inbox"!==c.panel,onClick:function(){return n(Object(r.a)(Object(r.a)({},c),{},{panel:"neworedit"}))},children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo producto"]}),Object(x.jsx)($,{})]}),Object(x.jsxs)("div",{className:"col-sm-12 col-md-10",children:["inbox"===c.panel&&Object(x.jsx)(J,{}),"neworedit"===c.panel&&Object(x.jsx)(ie,Object(r.a)({},e)),"category"===c.panel&&Object(x.jsx)(oe,{}),"brands"===c.panel&&Object(x.jsx)(je,{}),"inventory"===c.panel&&Object(x.jsx)(Oe,{}),"entries"===c.panel&&Object(x.jsx)(ge,{})]})]})})}var we=Object(d.createContext)(null),Ce=function(){return Object(d.useContext)(we)};function _e(e){var t,a,c,n,s,i=e.newOrEdit,l=void 0!==i&&i,o=e.handleNewOrEdit,d=Ce(),j=Object(u.f)();return Object(x.jsxs)("div",{className:"col-sm-12 col-md-2",children:[Object(x.jsxs)("button",{className:"btn bg-indigo btn-block mb-3",type:"button",disabled:l,onClick:function(){return o()},children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo contacto"]}),Object(x.jsx)(M,{title:l?"Menu":"Filtros",children:l?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("a",{href:"#back",className:"d-flex justify-content-between align-items-center",onClick:function(e){e.preventDefault(),j.push("/contactos"),window.location.href="/contactos"},children:["Ver listado",Object(x.jsx)("span",{className:"badge badge-primary badge-pill",children:Object(x.jsx)("i",{className:"fas fa-chevron-left"})})]})}),null!==(s=d.contact)&&void 0!==s&&s.id?Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("a",{href:"#details",className:"d-flex justify-content-between align-items-center",children:["Detalles",Object(x.jsx)("span",{className:"badge badge-primary badge-pill",children:Object(x.jsx)("i",{className:"fas fa-chevron-right"})})]})}):null]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"type",children:"Tipo"}),Object(x.jsxs)("select",{className:"form-control ",name:"type",id:"type",value:null===(t=d.options)||void 0===t?void 0:t.type,onChange:function(e){var t=e.target,a=parseInt(t.value);d.set(Object(r.a)(Object(r.a)({},d),{},{options:Object(r.a)(Object(r.a)({},d.options),{},{type:isNaN(a)?"":a})}))},children:[Object(x.jsx)("option",{value:"",children:"-- Todos --"}),Object(x.jsx)("option",{value:"0",children:"Clientes"}),Object(x.jsx)("option",{value:"1",children:"Proveedores"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:null===(a=d.options)||void 0===a?void 0:a.orderby,onChange:function(e){var t=e.target;d.set(Object(r.a)(Object(r.a)({},d),{},{options:Object(r.a)(Object(r.a)({},d.options),{},{orderby:t.value})}))},children:[Object(x.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(x.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:null===(c=d.options)||void 0===c?void 0:c.order,onChange:function(e){var t=e.target;d.set(Object(r.a)(Object(r.a)({},d),{},{options:Object(r.a)(Object(r.a)({},d.options),{},{order:t.value})}))},children:[Object(x.jsx)("option",{value:"asc",children:"Antiguos"}),Object(x.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"itemsPage",children:"Numero de contactos"}),Object(x.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:null===(n=d.options)||void 0===n?void 0:n.itemsPage,onChange:function(e){var t=e.target;d.set(Object(r.a)(Object(r.a)({},d),{},{options:Object(r.a)(Object(r.a)({},d.options),{},{itemsPage:parseInt(t.value)})}))},children:[Object(x.jsx)("option",{value:"25",children:"ver 25"}),Object(x.jsx)("option",{value:"50",children:"ver 50"}),Object(x.jsx)("option",{value:"75",children:"ver 75"}),Object(x.jsx)("option",{value:"100",children:"ver 100"})]})]})]})})]})}function Se(){var e,t,a=Ce(),c=Y(),n=Object(u.f)(),s=Object(d.useState)({contactSelected:"",contacts:[],meta:{},loading:!1}),l=Object(i.a)(s,2),o=l[0],j=l[1],b=function(){j(Object(r.a)(Object(r.a)({},o),{},{loading:!0})),c.getContacts(Object(r.a)({},a.options)).then((function(e){j(Object(r.a)(Object(r.a)({},o),{},{loading:!1,contacts:e.data,meta:e.meta,contactSelected:""}))}))};return Object(d.useEffect)((function(){Object.keys(a.options).length&&b()}),[a.options]),Object(x.jsx)(Z,{title:"Lista de contactos",icon:"id-badge",color:"indigo",loading:o.loading,meta:o.meta,itemSelected:o.contactSelected,handlePagination:function(e){e&&a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},{page:e})}))},handleSearch:function(e){e?a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},{search:e,page:1})})):a.options.search&&a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},{search:"",page:1})}))},handleDeleteItem:function(e){o.contactSelected?window.Swal.fire({title:"Contactos",text:"\xbfDesea eliminar a este contacto?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss?j(Object(r.a)(Object(r.a)({},o),{},{contactSelected:""})):c.deleteContact(o.contactSelected).then((function(){b()})).catch((function(e){console.error("[Orus System] Catch when delete contact:",e.message)}))})):window.Swal.fire({title:"Error",text:"Lo sentimos no existe un contacto seleccionado",icon:"error",timer:3e3})},handleEditItem:function(){o.contactSelected?n.push("contactos/".concat(o.contactSelected)):window.Swal.fire({title:"Error",text:"Lo sentimos no existe un contacto seleccionado",icon:"error",timer:3e3})},handleSync:function(){a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},{page:1})}))},children:Object(x.jsxs)("table",{className:"table table-hover table-striped",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{children:"Edad"}),Object(x.jsx)("th",{children:"E-mail"}),Object(x.jsx)("th",{children:"Telefono"}),Object(x.jsx)("th",{children:"Creado por"}),Object(x.jsx)("th",{children:"created_at"===a.options.orderby?"Registrado":"Actualizado"})]})}),Object(x.jsxs)("tbody",{children:[null===(e=o.contacts)||void 0===e?void 0:e.map((function(e){var t,c=Object.values(e.phones).filter((function(e){return e}));return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(x.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:e.id,id:"contact_"+e.id,checked:o.contactSelected===e.id,onChange:function(e){var t=e.target,a=t.value,c=t.checked;j(Object(r.a)(Object(r.a)({},o),{},{contactSelected:c?parseInt(a):""}))}}),Object(x.jsx)("label",{htmlFor:"contact_"+e.id,className:"sr-only"})]}),Object(x.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",style:{cursor:"pointer",maxWidth:180},onClick:function(){n.push("contactos/".concat(e.id))},children:Object(x.jsxs)("label",{style:{cursor:"pointer"},className:e.enUso?"text-indigo":"",children:[e.type?Object(x.jsx)("i",{className:"fas fa-store text-sm mr-2"}):Object(x.jsx)("i",{className:"fas fa-user text-sm mr-2"}),e.name.toLowerCase()]})}),Object(x.jsx)("th",{children:e.age?e.age:"--"}),Object(x.jsx)("td",{className:"mailbox-attachment text-lowercase text-truncate",style:{maxWidth:180},children:Object(x.jsxs)("span",{children:[Object(x.jsx)("i",{className:"fas fa-envelope text-sm mr-2"}),Object(x.jsx)("a",{href:"mailto:"+e.email,className:"text-muted",children:null===(t=e.email)||void 0===t?void 0:t.toLowerCase()})]})}),Object(x.jsx)("td",{className:"mailbox-date text-muted text-truncate text-right",children:Object(x.jsxs)("span",{children:[Object(x.jsx)("i",{className:"fas fa-phone text-sm mr-2"}),c.length?c[0]:"--"]})}),Object(x.jsx)("td",{className:"text-capitalize",children:e.created.name.toLowerCase()}),Object(x.jsx)("td",{children:D()("created_at"===a.options.orderby?e.created_at:e.updated_at).fromNow()})]},e.id)})),!(null!==(t=o.contacts)&&void 0!==t&&t.length)&&Object(x.jsx)("tr",{children:Object(x.jsxs)("th",{className:"text-center text-muted",colSpan:"7",children:[Object(x.jsx)("i",{className:"fa fa-info mx-2"}),a.options.search?Object(x.jsxs)("span",{children:["La busqueda",Object(x.jsxs)("strong",{className:"text-dark mx-1",children:['"',a.options.search,'",']}),"no coincide con ning\xfan contacto."]}):"No hay contactos registrados"]})})]})]})})}var ke=a(22),Ee=a.n(ke),Be=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})$/i;var Ie={handleVerificationData:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=e.name,c=e.email,n=e.birthday,s=e.phone,r=e.type,i=/^[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+\s[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]{2,}(\s?[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+){1,}/gim,l=/^\d{10}$/gim;if(!r&&!i.test(a))return t&&window.Swal.fire({title:"Verificacion",text:"El nombre del contacto es erroneo",icon:"warning"}),{result:!1,name:"name"};if(!Be.test(c))return t&&window.Swal.fire({title:"Verificacion",text:"El correo electr\xf3nico del contacto es erroneo",icon:"warning"}),{result:!1,name:"email"};var o=l.test(s);if(!r&&!o)return t&&window.Swal.fire({title:"Verificacion",text:"El numero de contacto es erroneo",icon:"warning"}),{result:!1,name:"telnumbers"};var d=new Date(n),j=new Date,u=j.getFullYear()-d.getFullYear();return r||n&&!(u<1)?{result:!0}:(t&&window.Swal.fire({title:"Verificacion",text:"La fecha de nacimiento es erronea",icon:"warning"}),{result:!1,name:"bithday"})},saveContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"contacto",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;window.Swal.fire({title:"Almacenamiento",text:c?"\xbfEsta seguro de actualizar al ".concat(e,"?"):"\xbfEsta seguro de crear un nuevo ".concat(e,"?"),icon:"question",showCancelButton:!0,confirmButtonText:c?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){!e.dismiss&&a&&a({id:c,data:t})}))},changeDataInput:function(e,t,a){var c=e.name,n=e.value,s=n;"telnumbers"===c&&(s=Object(r.a)(Object(r.a)({},t.telnumbers),{},{t_movil:n})),a(Object(r.a)(Object(r.a)({},t),{},Object(g.a)({},c,s)))},handleGetDataObject:function(e,t,a){switch(e){case"name":return{name:t,verification:Object(r.a)(Object(r.a)({},a),{},{name:!0})};case"email":return{email:t,verification:Object(r.a)(Object(r.a)({},a),{},{email:!0})};case"birthday":return{birthday:t,verification:Object(r.a)(Object(r.a)({},a),{},{birthday:!0})};case"telefonos":return{telefonos:t,verification:Object(r.a)(Object(r.a)({},a),{},{telefonos:!0})};default:return Object(g.a)({},e,t)}},dataPrimary:{name:"",telnumbers:{t_casa:"",t_oficina:"",t_movil:""},email:"",birthday:"",type:0,business:0,gender:"female"},isEmail:function(e){return!!e&&Be.test(e)}},De=Ie,Le=a(39);function Pe(e){var t,a,c,n,s,l,o,j,u,b=e.data,m=void 0===b?{}:b,h=e.handleChange,O=e.fn,p=Object(d.useState)({emailVerification:null,emailColor:"dark",nameVerification:null,nameColor:"dark",birthdayVerification:!1,birthdayColor:"dark",contatcs:[]}),f=Object(i.a)(p,2),v=f[0],g=f[1],N=function(e,t){e&&t&&("email"===e&&De.isEmail(t)&&O.getContacts({page:1,orderby:"created_at",order:"desc",itemsPage:10,email:t,except:m.id}).then((function(e){var t,a,c;g(Object(r.a)(Object(r.a)({},v),{},{emailVerification:Boolean(null===(t=e.data)||void 0===t?void 0:t.length),emailColor:null!==(a=e.data)&&void 0!==a&&a.length?"danger":"dark"})),h("validates",Object(r.a)(Object(r.a)({},m.validates),{},{email:!Boolean(null===(c=e.data)||void 0===c?void 0:c.length)}))})),"name"===e&&O.getContacts({page:1,orderby:"created_at",order:"desc",itemsPage:10,name:t,except:m.id}).then((function(e){var t,a,c,n;g(Object(r.a)(Object(r.a)({},v),{},{contacts:null!==(t=e.data)&&void 0!==t&&t.length?e.data:[],nameVerification:Boolean(null===(a=e.data)||void 0===a?void 0:a.length),nameColor:null!==(c=e.data)&&void 0!==c&&c.length?"danger":"dark"})),h("validates",Object(r.a)(Object(r.a)({},m.validates),{},{name:!Boolean(null===(n=e.data)||void 0===n?void 0:n.length)}))})))};return Object(d.useEffect)((function(){var e={birthday:Boolean(D()().diff(m.birthday,"days")>0),test:D()().diff(m.birthday,"days")};e.birthday!==v.birthdayVerification&&(g(Object(r.a)(Object(r.a)({},v),{},{birthdayVerification:e.birthday,birthdayColor:e.birthday?"dark":"danger"})),h("validates",Object(r.a)(Object(r.a)({},m.validates),{},{birthday:e.birthday})))}),[m.name,m.email,m.birthday]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Tipo de contacto"}),Object(x.jsxs)("select",{className:"custom-select",name:"type",value:null!==(t=m.type)&&void 0!==t?t:"",onChange:function(e){var t=e.target;return h("type",parseInt(t.value))},children:[Object(x.jsx)("option",{value:"0",children:"Cliente"}),Object(x.jsx)("option",{value:"1",children:"Proveedor"})]})]}),m.type?Object(x.jsxs)("div",{className:"form-group custom-control custom-checkbox",children:[Object(x.jsx)("input",{type:"checkbox",name:"business",className:"custom-control-input",checked:null!==(a=m.business)&&void 0!==a&&a,onChange:function(e){var t=e.target;return h("business",t.checked)},id:"business_checkbox"}),Object(x.jsx)("label",{htmlFor:"business_checkbox",className:"custom-control-label cursor-pointer",children:Object(x.jsx)("small",{children:"\xbfEs un laboratorio?"})})]}):null,Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"RFC"}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase text-truncate",placeholder:"facturas",name:"rfc",defaultValue:null!==(c=m.rfc)&&void 0!==c?c:"",onChange:function(e){var t=e.target;return h("rfc",t.value.toUpperCase())},minLength:"10"})]}),!m.type&&Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"G\xe9nero"}),Object(x.jsxs)("select",{className:"custom-select",name:"gender",value:null!==(n=m.gender)&&void 0!==n?n:"",onChange:function(e){var t=e.target;return h("gender",t.value)},children:[Object(x.jsx)("option",{value:"male",children:"Hombre"}),Object(x.jsx)("option",{value:"female",children:"Mujer"})]})]})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsxs)("div",{className:"form-group position-relative",children:[Object(x.jsxs)("label",{children:["Nombre completo ",Object(x.jsx)("span",{className:"text-orange",children:"*"})]}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize text-truncate text-".concat(v.nameColor),placeholder:"Ej: Juan Perez G",name:"name",defaultValue:null!==(s=m.name)&&void 0!==s?s:"",onChange:function(e){var t=e.target;return h("name",t.value.toLowerCase())},onBlur:function(e){var t=e.target;return N("name",t.value.toLowerCase())},onKeyDown:function(e){"Escape"===e.key&&g(Object(r.a)(Object(r.a)({},v),{},{contacts:[]}))}}),!m.name&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})}),null!==(l=v.contacts)&&void 0!==l&&l.length&&(null===(o=m.name)||void 0===o?void 0:o.length)>5&&!m.id?(u=v.contacts,Object(x.jsx)("div",{className:"position-absolute border rounded p-0 bg-white overflow-auto ",style:{zIndex:"50",top:"4.1rem",width:"100%",maxHeight:"8rem"},children:Object(x.jsx)("ul",{className:"list-group",children:u.map((function(e){var t;return Object(x.jsxs)("li",{className:"list-group-item text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-minus mr-1 text-danger"}),Object(x.jsx)("span",{className:"text-capitalize text-muted text-monospace text-sm",children:null===(t=e.name)||void 0===t?void 0:t.toLowerCase()})]},e.id)}))})})):null]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsxs)("label",{children:["Correo electr\xf3nico ",Object(x.jsx)("span",{className:"text-orange",children:"*"})]}),Object(x.jsx)("input",{type:"email",className:"form-control text-lowercase text-truncate text-".concat(v.emailColor),placeholder:"Ej: correo@domain.com",name:"email",defaultValue:null!==(j=m.email)&&void 0!==j?j:"",onChange:function(e){var t=e.target;return h("email",t.value.toLowerCase())},onBlur:function(e){var t=e.target;return N("email",t.value)}}),!m.email&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})}),m.email&&!De.isEmail(m.email)&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Este no es un correo valido"})}),v.emailVerification&&"boolean"===typeof v.emailVerification&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Este e-mail ya se encuentra registrado"})})]}),m.type?null:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsxs)("label",{children:["Fecha de nacimiento ",Object(x.jsx)("span",{className:"text-orange",children:"*"})]}),Object(x.jsx)(Ee.a,{className:"form-control text-".concat(v.birthdayColor),locale:"es",selected:new Date(m.birthday.format("YYYY/MM/DD")),dateFormat:"dd/MM/yyyy",maxDate:new Date,placeholderText:"Seleccione una fecha",onSelect:function(e){if(e){e=e.toLocaleDateString("es-MX");var t=D()(e,"DD/MM/YYYY");t.isValid()&&h("birthday",t)}},onChange:function(e){if(e){e=e.toLocaleDateString("es-MX");var t=D()(e,"DD/MM/YYYY");t.isValid()&&h("birthday",t)}}}),!v.birthdayVerification&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})})]})]})]})}function Fe(e){var t,a,c,n=e.data,s=e.handleChange;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"col",children:[n.address_street?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Calle y numero"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-1",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-road"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Calle y numero",value:null!==(t=n.address_street)&&void 0!==t?t:"",onChange:function(e){var t=e.target;console.log("FUNCTION COMPONENT",t.value),s("address_street",t.value.toLowerCase())}})]}),n.address_neighborhood?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Colonia"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-1",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-location-arrow"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Colonia",defaultValue:null!==(a=n.address_neighborhood)&&void 0!==a?a:"",onChange:function(e){var t=e.target;return s("address_neighborhood",t.value.toLowerCase())}})]}),n.address_location?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Municipio"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-1",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-location-arrow"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Municipio",defaultValue:n.address_location?n.address_location:"",onChange:function(e){var t=e.target;return s("address_location",t.value.toLowerCase())}})]})]}),Object(x.jsxs)("div",{className:"col",children:[n.address_state?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Estado"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-1",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-map-marker"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Estado",defaultValue:n.address_state?n.address_state:"",onChange:function(e){var t=e.target;return s("address_state",t.value.toLowerCase())}})]}),n.address_zip?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Codigo postal"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group mb-1",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-map-marker"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Codigo Postal",defaultValue:null!==(c=n.address_zip)&&void 0!==c?c:"",onChange:function(e){var t=e.target;return s("address_zip",t.value.toLowerCase())}})]})]})]})}function Te(e){var t=e.data,a=e.handleChange;return Object(d.useEffect)((function(){var e,c=Boolean([t.phone_notices,t.phone_cell,t.phone_office].filter((function(e){return 10===e.length})).length);c!==(null===(e=t.validates)||void 0===e?void 0:e.phones)&&a("validates",Object(r.a)(Object(r.a)({},t.validates),{},{phones:c}))}),[t.phone_notices,t.phone_cell,t.phone_office]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Telefono para recados"}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-phone"})})}),Object(x.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",value:t.phone_notices,onChange:function(e){var t=e.target;isNaN(t.value)||a("phone_notices",t.value)}})]}),t.phone_notices&&10!==t.phone_notices.length&&Object(x.jsx)("small",{children:Object(x.jsx)("span",{className:"text-orange",children:"Telefono a 10 numeros"})})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Telefono personal / whatsApp"}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-phone"})})}),Object(x.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",value:t.phone_cell,onChange:function(e){var t=e.target;isNaN(t.value)||a("phone_cell",t.value)}})]})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Telefono del trabajo"}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-phone"})})}),Object(x.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",value:t.phone_office,onChange:function(e){var t=e.target;isNaN(t.value)||a("phone_office",t.value)}})]})]})})]})}Object(ke.registerLocale)("es",Le.a);var ze=function(e){var t=e.sales;return Object(x.jsxs)("table",{className:"table m-0",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"ID"}),Object(x.jsx)("th",{children:"Total"}),Object(x.jsx)("th",{children:"Orden"}),Object(x.jsx)("th",{children:"Registrado"})]})}),Object(x.jsx)("tbody",{children:t.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("th",{children:["#",e.id]}),Object(x.jsxs)("td",{children:["$ ",e.total.toFixed(2)]}),Object(x.jsxs)("td",{children:["#",e.pedido]}),Object(x.jsxs)("td",{className:"text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-clock mr-2"}),D()(e.created_at).fromNow()]})]},e.id)}))})]})};function Ve(e){var t=e.analytics,a=e.metadata,c=t.purchases,n=t.exams,s=t.brands,r=t.orders,i=t.suppliers,l=a.created_at,o=a.created,d=a.updated,j=a.updated_at;return Object(x.jsxs)("div",{className:"row",children:[s?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-orange",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:s}),Object(x.jsx)("p",{children:"Marcas"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-shopping-bag"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(x.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,i?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-indigo",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:i}),Object(x.jsx)("p",{children:"Laboratorio"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-building"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(x.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,c?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-success",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:c}),Object(x.jsx)("p",{children:"Compras"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-money-bill"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(x.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,n?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-info",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:n}),Object(x.jsx)("p",{children:"Examenes"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-notes-medical"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(x.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,r?Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-warning",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:r}),Object(x.jsx)("p",{children:"Pedidos"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-shopping-basket"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(x.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,l&&Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-primary",children:[Object(x.jsxs)("div",{className:"inner",children:[Object(x.jsx)("h5",{children:D()().diff(l,"days")>=0?l.format("DD/MMMM/Y"):"--/--/--"}),Object(x.jsx)("p",{children:"Registrado"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-calendar"})}),Object(x.jsx)("a",{href:"#details",className:"small-box-footer text-xs",children:D()().diff(j,"days")>=0?"Modificado: ".concat(j.format("DD/MMMM/Y")):"Modificado --/--/--"})]})}),o&&Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"small-box bg-primary",children:[Object(x.jsxs)("div",{className:"inner text-capitalize",children:[Object(x.jsx)("h5",{className:"text-truncate",children:o}),Object(x.jsx)("p",{children:"Registrado por"})]}),Object(x.jsx)("div",{className:"icon",children:Object(x.jsx)("i",{className:"fas fa-user"})}),Object(x.jsxs)("a",{href:"#details",className:"small-box-footer text-xs text-truncate text-capitalize",children:["Modificado: ",d]})]})})]})}var Ae=function(e){var t=e.brands;return Object(x.jsxs)("table",{className:"table m-0",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{children:"Registrado"})]})}),Object(x.jsx)("tbody",{children:t.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-uppercase",children:e.name}),Object(x.jsxs)("td",{className:"text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-clock mr-2"}),D()(e.created_at).fromNow()]})]},e.id)}))})]})},Me=function(e){switch(e){case 0:return"procesando";case 1:return"laboratorio";case 2:return"bicelacion";case 3:return"terminado";case 4:return"entregado";default:return"garantia"}},Ue=function(e){var t,a=JSON.parse(null!==(t=localStorage.getItem("OrusSystem"))&&void 0!==t?t:"");return a.orders||(a.orders=[]),e?a.orders:a},Re=function(e,t){t&&t()},qe={handleStatusString:Me,getBadgeStatus:function(e){switch(e){case 0:return Object(x.jsx)("span",{className:"badge badge-light mr-2 text-uppercase",children:Me(e)});case 1:case 2:return Object(x.jsx)("span",{className:"badge badge-primary mr-2 text-uppercase",children:Me(e)});case 3:return Object(x.jsx)("span",{className:"badge badge-info mr-2 text-uppercase",children:Me(e)});case 4:return Object(x.jsx)("span",{className:"badge badge-secondary mr-2 text-uppercase",children:Me(e)});default:return Object(x.jsx)("span",{className:"badge badge-dark mr-2 text-uppercase",children:Me(e)})}},handleDeleteOrder:function(e,t,a){if(e.id)return e.estado?(window.Swal.fire({title:"Verificacion",text:"El pedido tiene un proceso avanzado",icon:"warning"}),!1):e.nota?(window.Swal.fire({title:"Verificacion",text:"No se puede eliminar un pedido con una venta activa",icon:"warning"}),!1):(window.Swal.fire({text:"\xbfEsta seguro de eliminar el pedido ".concat(e.id,"?"),icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(c){if(!c.dismiss&&a)return a({id:e.id,options:t}),console.log("[Orus System] Eliminando pedido: "+e.id),!0})),!1)},handleSaveOrder:function(e,t,a,c,n){window.Swal.fire({title:"Almacenamiento",text:e?"\xbfEsta seguro de actualizar el pedido ".concat(e,"?"):"\xbfEsta seguro de crear un nuevo pedido?",icon:"question",showCancelButton:!0,confirmButtonText:e?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(s){!s.dismiss&&c&&(c({data:t,id:e,options:a}),n&&n(),Re(t.contact_id))}))},getDataTemporary:Ue,addDataTemporary:function(e){var t=Ue();Object(r.a)(Object(r.a)({},t),{},{orders:t.orders.filter((function(t){return t.id!==e.id}))}).orders.push(e)},removeDataTemporary:Re,getDataOneItem:function(e){var t,a=Ue().orders.filter((function(t){return t.id===e}));return null!==(t=a[0])&&void 0!==t?t:{}},getStatusType:["procesando","laboratorio","bicelacion","terminado","entregado"]},Ye=function(e){var t=e.orders;return Object(x.jsxs)("table",{className:"table m-0",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"ID"}),Object(x.jsx)("th",{children:"Folio LAB"}),Object(x.jsx)("th",{children:"Nota"}),Object(x.jsx)("th",{children:"Estado"}),Object(x.jsx)("th",{children:"Registrado"})]})}),Object(x.jsx)("tbody",{children:t.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("th",{children:["#",e.id]}),Object(x.jsx)("td",{children:e.order_foreing?"#".concat(e.order_foreing):"--"}),Object(x.jsx)("td",{children:e.nota?"#".concat(e.nota):"--"}),Object(x.jsx)("td",{className:"text-uppercase",children:Object(x.jsx)("span",{className:"badge badge-secondary",children:qe.handleStatusString(e.status)})}),Object(x.jsxs)("td",{className:"text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-clock mr-2"}),D()(e.created_at).fromNow()]})]},e.id)}))})]})};function Ge(e){var t=e.exams,a=void 0===t?[]:t,c=e.allSelect,n=void 0!==c&&c,s=e.handleSelectedExam,r=Object(d.useState)(""),l=Object(i.a)(r,2),o=l[0],j=l[1];return Object(x.jsxs)("table",{className:"table m-0",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{scope:"col"}),Object(x.jsx)("th",{scope:"col",children:"Folio"}),Object(x.jsx)("th",{scope:"col",children:"Registrado"}),Object(x.jsx)("th",{scope:"col",children:"Estado"})]})}),Object(x.jsxs)("tbody",{children:[a.length?null:Object(x.jsx)("tr",{children:Object(x.jsxs)("th",{colSpan:"4",className:"text-center",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"No hay registros"]})}),a.map((function(e){return Object(x.jsxs)("tr",{className:D()(new Date).isSame(D()(e.created_at),"day")?"text-primary":"",children:[Object(x.jsx)("td",{children:Object(x.jsx)("div",{className:"icheck-primary",children:s?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{type:"checkbox",name:"exam_"+e.id,id:"exam_"+e.id,defaultValue:e.id,onChange:function(t){t.target.checked?(j(e.id),s(e)):j("")},disabled:!n,checked:o===e.id}),Object(x.jsx)("label",{htmlFor:"exam_"+e.id})]}):null})}),Object(x.jsx)("th",{scope:"row",children:Object(x.jsxs)("span",{className:"text",children:["#",e.id]})}),Object(x.jsxs)("td",{className:"text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-clock mr-2"}),D()(e.created_at).fromNow()]}),Object(x.jsx)("td",{children:e.status?Object(x.jsxs)("span",{className:"badge badge-success",children:[Object(x.jsx)("i",{className:"fas fa-check"})," Terminado"]}):Object(x.jsxs)("span",{className:"badge badge-secondary",children:[Object(x.jsx)("i",{className:"fas fa-hourglass"})," Activo"]})})]},e.id)}))]})]})}function $e(e){var t=e.showBottons,a=void 0!==t&&t,c=e.exams,n=void 0===c?[]:c;return Object(x.jsxs)("div",{className:"card",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-indigo text-bold",children:[Object(x.jsx)("i",{className:"fas fa-notes-medical mr-1"}),"Examenes"]}),n.length?Object(x.jsx)(Ge,{allSelect:!0,exams:n,handleSelectedExam:function(e){}}):Object(x.jsx)("div",{className:"alert alert-info mt-5",children:Object(x.jsxs)("h5",{children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Aun no hay examenes para este contacto"]})})]}),a&&Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("div",{className:"btn-group",children:Object(x.jsx)("button",{className:"btn btn-secondary",children:"Nuevo"})})})]})}var He=function(e){var t=e.title,a=void 0===t?"confirmaci\xf3n":t,c=e.body,n=e.handleCancel;return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title text-dark text-bold text-capitalize",children:a}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){n&&n()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body",children:c})]})})})},Ze={id:0,name:"",rfc:"",gender:"male",email:"",type:0,business:0,birthday:D()(),phone_notices:"",phone_cell:"",phone_office:"",age:"",address_street:"",address_neighborhood:"",address_location:"",address_state:"",address_zip:"",done:{purchases:[],brands:[],supplier_of:[],orders:[],exams:[]},analytics:{purchases:0,exams:0,brands:0,suppliers:0,orders:0},metadata:{created_at:"",updated_at:"",deleted_at:"",created:"",updated:"--"},validates:{name:!1,email:!1,birthday:!1,phones:!1},activity:[],loading:!1};function Je(e){var t,a,c,s=e.match.params.id,l=e.handleNewOrEdit,o=e.showModal,j=void 0!==o&&o,b=Y(),m=Object(d.useState)(Ze),h=Object(i.a)(m,2),O=h[0],p=h[1],f=O.done,v=f.purchases,N=f.brands,y=f.supplier_of,w=f.orders,C=f.exams,_=O.analytics,S=O.metadata,k=Object(u.f)(),E=function(e,t){e&&O[e]!==t&&p(Object(r.a)(Object(r.a)({},O),{},Object(g.a)({},e,t)))},B=function(){return!O.name||(!O.email||O.phone_notices.length<10&&O.phone_cell.length<10&&O.phone_office.length<10)};return Object(d.useEffect)((function(){s&&(p(Object(r.a)(Object(r.a)({},O),{},{loading:!0})),b.getContact(parseInt(s)).then((function(e){!function(e,t){if(e){var a,c,n,s,r,i,l,o,d,j,u,b,m,h,O,x,p,f,v,g,N,y,w,C,_=D()(null===(a=e.metadata)||void 0===a?void 0:a.birthday),S=D()(),k=S.diff(_,"days");t({id:e.id,name:null===(c=e.name)||void 0===c?void 0:c.toLowerCase(),rfc:null===(n=e.rfc)||void 0===n?void 0:n.toUpperCase(),gender:null!==(s=e.metadata)&&void 0!==s&&s.gender?null===(r=e.metadata)||void 0===r?void 0:r.gender:"male",email:null===(i=e.email)||void 0===i?void 0:i.toLowerCase(),type:e.type,business:e.business,birthday:k>0?_:S,phone_notices:null===(l=e.phones)||void 0===l?void 0:l.notices,phone_cell:null===(o=e.phones)||void 0===o?void 0:o.cell,phone_office:null===(d=e.phones)||void 0===d?void 0:d.office,age:null!==(j=e.age)&&void 0!==j?j:0,address_street:null===(u=e.address)||void 0===u?void 0:u.street.toLowerCase(),address_neighborhood:null===(b=e.address)||void 0===b?void 0:b.neighborhood.toLowerCase(),address_location:null===(m=e.address)||void 0===m?void 0:m.location.toLowerCase(),address_state:null===(h=e.address)||void 0===h?void 0:h.state.toLowerCase(),address_zip:null===(O=e.address)||void 0===O?void 0:O.zip.toLowerCase(),done:{purchases:e.purchases,brands:e.brands,supplier_of:e.supplier_of,orders:e.orders,exams:e.exams},analytics:{purchases:e.purchases_count,exams:e.exams_count,brands:e.brands_count,suppliers:e.suppliers_count,orders:e.orders_count},metadata:{created_at:e.created_at?D()(e.created_at):D()(),updated_at:e.updated_at?D()(e.updated_at):D()(),deleted_at:null!==(x=e.deleted_at)&&void 0!==x?x:"",created:null!==(p=null===(f=e.created)||void 0===f?void 0:f.username.toLowerCase())&&void 0!==p?p:"",updated:null!==(v=null===(g=e.updated)||void 0===g?void 0:g.username.toLowerCase())&&void 0!==v?v:"--"},validates:{name:(null===(N=e.name)||void 0===N?void 0:N.length)>5,email:De.isEmail(e.email),birthday:Boolean(D()().diff(null===(y=e.metadata)||void 0===y?void 0:y.birthday,"days")>0),phones:Boolean(Object.values(null!==(w=e.phones)&&void 0!==w?w:{}).filter((function(e){return 10===e.length})).length)},activity:null!==(C=e.activity)&&void 0!==C?C:[],loading:!1})}}(e,p)})))}),[s]),Object(x.jsxs)(x.Fragment,{children:[O.id?Object(x.jsx)(Ve,{analytics:_,metadata:S}):null,Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-md-12",children:[S.deleted_at?Object(x.jsxs)("div",{className:"alert alert-warning",children:[Object(x.jsxs)("h4",{className:"alert-heading",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Precaucion!"]}),Object(x.jsxs)("p",{children:["Este contacto fue eliminado por ",null===(t=O.updated)||void 0===t?void 0:t.name," el"," ",D()(O.deleted_at).format("LLLL")]})]}):null,Object(x.jsxs)("div",{className:"card card-indigo card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title text-indigo",children:[Object(x.jsx)("i",{className:"fas fa-address-book mr-1"}),O.id?Object(x.jsxs)("label",{children:["Editar contacto",Object(x.jsx)("span",{className:"badge bg-indigo ml-2",children:O.id})]}):Object(x.jsx)("label",{children:"Registrar nuevo contacto"})]})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:"Datos personales"}),Object(x.jsx)(Pe,{data:O,handleChange:E,fn:b})]}),Object(x.jsxs)("div",{className:"row mt-5 border-top pt-5",children:[Object(x.jsxs)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:["Medios de contacto ",Object(x.jsx)("span",{className:"text-orange",children:"*"}),!O.validates.phones&&Object(x.jsx)("small",{className:"d-block w-100",children:Object(x.jsx)("span",{className:"text-orange",children:"Ingrese por lo menos un telefono"})})]}),Object(x.jsx)(Te,{data:O,handleChange:E})]}),O.type?null:Object(x.jsxs)("div",{className:"row mt-5 border-top pt-5",children:[Object(x.jsx)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:"Domicilios del contacto"}),Object(x.jsx)(Fe,{data:O,domicilios:null!==(a=O.address)&&void 0!==a?a:{calle:"",colonia:"",municipio:"",estado:"",cp:""},handleChange:E})]})]}),Object(x.jsx)("div",{className:"card-footer",children:Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-md-12",children:Object(x.jsxs)("div",{className:"btn-group float-right",role:"group",children:[Object(x.jsxs)("button",{className:"btn btn-default",type:"button",onClick:function(){k.push("/contactos"),l()},children:[Object(x.jsx)("i",{className:O.id?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),Object(x.jsx)("strong",{children:O.id?"Cerrar":"Cancelar"})]}),Object(x.jsxs)("button",{type:"button",className:"btn bg-indigo",onClick:function(){return function(){var e,t={id:O.id,name:O.name,rfc:O.rfc,gender:O.gender,email:O.email,type:O.type,business:O.business,birthday:O.birthday.format("YYYY/MM/DD"),phones:{notices:O.phone_notices,cell:O.phone_cell,office:O.phone_office},domicilio:{street:O.address_street,neighborhood:O.address_neighborhood,location:O.address_location,state:O.address_state,zip:O.address_zip}};if(null!==(e=O.address_street)&&void 0!==e&&e.length){if(!O.address_neighborhood)return window.Swal.fire({title:"Contactos",icon:"warning",text:"Completa el campo Colonia",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0});if(!O.address_location)return window.Swal.fire({title:"Contactos",icon:"warning",text:"Completa el campo Municipio",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0});if(!O.address_state)return window.Swal.fire({title:"Contactos",icon:"warning",text:"Completa el campo Estado",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0});if(!O.address_zip)return window.Swal.fire({title:"Contactos",icon:"warning",text:"Completa el campo c\xf3digo postal",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0})}window.Swal.fire({title:"Contactos",text:t.id?"\xbfDesea actualizar a este contacto?":"\xbfDesea crear un nuevo contacto?",icon:"question",showCancelButton:!0,confirmButtonText:t.id?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||(delete t.domicilio,b.saveContact(t).then((function(e){null!==e&&void 0!==e&&e.id&&(console.log("[Orus System] Create contatc successfully",e.id),l(),k.push("/contactos"))})))}))}()},disabled:O.type?B():!!B()||!O.birthday||!Boolean(D()().diff(O.birthday,"days")>0),children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),O.id?"Actualizar":"Guardar"]})]})})})}),O.loading&&Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})]})}),O.id?Object(x.jsxs)("div",{className:"content",id:"details",children:[Object(x.jsxs)("div",{className:"row",children:[!O.type&&Object(x.jsx)("div",{className:"col",children:Object(x.jsx)($e,{exams:C})}),v.length?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(x.jsx)("i",{className:"fas fa-money-bill mr-1"}),"Compras"]}),Object(x.jsx)(ze,{sales:v})]})})}):null,N.length?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(x.jsx)("i",{className:"fas fa-copyright mr-1"}),"Marcas"]}),Object(x.jsx)(Ae,{brands:N})]})})}):null,y.length?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(x.jsx)("i",{className:"fas fa-building mr-1"}),"Laboratorio"]}),Object(x.jsx)(Ye,{orders:null!==y&&void 0!==y?y:[]})]})})}):null,w.length?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("div",{className:"card",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(x.jsx)("i",{className:"fas fa-shopping-basket mr-1"}),"Pedidos"]}),Object(x.jsx)(Ye,{orders:null!==w&&void 0!==w?w:[]})]})})}):null]}),Boolean(O.activity.length)&&Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-12",children:Object(x.jsx)(F,{data:O.activity})})})]}):null,j&&Object(x.jsx)(He,{body:(c=10,Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"text-center",children:"\xbfRealmente desea ver el examen?"}),Object(x.jsx)("div",{className:"text-center",children:Object(x.jsx)(n.b,{to:"/consultorio/".concat(c),className:"btn btn-primary",children:"Confirmar"})})]})),handleCancel:function(){}})]})}var Ke={page:1,orderby:"created_at",order:"desc",itemsPage:25};function We(e){var t=Object(d.useState)({options:Ke,newOrEdit:null}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.match.params.id;return Object(d.useEffect)((function(){n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!!s}))}),[s]),Object(x.jsx)(we.Provider,{value:Object(r.a)(Object(r.a)({},c),{},{set:n}),children:Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsx)(_e,{newOrEdit:c.newOrEdit,handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!c.newOrEdit}))}}),"boolean"===typeof c.newOrEdit?Object(x.jsx)("div",{className:"col-sm-12 col-md-8 col-lg-10",children:c.newOrEdit?Object(x.jsx)(Je,Object(r.a)(Object(r.a)({},e),{},{handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!c.newOrEdit}))}})):Object(x.jsx)(Se,{})}):Object(x.jsx)("p",{children:"Loading component"})]})})}function Xe(){var e=Object(d.useState)({showForm:!1,id:0,name:"",address:"",phone:""}),t=Object(i.a)(e,2),a=t[0],c=t[1],n=Object(d.useContext)(y).data.filter((function(e){return"branches"===e.name})),s=function(e){var t=e.name,n=e.value;c(Object(r.a)(Object(r.a)({},a),{},Object(g.a)({},t,n.toString().toLowerCase())))};return Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title d-block mb-2",children:[Object(x.jsx)("i",{className:"fas fa-store mr-1"}),"Sucursales"]}),a.showForm?Object(x.jsxs)("form",{className:"card-text m-2 mt-4",onSubmit:function(e){e.preventDefault()},children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Nombre de la sucursal"}),Object(x.jsx)("input",{type:"text",placeholder:"Escriba el nombre de la sucursal",className:"form-control",name:"name",defaultValue:a.name,onChange:function(e){var t=e.target;return s(t)}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Domicilio"}),Object(x.jsx)("input",{type:"text",placeholder:"Escriba el domicilio de la sucursal",className:"form-control",name:"address",defaultValue:a.address,onChange:function(e){var t=e.target;return s(t)}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Telefono"}),Object(x.jsx)("input",{type:"phone",placeholder:"Escriba el telefono de la sucursal",className:"form-control",name:"phone",defaultValue:a.phone,onChange:function(e){var t=e.target;return s(t)},maxLength:10})]}),Object(x.jsxs)("div",{className:"form-group text-right",children:[Object(x.jsx)("button",{type:"button",className:"btn btn-link",onClick:function(){return c(Object(r.a)(Object(r.a)({},a),{},{showForm:!1,id:0,name:"",address:"",phone:""}))},children:"Cancelar"}),Object(x.jsx)("button",{type:"submit",className:"btn btn-dark ml-2",children:"Guardar"})]})]}):Object(x.jsx)("div",{className:"table-responsive",children:Object(x.jsxs)("table",{className:"table table-striped table-sm",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{children:"Domicilio"}),Object(x.jsx)("td",{children:Object(x.jsx)("span",{className:"sr-only",children:"Acciones"})})]})}),Object(x.jsx)("tbody",{children:n.map((function(e){var t;return"bank"!==e.name?Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-capitalize",children:e.data.name}),Object(x.jsx)("td",{className:"text-truncate text-capitalize",children:null!==(t=e.data.address)&&void 0!==t?t:"--"}),Object(x.jsx)("td",{className:"text-right",children:Object(x.jsx)("button",{type:"button",className:"btn btn-sm btn-primary ml-1",onClick:function(){return function(e){var t,a,n,s=e.id,i=(e.values,e.data);c(Object(r.a)(Object(r.a)({},i),{},{showForm:!0,id:s,name:null===(t=i.name)||void 0===t?void 0:t.toString().toLowerCase(),address:null===(a=i.address)||void 0===a?void 0:a.toString().toLowerCase(),phone:null===(n=i.phone)||void 0===n?void 0:n.toString().toLowerCase()}))}(e)},children:Object(x.jsx)("i",{className:"fas fa-edit"})})})]},e.id):null}))})]})})]}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("button",{className:"btn btn-primary btn-sm",disabled:a.showForm,onClick:function(){return c(Object(r.a)(Object(r.a)({},a),{},{showForm:!0}))},children:Object(x.jsx)("i",{className:"fas fa-plus"})})})]})}function Qe(){var e=Object(d.useContext)(p).auth,t=JSON.parse(localStorage.getItem("OrusSystem")),a=Object(d.useState)({server:t.host?t.host:"",company:t.company?t.company:"",email:e.email?e.email:"",name:e.name?e.name:"",username:e.username?e.username:"",password:"",category_list:[]}),c=Object(i.a)(a,2),n=c[0],s=c[1],r=function(e){var t=e.target,a=t.name,c=t.value;s(Object(g.a)({},a,c.toLowerCase()))};return Object(x.jsxs)("div",{className:"row",style:{height:"100vh"},children:[Object(x.jsx)("div",{className:"col-12",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:"Generales"}),Object(x.jsx)("p",{children:"\xa0"}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-server"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"server",value:n.server,onChange:r})]}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-building"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre de la empresa",name:"company",value:n.company,onChange:r})]})]}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.company=n.company,localStorage.setItem("OrusSystem",JSON.stringify(e))},children:"Guardar"})})]})}),Object(x.jsx)("div",{className:"col-lg-6 col-sm-12",children:Object(x.jsxs)("div",{className:"card card-primary card-outline",children:[Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:"Usuario"}),Object(x.jsx)("p",{children:"\xa0"}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-at"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Email",name:"email",value:n.email,onChange:r})]}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-user-tag"})})}),Object(x.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",value:n.name,onChange:r})]}),Object(x.jsx)("hr",{}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-user-check"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Usuario",name:"username",value:n.username,onChange:r})]}),Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:Object(x.jsx)("i",{className:"fas fa-lock"})})}),Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Contrase\xf1a",name:"password",value:n.password,onChange:r})]})]}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){},children:"Guardar"})})]})}),Object(x.jsx)("div",{className:"col-lg-6 col-md-12 col-sm-12",children:Object(x.jsx)(Xe,{})})]})}var et=Object(d.createContext)(null),tt=function(){return Object(d.useContext)(et)};function at(e){var t,a,c,n,s,i,l,o=e.newOrEdit,d=e.handleNewOrEdit,j=tt(),u=null===(t=w().data)||void 0===t?void 0:t.filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"branches"===e.name})),b=null!==(a=j.options)&&void 0!==a&&a.date?D()(j.options.date):D()();return Object(x.jsxs)("div",{className:"col-sm-12 col-md-2 d-print-none",children:[Object(x.jsxs)("button",{className:"btn bg-info btn-block mb-3",type:"button",disabled:o,onClick:d,children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo examen"]}),Object(x.jsxs)(M,{title:"Filtros",children:[Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(x.jsxs)("select",{className:"form-control",id:"orderby",defaultValue:null===(c=j.options)||void 0===c?void 0:c.orderby,onChange:function(e){var t=e.target;j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{orderby:t.value})}))},children:[Object(x.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(x.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"date",children:"Fecha"}),Object(x.jsx)(Ee.a,{className:"form-control",locale:"es",selected:new Date(b.format("YYYY/MM/DD")),dateFormat:"dd/MM/yyyy",maxDate:new Date,placeholderText:"Seleccione una fecha",onSelect:function(e){e&&(e=e.toLocaleDateString("es-MX"),(e=D()(e,"DD/MM/YYYY")).isValid()&&j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{date:e.format("YYYY/MM/DD")})})))},onChange:function(e){e&&(e=e.toLocaleDateString("es-MX"),(e=D()(e,"DD/MM/YYYY")).isValid()&&j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{date:e.format("YYYY/MM/DD")})})))}}),Object(x.jsxs)("button",{type:"button",className:"btn btn-info btn-block text-bold mt-1",onClick:function(e){j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{date:""})}))},children:[Object(x.jsx)("i",{className:"fas fa-trash mr-1"}),"Borrar fecha"]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(x.jsxs)("select",{className:"form-control",id:"order",value:null===(n=j.options)||void 0===n?void 0:n.order,onChange:function(e){var t=e.target;j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{order:t.value})}))},children:[Object(x.jsx)("option",{value:"asc",children:"Antiguos"}),Object(x.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"itemsPage",children:"Numero de examenes"}),Object(x.jsxs)("select",{className:"form-control",id:"itemsPage",value:null===(s=j.options)||void 0===s?void 0:s.itemsPage,onChange:function(e){var t=e.target;j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{itemsPage:t.value})}))},children:[Object(x.jsx)("option",{value:"25",children:"ver 25"}),Object(x.jsx)("option",{value:"50",children:"ver 50"}),Object(x.jsx)("option",{value:"75",children:"ver 75"}),Object(x.jsx)("option",{value:"100",children:"ver 100"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"status",children:"Estado"}),Object(x.jsxs)("select",{className:"form-control",id:"status",value:null===(i=j.options)||void 0===i?void 0:i.status,onChange:function(e){var t=e.target;j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{status:t.value})}))},children:[Object(x.jsx)("option",{value:"",children:"-- Todos --"}),Object(x.jsx)("option",{value:"1",children:"Solo terminados"}),Object(x.jsx)("option",{value:"0",children:"En proceso"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"status",children:"Sucursales"}),Object(x.jsxs)("select",{className:"form-control text-capitalize",id:"branch",value:null===(l=j.options)||void 0===l?void 0:l.branch,onChange:function(e){var t=e.target;j.set(Object(r.a)(Object(r.a)({},j),{},{options:Object(r.a)(Object(r.a)({},j.options),{},{branch:t.value})}))},children:[Object(x.jsx)("option",{value:"all",children:"-- Todas --"}),null===u||void 0===u?void 0:u.map((function(e){var t;return Object(x.jsx)("option",{value:e.id,children:null===(t=e.data)||void 0===t?void 0:t.name},e.id)}))]})]})]})]})}function ct(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=O("exams",null,t),e.next=5,h(a,"GET").then((function(e){return e})).catch((function(e){return console.error("[Orus System] Catch when get contacts list in hook:",e.message),null}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("exams",t),e.next=5,h(a,"GET").then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when get contact in hook:",e.message),{}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return a=O("exams",t),e.next=5,h(a,"DELETE").then((function(){return!0})).catch((function(e){return console.error("[Orus System] Catch when delete contact in hook:",e.message),!1}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a=t.id,delete t.id,!a){e.next=11;break}return c=O("exams",a),e.next=8,h(c,"PUT",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when update exam in hook"),e}));case 8:case 14:return e.abrupt("return",e.sent);case 11:return n=O("exams"),e.next=14,h(n,"POST",t).then((function(e){return e.data})).catch((function(e){return console.error("[Orus System] Catch when create exam in hook"),e}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getExams:e,getExam:t,deleteExam:a,saveExam:c}}function nt(){var e,t,a,c,n=tt(),s=ct(),l=Object(u.f)(),o=Object(d.useState)({list:[],meta:{},loading:!1,examSelected:{}}),j=Object(i.a)(o,2),b=j[0],m=j[1],h=function(){m(Object(r.a)(Object(r.a)({},b),{},{loading:!0})),s.getExams(n.options).then((function(e){e.data&&m(Object(r.a)(Object(r.a)({},b),{},{list:e.data,meta:e.meta,loading:!1,examSelected:{}}))}))},O=function(e){var t,a;if(null!==e&&void 0!==e&&e.id)s.saveExam({id:e.id,status:!e.status,contact_id:null===(a=e.customer)||void 0===a?void 0:a.id}).then((function(e){if(e.id)h();else if(e.hasOwnProperty("errors")){var t=Object.values(e.errors);console.error("[Orus System] Message of server:",e.errors),window.Swal.fire({title:"Consultorio",text:t[0],icon:"error",showConfirmButton:!1,timer:3e3})}}));else if(null!==(t=b.examSelected)&&void 0!==t&&t.id){var c;s.saveExam({id:b.examSelected.id,status:!b.examSelected.status,contact_id:null===(c=b.examSelected.customer)||void 0===c?void 0:c.id}).then((function(e){if(e.id)h();else if(e.hasOwnProperty("errors")){var t=Object.values(e.errors);console.error("[Orus System] Message of server:",e.errors),window.Swal.fire({title:"Consultorio",text:t[0],icon:"error",showConfirmButton:!1,timer:3e3})}}))}else console.error("[Orus System] When get id of exam:",e,b.examSelected),window.Swal.fire({title:"Consultorio",text:"Lo sentimos no existe un examen seleccionado",icon:"warning",showConfirmButton:!1,timer:3e3})};return Object(d.useEffect)((function(){h()}),[n.options]),Object(x.jsx)(Z,{title:"Lista de examenes",icon:"notes-medical",color:"info",loading:b.loading,meta:b.meta,itemSelected:null===(e=b.examSelected)||void 0===e?void 0:e.id,handlePagination:function(e){e&&n.set(Object(r.a)(Object(r.a)({},n),{},{options:Object(r.a)(Object(r.a)({},n.options),{},{page:e})}))},handleSearch:function(e){e?n.set(Object(r.a)(Object(r.a)({},n),{},{options:Object(r.a)(Object(r.a)({},n.options),{},{search:e,page:1})})):n.options.search&&n.set(Object(r.a)(Object(r.a)({},n),{},{options:Object(r.a)(Object(r.a)({},n.options),{},{search:"",page:1})}))},handleDeleteItem:function(){var e;null!==(e=b.examSelected)&&void 0!==e&&e.id?window.Swal.fire({title:"Consultorio",text:"\xbfDesea eliminar el examen?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss?m(Object(r.a)(Object(r.a)({},b),{},{examSelected:{}})):s.deleteExam(b.examSelected.id).then((function(){h()}))})):window.Swal.fire({title:"Error",text:"Lo sentimos no existe un examen seleccionado",icon:"error",timer:3e3})},handleEditItem:function(){var e;null!==(e=b.examSelected)&&void 0!==e&&e.id?l.push("consultorio/".concat(b.examSelected.id)):window.Swal.fire({title:"Error",text:"Lo sentimos no existe un examen seleccionado",icon:"error"})},handleSync:h,handleStatus:O,children:Object(x.jsxs)("table",{className:"table table-hover table-striped",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{children:"Estado"}),Object(x.jsx)("th",{children:"ESF"}),Object(x.jsx)("th",{children:"CIL"}),Object(x.jsx)("th",{children:"EJE"}),Object(x.jsx)("th",{children:"ADC"}),Object(x.jsx)("th",{children:"MED"}),Object(x.jsx)("th",{children:"DP"}),Object(x.jsx)("th",{children:"ALT"}),Object(x.jsx)("th",{children:"created_at"===(null===(t=n.options)||void 0===t?void 0:t.orderby)?"Registrado":"Actualizado"})]})}),Object(x.jsx)("tbody",{children:null!==(a=b.list)&&void 0!==a&&a.length?Object(x.jsx)(x.Fragment,{children:null===(c=b.list)||void 0===c?void 0:c.map((function(e){var t,a,c,s,i;return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(x.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",id:"exam_"+e.id,checked:(null===(t=b.examSelected)||void 0===t?void 0:t.id)===e.id,disabled:e.estado||(null===(a=e.orders)||void 0===a?void 0:a.length),onChange:function(t){var a=t.target;m(Object(r.a)(Object(r.a)({},b),{},{examSelected:a.checked?e:""}))}}),Object(x.jsx)("label",{htmlFor:"exam_"+e.id,className:"sr-only"})]}),Object(x.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",children:Object(x.jsx)("a",{href:"#edit",onClick:function(t){t.preventDefault(),l.push("consultorio/".concat(e.id))},children:Object(x.jsxs)("span",{className:e.status||null!==(c=e.orders)&&void 0!==c&&c.length?"text-muted":"text-dark text-bold",children:[Object(x.jsx)("i",{className:"fas fa-user text-sm mr-2"}),null===(s=e.customer)||void 0===s?void 0:s.name.toLowerCase()]})})}),Object(x.jsx)("td",{className:"text-center",style:{cursor:"pointer"},onClick:function(){return O(e)},children:e.status?Object(x.jsx)("i",{className:"fas fa-clipboard-check text-muted",title:"Terminado"}):Object(x.jsx)("i",{className:"fas fa-clipboard text-info",title:"En proceso"})}),Object(x.jsxs)("td",{children:[e.esferaod,"/",e.esferaoi]}),Object(x.jsxs)("td",{children:[e.cilindrod,"/",e.cilindroi]}),Object(x.jsxs)("td",{children:[e.ejeod,"/",e.ejeoi]}),Object(x.jsxs)("td",{children:[e.adiciond,"/",e.adicioni]}),Object(x.jsxs)("td",{children:[e.adicion_media_od,"/",e.adicion_media_oi]}),Object(x.jsxs)("td",{children:[e.dpod,"/",e.dpoi]}),Object(x.jsxs)("td",{children:[e.alturaod,"/",e.alturaoi]}),Object(x.jsx)("td",{children:D()("created_at"===(null===(i=n.options)||void 0===i?void 0:i.orderby)?e.created_at:e.updated_at).fromNow()})]},e.id)}))}):Object(x.jsx)("tr",{children:Object(x.jsx)("th",{className:"text-center text-muted",colSpan:"12",children:"No hay examenes registrados"})})})]})})}function st(e){var t,a,c,n,s,r,i=function(t){var a=t.target,c=a.name,n=a.type,s=a.checked,r=a.value,i="checkbox"===n?s:r.toLowerCase();e.handleGetData(c,i)};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"pc",type:"checkbox",className:"custom-control-input",id:"pc",checked:e.pc,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"pc",children:[Object(x.jsx)("i",{className:"fas fa-desktop"})," PC"]})]}),Object(x.jsx)("input",{type:"text",name:"pc_time",className:"form-control input-xs",defaultValue:null!==(t=e.pc_time)&&void 0!==t?t:"",onChange:i,readOnly:e.pc?"":"readonly"})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"tablet",type:"checkbox",className:"custom-control-input",id:"tablet",checked:e.tablet,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"tablet",children:[Object(x.jsx)("i",{className:"fas fa-tablet-alt"})," Tablet"]})]}),Object(x.jsx)("input",{type:"text",name:"tablet_time",className:"form-control input-xs",defaultValue:null!==(a=e.tablet_time)&&void 0!==a?a:"",onChange:i,readOnly:e.tablet?"":"readonly"})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"movil",type:"checkbox",className:"custom-control-input",id:"movil",checked:e.movil,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"movil",children:[Object(x.jsx)("i",{className:"fas fa-mobile-alt"})," Telefono"]})]}),Object(x.jsx)("input",{type:"text",name:"movil_time",className:"form-control input-xs",defaultValue:null!==(c=e.movil_time)&&void 0!==c?c:"",onChange:i,readOnly:e.movil?"":"readonly"})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"lap",type:"checkbox",className:"custom-control-input",id:"lap",checked:e.lap,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"lap",children:[Object(x.jsx)("i",{className:"fas fa-laptop"})," Laptop"]})]}),Object(x.jsx)("input",{type:"text",name:"lap_time",className:"form-control input-xs",defaultValue:null!==(n=e.lap_time)&&void 0!==n?n:"",onChange:i,readOnly:e.lap?"":"readonly"})]})]}),Object(x.jsxs)("div",{className:"row mt-1",children:[Object(x.jsx)("div",{className:"col-md-6",children:Object(x.jsxs)("ul",{className:"list-group",children:[Object(x.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"frontal",type:"checkbox",className:"custom-control-input",id:"frontal",checked:e.frontal,onChange:i}),Object(x.jsx)("label",{className:"custom-control-label",htmlFor:"frontal",children:"Frontal"})]})}),Object(x.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"occipital",type:"checkbox",className:"custom-control-input",id:"occipital",checked:e.occipital,onChange:i}),Object(x.jsx)("label",{className:"custom-control-label",htmlFor:"occipital",children:"Occipital"})]})}),Object(x.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"generality",type:"checkbox",className:"custom-control-input",id:"generality",checked:e.generality,onChange:i}),Object(x.jsx)("label",{className:"custom-control-label",htmlFor:"generality",children:"General"})]})}),Object(x.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"cefalea",type:"checkbox",className:"custom-control-input",id:"cefalea",checked:e.cefalea,onChange:i}),Object(x.jsx)("label",{className:"custom-control-label",htmlFor:"cefalea",children:"Cefalea"})]})})]})}),Object(x.jsx)("div",{className:"col-md-6",children:Object(x.jsxs)("ul",{className:"list-group",children:[Object(x.jsxs)("li",{className:"list-group-item",children:["Temporal",Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"row mt-2",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"temporaod",type:"checkbox",className:"custom-control-input",id:"temporaod",checked:e.temporaod,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"temporaod",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," Derecho"]})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"temporaoi",type:"checkbox",className:"custom-control-input",id:"temporaoi",checked:e.temporaoi,onChange:i}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"temporaoi",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," Izquierdo"]})]})})]})]}),Object(x.jsxs)("li",{className:"list-group-item",children:["Frecuencia",Object(x.jsx)("span",{className:"badge badge-pill",children:Object(x.jsx)("input",{type:"text",name:"c_frecuencia",maxLength:"60",className:"form-control input-xs",defaultValue:null!==(s=e.c_frecuencia)&&void 0!==s?s:"",onChange:i})})]}),Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("label",{htmlFor:"c_intensidad",children:"Intensidad"}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-11",children:Object(x.jsx)("input",{type:"range",name:"c_intensidad",className:"custom-range custom-range-info",id:"c_intensidad",min:"0",max:"4",defaultValue:null!==(r=e.c_intensidad)&&void 0!==r?r:"",onChange:i})}),Object(x.jsx)("div",{className:"col-1",children:Object(x.jsx)("h6",{children:e.c_intensidad})})]})]})]})})]})]})}Object(ke.registerLocale)("es",Le.a);var rt=a(15),it=a(16),lt=a(17),ot=a(18),dt=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,c)},e}return Object(it.a)(a,[{key:"render",value:function(){var e,t,a,c;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Interrogatorio inicial"}),Object(x.jsx)("textarea",{name:"interrogatorio",className:"form-control",defaultValue:null!==(e=this.props.interrogatorio)&&void 0!==e?e:"",onChange:this.catchInputs})]})}),Object(x.jsx)("div",{className:"row mt-2",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Cirugias oculares"}),Object(x.jsx)("textarea",{name:"coa",className:"form-control",defaultValue:null!==(t=this.props.coa)&&void 0!==t?t:"",onChange:this.catchInputs})]})}),Object(x.jsx)("div",{className:"row mt-2",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Antecedentes oculares patologicas personales"}),Object(x.jsx)("textarea",{name:"aopp",className:"form-control",rows:"2",defaultValue:null!==(a=this.props.aopp)&&void 0!==a?a:"",onChange:this.catchInputs})]})}),Object(x.jsx)("div",{className:"row mt-2",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Antecedentes oculares patologicas familiares"}),Object(x.jsx)("textarea",{name:"aopf",className:"form-control",rows:"2",defaultValue:null!==(c=this.props.aopf)&&void 0!==c?c:"",onChange:this.catchInputs})]})})]})}}]),a}(d.Component),jt=function(e){var t,a,c,n,s=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.onChangeInput(a,c)};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-6",children:"Keratometria"}),Object(x.jsx)("div",{className:"col-6",children:"Retinoscopia"})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fas fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"keratometriaod",maxLength:"12",className:"form-control input-xs",defaultValue:null!==(t=e.keratometriaod)&&void 0!==t?t:"",onChange:s})]}),Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("i",{className:"fas fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"keratometriaoi",maxLength:"12",className:"form-control input-xs",defaultValue:null!==(a=e.keratometriaoi)&&void 0!==a?a:"",onChange:s})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"rsod",maxLength:"16",className:"form-control",defaultValue:null!==(c=e.rsod)&&void 0!==c?c:"",onChange:s})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"rsoi",maxLength:"16",className:"form-control",defaultValue:null!==(n=e.rsoi)&&void 0!==n?n:"",onChange:s})]})]})]})},ut=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,c)},e}return Object(it.a)(a,[{key:"render",value:function(){var e,t,a,c,n,s;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsx)("label",{children:"Diab\xe9tico"})}),Object(x.jsx)("div",{className:"col-md-4",children:Object(x.jsx)("label",{children:"Fotocoagulaci\xf3n laser"})})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-3",children:"Fecha"}),Object(x.jsx)("div",{className:"col-2",children:"Rango de glucosa"}),Object(x.jsx)("div",{className:"col-3",children:"Ultimo examen"}),Object(x.jsx)("div",{className:"col-2",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"d_fclod",type:"checkbox",className:"custom-control-input",id:"d_fclod",checked:this.props.d_fclod,onChange:this.catchInputs}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"d_fclod",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," Derecho"]})]})}),Object(x.jsx)("div",{className:"col-2",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"d_fcloi",type:"checkbox",className:"custom-control-input",id:"d_fcloi",checked:this.props.d_fcloi,onChange:this.catchInputs}),Object(x.jsxs)("label",{className:"custom-control-label",htmlFor:"d_fcloi",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," Izquierdo"]})]})})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-md-3",children:Object(x.jsx)("input",{type:"date",name:"d_time",className:"form-control",defaultValue:null!==(e=this.props.d_time)&&void 0!==e?e:"",onChange:this.catchInputs})}),Object(x.jsx)("div",{className:"col-md-2",children:Object(x.jsx)("input",{type:"text",name:"d_media",className:"form-control",defaultValue:null!==(t=this.props.d_media)&&void 0!==t?t:"",onChange:this.catchInputs})}),Object(x.jsx)("div",{className:"col-md-3",children:Object(x.jsx)("input",{type:"date",name:"d_test",className:"form-control",defaultValue:null!==(a=this.props.d_test)&&void 0!==a?a:"",onChange:this.catchInputs})}),Object(x.jsx)("div",{className:"col-md-2",children:Object(x.jsx)("input",{type:"text",name:"d_fclod_time",className:"form-control",defaultValue:null!==(c=this.props.d_fclod_time)&&void 0!==c?c:"",onChange:this.catchInputs,readOnly:this.props.d_fclod?"":"readonly"})}),Object(x.jsx)("div",{className:"col-md-2",children:Object(x.jsx)("input",{type:"text",name:"d_fcloi_time",className:"form-control",defaultValue:null!==(n=this.props.d_fcloi_time)&&void 0!==n?n:"",onChange:this.catchInputs,readOnly:this.props.d_fcloi?"":"readonly"})})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Oftalmoscopia"}),Object(x.jsx)("textarea",{name:"oftalmoscopia",className:"form-control",defaultValue:null!==(s=this.props.oftalmoscopia)&&void 0!==s?s:"",onChange:this.catchInputs})]})})]})}}]),a}(d.Component),bt=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,c)},e}return Object(it.a)(a,[{key:"render",value:function(){var e,t,a,c,n,s,r,i,l;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-md-6",children:"Capacidad visual"})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"cvod",maxLength:"12",className:"form-control",defaultValue:null!==(e=this.props.cvod)&&void 0!==e?e:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"cvoi",maxLength:"12",className:"form-control",defaultValue:null!==(t=this.props.cvoi)&&void 0!==t?t:"",onChange:this.catchInputs})]})]}),Object(x.jsxs)("div",{className:"row mt-2",children:[Object(x.jsx)("div",{className:"col-md-6",children:"Agudeza visual (Sin lentes)"}),Object(x.jsx)("div",{className:"col-md-6",children:"Agudeza visual (con la graduaci\xf3n anterior)"})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"avslod",maxLength:"12",className:"form-control",defaultValue:null!==(a=this.props.avslod)&&void 0!==a?a:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"avsloi",maxLength:"12",className:"form-control",defaultValue:null!==(c=this.props.avsloi)&&void 0!==c?c:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"avcgaod",maxLength:"12",className:"form-control input-xs",defaultValue:null!==(n=this.props.avcgaod)&&void 0!==n?n:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"avcgaoi",maxLength:"12",className:"form-control input-xs",defaultValue:null!==(s=this.props.avcgaoi)&&void 0!==s?s:"",onChange:this.catchInputs})]})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-md-6",children:"Agudeza visual final"})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("br",{}),Object(x.jsx)("input",{type:"text",name:"avfod",maxLength:"12",className:"form-control",defaultValue:null!==(r=this.props.avfod)&&void 0!==r?r:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("br",{}),Object(x.jsx)("input",{type:"text",name:"avfoi",maxLength:"12",className:"form-control",defaultValue:null!==(i=this.props.avfoi)&&void 0!==i?i:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-md-4",children:[Object(x.jsx)("i",{className:"fa fa-eye"}),Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Ambos"}),Object(x.jsx)("br",{}),Object(x.jsx)("input",{type:"text",name:"avf2o",maxLength:"25",className:"form-control",defaultValue:null!==(l=this.props.avf2o)&&void 0!==l?l:"",onChange:this.catchInputs})]})]})]})}}]),a}(d.Component),mt=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,c)},e}return Object(it.a)(a,[{key:"render",value:function(){var e,t,a,c;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-md-6"}),Object(x.jsx)("div",{className:"col-md-6",children:"Tensi\xf3n ocular"})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-md-3",children:["Diagnostico",Object(x.jsxs)("select",{name:"diagnostico",className:"form-control",defaultValue:null!==(e=this.props.diagnostico)&&void 0!==e?e:"",onChange:this.catchInputs,children:[Object(x.jsx)("option",{value:"Emetrope",children:"Em\xe9trope"}),Object(x.jsx)("option",{value:"hipermetropia",children:"Hipermetrop\xeda"}),Object(x.jsx)("option",{value:"hipermetropia-astigmatismo",children:"Hipermetrop\xeda y astigmatismo"}),Object(x.jsx)("option",{value:"hipermetropia-miopia",children:"Hipermetrop\xeda y miop\xeda"}),Object(x.jsx)("option",{value:"astigmatismo-regla",children:"Astigmatismo con la regla"}),Object(x.jsx)("option",{value:"astigmatismo-contra-regla",children:"Astigmatismo contra la regla"}),Object(x.jsx)("option",{value:"astigmatismo-oblicuo",children:"Astigmatismo oblicuo"}),Object(x.jsx)("option",{value:"astigmatismo-miopia",children:"Astigmatismo/m\xedopico"}),Object(x.jsx)("option",{value:"miopia",children:"Miop\xeda"})]})]}),Object(x.jsx)("div",{className:"col-md-3",children:Object(x.jsxs)("div",{className:"custom-control custom-switch",children:[Object(x.jsx)("input",{name:"presbicie",type:"checkbox",className:"custom-control-input",id:"presbicie",checked:this.props.presbicie,onChange:this.catchInputs}),Object(x.jsx)("label",{className:"custom-control-label",htmlFor:"presbicie",children:"Presbicie"})]})}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"number",name:"piod",min:"0",max:"40",step:"1",className:"form-control",defaultValue:null!==(t=this.props.piod)&&void 0!==t?t:"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col-md-3",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"number",name:"pioi",min:"0",max:"40",step:"1",className:"form-control",defaultValue:null!==(a=this.props.pioi)&&void 0!==a?a:"",onChange:this.catchInputs})]})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-12",children:[Object(x.jsx)("label",{children:"Tratamiento oftalmico"}),Object(x.jsx)("textarea",{name:"txoftalmico",className:"form-control",defaultValue:null!==(c=this.props.txoftalmico)&&void 0!==c?c:"",onChange:this.catchInputs})]})})]})}}]),a}(d.Component),ht=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target,c=a.name,n=a.type,s=a.value,r=a.checked,i=e.props.onChangeInput,l=s;"checkbox"===n&&(l=r),"text"===n&&(l=s.toLowerCase()),"number"===n&&("ejeod"===c||"ejeoi"===c?l=parseInt(s):(l=(l=parseFloat(s)).toFixed(2),l=parseFloat(l))),i&&i(c,l)},e}return Object(it.a)(a,[{key:"render",value:function(){var e=this.props,t=e.readOnly,a=void 0!==t&&t,c=e.cilindrod,n=e.cilindroi,s=e.esferaod,r=e.esferaoi,i=e.ejeod,l=e.ejeoi,o=e.adiciond,d=e.adicioni,j=e.adicion_media_od,u=e.adicion_media_oi,b=e.dpod,m=e.dpoi,h=e.alturaod,O=e.alturaoi,p=e.lcmarca,f=e.lcgod,v=e.lcgoi,g=e.showContactGlasses,N=void 0===g||g;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("table",{className:"table",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"#"}),Object(x.jsx)("th",{children:"Esfera"}),Object(x.jsx)("th",{children:"Cilindro"}),Object(x.jsx)("th",{children:"Eje"}),Object(x.jsx)("th",{children:"Adici\xf3n"}),Object(x.jsx)("th",{children:"Adici\xf3n media"}),Object(x.jsx)("th",{children:"D/P"}),Object(x.jsx)("th",{children:"Altura"})]})}),Object(x.jsxs)("tbody",{children:[Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{children:[Object(x.jsx)("i",{className:"fa fa-eye mr-1",title:"Ojo derecho"}),Object(x.jsx)("span",{className:"text-sm d-block",children:"Derecho"})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"esferaod",min:"-20",max:"20",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==s&&void 0!==s?s:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==s&&void 0!==s?s:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"cilindrod",min:"-20",max:"0",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==c&&void 0!==c?c:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==c&&void 0!==c?c:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"ejeod",min:"0",max:"180",step:"1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,placeholder:"\xb0",defaultValue:i?parseInt(i):"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==i&&void 0!==i?i:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"adiciond",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==o&&void 0!==o?o:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==o&&void 0!==o?o:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"adicion_media_od",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==j&&void 0!==j?j:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==j&&void 0!==j?j:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"dpod",min:"40",max:"80",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==b&&void 0!==b?b:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==b&&void 0!==b?b:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"alturaod",min:"0",max:"35",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==h&&void 0!==h?h:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==h&&void 0!==h?h:""})]})]}),Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{children:[Object(x.jsx)("i",{className:"fa fa-eye ml-1",title:"Ojo izquierdo"}),Object(x.jsx)("span",{className:"text-sm d-block",children:"Izquierdo"})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"esferaoi",min:"-20",max:"20",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==r&&void 0!==r?r:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==r&&void 0!==r?r:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"cilindroi",min:"-20",max:"0",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==n&&void 0!==n?n:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==n&&void 0!==n?n:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"ejeoi",min:"0",max:"180",step:"1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,placeholder:"\xb0",defaultValue:l?parseInt(l):"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==l&&void 0!==l?l:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"adicioni",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==d&&void 0!==d?d:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==d&&void 0!==d?d:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"adicion_media_oi",min:"0",max:"3",step:".25",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==u&&void 0!==u?u:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==u&&void 0!==u?u:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"dpoi",min:"40",max:"80",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==m&&void 0!==m?m:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==m&&void 0!==m?m:""})]}),Object(x.jsxs)("td",{className:"text-right",children:[Object(x.jsx)("input",{type:"number",name:"alturaoi",min:"0",max:"35",step:".1",className:a?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!a,defaultValue:null!==O&&void 0!==O?O:"",onChange:this.catchInputs}),Object(x.jsx)("h5",{className:"d-none d-print-block",children:null!==O&&void 0!==O?O:""})]})]})]})]}),N&&Object(x.jsx)("ul",{className:"list-group d-print-none mt-4",children:Object(x.jsxs)("li",{className:"list-group-item",children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-md-12",children:["Lente de contacto",Object(x.jsx)("input",{type:"text",name:"lcmarca",maxLength:"70",className:a?"form-control disabled":"form-control",disabled:!!a,defaultValue:null!==p&&void 0!==p?p:"",onChange:this.catchInputs})]})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Derecho"}),Object(x.jsx)("input",{type:"text",name:"lcgod",maxLength:"30",className:a?"form-control disabled":"form-control",disabled:!!a,defaultValue:f||"",onChange:this.catchInputs})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("i",{className:"fa fa-eye"})," ",Object(x.jsx)("label",{children:"Izquierdo"}),Object(x.jsx)("input",{type:"text",name:"lcgoi",maxLength:"30",className:a?"form-control disabled":"form-control",disabled:!!a,defaultValue:v||"",onChange:this.catchInputs})]})]})]})})]})}}]),a}(d.Component),Ot=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){var e;Object(rt.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,c="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,c)},e}return Object(it.a)(a,[{key:"render",value:function(){var e;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{htmlFor:"observaciones",children:"Observaciones"}),Object(x.jsx)("textarea",{name:"observaciones",id:"observaciones",className:"form-control",defaultValue:null!==(e=this.props.observaciones)&&void 0!==e?e:"",onChange:this.catchInputs})]})}}]),a}(d.Component),xt=function(e){var t="";return e.parent?e.parent.parent?(t=e.parent.parent.meta.code,t+=e.parent.meta.code,t+=e.meta.code):(t=e.parent.meta.code,t+=e.meta.code):t=e.meta.code,t},pt={handleTypeInput:function(e){return"pc"===e||"tablet"===e||"movil"===e||"lap"===e||"pc_time"===e||"tablet_time"===e||"movil_time"===e||"lap_time"===e||"frontal"===e||"occipital"===e||"generality"===e||"cefalea"===e||"temporaod"===e||"temporaoi"===e||"c_frecuencia"===e||"c_intensidad"===e?"generales":"interrogatorio"===e||"coa"===e||"aopp"===e||"aopf"===e?"interrogatorios":"keratometriaod"===e||"keratometriaoi"===e||"rsod"===e||"rsoi"===e?"keraRet":"d_time"===e||"d_media"===e||"d_test"===e||"d_fclod"===e||"d_fclod_time"===e||"d_fcloi"===e||"d_fcloi_time"===e?"diabetes":"cvod"===e||"cvoi"===e||"avslod"===e||"avsloi"===e||"avcgaod"===e||"avcgaoi"===e||"avfod"===e||"avfoi"===e||"avf2o"===e?"agudeza":"diagnostico"===e||"presbicie"===e||"piod"===e||"pioi"===e||"txoftalmico"===e?"diagnostico":"esferaod"===e||"esferaoi"===e||"cilindrod"===e||"cilindroi"===e||"ejeod"===e||"ejeoi"===e||"adiciond"===e||"adicioni"===e||"adicion_media_od"===e||"adicion_media_oi"===e||"dpod"===e||"dpoi"===e||"alturaod"===e||"alturaoi"===e||"lcmarca"===e||"lcgod"===e||"lcgoi"===e?"graduacion":"observaciones"===e?"observaciones":null},handleCodeName:xt,getCodeGrad:function(e,t,a,c,n){var s=Object.keys(e).length?xt(e):null;if(!s)return{};var r="+000000",i="+000000";return(c||t)&&(r=t>0?"+":"",r+=t.toFixed(2).toString().replace(".","")+c.toFixed(2).toString().replace("-","").replace(".","")),(n||a)&&(i=a>0?"+":"",i+=a.toFixed(2).toString().replace(".","")+n.toFixed(2).toString().replace("-","").replace(".","")),{code:s,od:r,oi:i}},handleSaveExam:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,c=e.examenes.filter((function(e){return 0===D()(e.created_at).diff(D()(),"days")||!e.estado}));if(c.length&&!t)return window.Swal.fire({title:"Examenes",text:"Existe un examen activo o del dia",icon:"error"}),console.error("[OrusSystem] Examenes activos:",c.length),!1;window.Swal.fire({title:"Almacenamiento",text:t?"\xbfEsta seguro de actualizar este examen?":"\xbfEsta seguro de crear un nuevo examen?",icon:"question",showCancelButton:!0,confirmButtonText:t?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(t){!t.dismiss&&a&&a({id:0,data:{edad:e.edad,contact_id:e.id}})}))}},ft=pt;function vt(e){var t=Object(d.useState)({category_list:[],category_list_2:[],category_list_3:[],category_id_1:0,category_id_2:0,category_id_3:0,category:{},codesItems:{}}),a=Object(i.a)(t,2),c=a[0],n=a[1],l=Q(),j=e.category_id,u=e.title,b=e.esferaod,m=e.esferaoi,h=e.cilindrod,O=e.cilindroi,p=e.handleCodesItems,f=c.codesItems,v=c.category_id_1,N=c.category_id_2,y=c.category_id_3,w=c.category_list_2,C=c.category_list_3,_=c.category_list,S=function(t){var a=t.target,s=a.name,i=a.value,l=e.onChangeInput;switch(s){case"category_id_1":for(var o in _)if(_[o].id===parseInt(i)){n(Object(r.a)(Object(r.a)({},c),{},{category_id_1:parseInt(i),category_id_3:0,category_list_2:_[o].sons,category_list_3:[]}));break}break;case"category_id_2":i&&c.category_list_2.map((function(e){return e.id===parseInt(i)&&n(Object(r.a)(Object(r.a)({},c),{},{category_id_2:parseInt(i),category_list_3:e.sons})),null}));break;case"category_id_3":l(parseInt(i));break;default:n(Object(r.a)(Object(r.a)({},c),{},Object(g.a)({},s,parseInt(i))))}},k=function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&l.getCategory(t).then((function(e){e.id?n(Object(r.a)(Object(r.a)({},c),{},{category:e})):console.error("[DEBUG] NEW ERROR",e)})),e.abrupt("return",{});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.getCategories({categoryid:"raiz",search:"lentes",order:"id"}).then((function(e){var t=e.data;n(Object(r.a)(Object(r.a)({},c),{},{category_list:t[0].sons}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){j?k(j):E()}),[j]),Object(d.useEffect)((function(){if(c.category.id){var e=ft.getCodeGrad(c.category,b,m,h,O);n(Object(r.a)(Object(r.a)({},c),{},{codesItems:e}))}}),[c.category]),Object(x.jsx)("div",{className:"card border border-info rounded d-print-none",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h3",{className:"card-title text-success m-2",children:u}),!j&&Object(x.jsxs)(x.Fragment,{children:[_.length?Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:"Tipo"})}),Object(x.jsxs)("select",{name:"category_id_1",className:"custom-select",defaultValue:null!==v&&void 0!==v?v:"",onChange:S,children:[Object(x.jsx)("option",{value:"0",children:"-- Seleccione el tipo --"}),_.map((function(e){return e.meta&&e.meta.rangoInf<=b&&b<=e.meta.rangoSup&&e.meta.rangoInf<=m&&m<=e.meta.rangoSup&&e.meta.cil<=h&&e.meta.cil<=O?Object(x.jsx)("option",{value:e.id,children:e.name},e.id):null}))]})]}):null,v&&w.length?Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:"Material"})}),Object(x.jsxs)("select",{name:"category_id_2",className:"custom-select",defaultValue:null!==N&&void 0!==N?N:"",onChange:S,children:[Object(x.jsx)("option",{value:"0",children:"-- Seleccione el material --"}),w.map((function(e){var t;return!!(e.meta&&e.meta.rangoInf<=b&&b<=e.meta.rangoSup&&e.meta.rangoInf<=m&&m<=e.meta.rangoSup)&&Object(x.jsx)("option",{value:null!==(t=e.id)&&void 0!==t?t:"",children:e.name},e.id)}))]})]}):null,v&&N&&C.length?Object(x.jsxs)("div",{className:"input-group mb-3",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text",children:"Tratamiento"})}),Object(x.jsxs)("select",{name:"category_id_3",className:"custom-select",defaultValue:null!==y&&void 0!==y?y:"",onChange:S,children:[Object(x.jsx)("option",{value:"0",children:"-- Seleccione el tratamiento --"}),C.map((function(e){var t;return Object(x.jsx)("option",{value:null!==(t=e.id)&&void 0!==t?t:"",children:e.name},e.id)}))]})]}):null]}),Object.values(f).length?Object(x.jsxs)(x.Fragment,{children:[f.code+f.od===f.code+f.oi?Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("label",{children:"Lente"}),": ",f.code+f.od]}):Object(x.jsxs)("div",{className:"row card-text",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Lente Derecho"}),Object(x.jsx)("br",{})," ",f.code+f.od]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Lente Izquierdo"}),Object(x.jsx)("br",{})," ",f.code+f.oi]})]}),p&&Object(x.jsx)("p",{className:"card-text text-right",children:Object(x.jsxs)("button",{className:"btn btn-info",onClick:function(e){e.preventDefault(),p({code:f.code,od:f.od,oi:f.oi})},children:[Object(x.jsx)("i",{className:"fas fa-check mr-2"}),"Siguiente"]})}),e.update?Object(x.jsx)("p",{className:"card-text text-right",children:Object(x.jsx)("button",{className:"btn btn-outline-info btn-sm card-link mt-2",onClick:function(t){t.preventDefault();var a=e.onChangeInput;n(Object(r.a)(Object(r.a)({},c),{},{category_list_2:[],category_list_3:[],category_id_1:0,category_id_2:0,category_id_3:0,category:{},codesItems:{}})),a(0)},children:"Cambiar"})}):null]}):null]})})}function gt(e){var t=e.title,a=void 0===t?"contacto":t,c=e.nameDefault,n=e.messages,s=void 0===n?[]:n,l=Object(d.useState)({name:"",phone:"",birthday:D()(),email:"",gender:"female"}),o=Object(i.a)(l,2),j=o[0],u=o[1],b=Y();return Object(d.useEffect)((function(){c&&u(Object(r.a)(Object(r.a)({},j),{},{name:c}))}),[]),Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsxs)("h5",{className:"modal-title text-primary text-bold",children:[Object(x.jsx)("i",{className:"fas fa-plus mr-2"}),"Crear nuevo ",a]}),Object(x.jsx)("button",{type:"button",className:"close",onClick:e.handleCancel,children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsxs)("div",{className:"modal-body",children:[s.length?Object(x.jsx)(x.Fragment,{children:s.map((function(e,t){var a=e.type,c=e.text;return Object(x.jsxs)("div",{className:"alert alert-".concat("error"===a?"danger":"success"===a?a:"warning"),children:[Object(x.jsx)("i",{className:"fas fa-info mr-1"}),c]},t)}))}):null,Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsxs)("label",{children:["Nombre del ",a]}),Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre del ".concat(a),autoComplete:"off",required:"required",pattern:"^[a-zA-Z.]{2,20}[\\s]{1}[a-zA-Z.]{2,20}.*",minLength:"8",defaultValue:j.name,onChange:function(e){var t=e.target;u(Object(r.a)(Object(r.a)({},j),{},{name:t.value.toLowerCase()}))}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"E-mail"}),Object(x.jsx)("input",{type:"email",className:"form-control",defaultValue:j.email,onChange:function(e){var t=e.target;u(Object(r.a)(Object(r.a)({},j),{},{email:t.value.toLowerCase()}))}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Telefono celular"}),Object(x.jsx)("input",{type:"tel",placeholder:"Telefono celular",className:"form-control",maxLength:"10",value:j.phone,onChange:function(e){var t=e.target;isNaN(t.value)||u(Object(r.a)(Object(r.a)({},j),{},{phone:t.value}))}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Fecha de naciemiento"}),Object(x.jsx)(Ee.a,{className:"form-control",locale:"es",selected:new Date(j.birthday.format("YYYY/MM/DD")),dateFormat:"dd/MM/yyyy",maxDate:new Date,placeholderText:"Seleccione una fecha",onSelect:function(e){e&&(e=e.toLocaleDateString("es-MX"),(e=D()(e,"DD/MM/YYYY")).isValid()&&u(Object(r.a)(Object(r.a)({},j),{},{birthday:e})))},onChange:function(e){e&&(e=e.toLocaleDateString("es-MX"),(e=D()(e,"DD/MM/YYYY")).isValid()&&u(Object(r.a)(Object(r.a)({},j),{},{birthday:e})))}})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"G\xe9nero"}),Object(x.jsxs)("select",{className:"custom-select",onChange:function(e){var t=e.target;u(Object(r.a)(Object(r.a)({},j),{},{gender:t.value}))},defaultValue:j.gender,children:[Object(x.jsx)("option",{value:"male",children:"Hombre"}),Object(x.jsx)("option",{value:"female",children:"Mujer"})]})]})]}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("div",{className:"btn-group",children:[e.handleCancel&&Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:e.handleCancel,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return De.handleVerificationData(j,e).result}(!0),a=Object(r.a)(Object(r.a)({},j),{},{phones:{cell:j.phone},type:0,business:0});if(!t)return!1;b.saveContact(a).then((function(t){null!==t&&void 0!==t&&t.id?window.Swal.fire({icon:"success",title:"Usuario guardado correctamente",showConfirmButton:!1,showCancelButton:!1,timer:3e3}).then((function(a){a.dissmiss||e.handleResult(t)})):window.Swal.fire({icon:"errror",title:"Error al guardar el usuario",showConfirmButton:!1,showCancelButton:!1,timer:3e3})}))},children:[Object(x.jsx)("i",{className:"fas fa-save"}),"Guardar"]})]})})]})})})}function Nt(e){var t,a,c,n,s;return Object(x.jsx)("div",{className:"position-absolute overflow-auto",style:{left:null!==(t=e.left)&&void 0!==t?t:"0rem",height:e.showNew?"0rem":"12rem",zIndex:"10",width:"100%",maxWidth:null!==(a=e.maxWidth)&&void 0!==a?a:"30rem"},children:Object(x.jsx)("ul",{className:"list-group",children:e.contacts.length?Object(x.jsxs)(x.Fragment,{children:[e.contacts.map((function(t){return 2===t.id?Object(x.jsxs)("li",{className:"list-group-item text-capitalize",children:[Object(x.jsx)("i",{className:"fas fa-user mr-1 text-secondary"}),t.name.toLowerCase()]},t.id):Object(x.jsx)("li",{className:"list-group-item text-capitalize",children:Object(x.jsxs)("a",{href:"#selecte",className:"text-indigo",onClick:function(a){a.preventDefault(),e.handleSelected(t)},children:[Object(x.jsx)("i",{className:"fas fa-user mr-1"}),t.name.toLowerCase()]})},t.id)})),(null===(c=e.meta)||void 0===c?void 0:c.total)>(null===(n=e.meta)||void 0===n?void 0:n.per_page)?Object(x.jsxs)("li",{className:"list-group-item text-muted",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Existen mas registros, sea mas espesifico"]}):null]}):0===(null===(s=e.meta)||void 0===s?void 0:s.total)&&e.handleNew?Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("a",{href:"\xb7create",onClick:function(t){t.preventDefault(),e.handleNew()},children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1 text-dark"}),Object(x.jsxs)("label",{children:["El ",e.title,":"]}),Object(x.jsx)("span",{className:"text-uppercase text-dark font-weight-bold ml-1",children:e.text}),", no existe.",Object(x.jsx)("span",{className:"badge badge-dark ml-2",children:"Registrar"})]})}):null})})}function yt(e){var t=Object(d.useState)({search:"",contacts:[],meta:{},new:!1,newName:"",loading:!1,timer:""}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=Y(),l=Object(d.useRef)(),o=function(){n(Object(r.a)(Object(r.a)({},c),{},{timer:"",loading:!0})),s.getContacts({search:c.search,itemsPage:10}).then((function(e){if(e.data)n(Object(r.a)(Object(r.a)({},c),{},{contacts:e.data,meta:e.meta,loading:!1}));else{var t=Object.values(e.errors);console.error("[Orus System] Message of server:",e.errors),window.Swal.fire({title:"Contactos",text:t[0],icon:"error",showConfirmButton:!1,timer:3e3}),n(Object(r.a)(Object(r.a)({},c),{},{contacts:[],meta:{},loading:!1}))}}))};return Object(d.useEffect)((function(){var e=null;c.search.length>=3?(c.timer&&clearTimeout(c.timer),e=setTimeout((function(){return o()}),2e3),n(Object(r.a)(Object(r.a)({},c),{},{timer:e,contacts:[],meta:{}}))):c.search.length||(c.timer&&clearTimeout(c.timer),n(Object(r.a)(Object(r.a)({},c),{},{timer:null,contacts:[],meta:{},loading:!1})))}),[c.search]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{type:"text",className:"form-control text-uppercase",defaultValue:c.search,onChange:function(e){var t,a=e.target;n(Object(r.a)(Object(r.a)({},c),{},{search:null===(t=a.value)||void 0===t?void 0:t.toLowerCase()}))},disabled:c.loading,onKeyDown:function(e){var t=e.key;"Escape"===t?(n(Object(r.a)(Object(r.a)({},c),{},{contacts:[],search:""})),l.current.value=""):"Enter"===t&&(c.timer&&clearTimeout(c.timer),o(),n(Object(r.a)(Object(r.a)({},c),{},{timer:null})))},ref:l}),c.loading&&Object(x.jsx)("div",{className:"float-right px-4",children:Object(x.jsx)("div",{className:"spinner-border text-indigo"})}),c.new&&Object(x.jsx)(gt,{title:e.title,nameDefault:c.newName,handleCancel:function(e){n(Object(r.a)(Object(r.a)({},c),{},{new:!1,newName:""}))},handleResult:function(t){n(Object(r.a)(Object(r.a)({},c),{},{new:!1,newName:""})),e.handleSelectContact(t)}}),c.search.length>2&&!c.loading&&Object(x.jsx)("div",{className:"w-100 d-block position-static",children:Object(x.jsx)(Nt,{contacts:c.contacts,text:c.search,meta:c.meta,title:e.title,left:"6rem",maxWidth:"28rem",handleNew:function(e){n(Object(r.a)(Object(r.a)({},c),{},{contacts:[],search:"",new:!0,newName:c.search})),l.current.value=""},handleSelected:function(t){e.handleSelectContact(t),n(Object(r.a)(Object(r.a)({},c),{},{contacts:[],search:""})),l.current.value=""}})})]})}function wt(e){var t=e.data,a=void 0===t?{}:t,c=e.readOnly,n=void 0!==c&&c,s=e.title,r=void 0===s?"contacto":s,i=e.legend,l=Object(u.f)();return Object(x.jsxs)("div",{className:"w-100 d-block",children:[i&&!a.id&&Object(x.jsxs)("span",{className:"text-sm text-muted ml-4 w-100 d-block",children:[Object(x.jsx)("label",{children:"Primero:"})," ",i]}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsxs)("span",{className:"input-group-text text-capitalize",children:[Object(x.jsx)("i",{className:"fas fa-user mr-2"})," ",r]})}),a.id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("span",{className:"form-control bg-light",children:[a.name.toUpperCase(),Object(x.jsxs)("span",{className:"badge badge-secondary mx-1",children:[Object(x.jsx)("i",{className:"fas fa-envelope mr-1"}),a.email?a.email:"--"]}),Object(x.jsxs)("span",{className:"badge badge-secondary ml-1",children:[Object(x.jsx)("i",{className:"fas fa-calendar mr-1"}),e.age?"".concat(e.age," a\xf1os"):"--"]})]}),!n&&Object(x.jsx)("div",{className:"float-right",children:Object(x.jsxs)("div",{className:"btn-group btn-sm d-print-none",children:[Object(x.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(){window.Swal.fire({title:"Contactos",text:"\xbfEsta seguro de cambiar de ".concat(e.title,"?"),icon:"question",showCancelButton:!0,confirmButtonText:"Cambiar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(t){t.dismiss||e.handleContactSelect({id:0})}))},title:"Cambiar",children:Object(x.jsx)("i",{className:"fas fa-exchange-alt"})}),Object(x.jsx)("button",{className:"btn bg-indigo btn-sm",onClick:function(){return l.push("/contactos/".concat(a.id))},title:"Editar",children:Object(x.jsx)("i",{className:"fas fa-edit"})})]})})]}):Object(x.jsx)(yt,{title:r,handleSelectContact:function(t){e.handleContactSelect(t)}})]})]})}function Ct(e){var t=e.state,a=e.handle;return Object(x.jsxs)("div",{className:"nav flex-column nav-tabs",children:[Object(x.jsxs)("a",{className:t.panel?"nav-link":"nav-link text-bold active",href:"#general",onClick:function(e){e.preventDefault(),a(0)},children:[Object(x.jsx)("i",{className:t.generales?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Generales"]}),Object(x.jsxs)("a",{className:1===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(1)},children:[Object(x.jsx)("i",{className:t.interrogatorios?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Interrogatorio"]}),Object(x.jsxs)("a",{className:2===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(2)},children:[Object(x.jsx)("i",{className:t.keraRet?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Keratometria"]}),Object(x.jsxs)("a",{className:3===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(3)},children:[Object(x.jsx)("i",{className:t.diabetes?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Diabetes"]}),Object(x.jsxs)("a",{className:4===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(4)},children:[Object(x.jsx)("i",{className:t.agudeza?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Agudeza"]}),Object(x.jsxs)("a",{className:5===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(5)},children:[Object(x.jsx)("i",{className:t.diagnostico?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Diagnostico"]}),Object(x.jsxs)("a",{className:6===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(6)},children:[Object(x.jsx)("i",{className:t.graduacion?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Graduaci\xf3n"]}),Object(x.jsxs)("a",{className:7===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(7)},children:[Object(x.jsx)("i",{className:t.observaciones?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Observaciones"]}),Object(x.jsxs)("a",{className:8===t.panel?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),a(8)},children:[Object(x.jsx)("i",{className:t.recomendaciones?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Recomendaciones"]})]})}function _t(e){var t,a,c,n,s,l,o,j,b,m,h,O,p,f,v,N,y,w,C,_,S,k,E,B,I,D,L,P,T,z,V,A,M,U,R,q,Y,G,$,H,Z,J,K,W,X,Q,ee,te,ae,ce,ne,se,re,ie,le,oe,de,je,ue,be,me,he,Oe,xe,pe,fe,ve,ge,Ne,ye,we,Ce,_e,Se,ke,Ee,Be,Ie,De=Object(d.useState)(Object(r.a)(Object(r.a)({},St()),{},{loading:!1,panel:0,used:{generales:!1,interrogatorios:!1,keraRet:!1,diabetes:!1,agudeza:!1,diagnostico:!1,graduacion:!1,observaciones:!1,recomendaciones:!1},activitys:[]})),Le=Object(i.a)(De,2),Pe=Le[0],Fe=Le[1],Te=e.match.params.id,ze=ct(),Ve=Object(u.f)();return Object(d.useEffect)((function(){Te&&(console.log("[Orus System] Loading exam:",Te),Fe(Object(r.a)(Object(r.a)({},Pe),{},{loading:!1})),ze.getExam(Te).then((function(e){var t,a,c;e.category_ii=null===(t=e.category_ii)||void 0===t?void 0:t.id,e.category_id=null===(a=e.category_id)||void 0===a?void 0:a.id,Fe(Object(r.a)(Object(r.a)({},St(e)),{},{loading:!1,panel:0,used:{generales:!0,interrogatorios:!0,keraRet:!0,diabetes:!0,agudeza:!0,diagnostico:!0,graduacion:!0,observaciones:!0,recomendaciones:!0},activitys:null!==(c=e.activity)&&void 0!==c?c:[]}))})))}),[Te]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"card card-info card-outline d-print-none",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title text-info",children:[Object(x.jsx)("i",{className:"fas fa-notes-medical mr-1"}),Pe.id?Object(x.jsxs)("label",{children:["Examen ",Object(x.jsxs)("span",{className:"badge badge-info",children:["#",Pe.id]})]}):"Nuevo examen"]})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)(wt,{readOnly:!!Pe.id,title:"paciente",legend:"Busque el paciente por nombre para crear un nuevo examen",left:"6.5rem",data:Pe.contact,age:Pe.age,handleContactSelect:function(e){Fe(Object(r.a)(Object(r.a)({},Pe),{},{contact:e,contact_id:e.id,age:e.age}))}})}),null!==(t=Pe.contact)&&void 0!==t&&t.id?Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-2",children:Object(x.jsx)(Ct,{state:Object(r.a)({panel:Pe.panel},Pe.used),handle:function(e){isNaN(e)||("string"===typeof e&&(e=parseInt(e)),Fe(Object(r.a)(Object(r.a)({},Pe),{},{panel:e})))}})}),Object(x.jsxs)("div",{className:"col-10",children:[Pe.panel?null:Object(x.jsx)(st,{pc:null!==(a=Pe.pc)&&void 0!==a?a:"",tablet:null!==(c=Pe.tablet)&&void 0!==c?c:"",movil:null!==(n=Pe.movil)&&void 0!==n?n:"",lap:null!==(s=Pe.lap)&&void 0!==s?s:"",lap_time:null!==(l=Pe.lap_time)&&void 0!==l?l:"",pc_time:null!==(o=Pe.pc_time)&&void 0!==o?o:"",tablet_time:null!==(j=Pe.tablet_time)&&void 0!==j?j:"",movil_time:null!==(b=Pe.movil_time)&&void 0!==b?b:"",cefalea:null!==(m=Pe.cefalea)&&void 0!==m?m:"",c_frecuencia:null!==(h=Pe.c_frecuencia)&&void 0!==h?h:"",c_intensidad:null!==(O=Pe.c_intensidad)&&void 0!==O?O:"",frontal:null!==(p=Pe.frontal)&&void 0!==p?p:"",temporal:null!==(f=Pe.temporal)&&void 0!==f?f:"",occipital:null!==(v=Pe.occipital)&&void 0!==v?v:"",generality:null!==(N=Pe.generality)&&void 0!==N?N:"",temporaoi:null!==(y=Pe.temporaoi)&&void 0!==y?y:"",temporaod:null!==(w=Pe.temporaod)&&void 0!==w?w:"",handleGetData:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{generales:!0})),a)))}}),1===Pe.panel?Object(x.jsx)(dt,{interrogatorio:null!==(C=Pe.interrogatorio)&&void 0!==C?C:"",coa:null!==(_=Pe.coa)&&void 0!==_?_:"",aopp:null!==(S=Pe.aopp)&&void 0!==S?S:"",aopf:null!==(k=Pe.aopf)&&void 0!==k?k:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{interrogatorios:!0})),a)))}}):null,2===Pe.panel?Object(x.jsx)(jt,{keratometriaoi:null!==(E=Pe.keratometriaoi)&&void 0!==E?E:"",keratometriaod:null!==(B=Pe.keratometriaod)&&void 0!==B?B:"",rsoi:null!==(I=Pe.rsoi)&&void 0!==I?I:"",rsod:null!==(D=Pe.rsod)&&void 0!==D?D:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{keraRet:!0})),a)))}}):null,3===Pe.panel?Object(x.jsx)(ut,{d_time:null!==(L=Pe.d_time)&&void 0!==L?L:"",d_media:null!==(P=Pe.d_media)&&void 0!==P?P:"",d_test:null!==(T=Pe.d_test)&&void 0!==T?T:"",d_fclod:null!==(z=Pe.d_fclod)&&void 0!==z?z:"",d_fclod_time:null!==(V=Pe.d_fclod_time)&&void 0!==V?V:"",d_fcloi:null!==(A=Pe.d_fcloi)&&void 0!==A?A:"",d_fcloi_time:null!==(M=Pe.d_fcloi_time)&&void 0!==M?M:"",oftalmoscopia:null!==(U=Pe.oftalmoscopia)&&void 0!==U?U:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{diabetes:!0})),a)))}}):null,4===Pe.panel?Object(x.jsx)(bt,{cvod:null!==(R=Pe.cvod)&&void 0!==R?R:"",cvoi:null!==(q=Pe.cvoi)&&void 0!==q?q:"",avslod:null!==(Y=Pe.avslod)&&void 0!==Y?Y:"",avsloi:null!==(G=Pe.avsloi)&&void 0!==G?G:"",avcgaod:null!==($=Pe.avcgaod)&&void 0!==$?$:"",avcgaoi:null!==(H=Pe.avcgaoi)&&void 0!==H?H:"",avfod:null!==(Z=Pe.avfod)&&void 0!==Z?Z:"",avfoi:null!==(J=Pe.avfoi)&&void 0!==J?J:"",avf2o:null!==(K=Pe.avf2o)&&void 0!==K?K:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{agudeza:!0})),a)))}}):null,5===Pe.panel?Object(x.jsx)(mt,{diagnostico:null!==(W=Pe.diagnostico)&&void 0!==W?W:"",presbicie:null!==(X=Pe.presbicie)&&void 0!==X?X:"",piod:null!==(Q=Pe.piod)&&void 0!==Q?Q:"",pioi:null!==(ee=Pe.pioi)&&void 0!==ee?ee:"",txoftalmico:null!==(te=Pe.txoftalmico)&&void 0!==te?te:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{diagnostico:!0})),a)))}}):null,6===Pe.panel?Object(x.jsx)(ht,{esferaod:null!==(ae=Pe.esferaod)&&void 0!==ae?ae:0,esferaoi:null!==(ce=Pe.esferaoi)&&void 0!==ce?ce:0,cilindrod:null!==(ne=Pe.cilindrod)&&void 0!==ne?ne:0,cilindroi:null!==(se=Pe.cilindroi)&&void 0!==se?se:0,ejeod:null!==(re=Pe.ejeod)&&void 0!==re?re:0,ejeoi:null!==(ie=Pe.ejeoi)&&void 0!==ie?ie:0,adiciond:null!==(le=Pe.adiciond)&&void 0!==le?le:0,adicioni:null!==(oe=Pe.adicioni)&&void 0!==oe?oe:0,adicion_media_od:null!==(de=Pe.adicion_media_od)&&void 0!==de?de:0,adicion_media_oi:null!==(je=Pe.adicion_media_oi)&&void 0!==je?je:0,dpod:null!==(ue=Pe.dpod)&&void 0!==ue?ue:0,dpoi:null!==(be=Pe.dpoi)&&void 0!==be?be:0,alturaod:null!==(me=Pe.alturaod)&&void 0!==me?me:0,alturaoi:null!==(he=Pe.alturaoi)&&void 0!==he?he:0,lcmarca:null!==(Oe=Pe.lcmarca)&&void 0!==Oe?Oe:0,lcgod:null!==(xe=Pe.lcgod)&&void 0!==xe?xe:0,lcgoi:null!==(pe=Pe.lcgoi)&&void 0!==pe?pe:0,onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{graduacion:!0})),a)))}}):null,7===Pe.panel?Object(x.jsx)(Ot,{observaciones:null!==(fe=Pe.observaciones)&&void 0!==fe?fe:"",onChangeInput:function(e,t){var a;e&&Fe(Object(r.a)(Object(r.a)({},Pe),{},(a={},Object(g.a)(a,e,t),Object(g.a)(a,"used",Object(r.a)(Object(r.a)({},Pe.used),{},{observaciones:!0})),a)))}}):null,8===Pe.panel?Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(vt,{category_id:null!==(ve=Pe.category_id)&&void 0!==ve?ve:null,esferaod:null!==(ge=Pe.esferaod)&&void 0!==ge?ge:"",esferaoi:null!==(Ne=Pe.esferaoi)&&void 0!==Ne?Ne:"",cilindrod:null!==(ye=Pe.cilindrod)&&void 0!==ye?ye:"",cilindroi:null!==(we=Pe.cilindroi)&&void 0!==we?we:"",nameItem:"item1",title:"Recomendacion principal",onChangeInput:function(e){Fe(Object(r.a)(Object(r.a)({},Pe),{},{category_id:e,category_ii:0,used:Object(r.a)(Object(r.a)({},Pe.used),{},{recomendaciones:!0})}))},update:!0})}),Pe.category_id?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(vt,{category_id:null!==(Ce=Pe.category_ii)&&void 0!==Ce?Ce:null,esferaod:null!==(_e=Pe.esferaod)&&void 0!==_e?_e:"",esferaoi:null!==(Se=Pe.esferaoi)&&void 0!==Se?Se:"",cilindrod:null!==(ke=Pe.cilindrod)&&void 0!==ke?ke:"",cilindroi:null!==(Ee=Pe.cilindroi)&&void 0!==Ee?Ee:"",nameItem:"item2",title:"Recomendacion adicional",onChangeInput:function(e){Fe(Object(r.a)(Object(r.a)({},Pe),{},{category_ii:e,used:Object(r.a)(Object(r.a)({},Pe.used),{},{recomendaciones:!0})}))},update:!0})}):null]}):null]})]}):null]}),Object(x.jsx)("div",{className:"card-footer text-right",children:Object(x.jsxs)("div",{className:"btn-group",role:"group",children:[Object(x.jsxs)("a",{href:"#close",className:"btn btn-default",onClick:function(t){t.preventDefault(),Ve.push("/consultorio"),e.handleNewOrEdit()},children:[Object(x.jsx)("i",{className:Pe.id?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),Object(x.jsx)("strong",{children:Pe.id?"Cancelar":"Cerrar"})]}),Pe.id?Object(x.jsxs)("button",{className:"btn btn-default",onClick:function(e){e.preventDefault()},children:[Object(x.jsx)("i",{className:"fas fa-print mr-2"}),"Imprimir"]}):null,Object(x.jsxs)("button",{type:"button",className:null!==(Be=Pe.contact)&&void 0!==Be&&Be.id?"btn btn-info":"btn btn-info disabled",onClick:function(){var t=Object(r.a)({},Pe),a=t.contact;if(delete t.loading,delete t.panel,delete t.used,delete t.contact,delete t.activitys,t.category_ii||delete t.category_ii,t.category_id||delete t.category_id,t.cilindrod<0&&!t.ejeod||t.cilindroi<0&&!t.ejeoi)return window.Swal.fire("Consultorio","El campo CILINDRO esta vacio","warning"),!1;window.Swal.fire({title:"Consultorio",text:t.id?"\xbfDesea actualizar el examen de ".concat(a.name.toUpperCase(),"?"):"\xbfDesea crear un nuevo examen para ".concat(a.name.toUpperCase(),"?"),icon:"question",showCancelButton:!0,confirmButtonText:t.id?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(a){a.dismiss||ze.saveExam(t).then((function(t){if(null!==t&&void 0!==t&&t.id)console.log("[Orus System] Save exam successfully",t.id),e.handleNewOrEdit(),Ve.push("/consultorio");else if(t.hasOwnProperty("errors")){var a=Object.values(t.errors);console.error("[Orus System] Message of server:",t.errors),window.Swal.fire({title:"Consultorio",text:a[0],icon:"error",showConfirmButton:!1,timer:3e3})}}))}))},disabled:null===(Ie=Pe.contact)||void 0===Ie||!Ie.id,children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),Object(x.jsx)("strong",{children:Pe.id?"Actualizar":"Guardar"})]})]})})]}),Pe.activitys.length?Object(x.jsx)(F,{data:Pe.activitys}):null]})}function St(){var e,t,a,c,n,s,r,i,l,o,d,j,u,b,m,h,O,x,p,f,v,g,N,y,w,C,_,S,k,E,B,I,D,L,P,F,T,z,V,A,M,U,R,q,Y,G,$,H,Z,J,K,W,X,Q,ee,te,ae,ce,ne,se,re,ie,le,oe,de,je,ue,be,me,he,Oe,xe,pe,fe,ve,ge=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Ne=0;return null!==ge&&void 0!==ge&&null!==(e=ge.customer)&&void 0!==e&&e.age&&(Ne=ge.customer.age),{id:null!==(t=ge.id)&&void 0!==t?t:0,age:ge.age?ge.age:Ne,keratometriaoi:null!==(a=ge.keratometriaoi)&&void 0!==a?a:"",keratometriaod:null!==(c=ge.keratometriaod)&&void 0!==c?c:"",pantalleooi:null!==(n=ge.pantalleooi)&&void 0!==n?n:"",pantalleood:null!==(s=ge.pantalleood)&&void 0!==s?s:"",interrogatorio:null!==(r=ge.interrogatorio)&&void 0!==r?r:"",cefalea:null!==(i=ge.cefalea)&&void 0!==i?i:0,c_frecuencia:null!==(l=ge.c_frecuencia)&&void 0!==l?l:"",c_intensidad:null!==(o=ge.c_intensidad)&&void 0!==o?o:0,frontal:null!==(d=ge.frontal)&&void 0!==d?d:0,temporal:null!==(j=ge.temporal)&&void 0!==j?j:0,occipital:null!==(u=ge.occipital)&&void 0!==u?u:0,generality:null!==(b=ge.generality)&&void 0!==b?b:0,temporaoi:null!==(m=ge.temporaoi)&&void 0!==m?m:0,temporaod:null!==(h=ge.temporaod)&&void 0!==h?h:0,coa:null!==(O=ge.coa)&&void 0!==O?O:"",aopp:null!==(x=ge.aopp)&&void 0!==x?x:"",aopf:null!==(p=ge.aopf)&&void 0!==p?p:"",avsloi:null!==(f=ge.avsloi)&&void 0!==f?f:"",avslod:null!==(v=ge.avslod)&&void 0!==v?v:"",avcgaoi:null!==(g=ge.avcgaoi)&&void 0!==g?g:"",avcgaod:null!==(N=ge.avcgaod)&&void 0!==N?N:"",cvoi:null!==(y=ge.cvoi)&&void 0!==y?y:"",cvod:null!==(w=ge.cvod)&&void 0!==w?w:"",oftalmoscopia:null!==(C=ge.oftalmoscopia)&&void 0!==C?C:"",rsoi:null!==(_=ge.rsoi)&&void 0!==_?_:"",rsod:null!==(S=ge.rsod)&&void 0!==S?S:"",diagnostico:null!==(k=ge.diagnostico)&&void 0!==k?k:"",presbicie:null!==(E=ge.presbicie)&&void 0!==E?E:0,txoftalmico:null!==(B=ge.txoftalmico)&&void 0!==B?B:"",esferaoi:null!==(I=ge.esferaoi)&&void 0!==I?I:0,esferaod:null!==(D=ge.esferaod)&&void 0!==D?D:0,cilindroi:null!==(L=ge.cilindroi)&&void 0!==L?L:0,cilindrod:null!==(P=ge.cilindrod)&&void 0!==P?P:0,ejeoi:null!==(F=ge.ejeoi)&&void 0!==F?F:0,ejeod:null!==(T=ge.ejeod)&&void 0!==T?T:0,adicioni:null!==(z=ge.adicioni)&&void 0!==z?z:0,adiciond:null!==(V=ge.adiciond)&&void 0!==V?V:0,adicion_media_oi:null!==(A=ge.adicion_media_oi)&&void 0!==A?A:0,adicion_media_od:null!==(M=ge.adicion_media_od)&&void 0!==M?M:0,dpoi:null!==(U=ge.dpoi)&&void 0!==U?U:0,dpod:null!==(R=ge.dpod)&&void 0!==R?R:0,avfod:null!==(q=ge.avfod)&&void 0!==q?q:"",avfoi:null!==(Y=ge.avfoi)&&void 0!==Y?Y:"",avf2o:null!==(G=ge.avf2o)&&void 0!==G?G:"",lcmarca:null!==($=ge.lcmarca)&&void 0!==$?$:"",lcgoi:null!==(H=ge.lcgoi)&&void 0!==H?H:"",lcgod:null!==(Z=ge.lcgod)&&void 0!==Z?Z:"",txoptico:null!==(J=ge.txoptico)&&void 0!==J?J:"",alturaod:null!==(K=ge.alturaod)&&void 0!==K?K:0,alturaoi:null!==(W=ge.alturaoi)&&void 0!==W?W:0,pioi:null!==(X=ge.pioi)&&void 0!==X?X:0,piod:null!==(Q=ge.piod)&&void 0!==Q?Q:0,observaciones:null!==(ee=ge.observaciones)&&void 0!==ee?ee:"",pc:null!==(te=ge.pc)&&void 0!==te?te:0,tablet:null!==(ae=ge.tablet)&&void 0!==ae?ae:0,movil:null!==(ce=ge.movil)&&void 0!==ce?ce:0,lap:null!==(ne=ge.lap)&&void 0!==ne?ne:0,lap_time:null!==(se=ge.lap_time)&&void 0!==se?se:"00:00",pc_time:null!==(re=ge.pc_time)&&void 0!==re?re:"00:00",tablet_time:null!==(ie=ge.tablet_time)&&void 0!==ie?ie:"00:00",movil_time:null!==(le=ge.movil_time)&&void 0!==le?le:"00:00",d_time:null!==(oe=ge.d_time)&&void 0!==oe?oe:"",d_media:null!==(de=ge.d_media)&&void 0!==de?de:"",d_test:null!==(je=ge.d_test)&&void 0!==je?je:"",d_fclod:null!==(ue=ge.d_fclod)&&void 0!==ue?ue:0,d_fcloi:null!==(be=ge.d_fcloi)&&void 0!==be?be:0,d_fclod_time:null!==(me=ge.d_fclod_time)&&void 0!==me?me:"00:00",d_fcloi_time:null!==(he=ge.d_fcloi_time)&&void 0!==he?he:"00:00",contact:null!==(Oe=ge.customer)&&void 0!==Oe?Oe:{},status:null!==(xe=ge.status)&&void 0!==xe?xe:1,contact_id:null===(pe=ge.customer)||void 0===pe?void 0:pe.id,category_id:null!==(fe=ge.category_id)&&void 0!==fe?fe:0,category_ii:null!==(ve=ge.category_ii)&&void 0!==ve?ve:0}}Object(ke.registerLocale)("es",Le.a);var kt={page:1,orderby:"created_at",order:"desc",search:"",status:"",itemsPage:25,date:"",branch:"all"};function Et(e){var t=Object(d.useState)({options:kt,newOrEdit:null}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.match.params.id;return Object(d.useEffect)((function(){n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!!s}))}),[s]),Object(x.jsx)(et.Provider,{value:Object(r.a)(Object(r.a)({},c),{},{set:n}),children:Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsx)(at,{newOrEdit:c.newOrEdit,handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!(null!==c&&void 0!==c&&c.newOrEdit)}))}}),"boolean"===typeof c.newOrEdit?Object(x.jsx)("div",{className:"col-sm-12 col-md-10",children:c.newOrEdit?Object(x.jsx)(_t,Object(r.a)(Object(r.a)({},e),{},{handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!c.newOrEdit}))}})):Object(x.jsx)(nt,{})}):Object(x.jsx)("p",{children:"Loading component"})]})})}var Bt=Object(d.createContext)(null),It=function(){return Object(d.useContext)(Bt)};var Dt=function(e){var t=e.items,a=e.cantDefault,c=void 0===a?1:a,n=e.handleClose,s=e.handleSelect,l=Object(d.useState)({item:null,cant:c,price:0}),o=Object(i.a)(l,2),j=o[0],u=o[1],b=!!(j.price<=0||isNaN(j.price)),m=function(){n&&n()},h=function(e){var t=e.name,a=e.value;u(Object(r.a)(Object(r.a)({},j),{},Object(g.a)({},t,parseInt(a))))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Seleccione un producto"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:m,children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:Object(x.jsx)("div",{className:"table-responsive overflow-auto",style:{height:"12rem"},children:j.item&&j.item.id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"text-uppercase mb-4",children:j.item.producto}),Object(x.jsxs)("div",{className:"form-group row",children:[Object(x.jsx)("label",{className:"col-2 col-form-label",children:"Cantidad"}),c<2?Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("input",{type:"number",placeholder:"Cantidad",name:"cant",className:"form-control",defaultValue:j.cant,onChange:function(e){var t=e.target;return h(t)}})}):Object(x.jsx)("span",{className:"col text-lg",children:j.cant}),Object(x.jsx)("label",{className:"col-2 col-form-label",children:"Precio"}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("input",{type:"number",placeholder:"Precio",name:"price",className:"form-control",defaultValue:j.price.toString(),onChange:function(e){var t=e.target;return h(t)}})})]})]}):Object(x.jsx)("table",{className:"table table-sm",children:Object(x.jsx)("tbody",{children:t?Object(x.jsx)(x.Fragment,{children:t.length?Object(x.jsx)(x.Fragment,{children:t.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-right",children:Object(x.jsx)("span",{className:"badge badge-dark",children:e.code})}),Object(x.jsx)("td",{className:"text-capitalize text-left",children:Object(x.jsx)("a",{href:"#select",onClick:function(t){return function(e,t){e.preventDefault(),u(Object(r.a)(Object(r.a)({},j),{},{price:t.price,item:t}))}(t,e)},children:e.name})}),Object(x.jsxs)("td",{children:["$",e.price]})]},e.id)}))}):Object(x.jsx)("tr",{children:Object(x.jsx)("td",{children:"No existen productos para esta coincidencia"})})}):Object(x.jsx)("tr",{children:Object(x.jsxs)("td",{children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"})," No se recibieron los productos"]})})})})})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:m,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){var e=Object(r.a)(Object(r.a)({},j),{},{item:Object(r.a)(Object(r.a)({},j.item),{},{price:j.price})});s(e),u({item:null,cant:1,price:0}),m()},disabled:b,children:[Object(x.jsx)("i",{className:"fas fa-check mr-1"}),"Seleccionar"]})]})]})})})},Lt={confirm:function(e,t){window.Swal.fire({title:"Ventas",text:e,icon:"warning",showCancelButton:!0,confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"}).then((function(e){e.dismiss||t&&t()}))},getMethodName:function(e){switch(e){case 1:return"efectivo";case 2:return"tarjeta debito";case 3:return"tarjeta Credito";case 4:return"la marina";case 5:return"cheque";case 6:return"transferencia";default:return"otro"}},getSession:function(){return Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10)},getForPay:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!Array.isArray(e)||!e.length)return 0;Array.isArray(t)||(t=[]);var c=t.reduce((function(e,t){return e+t.total}),0),n=e.reduce((function(e,t){return e+t.subtotal}),0);return n-c-a},getSubTotal:function(e){return e&&e.length?e.reduce((function(e,t){return e+t.subtotal}),0):0},getTotal:function(e,t){return e-t},getPagado:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e&&e.length?e.reduce((function(e,t){return e+t.total}),0):0}},Pt=Lt;var Ft=function(){var e=Object(d.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],n=Object(d.useState)(!1),s=Object(i.a)(n,2),l=s[0],o=s[1],j=Object(d.useState)(1),u=Object(i.a)(j,2),b=u[0],m=u[1],h=Object(d.useState)([]),O=Object(i.a)(h,2),p=O[0],f=O[1],v=It(),g=v.session,N=te(),y=function(){if(a.length>2){var e=a.split("*"),t=a;2===e.length&&(t=e[1],m(parseInt(e[0]))),N.getProducts(t).then((function(e){e?f(e.data):console.error("Error al buscar el producto")})),c("")}},w=function(e){return{id:0,cant:e.cant,price:parseFloat(e.item.price),subtotal:parseInt(e.cant)*parseFloat(e.item.price),inStorage:parseInt(e.item.cantidades)>=parseInt(e.cant),out:parseInt(e.item.cantidades)-parseInt(e.cant),cantInStore:parseInt(e.item.cantidades),session:g,store_items_id:e.item.id,descripcion:e.item.descripcion,producto:e.item.name.toLowerCase(),category:e.item.categoria?e.item.categoria.id:0}},C=function(e){var t=v.items.filter((function(t){return t.store_items_id===e.store_items_id})),a=v.items.filter((function(t){return t.store_items_id!==e.store_items_id}));if(t.length){var c=parseInt(e.cant)+parseInt(t[0].cant),n=Object(r.a)(Object(r.a)({},t[0]),{},{cant:c,subtotal:parseFloat(e.price)*c,inStorage:c>=parseInt(e.cantInStore),out:parseInt(e.cantInStore)-c});a.push(n),window.Swal.fire({title:"Producto agregado",text:"Se agrego otro ".concat(t[0].producto," a la lista"),icon:"success",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0})}else a.push(e);var s=Pt.getSubTotal(a);v.set(Object(r.a)(Object(r.a)({},v),{},{items:a,total:Pt.getTotal(s,v.discount),subtotal:s}))};return Object(d.useEffect)((function(){if(p.length)if(1===p.length){var e=w({item:p[0],cant:b||1});e.price<=0?window.Swal.fire({title:"Verificar",text:"El item que intentas agregar tiene un precio de $0, revisa el precio en el almacen",icon:"warning",showCancelButton:!1,confirmButtonText:"Ok",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}):(C(e),m(1))}else o(!0)}),[p]),Object(x.jsxs)("div",{className:"btn-group text-center d-print-none",children:[Object(x.jsx)("input",{className:"form-control",placeholder:"Codigo",onChange:function(e){return function(e){var t=e.value;c(t)}(e.target)},onKeyPress:function(e){return function(e){"Enter"===e&&y()}(e.key)},value:a}),Object(x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:y,disabled:!(a.length>2),children:Object(x.jsx)("i",{className:"fas fa-barcode"})}),l&&p.length?Object(x.jsx)(Dt,{items:p,cantDefault:b,handleClose:function(){o(!1)},handleSelect:function(e){var t=w(e);C(t),m(1)}}):null]})};function Tt(){var e=It(),t=Pt.getPagado(e.payments),a=!(e.subtotal-t>0&&0===e.discount&&0===t);return Object(x.jsx)("button",{className:"btn btn-primary mx-1",title:"Agregar descuento",onClick:function(){var t=window.prompt("Agregue el descuento a aplicar");if(null===t)return null;var a=0;if(e.items.forEach((function(e){return a+=e.subtotal})),t.match(/^[0-9]+$/gm)){var c=parseInt(t);e.set(Object(r.a)(Object(r.a)({},e),{},{discount:c,total:e.subtotal-c}))}else if(t.match(/^[0-9]{2,3}%$/gm)){var n=parseInt(t.replace("%",""))/100,s=parseInt(a*n);e.set(Object(r.a)(Object(r.a)({},e),{},{discount:s,total:e.subtotal-s}))}},disabled:a,children:Object(x.jsx)("i",{className:"fas fa-percent"})})}function zt(e){var t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={orderBy:"created_at",order:"desc",itemsPage:100},t&&(a.search=t),c=O("sales",null,a),e.next=5,h(c);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("sales",t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.id,c=O("sales",a),n=a?"PUT":"POST",e.next=4,h(c,n,t);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),console.error("[Orus System] Error in saga/sales handledSaveSale",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return{getSaleList:t,getSaleById:a,saveSale:c}}var Vt=function(e){var t=e.handleClose,a=e.handleSelect,c=zt(),n=Object(d.useState)(""),s=Object(i.a)(n,2),r=s[0],l=s[1],o=Object(d.useState)([]),j=Object(i.a)(o,2),u=j[0],b=j[1],m=It(),h=0!==u.length?u:0!==m.length?m:[];return Object(d.useEffect)((function(){c.getSaleList(r).then((function(e){e?b(e.data):console.error("Error al obtener las ventas")})).catch((function(e){return console.error(e)}))}),[r]),Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Seleccione una venta"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return t()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsxs)("div",{className:"modal-body p-2",children:[Object(x.jsx)("div",{className:"w-full d-block mb-4",children:Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Buscar por folio o nombre",onChange:function(e){return function(e){var t=e.value;l(t)}(e.target)}}),Object(x.jsx)("button",{type:"button",className:"btn btn-default ml-1",children:Object(x.jsx)("i",{className:"fas fa-search"})})]})}),Object(x.jsx)("div",{className:"table-responsive overflow-auto",style:{height:"12rem"},children:Object(x.jsx)("table",{className:"table table-sm",children:Object(x.jsx)("tbody",{children:h?Object(x.jsx)(x.Fragment,{children:h.length?Object(x.jsx)(x.Fragment,{children:h.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-right",children:Object(x.jsx)("span",{className:"badge badge-dark",children:e.id})}),Object(x.jsx)("td",{className:"text-capitalize text-left",children:Object(x.jsx)("a",{href:"#select",onClick:function(t){return function(e,t){e&&e.preventDefault(),m.items.length?window.Swal.fire({title:"Ventas",text:"Si cargas una venta, se cerrar\xe1 la venta actual",icon:"question",showCancelButton:!0,confirmButtonText:"Cargar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){if(e.dismiss)return null;a(t)})):a(t)}(t,e)},children:e.customer?e.customer.name:"--"})}),Object(x.jsx)("td",{className:"text-right",children:D()(e.created_at).fromNow()})]},e.id)}))}):Object(x.jsx)("tr",{className:"overlay dark",children:Object(x.jsxs)("td",{className:"overlay dark",children:[Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"}),"Cargando las ventas!!"]})})}):Object(x.jsx)("tr",{children:Object(x.jsxs)("td",{children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"})," Escriba el folio o nombre para cargar una venta"]})})})})})]}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return t()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]})})]})})})};function At(){var e=It(),t=Object(d.useState)(!1),a=Object(i.a)(t,2),c=a[0],n=a[1],s=!!e.items.length;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{className:"btn btn-primary mr-1",title:"Cargar una venta",onClick:function(){n(!0)},disabled:s,children:Object(x.jsx)("i",{className:"fas fa-list"})}),c&&Object(x.jsx)(Vt,{handleClose:function(){n(!1)},handleSelect:function(t){var a,c=0;return t.payments.forEach((function(e){return c=e.total})),n(!1),e.set({id:t.id,contact_id:t.customer.id,customer:t.customer,items:t.items,session:t.session,discount:t.discount,subtotal:t.subtotal,total:t.total,payments:t.payments,branch_id:t.branch.id,created_at:t.created_at,activitys:t.activity,order:null!==(a=t.order)&&void 0!==a?a:0,thereNews:!1}),c}})]})}a(161);function Mt(e){var t=f().auth.branch;return Object(d.useEffect)((function(){if(e.data){var a=window.open("","_blank","fullscreen=1,menubar=0,resizable=0,scrollbars=0,titlebar=0,toolbar=0,top=0,left=300");a.document.write(function(e,t){var a=function(e,t){var a,c,n,s,r,i,l=Pt.getPagado(e.payments),o=e.total-l,d=Object.values(null!==(a=null===(c=e.customer)||void 0===c?void 0:c.phones)&&void 0!==a?a:{}).filter((function(e){return e}));return'\n  <div style="width:100%; padding: 0px; margin: 0px;">\n    <h6 style="font-size: 14; font-family:sans-serif; text-align: right; margin: 0px">\n      '.concat(e.order_id?"Pedido":"Nota",":\n      <strong>").concat(e.order_id?e.order_id:e.id,'</strong>\n    </h6> \n    \n    <h2 style="font-size: 28; font-family: sans-serif; margin: 24px 0px;">\n      <center>\n        <strong>\xd3ptica Madero</strong>\n      </center>\n    </h2>\n\n    <h4 style="font-size: 22; font-family: sans-serif; text-align: center; margin:10px 0px;">\n      Julio Cesar Cardenas Martinez\n    </h4>\n\n    <div style="font-size: 14; font-family: sans-serif; width:100%; text-align: center; margin: 0px 5px">\n      <span style="text-transform: uppercase;">\n        ').concat(t.name,"\n      </span>\n      <br />\n      <span>").concat(t.phone,"</span>\n      <br />\n      <span>").concat(t.address,"</span>\n      <br/>\n      <strong>").concat(D()(e.created_at).format("LLLL"),'</strong>\n    </div>\n\n    <h4 style="font-size: 22; font-family: sans-serif; text-align: center; text-transform: uppercase;">\n      ').concat(null!==(n=e.customer)&&void 0!==n&&n.name?e.customer.name:"Venta de mostrador",'\n      <br />\n      <strong>\n        <em style="font-size: 18">\n          ').concat(d.length?d:"--",'\n        </em>\n      </strong>\n    </h4>\n\n    <h2 style= "font-size: 22; font-family:sans-serif">\n      <center><strong>').concat(e.order_id?"Pedido":"Nota",'</strong></center>\n    </h2>\n\n    <table style="width:100%;">\n      <thead>\n        <tr>\n          <th style="font-size: 12; font-family: sans-serif; text-align:left; width:24px">\n            Cant\n          </th>\n          <th style="font-size: 12; font-family: sans-serif">\n            Descripcion\n          </th>\n          <th style="font-size: 12; font-family: sans-serif; text-align:right; width:48px">\n            Total\n          </th>\n        </tr>\n      </thead>\n          \n      <tbody>\n        ').concat(e.items.map((function(e,t){var a;return"<tr key=".concat(t,' style="">\n            <td style="font-size: 16; font-family: sans-serif; text-align:left">\n              ').concat(e.cant,'\n            </td>\n            <td style="font-size: 14; font-family: sans-serif">\n              ').concat(null!==(a=e.name)&&void 0!==a?a:e.producto,'\n            </td>\n            <td style="font-size: 16; font-family: sans-serif; text-align:right;">                    \n              $ ').concat(e.cant*e.price,"\n            </td>\n          </tr>")})),'\n      </tbody>\n\n      <tfoot>\n        <tr>\n          <td colspan="3">\n            ').concat(0!==e.discount?'<div style = "width:100%">\n                  <h4 style= "font-size: 18; font-family: sans-serif; text-align: right; margin:0px; margin-top:12px">\n                    Subtotal: <label>$ '.concat(null!==(s=e.subtotal)&&void 0!==s?s:0,'</label>\n                  </h4>\n                  <h4 style= "font-size: 18; font-family: sans-serif; text-align: right; margin:0px;">\n                    Descuento: <label>$ ').concat(e.discount,'</label>\n                  </h4>\n                </div>\n                <h4 style= "font-size:18; width:100%; font-family: sans-serif; text-align: right; margin:0px;">\n                  Total: <label>$ ').concat(null!==(r=e.total)&&void 0!==r?r:0,"</label>\n                </h4>"):'<h4 style= "font-size:18; width:100%; font-family: sans-serif; text-align: right; margin:0px; margin-top:12px">\n                  Total: <label>$ '.concat(null!==(i=e.total)&&void 0!==i?i:0,"</label>\n                </h4>"),'\n                      \n            <div style = "width:100%;">\n              <h4 style= "font-size: 18; font-family: sans-serif; text-align: right; margin:0px;">\n                Abonado: <label>$ ').concat(l,"</label>\n              </h4>\n              ").concat(o?'<h4 style= "font-size: 18; font-family: sans-serif; text-align: right; margin:0px;">\n                    Saldo: <label>$ '.concat(o,"</label>\n                    </h4>"):'<div style="text-align:center; width: 100%">\n                     <h3 style="font-weight:bold">\n                      ::: Cuenta Pagada :::                      \n                    </h3>\n                  </div>','\n            </div>\n          </td>\n        </tr>\n      </tfoot>\n    </table>\n      \n    <div>\n      <ul style="font-family:sans-serif; font-size: 12;">\n        <li>\n          Armazones usados, viejos y/o resecos son responsabilidad del\n          cliente\n        </li>\n        <li>\n          Armazones reparados por el cliente pierden garantia de proovedor\n        </li>\n      </ul>\n    </div>\n  </div>\n  ')}(null!==e&&void 0!==e?e:{},t),c='<div style="width:280px; padding: 0px; margin: 0px; border:1px dotted #DDD">'.concat(a,"</div>");return"<html>\n        <head>\n            <title>".concat(e.order_id?"Pedido #"+e.order_id:"Venta #"+e.id,'</title>            \n        </head>\n        <body style="display:flex; justify-content: center; align-items:start">\n            ').concat(c,"\n        </body>\n    </html>")}(e.data,t)),a.window.print(),a.onbeforeunload=function(){e.setPrint()}}else console.error("[Orus System] Data is parameter required")}),[]),Object(x.jsxs)("div",{className:"load",style:{position:"fixed",zIndex:"5",width:"100%",top:0,left:0,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,.5)"},children:[Object(x.jsx)("h1",{style:{color:"white",marginBottom:"5%"},children:"IMPRESION EN CURSO"}),Object(x.jsx)("i",{className:"fas fa-print fa-6x"})]})}D.a.locale("es");var Ut=function(e){var t=e.forPaid,a=e.handleClose,c=Object(d.useContext)(y).data,n=It(),s=Object(d.useState)({id:0,metodopago:1,metodoname:"efectivo",total:0,bank_id:null,details:null,auth:null,forPaid:t}),l=Object(i.a)(s,2),o=l[0],j=l[1],u=function(e){var t=e.name,a=e.value,c=e.type,n=a;"number"!==c&&"select-one"!==c||(n=parseFloat(a)),j(Object(r.a)(Object(r.a)({},o),{},Object(g.a)({},t,n)))},b=function(){var e=Object(ue.a)(n.payments),c=0;if(!o.total)return window.Swal.fire({icon:"warning",title:"El total del abono debe ser mayor a 0",showConfirmButton:!1,timer:1500}),!1;if(1!==o.metodopago&&4!==o.metodopago&&0!==o.metodopago){var s,i;if(!o.bank_id)return window.Swal.fire({icon:"warning",title:"Seleccione un banco",showConfirmButton:!1,timer:1500}),!1;if((null===(s=o.auth)||void 0===s?void 0:s.length)<4)return window.Swal.fire({icon:"warning",title:"Espesifique los ultimos 4 numeros de la tarjeta",showConfirmButton:!1,timer:1500}),!1;if((null===(i=o.auth)||void 0===i?void 0:i.length)>4)return window.Swal.fire({icon:"warning",title:"Espesifique solamente 4 numeros",showConfirmButton:!1,timer:1500}),!1}if(4===o.metodopago&&!o.auth)return window.Swal.fire({icon:"warning",title:"Espesifique el numero de autorizaci\xf3n",showConfirmButton:!1,timer:1500}),!1;e.push(Object(r.a)(Object(r.a)({},o),{},{id:"new".concat(Date.now().toString()),metodoname:Pt.getMethodName(o.metodopago),total:t<o.total?t:o.total})),e.forEach((function(e){return c+=e.total})),a(),n.set(Object(r.a)(Object(r.a)({},n),{},{payments:e,thereNews:!0}))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Capture el pago"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return a()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:Object(x.jsxs)("form",{autoComplete:"off",onSubmit:function(e){e.preventDefault(),b()},children:[Object(x.jsx)("div",{className:"row mb-2 bg-gray-light",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("h4",{className:"text-center",children:["Por pagar: ",Object(x.jsxs)("span",{className:"text-success",children:["$ ",t]})]})})}),Object(x.jsxs)("div",{className:"row my-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Metodo de pago"}),Object(x.jsxs)("select",{name:"metodopago",className:"custom-select text-uppercase",onChange:function(e){var t=e.target;return u(t)},defaultValue:o.metodopago,children:[Object(x.jsx)("option",{value:"1",children:"Efectivo"}),Object(x.jsx)("option",{value:"2",children:"Tarjeta de debito"}),Object(x.jsx)("option",{value:"3",children:"Tarjeta de credito"}),Object(x.jsx)("option",{value:"4",children:"La marina"}),Object(x.jsx)("option",{value:"5",children:"Cheque"}),Object(x.jsx)("option",{value:"6",children:"Transferencia"}),Object(x.jsx)("option",{value:"0",children:"Otro"})]})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Cantidad"}),Object(x.jsx)("input",{type:"number",min:"0",className:"form-control text-right",name:"total",onChange:function(e){var t=e.target;return u(t)},autoFocus:!0})]})]}),1!==o.metodopago?Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsx)("div",{className:"col",children:4!==o.metodopago&&0!==o.metodopago?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Banco"}),Object(x.jsxs)("select",{name:"bank_id",className:"custom-select text-uppercase",onChange:function(e){var t=e.target;return u(t)},children:[Object(x.jsx)("option",{value:"",children:"--Seleccione un banco--"}),c.map((function(e){return"bank"===e.name?Object(x.jsx)("option",{value:e.id,children:e.data},e.id):null}))]})]}):o.metodopago?Object(x.jsx)("h4",{className:"d-bloc text-center mt-4 text-success",children:"LA MARINA"}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Espesifique"}),Object(x.jsx)("input",{type:"text",name:"details",className:"form-control",onChange:function(e){var t=e.target;return u(t)}})]})}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:4!==o.metodopago?"Ultimos 4 digitos":"N. Autorizaci\xf3n"}),Object(x.jsx)("input",{type:"text",name:"auth",className:"form-control",onChange:function(e){var t=e.target;return u(t)}})]})]}):null,t<o.total?Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("h4",{className:"text-center mt-4",children:1===o.metodopago?Object(x.jsxs)(x.Fragment,{children:["Cambio:",Object(x.jsxs)("span",{className:"ml-2",children:["$ ",o.total-t]})]}):Object(x.jsxs)("span",{className:"text-danger",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-2"}),"La cantidad cobrada es mayor al total"]})})})}):null]})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return a()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){return b()},disabled:!o.total||o.total>o.forPaid,children:[Object(x.jsx)("i",{className:"fas fa-money-bill mr-1"}),"Abonar"]})]})]})})})};function Rt(){var e=Object(d.useState)({showPayment:!1}),t=Object(i.a)(e,2),a=t[0],c=t[1],n=It(),s=Pt.getForPay(n.items,n.payments,n.discount),l=0===n.discount?Pt.getPagado(n.payments):Pt.getPagado(n.payments)+n.discount,o=n.subtotal<=l;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("button",{className:"btn btn-success ml-2 d-print-none",onClick:function(){c(Object(r.a)(Object(r.a)({},a),{},{showPayment:!0}))},disabled:!n.items.length||n.subtotal&&o,children:Object(x.jsx)("i",{className:"fas fa-money-bill-alt"})}),a.showPayment&&Object(x.jsx)(Ut,{handleClose:function(){c(Object(r.a)(Object(r.a)({},a),{},{showPayment:!1}))},sale:Object(r.a)(Object(r.a)({},n),{},{contact_id:n.customer.id}),forPaid:s})]})}function qt(e){var t=It(),a=!t.customer.id&&!t.items.length,c=Object(d.useContext)(p).auth,n=Object(u.f)(),s=function(){if(t.set({id:0,customer:{id:0,name:"venta de mostrador"},contact_id:2,items:[],session:Pt.getSession(),discount:0,subtotal:0,total:0,payments:[],branch_id:c.branch.id,isPayed:!1}),!e.match.params.id)return null;n.push("/notas")};return Object(x.jsx)("button",{className:"btn btn-warning ml-1",title:"Nueva venta",onClick:function(){Pt.confirm("\xbfDesea terminar esta venta? La venta actual no se guardara",s)},disabled:a,children:Object(x.jsx)("i",{className:"fas fa-window-close"})})}var Yt=function(e){var t=e.handleClose,a=Object(d.useState)({textSearch:""}),c=Object(i.a)(a,2),n=c[0],s=c[1],l=Object(d.useState)([]),o=Object(i.a)(l,2),j=o[0],u=o[1],b=It(),m=Object(d.useContext)(p).auth,h=Y(),O=function(){t&&t()},f=function(){var e={search:n.textSearch,itemsPage:"25",orderBy:"id",order:"desc"};h.getContacts(e).then((function(e){e?u(e.data):console.error("Error al obtener usuario")}))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Seleccione un cliente"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:O,children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsxs)("div",{className:"modal-body p-2",children:[Object(x.jsxs)("div",{className:"form-inline mb-3",children:[Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("input",{className:"form-control",placeholder:"Buscar cliente",onChange:function(e){return function(e){var t=e.value;s({textSearch:t})}(e.target)},onKeyPress:function(e){return function(e){if("Enter"===e){if(n.textSearch.length>4)return f();window.Swal.fire({title:"Verificacion",text:"Escriba un nombre valido, al menos 5 caracteres",icon:"warning"})}}(e.key)},onBlur:function(){return n.textSearch.length>4&&f()},autoFocus:!0})}),Object(x.jsx)("div",{className:"form-group pl-2",children:Object(x.jsx)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:f,disabled:n.textSearch.length<5,children:Object(x.jsx)("i",{className:"fas fa-search"})})})]}),Object(x.jsx)("div",{className:"table-responsive overflow-auto",style:{height:"12rem"},children:Object(x.jsx)("table",{className:"table table-sm",children:Object(x.jsxs)("tbody",{children:[j.map((function(e){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{className:"text-right",children:Object(x.jsx)("span",{className:"badge badge-dark",children:e.id})}),Object(x.jsx)("td",{className:"text-left",children:Object(x.jsx)("a",{href:"#select",onClick:function(a){return function(e,a){var c;e.preventDefault(),b.customer.id!==a.id?[0,2].includes(b.customer.id)?b.set(Object(r.a)(Object(r.a)({},b),{},{customer:{id:a.id,name:a.name?a.name:"Venta de mostrador",phones:null!==(c=a.phones)&&void 0!==c?c:{}},contact_id:a.id})).then((function(){return t()})):window.Swal.fire({title:"Ventas",text:"Esta accion creara una nueva venta \xbfEsta seguro que desea crear una nueva venta?",icon:"question",showCancelButton:!0,confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){var c;e.dismiss||(b.set({id:0,customer:{id:a.id,name:a.name,phones:null!==(c=a.phones)&&void 0!==c?c:{}},contact_id:a.id,items:[],session:Pt.getSession(),discount:0,subtotal:0,total:0,payments:[],branch_id:m.branch.id}),t())})):t()}(a,e)},className:"text-capitalize",children:e.name.toLowerCase()})})]},e.id)})),!j.length&&Object(x.jsx)(x.Fragment,{children:[0,2].includes(b.customer.id)?Object(x.jsx)("tr",{children:Object(x.jsx)("td",{children:"No existen pacientes con esta coincidencia"})}):Object(x.jsx)("tr",{children:Object(x.jsx)("td",{children:Object(x.jsxs)("span",{className:"alert alert-warning text-center",children:["Cambiar de usuario, provocara cerrar la"," ",Object(x.jsx)("strong",{children:"venta"})," actual."]})})})})]})})})]}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:O,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]})})]})})})};function Gt(){var e=Object(d.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],n=function(){c(!a)},s=It();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"fas fa-user mr-1 text-indigo"}),"Cliente:",Object(x.jsx)("label",{className:"text-capitalize ml-1",children:s.customer?s.customer.name:"XXX - vuelva a cargar"}),Object(x.jsx)("button",{type:"button",className:"btn bg-indigo btn-sm ml-2",title:"Buscar cliente",onClick:n,children:Object(x.jsx)("i",{className:"fas fa-exchange-alt"})}),a&&Object(x.jsx)(Yt,{handleClose:n})]})}var $t=function(e){var t,a=e.payment,c=void 0===a?{}:a,n=e.handleClose;return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Detalles del abono"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return n()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsxs)("div",{className:"modal-body p-2",children:[Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2",children:"Metodo de pago"}),Object(x.jsx)("span",{children:c.metodoname})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2",children:"Cantidad abonada"}),Object(x.jsxs)("span",{children:["$",c.total]})]})]}),c.banco&&c.banco.id?Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2",children:"Banco"}),Object(x.jsx)("span",{children:c.banco.value})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2",children:"Auth"}),Object(x.jsx)("span",{children:null!==(t=c.auth)&&void 0!==t?t:"--"})]})]}):null,c.id?Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2 d-block",children:"Folio"}),Object(x.jsx)("span",{children:c.id})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2 d-block",children:"Fecha"}),c.created_at?Object(x.jsx)("span",{children:D()(c.created_at).format("LL")}):Object(x.jsx)("span",{children:"--"})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{className:"mr-2 d-block text-uppercase",children:"Recibio"}),Object(x.jsx)("span",{children:c.created&&c.created.name?c.created.name:"--"})]})]}):Object(x.jsx)("div",{className:"row mb-2",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("span",{className:"alert alert-warning d-block text-bold",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Pago no acreditado!"]})})})]}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return n()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]})})]})})})};function Ht(e){var t,a,c=e.item,n=e.close,s=e.handleUpdate,l=Object(d.useState)({cant:null!==(t=c.cant)&&void 0!==t?t:0,price:null!==(a=c.price)&&void 0!==a?a:0}),o=Object(i.a)(l,2),j=o[0],u=o[1],b=function(e){var t=e.name,a=e.value;u(Object(r.a)(Object(r.a)({},j),{},Object(g.a)({},t,parseInt(a))))},m=function(){s(Object(r.a)(Object(r.a)(Object(r.a)({},c),j),{},{subtotal:j.cant*j.price}))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:Object(x.jsx)("span",{className:"text-capitalize text-truncate",children:c.producto})}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return n()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:Object(x.jsxs)("div",{className:"row my-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Cantidad"}),Object(x.jsx)("input",{type:"number",min:"0",className:"form-control text-right",name:"cant",defaultValue:j.cant,onChange:function(e){var t=e.target;return b(t)}})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Precio"}),Object(x.jsx)("input",{type:"number",min:"0",className:"form-control text-right",name:"price",defaultValue:j.price,onChange:function(e){var t=e.target;return b(t)},onKeyPress:function(e){return function(e){"Enter"===e&&m()}(e.key)}})]})]})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return n()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:m,children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),"Guardar"]})]})]})})})}function Zt(){var e=It(),t=e.discount?Pt.getPagado(e.payments)+e.discount:Pt.getPagado(e.payments),a=e.subtotal<=t,c=Object(d.useContext)(p).auth.roles,n=Object(d.useState)({showUpdateItem:!1,showPaymentDetails:!1,item:{},payment:{}}),s=Object(i.a)(n,2),l=s[0],o=s[1],j=function(t){var a=e.items.filter((function(e){return e.store_items_id!==t.store_items_id})),c=Pt.getSubTotal(a);e.set(Object(r.a)(Object(r.a)({},e),{},{items:a,total:Pt.getTotal(c,e.discount),subtotal:c}))},u=function(t){var a=t.id,c=t.total,n=(t.metodoname,e.payments.filter((function(e){return e.id!==a})));Pt.confirm("Realmente desea eliminar el pago de  $".concat(c),(function(){e.set(Object(r.a)(Object(r.a)({},e),{},{payments:n}))}))},b=function(e,t){e&&e.preventDefault(),o(Object(r.a)(Object(r.a)({},l),{},{showUpdateItem:!0,item:t}))},m=function(){o(Object(r.a)(Object(r.a)({},l),{},{showUpdateItem:!1,item:{}}))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("table",{className:"table table-striped",children:Object(x.jsxs)("tbody",{children:[e.items&&e.items.length?Object(x.jsx)(x.Fragment,{children:e.items.map((function(t,n){var s=e.subtotal&&a||e.payments.length||e.discount,r=D()(Date.now()).diff(D()(e.created_at),"days");return t.store_items_id?Object(x.jsxs)("tr",{children:[Jt(j,t,s),Object(x.jsxs)("td",{onClick:function(e){"ventas"===c&&0!==r?alert("No puedes editar esta venta!"):b(null,t)},children:[Object(x.jsx)("a",{href:"#details",className:"text-muted w-full d-block text-uppercase",onClick:function(e){if("ventas"===c)return null;b(e,t)},children:t.producto?t.producto:t.name}),Object(x.jsxs)("label",{className:"w-full d-block",children:[Object(x.jsx)("span",{className:"badge badge-dark mr-1",children:t.cant}),"*",Object(x.jsxs)("span",{className:t.price?"mx-1":"mx-1 text-danger",children:["$",t.price]}),"=",Object(x.jsxs)("span",{className:t.subtotal?"ml-1":"ml-1 text-danger",children:["$",t.subtotal]})]})]})]},n):null}))}):null,e.discount?Object(x.jsxs)("tr",{children:[Jt((function(){Pt.confirm("Realmente desea eliminar el descuento",(function(){e.set(Object(r.a)(Object(r.a)({},e),{},{discount:0}))}))}),null,a),Object(x.jsxs)("td",{children:[Object(x.jsx)("span",{className:"text-danger w-full d-block text-uppercase",children:"Descuento"}),Object(x.jsx)("label",{className:"w-full d-block",children:Object(x.jsxs)("span",{className:"ml-1 text-danger",children:["- $",e.discount]})})]})]}):null,e.payments.length?Object(x.jsx)(x.Fragment,{children:e.payments.map((function(t,a){var c=!(!e.id||e.order)||!(!e.id||!e.order)&&!!e.isPayed;return Object(x.jsxs)("tr",{children:[Jt(u,t,c),Object(x.jsxs)("td",{children:[Object(x.jsxs)("a",{href:"#link",className:" w-full d-block text-uppercase",onClick:function(e){return function(e,t){e&&e.preventDefault(),o(Object(r.a)(Object(r.a)({},l),{},{showPaymentDetails:!0,payment:t}))}(e,t)},children:[Object(x.jsx)("span",{className:"text-success",children:"Abono"}),Object(x.jsx)("span",{className:"ml-1 text-muted",children:t.metodoname})]}),Object(x.jsxs)("label",{className:"w-full d-block",children:[Object(x.jsxs)("span",{className:"ml-1 text-muted",children:[D()(t.created_at).format("LL"),","]}),Object(x.jsxs)("span",{className:"ml-1",children:["$",t.total]})]})]})]},a)}))}):null,e.thereNews&&e.order?Object(x.jsx)("tr",{className:"table-info",children:Object(x.jsx)("td",{colSpan:"2",children:Object(x.jsxs)("span",{className:" w-full d-block text-uppercase text-center text-bold",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1 text-primary"}),"Para guardar los cambios presione el boton \xa1Imprimir!"]})})}):Boolean(a&&e.subtotal)&&Object(x.jsx)("tr",{className:"table-info",children:Object(x.jsx)("td",{colSpan:"2",children:Object(x.jsxs)("span",{className:" w-full d-block text-uppercase text-center text-bold",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-1 text-primary"}),"Cuenta pagada!"]})})})]})}),l.showPaymentDetails&&Object(x.jsx)($t,{handleClose:function(){o(Object(r.a)(Object(r.a)({},l),{},{showPaymentDetails:!1,payment:{}}))},payment:l.payment}),l.showUpdateItem&&Object(x.jsx)(Ht,{item:l.item,handleUpdate:function(t){var a=e.items.filter((function(e){return e.store_items_id!==t.store_items_id}));a.push(t);var c=Pt.getSubTotal(a);e.set(Object(r.a)(Object(r.a)({},e),{},{items:a,total:Pt.getTotal(c,e.discount),subtotal:c})),m()},close:m})]})}function Jt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(x.jsx)("td",{style:{width:32},children:Object(x.jsx)("button",{type:"button",className:a?"btn btn-default disabled":"btn btn-default",onClick:function(){e&&(t?e(t):e())},disabled:a,children:Object(x.jsx)("i",{className:"fas fa-trash text-muted"})})})}function Kt(){var e=It();return Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{className:"mx-1",children:"Folio:"}),Object(x.jsx)("span",{className:"mx-1",children:e.id?e.id:"Nuevo"}),Object(x.jsx)("label",{className:"mx-1",children:"Fecha:"}),Object(x.jsx)("span",{className:"mx-1",children:D()(e.created_at).format("L")}),e.order?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{className:"mx-1",children:"Pedido:"}),Object(x.jsx)("span",{className:"mx-1",children:e.order})]}):null]})}function Wt(){var e=It();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("span",{className:"text-lg",children:"Por pagar:"}),Object(x.jsxs)("label",{className:"text-lg ml-1",children:["$",Pt.getForPay(e.items,e.payments,e.discount)]})]})}function Xt(){var e=It();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("span",{className:"text-lg",children:"Total:"}),Object(x.jsxs)("label",{className:"text-lg ml-1",children:["$",e.subtotal]})]})}function Qt(e){var t=e.handleClose,a=e.data;return Object(x.jsx)("div",{className:"modal d-block",children:Object(x.jsx)("div",{className:"modal-dialog modal-lg",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Actividad"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return t()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)(F,{data:a}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return t()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cerrar"]})})]})})})}function ea(){var e,t=Object(d.useContext)(Bt),a=Object(d.useState)(!1),c=Object(i.a)(a,2),n=c[0],s=c[1];return Object(x.jsxs)("div",{children:[Object(x.jsx)("button",{className:"btn btn-info ml-2",title:"Ver actividad",disabled:!t.id,onClick:function(){return s(!0)},children:Object(x.jsx)("i",{className:"fas fa-info"})}),n?Object(x.jsx)(Qt,{data:null!==(e=t.activitys)&&void 0!==e?e:[],handleClose:function(){s(!1)}}):null]})}function ta(){var e=Object(d.useContext)(Bt),t=Object(u.f)();return Object(x.jsx)("div",{children:Object(x.jsx)("button",{className:"btn btn-info mr-2",title:"Pedido",disabled:!e.order,onClick:function(){t.push("/pedidos/".concat(e.order))},children:Object(x.jsx)("i",{className:"fas fa-file-alt"})})})}function aa(e){var t=Object(d.useContext)(p).auth,a=zt(),c={id:0,order:0,customer:{id:0,name:"venta de mostrador",phones:{}},contact_id:2,items:[],session:Pt.getSession(),discount:0,subtotal:0,total:0,payments:[],branch_id:t.branch.id,activitys:[],print:!1,isPayed:!1,thereNews:!1,loading:!1},n=Object(d.useState)(c),s=Object(i.a)(n,2),l=s[0],o=s[1],j=Pt.getPagado(l.payments)+l.discount,u=l.total<=j,b=!l.order&&(!u||!l.items.length),m=function(){var e={id:l.id,contact_id:l.contact_id,discount:l.discount,items:[],payments:[]};return l.id||(e.session=l.session),l.items.forEach((function(t){return e.items.push({id:t.id,cant:t.cant,price:t.price,store_items_id:t.store_items_id})})),l.payments.length&&l.payments.forEach((function(t){var a={id:t.id?t.id:0,metodopago:t.metodopago,total:t.total};1!==t.metodopago&&(a.auth=t.auth,4!==t.metodopago&&(a.bank_id=t.bank_id)),e.payments.push(a)})),e},h=function(){window.Swal.fire({title:"Ventas",text:"\xbfRealmente quires guardar esta venta?",icon:"info",showCancelButton:!0,confirmButtonText:"Solo guardar",cancelButtonText:"Imprimir y guardar",showLoaderOnConfirm:!0,showDenyButton:!0}).then((function(e){e.dismiss?a.saveSale(m()).then((function(e){var t=e.data;t?l.id&&l.order?o(Object(r.a)(Object(r.a)({},l),{},{id:t.id,thereNews:!1,print:!0})):window.Swal.fire({title:"Venta Guardada correctamente",text:"\xbfQuieres imprimir el ticket de la venta?",icon:"success",showCancelButton:!0,confirmButtonText:"Imprimir",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss?Pt.confirm("Cerrar la venta actual",(function(){o(c)})):o(Object(r.a)(Object(r.a)({},l),{},{id:t.id,thereNews:!1,print:!0}))})):console.error("Error al guardar la venta")})):a.saveSale(m()).then((function(e){var t=e.data;t?l.id&&l.order?o(Object(r.a)(Object(r.a)({},l),{},{id:t.id,thereNews:!1})):window.Swal.fire({title:"Venta Guardada correctamente",icon:"success",showCancelButton:!1,showConfirmButton:!1,showLoaderOnConfirm:!0,timer:3e3}):console.error("Error al guardar la venta")}))}))};return Object(d.useEffect)((function(){var e,t,a=null===(e=l.items)||void 0===e?void 0:e.reduce((function(e,t){return t.cant*t.price+e}),0),c=null===(t=l.payments)||void 0===t?void 0:t.reduce((function(e,t){return t.total+e}),0),n=Boolean(!(a-l.discount-c)),s=!l.id;a||c?l.thereNews&&(s=!0):(s=!1,n=!1),!1===l.thereNews&&!1===l.load&&(s=!0),o(Object(r.a)(Object(r.a)({},l),{},{isPayed:n,thereNews:s,load:!1}))}),[l.items,l.payments,l.discount]),Object(d.useEffect)((function(){l.isPayed&&(l.id||l.order||h())}),[l.isPayed]),Object(d.useEffect)((function(){e.match.params.id&&(o(Object(r.a)(Object(r.a)({},l),{},{loading:!0})),a.getSaleById(e.match.params.id).then((function(e){var t=e.data;t&&o(Object(r.a)(Object(r.a)({},l),{},{id:t.id,order:t.order,contact_id:t.customer.id,items:t.items,session:t.session,discount:t.discount,subtotal:t.subtotal,total:t.total,payments:t.payments,branch_id:t.branch.id,created_at:t.created_at,activitys:t.activity,customer:t.customer,thereNews:!1,loading:!1}))})).catch((function(){o(Object(r.a)(Object(r.a)({},l),{},{loading:!1}))})))}),[]),Object(x.jsx)(Bt.Provider,{value:Object(r.a)(Object(r.a)({},l),{},{set:function(e){return new Promise((function(t){o(e),t()}))}}),children:Object(x.jsxs)("div",{className:"card border border-gray",children:[Object(x.jsxs)("div",{className:"card-body pb-2 d-print-none",children:[Object(x.jsxs)("nav",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(Gt,{})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(Kt,{})}),Object(x.jsx)("div",{className:"col-3",children:Object(x.jsxs)("div",{className:"card-tools d-flex justify-content-end mb-3",children:[Object(x.jsx)(ta,{}),Object(x.jsx)(At,{}),Object(x.jsx)(Tt,{}),Object(x.jsx)(qt,Object(r.a)({},e)),Object(x.jsx)(ea,{})]})})]}),Object(x.jsx)("div",{className:"overflow-auto text-right p-0 border border-gray",style:{minHeight:"65vh"},children:l.loading?Object(x.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center  mt-5",children:[Object(x.jsx)("h1",{children:"Cargando informacion"}),Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status"})]}):Object(x.jsx)(Zt,{})})]}),Object(x.jsx)("div",{className:"card-footer",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col d-print-none",children:Object(x.jsx)(Xt,{})}),Object(x.jsx)("div",{className:"col d-print-none",children:Object(x.jsx)(Wt,{})}),Object(x.jsxs)("div",{className:"col-6 text-right",children:[Object(x.jsx)(Ft,{}),Object(x.jsx)(Rt,{}),Object(x.jsxs)("button",{className:"btn btn-primary ml-3",onClick:function(){l.id&&l.order&&l.thereNews?h():o(Object(r.a)(Object(r.a)({},l),{},{print:!0}))},disabled:b,children:[Object(x.jsx)("i",{className:"fas fa-print mr-2"}),"Imprimir"]}),l.print&&Object(x.jsx)(Mt,{data:Object(r.a)(Object(r.a)({},l),{},{order_id:l.order}),setPrint:function(){return o(Object(r.a)(Object(r.a)({},l),{},{print:!1}))}})]})]})})]})})}var ca=a(30);function na(e){var t=e.filters,a=Object(d.useState)({payments:[],meta:{},page:1,load:!1}),c=Object(i.a)(a,2),n=c[0],l=c[1],j=function(){var e=Object(s.a)(o.a.mark((function e(){var a,c,s,i,d,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(r.a)(Object(r.a)({},t),{},{itemsPage:12,page:n.page}),l(Object(r.a)(Object(r.a)({},n),{},{load:!0})),c=O("payments",null,a),e.next=5,h(c);case 5:s=e.sent,i=s.data,d=s.message,j=s.meta,i?l(Object(r.a)(Object(r.a)({},n),{},{payments:i,meta:j,load:!1})):d&&(l(Object(r.a)(Object(r.a)({},n),{},{load:!1})),console.error("[Orus system] Error in report payments details:",d),window.Swal.fire("Fallo de conexion",d,"error"));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){j()}),[t.user_id,t.date_start,t.date_end,t.branch_id,n.page]),Object(x.jsxs)("div",{className:"card card-success card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h3",{className:"card-title text-success",children:"Detallado"})}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsxs)("table",{className:"table table-sm",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Metodo"}),Object(x.jsx)("th",{children:"Cliente"}),Object(x.jsx)("th",{children:"Pedido"}),Object(x.jsx)("th",{children:"Total"})]})}),Object(x.jsx)("tbody",{children:n.payments.length?n.payments.map((function(e){return Object(x.jsxs)("tr",{className:1===e.metodo?"text-success":"",children:[Object(x.jsx)("th",{className:"text-uppercase",children:e.metodoname}),Object(x.jsx)("td",{className:"text-capitalize",children:e.sale&&e.sale.customer?e.sale.customer.name:"--"}),Object(x.jsx)("td",{children:Object(x.jsx)("span",{className:"badge badge-primary",alt:"Cobrado por: "+e.created_user,title:"Cobrado por: "+e.created_user,children:e.sale&&e.sale.pedido?e.sale.pedido:"--"})}),Object(x.jsx)("td",{className:"text-right",children:ca.dollarUS.format(e.total)})]},e.id)})):Object(x.jsx)("tr",{children:Object(x.jsx)("th",{colSpan:"4",className:"text-center",children:Object(x.jsxs)("h6",{className:"text-warning",children:[Object(x.jsx)("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia"]})})})})]})}),Boolean(n.meta.total)&&Object(x.jsxs)("div",{className:"card-footer",children:[1===n.meta.current_page?Object(x.jsx)("a",{href:"#next",onClick:function(e){return e.preventDefault()},children:Object(x.jsx)("i",{className:"fas fa-step-backward text-dark"})}):Object(x.jsx)("a",{href:"#next",onClick:function(e){e.preventDefault(),l(Object(r.a)(Object(r.a)({},n),{},{page:n.page-1}))},children:Object(x.jsx)("i",{className:"fas fa-step-backward"})})," "+n.page+" / "+n.meta.last_page+" ",n.meta.current_page===n.meta.last_page?Object(x.jsx)("a",{href:"#next",onClick:function(e){return e.preventDefault()},children:Object(x.jsx)("i",{className:"fas fa-step-forward text-dark"})}):Object(x.jsx)("a",{href:"#next",onClick:function(e){e.preventDefault(),l(Object(r.a)(Object(r.a)({},n),{},{page:n.page+1}))},children:Object(x.jsx)("i",{className:"fas fa-step-forward"})})]}),n.load&&Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})}function sa(e){var t=e.filters,a=e.changeState,c=e.auth,n=Object(d.useState)({rol:c.roles,total:0,efectivo:0,char:null,load:!1}),l=Object(i.a)(n,2),j=l[0],u=l[1],b=function(){var e=Object(s.a)(o.a.mark((function e(){var a,c,n,s,i,l,d,b,m,x,p,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(Object(r.a)(Object(r.a)({},j),{},{load:!0})),a=Object(r.a)(Object(r.a)({},t),{},{itemsPage:20,type:"methods"}),c=O("payments",null,a),e.next=5,h(c);case 5:if(n=e.sent,s=n.data,i=n.message,console.log("[Orus System] Creating char"),!s){e.next=31;break}if(l=window.$("#donutChart").get(0).getContext("2d"),d={maintainAspectRatio:!0,responsive:!0},b=[],m=[],x=0,p=0,f={},j.char&&j.char.destroy(),s.message){e.next=23;break}if(!s||!s.length){e.next=18;break}return e.next=16,s.map((function(e){return b.push(e.method),m.push(e.total.toFixed(2)),"efectivo"===e.method&&(p=e.total),x+=e.total,null}));case 16:e.next=20;break;case 18:b=["No hay datos"],m=[0];case 20:u(Object(r.a)(Object(r.a)({},j),{},{total:x,efectivo:p,load:!1})),e.next=27;break;case 23:console.error("[ORUS] Error al cargar la venta del dia",s.message),b=["No hay datos"],m=[100],u(Object(r.a)(Object(r.a)({},j),{},{load:!1}));case 27:f={labels:b,datasets:[{data:m,backgroundColor:["#f56954","#00a65a","#f39c12","#00c0ef","#3c8dbc","#d2d6de","#000"]}]},j.char=new window.Chart(l,{type:"pie",data:f,options:d}),e.next=34;break;case 31:return window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error al descargar las ventas",icon:"error",confirmButtonText:"Ok"}),u(Object(r.a)(Object(r.a)({},j),{},{load:!1})),e.abrupt("return",i);case 34:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){b()}),[t.user_id,t.date_start,t.date_end,t.branch_id]),Object(d.useEffect)((function(){a({ventas:j.efectivo})}),[j.efectivo]),Object(x.jsxs)("div",{className:"card card-success card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h3",{className:"card-title text-success",children:"Ventas del dia por metodo de pago"})}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("canvas",{id:"donutChart"}),Object(x.jsxs)("p",{children:["Venta total: ",Object(x.jsx)("strong",{children:ca.dollarUS.format(j.total)}),Object(x.jsx)("br",{}),"Efectivo: ",Object(x.jsx)("strong",{children:ca.dollarUS.format(j.efectivo)})]})]}),j.load&&Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})}function ra(e){var t=e.filters,a=Object(d.useState)({listBank:[],page:1,data:[],load:!1}),c=Object(i.a)(a,2),n=c[0],l=c[1],j=function(){var e=Object(s.a)(o.a.mark((function e(){var a,c,s,i,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(r.a)(Object(r.a)({},t),{},{itemsPage:12,type:"banks"}),l(Object(r.a)(Object(r.a)({},n),{},{load:!0})),c=O("payments",null,a),e.next=5,h(c);case 5:s=e.sent,i=s.data,d=s.message,i?l(Object(r.a)(Object(r.a)({},n),{},{data:i,load:!1})):d&&(l(Object(r.a)(Object(r.a)({},n),{},{load:!1})),console.error("[Orus system] Error in report payments details:",d),window.Swal.fire("Fallo de conexion",d,"error"));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){j()}),[t.user_id,t.date_start,t.date_end,t.branch_id]),Object(x.jsxs)("div",{className:"card card-success card-outline",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("h3",{className:"card-title text-success",children:"Detallado de pagos bancarios"})}),Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)("ul",{className:"list-group",children:n.data.length?n.data.map((function(e,t){return Object(x.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(x.jsx)("label",{className:"text-uppercase",children:e.name}),Object(x.jsx)("span",{className:"badge badge-primary",children:ca.dollarUS.format(e.total)})]},t)})):Object(x.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(x.jsxs)("h6",{className:"text-warning",children:[Object(x.jsx)("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia"]})})})}),n.load&&Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})})]})}a(162);function ia(e){var t=e.filters,a=e.changeState,c=t.user_id,n=t.branch_id,s=t.date_end,l=t.date_start,o=Object(d.useState)({branch_id:n,user_id:c,date_start:l,date_end:s,userData:[],load:!1}),j=Object(i.a)(o,2),u=j[0],b=j[1],m=N(),h=Object(d.useContext)(y).data.filter((function(e){return"branches"===e.name})),O=function(e,t){b(Object(r.a)(Object(r.a)({},u),{},Object(g.a)({},e,D()(t).format("YYYY-MM-DD"))))},p=function(){b(Object(r.a)(Object(r.a)({},u),{},{load:!0})),m.getListUsers({branch_id:u.branch_id}).then((function(e){var t=e.data;if(t){var a=t.filter((function(e){return!e.roles.includes("doctor")}));b(Object(r.a)(Object(r.a)({},u),{},{userData:a,load:!1}))}else console.error("[Orus System] Error al obtener la lista de usuarios"),b(Object(r.a)(Object(r.a)({},u),{},{load:!1}))}))};return Object(d.useEffect)((function(){p()}),[]),Object(x.jsx)("div",{className:"border-bottom pb-3 mb-4",children:Object(x.jsx)("div",{className:"card-body p-0 bg-light",children:Object(x.jsxs)("div",{className:"form-group row col-lg-12 m-0",children:[Object(x.jsx)("div",{className:"col-lg-1 mt-sm-3 ml-sm-3",children:Object(x.jsx)("p",{className:"mt-2 font-weight-bold text-secondary h5",children:"Filtros"})}),Object(x.jsx)("div",{className:"col-lg-2 mt-sm-3",children:Object(x.jsx)("div",{className:"col-lg-12",children:Object(x.jsxs)("select",{className:"form-control text-capitalize",value:u.branch_id,onChange:function(e){var t=e.target;return b(Object(r.a)(Object(r.a)({},u),{},{branch_id:t.value}))},children:[Object(x.jsx)("option",{value:"",children:u.load&&!h.length?"Cargando...":"Todas"}),h.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.data.name},e.id)}))]})})}),Object(x.jsx)("div",{className:"col-lg-2 mt-sm-3",children:Object(x.jsx)("div",{className:"col-lg-12",children:Object(x.jsxs)("select",{className:"form-control text-capitalize",defaultValue:u.user_id,onChange:function(e){var t=e.target;return b(Object(r.a)(Object(r.a)({},u),{},{user_id:t.value}))},children:[Object(x.jsx)("option",{value:"",children:u.load?"Cargando...":"Todos"}),u.userData.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})})}),Object(x.jsxs)("div",{className:"row mt-sm-3 m-0 ml-sm-2",children:[Object(x.jsx)("label",{className:"col-lg-1 col-form-label p-0 ml-5 mt-2 ml-sm-3",children:"De:"}),Object(x.jsx)("div",{className:"col-lg-10",children:Object(x.jsx)(Ee.a,{className:"form-control",selected:new Date(D()(u.date_start).format("")),onSelect:function(e){return O("date_start",e)},onChange:function(e){return O("date_start",e)}})})]}),Object(x.jsxs)("div",{className:"row mt-sm-3 m-0",children:[Object(x.jsx)("label",{className:"col-lg-1 col-form-label p-0 mt-2 ml-sm-3",children:"a:"}),Object(x.jsx)("div",{className:"col-lg-10",children:Object(x.jsx)(Ee.a,{className:"form-control",selected:new Date(D()(u.date_end).format("")),onSelect:function(e){return O("date_end",e)},onChange:function(e){return O("date_end",e)}})})]}),Object(x.jsx)("div",{className:"col-lg-2 row mt-sm-3 d-flex justify-content-center m-0 h-50",children:Object(x.jsx)("button",{type:"button",className:"btn w-50 btn-success font-weight-bold",onClick:function(){var e=u.user_id,t=u.branch_id,c=u.date_end,n=u.date_start;a({branch_id:t,user_id:e,date_start:n,date_end:c}),p()},children:"Filtrar"})})]})})})}var la=function(e){Object(lt.a)(a,e);var t=Object(ot.a)(a);function a(){return Object(rt.a)(this,a),t.apply(this,arguments)}return Object(it.a)(a,[{key:"render",value:function(){var e=this.props.ventas;return Object(x.jsx)("div",{className:"card border border-info rounded",children:Object(x.jsxs)("div",{className:"card-body bg-light",children:[Object(x.jsx)("h2",{className:"card-title text-secondary",children:"Efectivo de caja"}),Object(x.jsx)("br",{}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("h5",{className:"text-success",children:ca.dollarUS.format(e)})})})]})})}}]),a}(d.Component);function oa(){var e=Object(d.useContext)(p).auth,t=Object(d.useState)({user_id:0,date_start:D()().startOf("week").format("YYYY-MM-DD"),date_end:D()().format("YYYY-MM-DD"),branch_id:e.branch.id,ventas:0}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=function(e){"object"===typeof e?n(Object(r.a)(Object(r.a)({},c),e)):console.log("[Orus system] The filters data not is a object:",e)};return Object(x.jsxs)("div",{className:"content",style:{minHeight:"100vh"},children:[Object(x.jsxs)("p",{className:"h4 border-bottom mb-4",children:["Bienvenido",Object(x.jsx)("span",{className:"font-weight-bold mx-2 text-capitalize",children:e.name.toLowerCase()}),"este es el resumen."]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col col-md-12 col-lg-12",children:Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-lg-12 col-md-12",children:Object(x.jsx)(ia,{filters:c,changeState:s})})})})}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col-lg-4 col-md-12",children:[Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-lg-12 col-md-12",children:Object(x.jsx)(la,{ventas:c.ventas})})}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col-lg-12 col-md-12",children:Object(x.jsx)(sa,{filters:c,changeState:s,auth:e})})})]}),Object(x.jsx)("div",{className:"col-lg-8 col-md-12",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-lg-4 col-md-12",children:Object(x.jsx)(ra,{filters:c,changeState:s})}),Object(x.jsx)("div",{className:"col-lg-8 col-md-12",children:Object(x.jsx)(na,{filters:c,changeState:s})})]})})]})]})}var da=Object(d.createContext)(null);function ja(e){var t=e.handleNewOrEdit,a=Object(d.useContext)(da),c=Object(u.f)();return Object(x.jsxs)("div",{className:"col-lg-12",children:[Object(x.jsxs)("button",{className:a.newOrEdit?"disabled mb-3 btn btn-secondary btn-block":"mb-3 btn btn-primary btn-block",onClick:function(e){e.preventDefault(),t()},disabled:a.newOrEdit,children:[Object(x.jsx)("i",{className:"mr-2 fas fa-plus"}),"Usuario nuevo"]}),a.newOrEdit?Object(x.jsx)("div",{children:Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("a",{href:"#back",className:"d-flex justify-content-between align-items-center",onClick:function(e){e.preventDefault(),t(),c.push("/usuarios")},children:["Ver listado",Object(x.jsx)("span",{className:"badge badge-primary badge-pill",children:Object(x.jsx)("i",{className:"fas fa-chevron-left"})})]})})}):Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h5",{className:"card-title text-dark",children:[Object(x.jsx)("i",{className:"mr-2 fas fa-ellipsis-v"}),"Filtros"]})}),Object(x.jsx)("div",{className:"p-0 card-body",children:Object(x.jsxs)("ul",{className:"nav nav-pills flex-column",children:[Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:a.options.orderby,onChange:function(e){var t=e.target,c=t.name,n=t.value;a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},Object(g.a)({},c,n))}))},children:[Object(x.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(x.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:a.options.order,onChange:function(e){var t=e.target,c=t.name,n=t.value;a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},Object(g.a)({},c,n))}))},children:[Object(x.jsx)("option",{value:"asc",children:"Antiguos"}),Object(x.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"itemsPage",children:"Numero de usuarios"}),Object(x.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:a.options.itemsPage,onChange:function(e){var t=e.target,c=t.name,n=t.value;a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},Object(g.a)({},c,n))}))},children:[Object(x.jsx)("option",{value:"25",children:"ver 25"}),Object(x.jsx)("option",{value:"50",children:"ver 50"}),Object(x.jsx)("option",{value:"75",children:"ver 75"}),Object(x.jsx)("option",{value:"100",children:"ver 100"})]})]})]})})]})]})}function ua(){var e=Object(u.f)(),t=N(),a=Object(d.useContext)(da),c=Object(d.useState)(""),n=Object(i.a)(c,2),s=n[0],l=n[1],o=Object(d.useState)({users:[],meta:{}}),j=Object(i.a)(o,2),b=j[0],m=j[1],h=Object(d.useState)(!1),O=Object(i.a)(h,2),p=O[0],f=O[1],v=b.users,y=b.meta,w=function(e,t){a.set(Object(r.a)(Object(r.a)({},a),{},{options:Object(r.a)(Object(r.a)({},a.options),{},Object(g.a)({},e,t))}))};return Object(d.useEffect)((function(){f(!0),t.getListUsers(a.options).then((function(e){e?(m(Object(r.a)(Object(r.a)({},e),{},{users:e.data,meta:e.meta})),f(!1)):console.error("Error al obtener los datos")}))}),[a.options]),Object(x.jsx)(Z,{title:"Lista de productos",icon:"id-badge",color:"primary",loading:p,meta:y,itemSelected:s,defaultSearch:a.options.search,handlePagination:function(e){return w("page",e)},handleSearch:function(e){return w("search",e)},handleDeleteItem:function(){f(!0),t.deleteUser(s).then((function(e){window.Swal.fire({icon:"success",title:"Usuario eliminado correctamente",showConfirmButton:!1,timer:2500}),l({id:0}),t.getListUsers(a.options).then((function(e){e&&(m(Object(r.a)(Object(r.a)({},e),{},{users:e.data,meta:e.meta})),f(!1))}))})).catch((function(e){console.error(e)}))},handleEditItem:function(t){s?e.push("usuarios/".concat(s)):window.Swal.fire({title:"Error",text:"Lo sentimos no existe un contacto seleccionado",icon:"error"})},handleSync:function(){a.set(Object(r.a)(Object(r.a)({},a),{},{options:{page:1,orderby:"created_at",order:"desc",itemsPage:10}}))},children:Object(x.jsxs)("table",{className:"table table-hover table-striped",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"Nombre"}),Object(x.jsx)("th",{children:"Email/Usuario"}),Object(x.jsx)("th",{children:"Rol"}),Object(x.jsx)("th",{children:"Sucursal"}),"created_at"===a.options.orderby?Object(x.jsx)("th",{children:"Creado"}):Object(x.jsx)("th",{children:"Modificado"})]})}),Object(x.jsx)("tbody",{children:v.length?Object(x.jsx)(x.Fragment,{children:v.map((function(t){return Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(x.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:t.id,id:"item_"+t.id,checked:s===t.id,onChange:function(e){var t=e.target,a=t.value,c=t.checked;l(c?parseInt(a):"")}}),Object(x.jsx)("label",{htmlFor:"item_"+t.id,className:"sr-only"})]}),Object(x.jsx)("td",{className:"mailbox-name text-capitalize text-truncate text-bold text-primary",style:{cursor:"pointer",maxWidth:180},onClick:function(a){e.push("usuarios/".concat(t.id))},children:t.name}),Object(x.jsx)("td",{className:"mailbox-name text-muted text-truncate",children:Object(x.jsx)("span",{children:t.email})}),Object(x.jsx)("td",{className:"mailbox-name ",children:Object(x.jsx)("span",{className:ba(t.roles[0]),children:t.roles[0]})}),Object(x.jsx)("td",{className:"text-truncate",children:Object(x.jsx)("span",{className:"text-capitalize",children:t.branch.data.name})}),"created_at"===a.options.orderby?Object(x.jsx)("td",{className:"mailbox-date text-muted text-truncate",children:Object(x.jsx)("span",{children:D()(t.created_at).format("LL")})}):Object(x.jsx)("td",{className:"mailbox-date text-muted text-truncate",children:Object(x.jsx)("span",{children:D()(t.updated_at).fromNow()})})]},t.id)}))}):Object(x.jsx)("tr",{children:Object(x.jsx)("th",{className:"text-center text-muted",colSpan:"6",children:"No hay usuarios registrados"})})})]})})}function ba(e){switch(e){case"admin":return"text-capitalize badge badge-pill badge-dark";case"ventas":return"text-capitalize badge badge-pill badge-success";default:return"text-capitalize badge badge-pill badge-primary"}}var ma={page:1,orderby:"created_at",order:"desc",itemsPage:25,search:""};function ha(e){var t=Object(d.useState)({options:ma,newOrEdit:null}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.match.params.id;return Object(d.useEffect)((function(){n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!!s}))}),[s]),Object(x.jsx)(da.Provider,{value:Object(r.a)(Object(r.a)({},c),{},{set:n}),children:Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsx)("div",{className:"col-lg-2",children:Object(x.jsx)(ja,{newOrEdit:c.newOrEdit,handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!c.newOrEdit}))}})}),Object(x.jsx)("div",{className:"col-lg-10",children:"boolean"===typeof c.newOrEdit?Object(x.jsx)("div",{className:"col-sm-10 col-md-12 col-lg-12",children:!0===c.newOrEdit?Object(x.jsx)(z,Object(r.a)(Object(r.a)({},e),{},{handleNewOrEdit:function(){return n(Object(r.a)(Object(r.a)({},c),{},{newOrEdit:!c.newOrEdit}))}})):!1===c.newOrEdit?Object(x.jsx)(ua,{}):null}):Object(x.jsx)("p",{children:"Loading component"})})]})})}var Oa=Object(d.createContext)(null);function xa(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("orders",null,t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("orders",t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(o.a.mark((function e(t){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id?"PUT":"POST",2!==t.status||t.bi_details.length||delete t.bi_details,c=O("orders",t.id),delete t.id,e.next=6,h(c,a,t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"DELETE",a=O("orders",t),e.next=4,h(a,"DELETE");case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getListOrders:e,getOrder:t,deleteOrder:c,saveOrder:a}}var pa=function(e){var t=Object(d.useContext)(Oa),a=xa(),c=null===t||void 0===t?void 0:t.options,s=Object(d.useState)({data:[],meta:{},loading:!1}),l=Object(i.a)(s,2),o=l[0],j=l[1],b=e._saveOrder,m=Object(u.f)(),h=Object(d.useState)({id:0}),O=Object(i.a)(h,2),p=O[0],f=O[1],v=function(e,a){null===t||void 0===t||t.set(Object(r.a)(Object(r.a)({},t),{},{options:Object(r.a)(Object(r.a)({},c),{},Object(g.a)({},e,a))}))},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:0};e&&e.preventDefault(),0!==t.id?m.push("/pedidos/".concat(t.id)):m.push("pedidos/".concat(p.id))};return Object(d.useEffect)((function(){!function(){if(!c)return null;j(Object(r.a)(Object(r.a)({},o),{},{loading:!0})),a.getListOrders(c).then((function(e){e?j({data:e.data,meta:e.meta}):console.error("Error al obtener la lista de pedidos")}))}()}),[c]),Object(x.jsx)(Z,{title:"Listado de pedidos",icon:"clipboard-list",color:"warning",meta:o.meta,itemSelected:p.id,loading:o.loading,defaultSearch:null===c||void 0===c?void 0:c.search,handlePagination:function(e){return v("page",e)},handleSearch:function(e){return v("search",e)},handleEditItem:N,handleDeleteItem:function(){window.Swal.fire({title:"\xbfEst\xe1s seguro de eliminar la orden?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar"}).then((function(e){e.dismiss||(a.deleteOrder(p.id),window.Swal.fire({icon:"success",title:"Orden eliminada correctamente",showConfirmButton:!1,timer:3e3}),t.set(Object(r.a)(Object(r.a)({},t),{},{options:{page:1,orderby:"created_at",order:"desc",itemsPage:10,status:0,search:""}})))}))},handleSync:function(){t.set(Object(r.a)(Object(r.a)({},t),{},{options:{page:1,orderby:"created_at",order:"desc",itemsPage:10,status:0,search:""}}))},handleStatus:function(){p.id&&p.estado<3&&qe.handleSaveOrder(p.id,{status:3},c,b),f({id:0})},children:Object(x.jsxs)("table",{className:"table table-hover table-striped",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"Folio"}),Object(x.jsx)("th",{children:"Cliente"}),Object(x.jsx)("th",{children:"Estado"}),Object(x.jsx)("th",{children:"Nota"}),Object(x.jsx)("th",{children:"created_at"===(null===c||void 0===c?void 0:c.orderby)?"Registrado":"Modificado"})]})}),Object(x.jsx)("tbody",{children:o.data.length?o.data.map((function(e,t){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsxs)("div",{className:"icheck-primary",children:[Object(x.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:e.id,id:"order_"+e.id,checked:p.id===e.id,disabled:e.status>2,onChange:function(t){return function(e,t){e.checked||(t={id:0}),f(t)}(t.target,e)}}),Object(x.jsx)("label",{htmlFor:"order_"+e.id,className:"sr-only"})]})}),Object(x.jsxs)("td",{children:["#",e.id]}),Object(x.jsx)("td",{className:"mailbox-name text-truncate text-capitalize text-bold",style:{cursor:"pointer"},children:Object(x.jsx)("a",{href:"#edit",onClick:function(t){return N(t,e)},children:Object(x.jsxs)("span",{className:e.status>2?"text-muted":"text-dark text-bold",children:[Object(x.jsx)("i",{className:"fas fa-user text-sm mr-2"}),e.paciente.name]})})}),Object(x.jsxs)("td",{className:"mailbox-subject",children:[qe.getBadgeStatus(e.status),1===e.status?Object(x.jsxs)("div",{children:[Object(x.jsx)("span",{className:"mr-1 text-dark",children:e.lab?e.lab.nombre:"Sin asignar"}),e.lab?"/ "+e.npedidolab:""]}):2===e.status?Object(x.jsx)("small",{children:e.ncaja?"CAJA: "+e.ncaja:"Caja no asignada"}):e.status?3===e.status?Object(x.jsx)("small",{className:"text-dark",children:"Sin entregar"}):null:Object(x.jsx)("small",{children:e.exam?1===e.exam.status?"Examen completado":"Examen no realizado":"Examen no asignado"})]}),Object(x.jsx)("td",{className:"mailbox-attachment",children:e.sale?Object(x.jsx)(n.b,{to:"/notas/registro/"+e.sale.id,children:Object(x.jsx)("span",{className:"badge badge-success",children:e.sale.id})}):"--"}),Object(x.jsx)("td",{className:"mailbox-date",children:"created_at"===c.orderby?D()(e.created_at).format("ll"):D()(e.updated_at).fromNow()})]},e.id)})):Object(x.jsx)("tr",{children:Object(x.jsx)("th",{colSpan:"10",className:"text-center",children:"No hay datos para mostrar"})})})]})})},fa={getSession:function(){return Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10)}};var va=function(e){var t=te(),a=e.item,c=void 0===a?{name:""}:a,n=e.handleItemSelect,s=Object(d.useState)(c.name),r=Object(i.a)(s,2),l=r[0],o=r[1],j=Object(d.useState)(""),u=Object(i.a)(j,2),b=u[0],m=u[1],h=Object(d.useState)(!1),O=Object(i.a)(h,2),p=O[0],f=O[1],v=Object(d.useState)([]),g=Object(i.a)(v,2),N=g[0],y=g[1],w=function(e){n(e),o(e.name.toUpperCase()),y([])};return Object(d.useEffect)((function(){var e=null;l.length>2&&!c.store_items_id&&(b&&clearTimeout(b),e=setTimeout((function(){t.getProducts(l).then((function(e){e?y(e.data):console.error("Error al obtener la lista de productos")})),m(""),f(!1)}),1e3),m(e)),!l.length&&N.length&&(b&&clearTimeout(b),f(!1)),l||y([])}),[l]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("label",{children:["Producto",p?Object(x.jsx)("span",{className:"position-absolute text-primary ml-2",style:{zIndex:"101",top:"0"},children:"Buscando..."}):null]}),Object(x.jsx)("input",{className:"form-control text-uppercase text-truncate",type:"text",placeholder:"Buscar producto",autoComplete:"off",value:l,onChange:function(e){var t=e.target.value;o(t.toLowerCase()),f(!0)}}),N.length&&l.length>2?Object(x.jsx)("div",{className:"position-absolute shadow p-0 pt-2 pl-1 bg-white rounded w-100 mh-50 overflow-auto",style:{maxHeight:"18rem",zIndex:"100"},children:Object(x.jsx)("div",{className:"list-group m-0 list-group-flush",children:N.sort((function(e,t){return e.cant>t.cant?-1:e.cant<t.cant?1:0})).map((function(e){return function(e,t){if(e.cant!==e.cant_total)return!e.cant&&e.cant_total?Object(x.jsxs)("a",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(a){a.preventDefault(),t(e)},children:[Object(x.jsxs)("span",{className:"text-truncate text-uppercase text-muted",children:["[S]-",e.name]}),Object(x.jsx)("span",{className:"badge badge-dark badge-pill",children:e.cant_total})]},e.id):Object(x.jsxs)("a",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(a){a.preventDefault(),t(e)},children:[Object(x.jsx)("span",{className:"text-truncate text-uppercase text-primary",children:e.name}),Object(x.jsx)("span",{className:"badge badge-dark badge-pill",children:e.cant_total})]},e.id);if(!e.cant_total&&!e.cant)return Object(x.jsxs)("a",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(a){a.preventDefault(),t(e)},children:[Object(x.jsxs)("span",{className:"text-truncate text-uppercase text-danger",children:["[X]-",e.name]}),Object(x.jsx)("span",{className:"badge badge-dark badge-pill",children:e.cant_total})]},e.id);return Object(x.jsxs)("a",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(a){a.preventDefault(),t(e)},children:[Object(x.jsx)("span",{className:"text-truncate text-uppercase text-primary",children:e.name}),Object(x.jsx)("span",{className:"badge badge-dark badge-pill",children:e.cant})]},e.id)}(e,w)}))})}):null]})};var ga=function(e){var t,a=Object(d.useContext)(p).auth,c=e.codeDefault,n=void 0===c?"":c,s=e.cantDefault,l=void 0===s?1:s,o=e.handleAddItem,j=e.handleCloseModal,u=Object(d.useState)({id:0,name:n,cant:l,price:0,out:0,inStorage:0,subtotal:0,store_items_id:0,descripcion:"",category:0}),b=Object(i.a)(u,2),m=b[0],h=b[1],O=Object(d.useState)(!1),f=Object(i.a)(O,2),v=f[0],N=f[1],y=function(){h({id:0,name:"",price:0,out:0,cant:1,inStorage:0,subtotal:0,store_items_id:0,descripcion:"",category:{}}),j()},w=function(e,t){h(Object(r.a)(Object(r.a)({},m),{},Object(g.a)({},e,"descripcion"===e?t:parseInt(t))))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsxs)("h5",{className:"modal-title text-primary text-bold",children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"}),"Agregar producto"]}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return y()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col position-relative",children:Object(x.jsx)(va,{item:m,handleItemSelect:function(e){h(Object(r.a)(Object(r.a)({},m),{},{store_items_id:e.id,id:0,name:e.name.toLowerCase(),price:parseFloat(e.price),out:e.cant_total,cant:1,inStorage:0,subtotal:e.price,descripcion:"",category:e.category}))}})}),m.store_items_id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"col-2",children:[Object(x.jsx)("label",{children:"Cantidad"}),Object(x.jsx)("input",{type:"number",className:"form-control",placeholder:"Cantidad",defaultValue:m.cant,min:"0",max:"100",onChange:function(e){var t=e.target;return w("cant",t.value)}})]}),Object(x.jsxs)("div",{className:"col-3",children:[Object(x.jsx)("label",{children:"Precio"}),Object(x.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Precio",min:"0",value:null!==(t=m.price)&&void 0!==t?t:"",onChange:function(e){var t=e.target;return w("price",t.value)}})]}),v?Object(x.jsx)("div",{className:"col-12 mt-2",children:Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Agregue una descripcion",value:m.descripcion,onChange:function(e){var t=e.target;return w("descripcion",t.value)}})}):null]}):null]})}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:function(){return y()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:function(){return N(!v)},disabled:!m.store_items_id,children:[Object(x.jsx)("i",{className:"fas fa-sticky-note mr-1"}),v?"Cerrar nota":"Abrir nota"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary btn-sm text-bold",disabled:!(m.store_items_id&&m.cant&&m.price),onClick:function(){return function(){if(!X.verifyItem(m))return!1;m.inStorage=m.out>=m.cant,m.out=m.out>=m.cant?0:m.cant-m.out,m.subtotal=parseFloat(m.cant*m.price),m.branch_id=a.branch.id,o(m)}()},children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"}),"Agregar"]})]})})]})})})};function Na(e){var t=Object(d.useState)({itemNew:!1,code:"",cant:1,validItems:!0,showDetails:!0,disabled:!1,total:0}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=function(t,a){var c=e.items.map((function(e){return e.store_items_id===t&&(e.cant=e.cant+a,e.subtotal=e.cant*e.price),e})).filter((function(e){return e.cant>0}));e.changeInput("items",c)};return Object(d.useEffect)((function(){var t=e.items.filter((function(e){var t,a;return["lentes","armazones","lentes de contacto"].includes(null===(t=e.category)||void 0===t||null===(a=t.code)||void 0===a?void 0:a.codeNameCategory[0])})),a=e.items.reduce((function(e,t){return t.cant*t.price+e}),0),s=Boolean(t.length),i=c.disabled,l=c.showDetails;e.hasOwnProperty("showDetails")&&(l=e.showDetails),e.hasOwnProperty("disabled")&&(i=e.disabled),a&&e.changeInput?e.changeInput("validItems",s):e.changeInput||(i=!0,s=!0),n(Object(r.a)(Object(r.a)({},c),{},{validItems:s,showDetails:l,disabled:i,total:a}))}),[e.items,e.disabled]),Object(x.jsxs)("div",{className:e.hasOwnProperty("className")?e.className:"card m-0 p-0",children:[Object(x.jsxs)("div",{className:"card-header",children:[Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-shopping-cart"})," Lista de Productos"]}),Object(x.jsx)("div",{className:"card-tools",children:Boolean(e.session)&&Object(x.jsxs)("button",{className:"btn btn-too btn-primary text-bold",disabled:c.disabled,onClick:function(e){n(Object(r.a)(Object(r.a)({},c),{},{itemNew:!c.itemNew,code:"",cant:1}))},children:[Object(x.jsx)("i",{className:"fas fa-plus mr-1"})," Agregar"]})})]}),Object(x.jsxs)("div",{className:"card-body table-responsive p-0",children:[Object(x.jsxs)("table",{className:"table table-sm m-0",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[c.showDetails&&Object(x.jsx)("th",{style:{width:80},children:"\xa0"}),Object(x.jsx)("th",{scope:"col",style:{width:32},children:"cant"}),Object(x.jsx)("th",{scope:"col",children:"Descripcion"}),c.showDetails&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("th",{scope:"col",className:"text-right",style:{width:120},children:"Precio"}),Object(x.jsx)("th",{scope:"col",className:"text-right",style:{width:120},children:"Subtotal"}),Object(x.jsx)("th",{scope:"col",style:{minWidth:"4rem",maxWidth:"8rem"},children:Object(x.jsx)("span",{className:"sr-only",children:"acciones"})})]})]})}),Object(x.jsxs)("tbody",{children:[e.items.map((function(t){return Object(x.jsxs)("tr",{children:[c.showDetails&&Object(x.jsxs)("td",{children:[0===t.cant||c.disabled?Object(x.jsx)("i",{className:"fas fa-minus mr-2 text-muted mr-1"}):Object(x.jsx)("i",{className:"fas fa-minus mr-2 text-primary mr-1",title:"Quitar",style:{cursor:"pointer"},onClick:function(){return s(t.store_items_id,-1)}}),c.disabled?Object(x.jsx)("i",{className:"fas fa-plus mr-2 text-muted mr-1"}):Object(x.jsx)("i",{className:"fas fa-plus mr-2 text-primary mr-1",title:"Agregar",style:{cursor:"pointer"},disabled:c.disabled,onClick:function(){return s(t.store_items_id,1)}})]}),Object(x.jsx)("th",{scope:"row",className:"text-right",children:t.cant}),Object(x.jsxs)("td",{children:[Object(x.jsx)("span",{className:"text-capitalize",children:t.name}),t.descripcion&&Object(x.jsxs)("span",{className:"text-muted ml-2",children:["(",t.descripcion,")"]}),t.lot&&Object(x.jsxs)("span",{className:"text-muted ml-2",children:["Fac: ",t.lot]})]}),c.showDetails&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("td",{className:"text-right",children:["$ ",parseFloat(t.price).toFixed(2)]}),Object(x.jsxs)("td",{className:"text-right",children:["$ ",t.subtotal.toFixed(2)]}),Object(x.jsx)("td",{className:"d-print-none text-right",children:Object(x.jsx)("button",{type:"button",className:"btn btn-sm btn-muted",onClick:function(){return function(t){var a=e.items.filter((function(e){return e.store_items_id!==t}));e.changeInput("items",a)}(t.store_items_id)},disabled:c.disabled,children:Object(x.jsx)("i",{className:"fas fa-trash"})})})]})]},t.store_items_id)})),!e.items.length&&Object(x.jsx)("tr",{className:"",children:Object(x.jsx)("td",{className:"text-center py-2",colSpan:"6",children:Object(x.jsx)("h5",{children:"No hay articulos seleccionados"})})})]}),Boolean(e.items.length&&c.showDetails)&&Object(x.jsx)("tfoot",{children:Object(x.jsxs)("tr",{children:[Object(x.jsxs)("td",{className:"text-right text-lg",colSpan:"5",children:[Object(x.jsx)("span",{className:" mr-2",children:"Total:"}),Object(x.jsxs)("label",{children:["$ ",c.total.toFixed(2)]})]}),Object(x.jsx)("td",{children:"\xa0"})]})})]}),!c.validItems&&Object(x.jsx)("div",{className:"d-flex justify-content-center",children:Object(x.jsxs)("p",{className:"bg-warning w-75 text-center text-md p-2",children:[Object(x.jsx)("i",{className:"fas fa-info mr-2"}),"Debe agregar al menos ",Object(x.jsx)("strong",{children:"1"})," producto a la lista con categoria ",Object(x.jsx)("strong",{children:"lentes"})," o ",Object(x.jsx)("strong",{children:"armazones"}),"."]})})]}),c.itemNew?Object(x.jsx)(ga,{codeDefault:c.code,cantDefault:c.cant,handleAddItem:function(t){if(t&&"object"===typeof t){var a=Object(ue.a)(e.items),s=e.items.findIndex((function(e){return e.store_items_id===t.store_items_id}));if(-1!==s){var i=a[s].price*c.cant;a[s].price===t.price?(a[s].cant=c.cant,a[s].subtotal=i):a.push(t)}else a.push(t);e.changeInput("items",a),n(Object(r.a)(Object(r.a)({},c),{},{itemNew:!1}))}else console.error("[Orus System] The item is corrupt:",t)},handleCloseModal:function(){return n(Object(r.a)(Object(r.a)({},c),{},{itemNew:!1}))}}):null]})}function ya(e){var t=Object(d.useState)({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email",searchEmail:!1}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.col,l=e.email,o=e.handleValidData,j=c.bgColor,u=c.validate,b=c.text,m=c.searchEmail,h=Y(),O=function(e){var t=e.value.replace(/\s/g,"");/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-primary",validate:" border border-primary",text:""})),function(e){h.getContacts({email:e}).then((function(t){t?t.data.length?(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-warning",validate:"border border-warning",text:"El email ".concat(e," ya est\xe1 registrado")})),o("email",!1,e)):o("email",!0,e):console.error("[Orus System] When get data from users:",t)}))}(t)):(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email valido"})),o("email",!1))};return Object(x.jsxs)("div",{className:"col-"+s,children:[l.length?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Email"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text "+j,children:m?Object(x.jsx)("i",{className:"fas fa-spinner"}):Object(x.jsx)("i",{className:"fas fa-at"})})}),Object(x.jsx)("input",{type:"email",className:"form-control"+u,placeholder:"email",name:"email",autoComplete:"off",value:l,onChange:function(t){var a=t.target;return e.onChange(a.value)},onBlur:function(e){var t=e.target;return O(t)},onKeyPress:function(e){var t=e.key,a=e.target;"Enter"===t&&O(a)},required:"required"})]}),u?Object(x.jsx)("small",{className:"text-muted",children:b}):""]})}function wa(e){var t=Object(d.useState)({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un tel\xe9fono"}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.col,l=e.phone,o=e.handleValidData,j=c.bgColor,u=c.validate,b=c.text,m=c.searchEmail,h=function(e){/^\d{10}$/gim.test(e)?(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-primary",validate:" border border-primary",text:""})),o("phone",!0,e)):10!==e.length?(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email valido"})),o("phone",!1)):e.length||(n(Object(r.a)(Object(r.a)({},c),{},{bgColor:"bg-red",validate:" border border-danger",text:"Escriba un telefono valido"})),o("phone",!1))};return Object(x.jsxs)("div",{className:"col-"+s,children:[l.length?Object(x.jsx)("small",{children:Object(x.jsx)("label",{children:"Telefono"})}):Object(x.jsx)("br",{}),Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("div",{className:"input-group-prepend",children:Object(x.jsx)("span",{className:"input-group-text "+j,children:m?Object(x.jsx)("i",{className:"fas fa-spinner"}):Object(x.jsx)("i",{className:"fas fa-phone"})})}),Object(x.jsx)("input",{type:"text",className:"form-control"+u,placeholder:"Tel\xe9fono",name:"phone",autoComplete:"off",value:e.phone,maxLength:"10",onChange:function(t){var a=t.target,c=parseInt(a.value);isNaN(c)?a.value.length||e.onChange(""):e.onChange(c.toString())},onBlur:function(e){var t=e.target;return h(t.value)},onKeyPress:function(e){var t=e.key,a=e.target;"Enter"===t&&h(a.value)}})]}),u?Object(x.jsx)("small",{className:"text-muted",children:b}):""]})}function Ca(e){var t,a,c,n=e.data,s=void 0===n?{}:n,l=e.disabled,o=e.handleRemoveCustomer,j=e.handleUpdateContact,u=e.handleEditor,b=Y(),m=Object(d.useState)({edit:!1,phone:"",email:"",validToSave:!1}),h=Object(i.a)(m,2),O=h[0],p=h[1];return Object(d.useEffect)((function(){var e,t=Object.values(null!==(e=s.phones)&&void 0!==e?e:{}).filter((function(e){return e}));t&&t.length&&s.email?p(Object(r.a)(Object(r.a)({},O),{},{edit:!1,phone:t[0],email:s.email,validToSave:!0})):p(Object(r.a)(Object(r.a)({},O),{},{edit:!0,phone:t[0],email:s.email,validToSave:!1}))}),[]),Object(d.useEffect)((function(){u(O.edit)}),[O.edit]),Object(x.jsxs)("div",{className:"card col-lg-5 mr-5 border border-success",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-user-alt mr-1"}),"Cliente seleccionado",Object(x.jsx)("i",{className:"ml-5 fas fa-check mr-1"})]})}),Object(x.jsxs)("div",{className:"card-body text-lg",children:[Object(x.jsx)("p",{className:"badge badge-success",children:"# ID ".concat(s.id)}),Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("i",{className:"fas fa-user-circle mr-1"}),s.name.toUpperCase()]}),O.edit?Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{children:[Object(x.jsx)(wa,{phone:null!==(t=O.phone)&&void 0!==t?t:"",col:12,onChange:function(e){p(Object(r.a)(Object(r.a)({},O),{},{phone:e}))},handleValidData:function(){var e=arguments.length<=1?void 0:arguments[1];O.email||(e=!1),p(Object(r.a)(Object(r.a)({},O),{},{validToSave:e}))}}),Object(x.jsx)(ya,{email:null!==(a=O.email)&&void 0!==a?a:"",userId:s.id,col:12,onChange:function(e){p(Object(r.a)(Object(r.a)({},O),{},{email:e}))},handleValidData:function(){var e=arguments.length<=1?void 0:arguments[1];O.phone||(e=!1),p(Object(r.a)(Object(r.a)({},O),{},{validToSave:e}))}})]}),Object(x.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[!O.validToSave&&Object(x.jsxs)("button",{className:"btn btn-dark mr-1",disabled:!!O.exam_id,onClick:o,children:[Object(x.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Cambiar"]}),Object(x.jsxs)("button",{className:"btn btn-secondary mr-1",onClick:function(){var e,t=Object.values(null!==(e=s.phones)&&void 0!==e?e:{}).filter((function(e){return e}));p(Object(r.a)(Object(r.a)({},O),{},{edit:!1,phone:t[0],email:s.email}))},disabled:function(){var e;return!Object.values(null!==(e=s.phones)&&void 0!==e?e:{}).filter((function(e){return e})).length||(!s.email||!O.validToSave)}(),children:[Object(x.jsx)("i",{className:"fas fa-ban mr-2"}),"Cancelar"]}),Object(x.jsxs)("button",{className:"btn btn-warning",onClick:function(){if(O.phone)if(O.email){var e={id:s.id,phones:Object(r.a)(Object(r.a)({},s.phones),{},{cell:O.phone}),email:O.email};b.saveContact(e).then((function(t){t?(window.Swal.fire({icon:"success",title:"Paciente actualizado",showConfirmButton:!1,timer:3e3}),j(t),p(Object(r.a)(Object(r.a)({},O),{},{edit:!1,validToSave:!0}))):(console.error("[Orus System] Server error - when save contact data:",s.id,e),window.Swal.fire({icon:"error",title:"Error al almacenar cambios del paciente",showConfirmButton:!0}))}))}else console.error("[Orus System] Fatal error - email not stablish");else console.error("[Orus System] Fatal error - phone not stablish")},disabled:!O.validToSave,children:[Object(x.jsx)("i",{className:"fas fa-save mr-2"}),"Guardar"]})]})]}):Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsxs)("p",{className:"card-text text-truncate",children:[Object(x.jsx)("i",{className:"fas fa-at mr-1"}),null!==(c=O.email)&&void 0!==c?c:"Email no registrado"]}),Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("i",{className:"fas fa-phone-alt mr-1"}),O.phone?O.phone:"Telefono no registrado"]})]}),Object(x.jsx)("div",{children:!O.edit&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("button",{className:"btn btn-secondary",disabled:l,onClick:o,children:[Object(x.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Cambiar"]}),Object(x.jsxs)("button",{className:"btn btn-info ml-1",disabled:l,onClick:function(){return p(Object(r.a)(Object(r.a)({},O),{},{edit:!0}))},children:[Object(x.jsx)("i",{className:"fas fa-edit mr-1"}),"Editar"]})]})})]})]})}function _a(e){var t=e.data,a=e.disabled,c=e.handleRemove,n=e.handleEdit;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"card-text",children:Object(x.jsx)("span",{className:"badge badge-success mr-3 mb-2",children:"# ".concat(t.id)})}),Object(x.jsxs)("p",{className:"font-weight-bold",children:["Creado:"," ",Object(x.jsx)("span",{className:"font-weight-normal",children:D()(t.created_at).fromNow()})]}),Object(x.jsxs)("p",{className:"font-weight-bold",children:["Fecha:"," ",Object(x.jsx)("span",{className:"font-weight-normal",children:D()(t.created_at).format("LL")})]}),Object(x.jsxs)("p",{className:"font-weight-bold",children:["Estatus:"," ",Object(x.jsx)("span",{className:"font-weight-normal",children:t.status?"Completo":"En proceso"})]}),Object(x.jsxs)("div",{children:[Object(x.jsxs)("button",{className:"btn btn-secondary mr-1",disabled:a,onClick:function(){window.Swal.fire({icon:"question",title:"\xbfRealmente desea cambiar el examen?",showConfirmButton:!0,confirmButtonText:"S\xed",showCancelButton:!0,cancelButttonText:"Cancelar"}).then((function(e){e.dismiss||c()}))},children:[Object(x.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Cambiar"]}),Object(x.jsxs)("button",{className:"btn btn-info",disabled:a,onClick:n,children:[Object(x.jsx)("i",{className:"fas fa-edit mr-2"}),"Editar"]})]})]})}function Sa(e){var t=e.exams,a=e.customer_id,c=e.handleClick,n=ct();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"text-secondary text-md",children:"*Seleciona un examen o crea uno nuevo para continuar"}),t.map((function(e){return Object(x.jsx)("div",{className:"border-bottom mb-1 cursor-pointer text-lg",onClick:function(){return c(e)},children:Object(x.jsxs)("p",{className:"card-text",children:[Object(x.jsx)("span",{className:"badge badge-warning mr-3 mb-2",children:"# ".concat(e.id)}),D()(e.created_at).fromNow(),Object(x.jsx)("span",{className:"badge badge-dark ml-3",children:e.status?"Completo":"En proceso"})]})},e.id)})),Object(x.jsxs)("button",{className:"btn btn-primary mt-2 float-right",onClick:function(){var e={contact_id:a};n.saveExam(e).then((function(e){e?(c(e),window.Swal.fire({icon:"success",title:"Examen Creado correctamente",showConfirmButton:!1,timer:3e3})):window.Swal.fire({icon:"error",title:"Error al crear el examen",showConfirmButton:!0})}))},children:[Object(x.jsx)("i",{className:"fas fa-plus mr-2"}),"Nuevo"]})]})}function ka(e){var t=e.data,a=e.handleEdit,c=Object(d.useState)({adicion_media_od:0,adicion_media_oi:0,dpod:0,dpoi:0}),n=Object(i.a)(c,2),s=n[0],l=n[1],o=function(e){var t=e.value,a=e.name;l(Object(r.a)(Object(r.a)({},s),{},Object(g.a)({},a,parseInt(t))))};return Object(d.useEffect)((function(){l(Object(r.a)(Object(r.a)({},s),{},{adicion_media_od:t.adicion_media_od,adicion_media_oi:t.adicion_media_od,dpod:t.adicion_media_od,dpoi:t.adicion_media_od}))}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row text-sm",children:[Object(x.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(x.jsx)("i",{className:"fas fa-eye mr-1"})," Derecho"]}),Object(x.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(x.jsx)("i",{className:"fas fa-eye mr-1"})," Izquierdo"]})]}),Object(x.jsx)("div",{className:"row mt-2 text-sm",children:Object(x.jsx)("div",{className:"col-12 text-center",children:Object(x.jsx)("label",{children:"Adicion media"})})}),Object(x.jsxs)("div",{className:"row mt-2 text-sm",children:[Object(x.jsx)("div",{className:"col-md-6 col-sm-12",children:Object(x.jsx)("input",{type:"text",className:"form-control",value:s.adicion_media_od,name:"adicion_media_od",onChange:o})}),Object(x.jsx)("div",{className:"col-md-6 col-sm-12",children:Object(x.jsx)("input",{type:"text",className:"form-control",value:s.adicion_media_oi,name:"adicion_media_oi",onChange:o})})]}),Object(x.jsx)("div",{className:"row mt-2 text-sm",children:Object(x.jsx)("div",{className:"col-12 text-center",children:Object(x.jsx)("label",{children:"Distancia pupilar"})})}),Object(x.jsxs)("div",{className:"row mt-2",children:[Object(x.jsx)("div",{className:"col-md-6 col-sm-12",children:Object(x.jsx)("input",{type:"text",className:"form-control",value:s.dpod,name:"dpod",onChange:o})}),Object(x.jsx)("div",{className:"col-md-6 col-sm-12",children:Object(x.jsx)("input",{type:"text",className:"form-control",value:s.dpoi,name:"dpoi",onChange:o})})]}),Object(x.jsx)("div",{className:"row mt-2",children:Object(x.jsxs)("div",{className:"col-12 text-right",children:[Object(x.jsxs)("button",{className:"btn btn-secondary mr-1",onClick:a,children:[Object(x.jsx)("i",{className:"fas fa-ban mr-2"}),"Cancelar"]}),Object(x.jsxs)("button",{className:"btn btn-warning",disabled:!0,children:[Object(x.jsx)("i",{className:"fas fa-save mr-2"}),"Guardar"]})]})})]})}function Ea(e){var t=e.data,a=e.customer,c=e.editCustomer,n=e.disabled,s=e.handleSelect,l=e.hanldeRemove,o=Object(d.useState)({exams:[],edit:!1}),j=Object(i.a)(o,2),u=j[0],b=j[1];return Object(d.useEffect)((function(){b(Object(r.a)(Object(r.a)({},u),{},{exams:a.exams}))}),[]),Object(x.jsxs)("div",{className:"card col-lg-5 border border-success",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-notes-medical mr-1"}),"Examen",Boolean(Object.keys(t).length)&&Object(x.jsxs)(x.Fragment,{children:["Seleccionado ",Object(x.jsx)("i",{className:"ml-5 fas fa-check mr-1"})]})]})}),Object(x.jsx)("div",{className:"card-body text-lg",children:c?Object(x.jsxs)("p",{className:"alert alert-warning",children:[Object(x.jsx)("i",{className:"fas fa-info mr-2"}),"Es necesario completar los datos del paciente para continuar."]}):u.edit?Object(x.jsx)(ka,{data:t,handleEdit:function(){return b(Object(r.a)(Object(r.a)({},u),{},{edit:!u.edit}))}}):Object(x.jsx)(x.Fragment,{children:Object.keys(t).length?Object(x.jsx)(_a,{data:t,disabled:n,handleRemove:l,handleEdit:function(){return b(Object(r.a)(Object(r.a)({},u),{},{edit:!u.edit}))}}):Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(Sa,{exams:u.exams,customer_id:a.id,handleClick:s})})})})]})}function Ba(e){var t,a,c=e.data,n=e.disabled,s=e.handleSetDiscount,l=Object(d.useState)({showForm:!1,discount:null,toPaid:0}),o=Object(i.a)(l,2),j=o[0],u=o[1],b=function(){var e=0;if(j.discount){if(j.discount.match(/^[0-9]+$/gm))e=(e=parseInt(j.discount))>c.total?c.total:parseInt(j.discount);else if(j.discount.match(/^[0-9]{1,3}%$/gm)){var t=parseInt(j.discount.replace("%",""))/100;e=t>=1?c.total:parseInt(c.total*t)}s("sale",Object(r.a)(Object(r.a)({},c),{},{discount:e})),u(Object(r.a)(Object(r.a)({},j),{},{showForm:!1}))}else u(Object(r.a)(Object(r.a)({},j),{},{showForm:!1}))};return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"card col-lg-4",children:[Object(x.jsx)("div",{className:"card-header border-primary",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-percent mr-1"}),"Descuento"]})}),Object(x.jsx)("div",{className:"card-body",children:j.showForm?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{className:"ml-1 text-dark my-2",children:'*Escribe la cantidad o el porcentaje con un "%" al final'}),Object(x.jsxs)("div",{className:"form-row",children:[Object(x.jsx)("div",{className:"col-8",children:Object(x.jsx)("input",{value:null!==(t=j.discount)&&void 0!==t?t:"",className:"form-control",type:"text",onChange:function(e){var t=e.target;return u(Object(r.a)(Object(r.a)({},j),{},{discount:t.value}))},onKeyPress:function(e){return"Enter"===e.key&&b()}})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("button",{className:"btn btn-primary",onClick:b,children:j.discount?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"})," Guardar"]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"})," Cancelar"]})})})]})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h5",{className:"font-weight-bold",children:n&&!j.discount?Object(x.jsxs)("span",{className:"text-danger text-sm",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-2"}),"Para aplicar un ",Object(x.jsx)("strong",{children:"descuento"}),", elimine primero los abonos."]}):Object(x.jsxs)(x.Fragment,{children:["Descuento:",Object(x.jsxs)("span",{className:"font-weight-normal ml-2",children:["$ ",null===(a=c.discount)||void 0===a?void 0:a.toFixed(2)]})]})}),Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-sm btn-secondary",disabled:!Boolean(c.discount),onClick:function(){s("sale",Object(r.a)(Object(r.a)({},c),{},{discount:0})),u(Object(r.a)(Object(r.a)({},j),{},{discount:0}))},children:[Object(x.jsx)("i",{className:"fas fa-window-close mr-1"}),"Eliminar"]}),Object(x.jsxs)("button",{className:"btn btn-warning mr-4",disabled:n,onClick:function(){u(Object(r.a)(Object(r.a)({},j),{},{showForm:!0}))},children:[Object(x.jsx)("i",{className:"fas fa-edit mr-1"}),"Editar"]})]})]})})]})})}var Ia=function(e){var t=e.forPaid,a=e.handleClose,c=(e.sale,e.handleSetPayments),n=Object(d.useContext)(y).data,s=Object(d.useState)({id:0,metodopago:1,metodoname:"efectivo",total:0,bank_id:null,details:null,auth:""}),l=Object(i.a)(s,2),o=l[0],j=l[1],u=function(e){var t=e.name,a=e.value,c=e.type,n=a;"number"!==c&&"select-one"!==c||(n=parseFloat(a)),j(Object(r.a)(Object(r.a)({},o),{},Object(g.a)({},t,n)))},b=function(){if(!o.total)return window.Swal.fire({icon:"warning",title:"El total del abono debe ser mayor a 0",showConfirmButton:!1,timer:1500}),!1;if(1!==o.metodopago&&4!==o.metodopago&&0!==o.metodopago){var e,a;if(!o.bank_id)return window.Swal.fire({icon:"warning",title:"Seleccione un banco",showConfirmButton:!1,timer:3e3}),!1;if((null===(e=o.auth)||void 0===e?void 0:e.length)<4)return window.Swal.fire({icon:"warning",title:"Espesifique los ultimos 4 numeros de la tarjeta",showConfirmButton:!1,timer:3e3}),!1;if((null===(a=o.auth)||void 0===a?void 0:a.length)>4)return window.Swal.fire({icon:"warning",title:"Espesifique solamente 4 numeros",showConfirmButton:!1,timer:3e3}),!1}if(4===o.metodopago&&!o.auth)return window.Swal.fire({icon:"warning",title:"Espesifique el numero de autorizaci\xf3n",showConfirmButton:!1,timer:1500}),!1;c(Object(r.a)(Object(r.a)({},o),{},{id:"new".concat(Date.now().toString()),metodoname:Pt.getMethodName(o.metodopago),total:t<o.total?t:o.total}))};return Object(x.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Capture el pago"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return a()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:Object(x.jsxs)("form",{autoComplete:"off",onSubmit:function(e){e.preventDefault(),b()},children:[Object(x.jsx)("div",{className:"row mb-2 bg-gray-light",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("h4",{className:"text-center",children:["Por pagar: ",Object(x.jsxs)("span",{className:"text-success",children:["$ ",t]})]})})}),Object(x.jsxs)("div",{className:"row my-2",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Metodo de pago"}),Object(x.jsxs)("select",{name:"metodopago",className:"custom-select text-uppercase",onChange:function(e){var t=e.target;return u(t)},defaultValue:o.metodopago,children:[Object(x.jsx)("option",{value:"1",children:"Efectivo"}),Object(x.jsx)("option",{value:"2",children:"Tarjeta de debito"}),Object(x.jsx)("option",{value:"3",children:"Tarjeta de credito"}),Object(x.jsx)("option",{value:"4",children:"La marina"}),Object(x.jsx)("option",{value:"5",children:"Cheque"}),Object(x.jsx)("option",{value:"6",children:"Transferencia"}),Object(x.jsx)("option",{value:"0",children:"Otro"})]})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:"Cantidad"}),Object(x.jsx)("input",{type:"number",min:"0",className:"form-control text-right",name:"total",onChange:function(e){var t=e.target;return u(t)},autoFocus:!0})]})]}),1!==o.metodopago?Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsx)("div",{className:"col",children:4!==o.metodopago&&0!==o.metodopago?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Banco"}),Object(x.jsxs)("select",{name:"bank_id",className:"custom-select text-uppercase",onChange:function(e){var t=e.target;return u(t)},children:[Object(x.jsx)("option",{value:"",children:"--Seleccione un banco--"}),n.map((function(e){return"bank"===e.name?Object(x.jsx)("option",{value:e.id,children:e.data},e.id):null}))]})]}):o.metodopago?Object(x.jsx)("h4",{className:"d-bloc text-center mt-4 text-success",children:"LA MARINA"}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("label",{children:"Espesifique"}),Object(x.jsx)("input",{type:"text",name:"details",className:"form-control",onChange:function(e){var t=e.target;return u(t)}})]})}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("label",{children:4!==o.metodopago?"Ultimos 4 digitos":"N. Autorizaci\xf3n"}),Object(x.jsx)("input",{name:"auth",className:"form-control",onChange:function(e){var t=e.target;return u(t)}})]})]}):null,t<o.total?Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("h4",{className:"text-center mt-4",children:1===o.metodopago?Object(x.jsxs)(x.Fragment,{children:["Cambio:",Object(x.jsxs)("span",{className:"ml-2",children:["$ ",o.total-t]})]}):Object(x.jsxs)("span",{className:"text-danger",children:[Object(x.jsx)("i",{className:"fas fa-info-circle mr-2"}),"La cantidad cobrada es mayor al total"]})})})}):null]})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return a()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){return b()},disabled:!o.total,children:[Object(x.jsx)("i",{className:"fas fa-money-bill mr-1"}),"Abonar"]})]})]})})})};function Da(e){var t,a=e.data,c=void 0===a?{}:a,n=e.disabled,s=e.handleSetPayments,l=Object(d.useState)({showModal:!1,amount:0,toPaid:0}),o=Object(i.a)(l,2),j=o[0],u=o[1];return Object(d.useEffect)((function(){!function(){var e,t=null===(e=c.payments)||void 0===e?void 0:e.reduce((function(e,t){return t.total+e}),0),a=(c.subtotal?c.subtotal:c.total)-(null!==t&&void 0!==t?t:0)-c.discount;u(Object(r.a)(Object(r.a)({},j),{},{toPaid:a,amount:null!==t&&void 0!==t?t:0}))}()}),[c.total,c.discount,c.payments,j.showModal]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"card col-lg-8 ml-2",children:[Object(x.jsx)("div",{className:"card-header border-primary",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-money-bill-alt mr-1"}),"Lista de abonos"]})}),Object(x.jsxs)("div",{className:"card-body",children:[null!==(t=c.payments)&&void 0!==t&&t.length?Object(x.jsx)("div",{className:"col-lg-12",children:c.payments.map((function(e,t){return Object(x.jsxs)("div",{className:"row",id:e.id,children:[Object(x.jsx)("div",{className:"col-1",children:t+1}),Object(x.jsx)("div",{className:"col-6 text-uppercase font-weight-bold",children:Object(x.jsxs)("h6",{className:"efectivo"===e.metodoname?"text-success":"text-dark",children:[Object(x.jsx)("span",{className:"text-dark mr-2",children:e.metodoname}),e.auth&&Object(x.jsxs)("span",{className:"text-muted",children:["- ",e.auth]})]})}),Object(x.jsx)("div",{className:"col-3 text-right",children:Object(x.jsxs)("h6",{children:["$",e.total]})}),Object(x.jsx)("div",{className:"col-2 text-right",children:Object(x.jsx)("button",{className:"btn btn-sm btn-muted",id:e.id,onClick:function(){var t=c.payments.filter((function(t){return t.id!==e.id}));s("sale",Object(r.a)(Object(r.a)({},c),{},{payments:t}))},disabled:!Boolean(j.toPaid)||n,children:Object(x.jsx)("i",{className:"fas fa-trash"})})})]},t)}))}):Object(x.jsxs)("h5",{className:"text-center bg-warning",children:[Object(x.jsx)("i",{className:"fas fa-info-circle p-2"}),"No tiene abonos en este pedido"]}),Object(x.jsxs)("div",{className:"card-footer text-right d-flex justify-content-end",children:[Object(x.jsx)("div",{className:"mr-4",children:Object(x.jsxs)("button",{className:"btn btn-success ml-3",onClick:function(){u(Object(r.a)(Object(r.a)({},j),{},{showModal:!0}))},disabled:!Boolean(j.toPaid)||n,children:[Object(x.jsx)("i",{className:"fas fa-money-bill-alt mr-2"}),"Abonar"]})}),Object(x.jsxs)("h4",{className:"mr-4 text-success",children:[Object(x.jsx)("span",{className:"font-weight-bold text-dark mr-2",children:"Abono total:"})," ","$ ",j.amount]}),Object(x.jsxs)("h4",{className:"text-danger",children:[Object(x.jsx)("span",{className:"font-weight-bold text-dark mr-2",children:"Por pagar:"}),"$ ",j.toPaid]})]})]})]}),j.showModal?Object(x.jsx)(Ia,{handleClose:function(){u(Object(r.a)(Object(r.a)({},j),{},{showModal:!1}))},sale:c,forPaid:j.toPaid,handleSetPayments:function(e){var t=c.payments,a=t.findIndex((function(t){return t.metodopago===e.metodopago}));a<0?t.push(e):t[a].total+=e.total,s("sale",Object(r.a)(Object(r.a)({},c),{},{payments:t})),u(Object(r.a)(Object(r.a)({},j),{},{showModal:!1}))}}):null]})}function La(e){var t,a,c,n,s,l=this,o=Object(d.useState)({id:0,contact_id:0,contact:{},exam_id:0,exam:{},examsList:[],items:[],session:fa.getSession(),sale:{total:0,discount:0,payments:[]},print:!1,editCustomer:!1,validItems:!1}),j=Object(i.a)(o,2),u=j[0],b=j[1],m=Object(d.useContext)(Oa),h=xa(),O=function(e,t){if("exam"===e)return t.category_id&&p(t.category_id),void(t.id?b(Object(r.a)(Object(r.a)({},u),{},{exam_id:t.id,exam:t})):b(Object(r.a)(Object(r.a)({},u),{},{exam_id:0,exam:{}})));if("items"!==e)b(Object(r.a)(Object(r.a)({},u),{},Object(g.a)({},e,t)));else{var a=t.reduce((function(e,t){return t.cant*t.price+e}),0);b(Object(r.a)(Object(r.a)({},u),{},{items:t,sale:Object(r.a)(Object(r.a)({},u.sale),{},{total:a})}))}},p=function(e){(0,l.props._getCategory)({id:e})},f=function(e){h.saveOrder(e).then((function(e){var t=e.data;t?window.Swal.fire({icon:"success",title:"Pedido guardado correctamente",showConfirmButton:!1,timer:3e3}).then((function(e){e.dismiss&&b(Object(r.a)(Object(r.a)({},u),{},{id:t.id,sale:{id:t.sale.id,total:t.sale.total,subtotal:t.sale.subtotal,discount:t.sale.descuento,payments:t.sale.payments,paid:t.sale.paid,customer:t.paciente},print:!0}))})):window.Swal.fire({icon:"danger",title:"Error al guardar el pedido",showConfirmButton:!0})}))},v=function(){m.set(Object(r.a)(Object(r.a)({},m),{},{panel:"inbox"}))};return Object(x.jsx)("div",{className:"mainAssitentComponent ",children:Object(x.jsxs)("div",{className:"card card-warning card-outline col-lg-12",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-clipboard-list mr-1"}),"Nuevo Pedido"]})}),Object(x.jsxs)("div",{className:"card-body d-flex justify-content-center col-lg-12",children:[u.contact_id?Object(x.jsx)(Ca,{data:u.contact,handleRemoveCustomer:function(){b({session:fa.getSession(),contact_id:0,contact:{},items:[],exam_id:0,exam:{}})},handleUpdateContact:function(e){return b(Object(r.a)(Object(r.a)({},u),{},{contact:e,editCustomer:!1}))},handleEditor:function(e){return b(Object(r.a)(Object(r.a)({},u),{},{editCustomer:e}))},disabled:Boolean(u.exam_id)}):Object(x.jsx)("div",{className:"form-group col-lg-6",children:Object(x.jsx)(wt,{title:"Paciente",legend:u.contact_id?null:"Busque el paciente por nombre para crearun nuevo pedido",handleContactSelect:function(e){var t;e.id&&b(Object(r.a)(Object(r.a)({},u),{},{contact_id:null!==(t=e.id)&&void 0!==t?t:0,examsList:e.exams.length?e.exams:[],contact:e}))},data:u.contact})}),Boolean(u.contact_id)&&Object(x.jsx)(Ea,{data:u.exam,customer:u.contact,editCustomer:u.editCustomer,disabled:Boolean(u.items.length),handleSelect:function(e){return b(Object(r.a)(Object(r.a)({},u),{},{exam_id:e.id,exam:e}))},hanldeRemove:function(){return b(Object(r.a)(Object(r.a)({},u),{},{exam_id:0,exam:{}}))}})]}),Boolean(u.exam_id)&&Object(x.jsx)("div",{className:"col-lg-10 d-flex align-self-center justify-content-center p-0",children:Object(x.jsx)(Na,{items:null!==(t=u.items)&&void 0!==t?t:[],session:u.session,disabled:Boolean(null===(a=u.sale)||void 0===a||null===(c=a.payments)||void 0===c?void 0:c.length),changeInput:O,className:u.items.length?"card border border-success col-lg-12":"card border border-warning col-lg-12"})}),Boolean(u.items.length)&&u.validItems&&Object(x.jsxs)("div",{className:"col-lg-10 d-flex align-self-center p-0 mt-2",children:[Object(x.jsx)(Ba,{data:null!==(n=u.sale)&&void 0!==n?n:{},handleSetDiscount:O,disabled:function(){var e,t=null===(e=u.sale.payments)||void 0===e?void 0:e.reduce((function(e,t){return t.total+e}),0);return!!u.id||(!!t||!Boolean(u.sale.total-u.sale.discount-t))}()}),Object(x.jsx)(Da,{data:null!==(s=u.sale)&&void 0!==s?s:{},handleSetPayments:O,disabled:Boolean(u.id)})]}),u.print&&Object(x.jsx)(Mt,{data:Object(r.a)(Object(r.a)({},u.sale),{},{items:u.items,order_id:u.id,created_at:u.created_at}),setPrint:function(){return b(Object(r.a)(Object(r.a)({},u),{},{print:!1}))}}),Object(x.jsx)("div",{className:"card col-lg-10 d-flex align-self-center border border-bottom-primary",children:Object(x.jsxs)("div",{className:"card-body text-right",children:[Object(x.jsxs)("button",{className:"btn btn-secondary",onClick:function(){u.contact_id&&!u.id?window.Swal.fire({icon:"question",title:"\xbfRealmente desea cerrar esta venta sin GUARDAR?",showConfirmButton:!0,confirmButtonText:"S\xed",showCancelButton:!0,cancelButttonText:"Cancelar"}).then((function(e){e.dismiss||v()})):v()},children:[Object(x.jsx)("i",{className:u.id?"fas fa-door-open mr-2":"fas fa-ban mr-2"}),u.id?"Cerrar":"Cancelar"]}),u.id?Object(x.jsxs)("button",{className:"btn btn-primary ml-3",onClick:function(){return b(Object(r.a)(Object(r.a)({},u),{},{print:!u.print}))},children:[Object(x.jsx)("i",{className:"fas fa-print mr-2"}),"Imprimir"]}):Object(x.jsxs)("button",{className:"btn btn-warning ml-3",disabled:!(u.items.length&&!u.id&&u.validItems),onClick:function(e){var t,a=0,c=u.items,n=u.exam_id,s=u.session,r=u.contact_id,i=u.sale,l=c.map((function(e){return 4===e.category&&a++,{cant:e.cant,price:e.price,subtotal:e.subtotal,inStorage:e.inStorage,session:s,out:e.out,descripcion:e.descripcion,store_items_id:e.store_items_id}}));if(l.length===a)return window.Swal.fire({title:"Verificacion",text:"No hay productos para procesar en un pedido",icon:"warning",timer:3e3}),!1;var o={session:s,contact_id:r,items:l,sale:{discount:i.discount}};if(i.payments.length){var d=i.payments;d.forEach((function(e){delete e.id,delete e.metodoname})),o.sale.payments=d}n&&(o.exam_id=parseInt(n)),null!==(t=o.sale.payments)&&void 0!==t&&t.length?window.Swal.fire({icon:"question",title:"Esta seguro que desea GUARDAR el pedido?",showConfirmButton:!0,confirmButtonText:"Si",showCancelButton:!0,denyButtonText:"No"}).then((function(e){e.dismiss||f(o)})):window.Swal.fire({icon:"question",title:"\xbfDesea GUARDAR el pedido sin ningun abono?",showConfirmButton:!0,confirmButtonText:"Si",showCancelButton:!0,denyButtonText:"No"}).then((function(e){e.dismiss||f(o)}))},children:[Object(x.jsx)("i",{className:"fas fa-save mr-2"}),"Guardar"]})]})})]})})}function Pa(e){var t=e.status,a=void 0!==t&&t,c=e.lab_id,n=void 0===c?"":c,s=e.lab_order,r=void 0===s?"":s,l=e.handleChange,o={page:1,orderby:"created_at",order:"desc",itemsPage:100,type:1,business:1},j=Object(d.useState)([]),u=Object(i.a)(j,2),b=u[0],m=u[1],h=Object(d.useState)(""),O=Object(i.a)(h,2),p=O[0],f=O[1],v=Y(),g=function(e){e.preventDefault();var t=e.target,a=t.name,c=t.value,n=c;"lab_id"===a&&(n=parseInt(c)),l&&l(a,n)};return Object(d.useEffect)((function(){v.getContacts(o).then((function(e){if(e){m(e.data);var t=e.data.filter((function(e){return e.id===n}));if(!t.length)return null;f(t[0].name)}}))}),[]),Object(x.jsxs)("div",{className:"row m-2",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(x.jsx)("label",{children:"Laboratorio"}),Object(x.jsxs)("select",{className:a>1?"form-control disabled":"form-control",disabled:a>1,name:"lab_id",defaultValue:n,onChange:g,children:[Object(x.jsx)("option",{value:"0",children:0===n?"Seleccione un proveedor":p}),b.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(x.jsx)("label",{children:"Folio"}),Object(x.jsx)("input",{type:"text",className:a>1?"form-control disabled":"form-control",disabled:a>1,name:"lab_order",maxLength:"50",defaultValue:r,onChange:g})]})})]})}function Fa(e){var t=e.status,a=void 0!==t&&t,c=e.bi_box,n=void 0===c?"":c,s=e.bi_details,r=void 0===s?"":s,i=e.handleChange,l=function(e){e.preventDefault();var t=e.target,a=t.name,c=t.value,n=c;"caja"===a&&(n=parseInt(c)),i&&i(a,n)};return Object(x.jsxs)("div",{className:"row m-2",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(x.jsx)("label",{htmlFor:"lab",children:"Caja"}),Object(x.jsx)("input",{type:"number",className:a>2?"form-control disabled":"form-control",disabled:a>2,name:"bi_box",min:"1",defaultValue:n,onChange:l})]})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(x.jsx)("label",{children:"Observaciones"}),Object(x.jsx)("textarea",{name:"bi_details",className:a>2?"form-control disabled":"form-control",disabled:a>2,defaultValue:r,onChange:l})]})})]})}var Ta=function(e){var t,a,c,n,s,l,o,j,u,b,m,h,O,p,f,v=e.exam,N=void 0===v?{}:v,y=e.examEdit,w=void 0!==y&&y,C=e.ChangeInput,_=e._saveExam,S=Object(d.useState)({esferaod:N.esferaod,esferaoi:N.esferaoi,cilindrod:N.cilindrod,cilindroi:N.cilindroi,ejeod:N.ejeod,ejeoi:N.ejeoi,adiciond:N.adiciond,adicioni:N.adicioni,adicion_media_od:N.adicion_media_od,adicion_media_oi:N.adicion_media_oi,dpod:N.dpod,dpoi:N.dpoi,alturaod:N.alturaod,alturaoi:N.alturaoi,lcmarca:N.lcmarca,lcgod:N.lcgod,lcgoi:N.lcgoi}),k=Object(i.a)(S,2),E=k[0],B=k[1],I=function(){C("examEdit",!1)};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("b",{children:["Folio ",Object(x.jsx)("br",{}),"#",N.id]})}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("b",{children:"Fecha:"}),Object(x.jsx)("br",{}),Object(x.jsx)("i",{className:"fas fa-calendar mr-2"}),D()(N.created_at).format("L")]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("b",{children:"Estado:"}),Object(x.jsx)("br",{}),N.estado?Object(x.jsxs)("span",{className:"badge badge-success",children:[Object(x.jsx)("i",{className:"fas fa-check"})," Terminado"]}):Object(x.jsxs)("span",{className:"badge badge-secondary",children:[Object(x.jsx)("i",{className:"fas fa-hourglass"})," Activo"]})]})]}),N.observaciones?Object(x.jsx)("div",{className:"form-group mt-2",children:Object(x.jsxs)("div",{className:"callout callout-info",children:[Object(x.jsxs)("h5",{className:"text-info text-bold",children:[Object(x.jsx)("i",{className:"fas fa-info"})," Observaciones:"]}),N.observaciones]})}):null,Object(x.jsx)("div",{className:"row mt-2",children:Object(x.jsx)("div",{className:"col",children:Object(x.jsx)(ht,{esferaod:null!==(t=E.esferaod)&&void 0!==t?t:0,esferaoi:null!==(a=E.esferaoi)&&void 0!==a?a:0,cilindrod:null!==(c=E.cilindrod)&&void 0!==c?c:0,cilindroi:null!==(n=E.cilindroi)&&void 0!==n?n:0,ejeod:null!==(s=E.ejeod)&&void 0!==s?s:0,ejeoi:null!==(l=E.ejeoi)&&void 0!==l?l:0,adiciond:null!==(o=E.adiciond)&&void 0!==o?o:0,adicioni:null!==(j=E.adicioni)&&void 0!==j?j:0,adicion_media_od:E.adicion_media_od,adicion_media_oi:E.adicion_media_oi,dpod:null!==(u=E.dpod)&&void 0!==u?u:0,dpoi:null!==(b=E.dpoi)&&void 0!==b?b:0,alturaod:null!==(m=E.alturaod)&&void 0!==m?m:0,alturaoi:null!==(h=E.alturaoi)&&void 0!==h?h:0,lcmarca:null!==(O=E.lcmarca)&&void 0!==O?O:0,lcgod:null!==(p=E.lcgod)&&void 0!==p?p:0,lcgoi:null!==(f=E.lcgoi)&&void 0!==f?f:0,readOnly:!w,onChangeInput:function(e,t){var a=Object(r.a)(Object(r.a)({},E),{},Object(g.a)({},e,parseFloat(t)));B(a),C("codes",{})}})})}),w?Object(x.jsx)("div",{className:"text-right mt-2",children:Object(x.jsxs)("div",{className:"btn-group",children:[Object(x.jsxs)("button",{className:"btn btn-default",onClick:I,children:[Object(x.jsx)("i",{className:"fas fa-times mr-1"})," Cerrar"]}),Object(x.jsxs)("button",{className:"btn btn-info",onClick:function(){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de actualizar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Actualizar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||(_({id:N.id,data:E}),I())}))},children:[Object(x.jsx)("i",{className:"fas fa-save mr-1"})," Guardar"]})]})}):null]})};function za(e){var t=e.handleClose,a=e.exam;return Object(x.jsx)("div",{className:"modal d-block",children:Object(x.jsx)("div",{className:"modal-dialog modal-lg",style:{maxWidth:"80%"},role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Examen"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return t()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:Object(x.jsx)("div",{className:"row mt-4 d-print-none",children:a&&a.id?Object(x.jsx)("div",{className:"col pt-6",children:Object(x.jsx)("div",{className:"card",children:Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)("div",{className:"p-0 mailbox-read-message",children:Object(x.jsx)(Ta,{id:a.id,examEdit:!1,exam:a})})})})}):null})}),Object(x.jsx)("div",{className:"modal-footer",children:Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return t()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]})})]})})})}function Va(e){var t=e.handleClose,a=e.sale,c=Object(u.f)(),n=function(){return Pt.getTotal(a.subtotal,a.discount)-Pt.getPagado(a.payments)};return Object(x.jsx)("div",{className:"modal d-block",children:Object(x.jsx)("div",{className:"modal-dialog",role:"document",children:Object(x.jsxs)("div",{className:"modal-content",children:[Object(x.jsxs)("div",{className:"modal-header",children:[Object(x.jsx)("h5",{className:"modal-title",children:"Nota"}),Object(x.jsx)("button",{type:"button",className:"close",onClick:function(){return t()},children:Object(x.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(x.jsx)("div",{className:"modal-body p-2",children:a.id?Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"ml-3 font-weight-bold",children:Object(x.jsxs)("h5",{className:"border-bottom pb-1 mb-2",children:["Resumen de la venta ",Object(x.jsxs)("span",{className:"badge badge-success",children:["#",a.id]})]})}),Object(x.jsxs)("div",{className:"d-flex pl-2",children:[Object(x.jsxs)("div",{className:"col-lg-7",children:[Object(x.jsxs)("h6",{children:["Descuento:",Object(x.jsxs)("span",{className:"text-secondary ml-2 font-weight-normal",children:["$",a.discount]})]}),Object(x.jsxs)("h6",{children:["Subtotal:",Object(x.jsxs)("span",{className:"text-secondary mb-3 ml-2 font-weight-normal",children:["$",a.subtotal]})]}),Object(x.jsxs)("h5",{className:"font-weight-bold",children:["Total:",Object(x.jsxs)("span",{className:"text-info ml-2 font-weight-normal",children:["$",a.total]})]})]}),Object(x.jsxs)("div",{className:"col-lg-6 d-flex flex-column justify-content-center align-items-center pt-4",children:[Object(x.jsxs)("h6",{className:"font-weight-bold",children:["Abonado:",Object(x.jsxs)("span",{className:"text-success ml-2 font-weight-normal",children:["$",Pt.getPagado(a.payments)]})]}),Object(x.jsxs)("h6",{className:"font-weight-bold",children:["Por pagar:",Object(x.jsxs)("span",{className:"text-danger ml-2 font-weight-normal",children:["$",n()]})]})]})]}),0===n()?Object(x.jsx)("h5",{className:"text-center bg-success p-1",children:"$ Cuenta pagada"}):null]}):Object(x.jsx)("p",{children:"No hay un nota para mostrar!!"})}),Object(x.jsxs)("div",{className:"modal-footer",children:[Object(x.jsxs)("button",{type:"button",className:"btn btn-default",onClick:function(){return t()},children:[Object(x.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(x.jsxs)("button",{className:"btn btn-info",onClick:function(){return c.push("/notas/".concat(a.id))},children:[Object(x.jsx)("i",{className:"fas fa-money-bill-alt mr-2"}),"Editar nota"]})]})]})})})}function Aa(e){var t,a,c,n=Object(d.useState)({id:0,paciente:{},session:null,lab_id:0,lab_order:"",bi_details:"",bi_box:0,items:[],sale:{},exam:{},codes:{},status:0,created:{},created_at:null,updated:{},updated_at:null,print:!1,statusInitial:0}),s=Object(i.a)(n,2),l=s[0],o=s[1],j=Object(d.useState)(!1),b=Object(i.a)(j,2),m=b[0],h=b[1],O=Object(d.useState)(!1),f=Object(i.a)(O,2),v=f[0],N=f[1],y=l.id,w=l.paciente,C=l.lab_id,_=l.lab_order,S=l.bi_box,k=l.bi_details,E=l.items,B=l.exam,I=void 0===B?{}:B,L=l.status,P=l.created_at,T=xa(),z=Object(d.useContext)(p).auth.roles,V=Object(u.f)(),A=Object(d.useContext)(Oa),M=e.loading,U=new Date(null!==(t=w.birthday)&&void 0!==t?t:"")<new Date?D()(w.birthday):null,R=Object.values(null!==(a=w.phones)&&void 0!==a?a:{}).filter((function(e){return e})),q=function(e){T.saveOrder(e).then((function(e){e?(window.Swal.fire({title:"Estado guardado correctamente",icon:"success",showCancelButton:!1,showConfirmButton:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar",timer:3e3}),A.set(Object(r.a)(Object(r.a)({},A),{},{panel:"inbox"})),V.push("/pedidos")):window.Swal.fire({title:"Error al actualizar el estado",icon:"error",showCancelButton:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar"})}))},Y=function(e,t){o(Object(r.a)(Object(r.a)({},l),{},Object(g.a)({},e,t)))};return Object(d.useEffect)((function(){var t=e.match.params.id;console.log("[Orus System] Loading order:",t),T.getOrder(t).then((function(e){var t=e.data;if(t){var a,c,n,s,r,i,l,d,j,u,b,m,h,O,x,p,f={id:null!==(a=t.id)&&void 0!==a?a:0,paciente:null!==(c=t.paciente)&&void 0!==c?c:{},session:null!==(n=t.session)&&void 0!==n?n:null,lab_id:t.lab?t.lab.id:0,lab_order:null!==(s=t.lab_order)&&void 0!==s?s:"",bi_details:null!==(r=t.bi_details)&&void 0!==r?r:"",bi_box:null!==(i=t.bi_box)&&void 0!==i?i:0,items:null!==(l=t.items)&&void 0!==l?l:[],exam:null!==(d=t.exam)&&void 0!==d?d:{},codes:null!==(j=t.codes)&&void 0!==j?j:{},status:null!==(u=t.status)&&void 0!==u?u:0,created:null!==(b=t.created)&&void 0!==b?b:{},created_at:null!==(m=t.created_at)&&void 0!==m?m:null,updated:null!==(h=t.updated)&&void 0!==h?h:{},updated_at:null!==(O=t.updated_at)&&void 0!==O?O:null,contact_id:t.paciente.id,activitys:null!==(x=t.activity)&&void 0!==x?x:[],statusInitial:null!==(p=t.status)&&void 0!==p?p:0,sale:{}};t.sale&&(f.sale={id:t.sale.id,total:t.sale.total,subtotal:t.sale.subtotal,session:t.sale.session,payments:t.sale.payments,paid:t.sale.paid,discount:t.sale.descuento,customer:t.paciente}),console.log("[DEBUG] items:",f.items),o(f)}else console.error("Error al obtener los datos")}))}),[y]),Object(x.jsxs)(x.Fragment,{children:[l?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"card card-warning card-outline d-print-none",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title w-100",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-clipboard-list"}),"Pedido",Object(x.jsxs)("span",{className:"ml-1 badge badge-pill badge-warning",children:["#",y]}),Object(x.jsxs)("span",{className:"float-right mailbox-read-time mt-1 text-dark",children:["Pedido registrado ",D()(P).fromNow()]})]})}),Object(x.jsxs)("div",{className:"p-0 card-body d-flex p-3",children:[Object(x.jsxs)("div",{className:"pl-3 col-lg-6",children:[Object(x.jsxs)("h6",{className:"d-flex mb-2",children:[Object(x.jsx)("i",{className:"mr-2 fas fa-user"}),Object(x.jsx)("span",{className:"text-capitalize m-0 text-secondary",children:w.name})]}),w.email?Object(x.jsxs)("h6",{className:"mb-2",children:[Object(x.jsx)("i",{className:"mr-2 fas fa-envelope"}),Object(x.jsx)("span",{className:"text-muted",children:w.email})]}):Object(x.jsxs)("h6",{className:"mb-2",children:[Object(x.jsx)("i",{className:"mr-2 fas fa-envelope"}),Object(x.jsx)("span",{className:"text-muted",children:"Email no registrado"})]}),R.length?Object(x.jsxs)("h6",{className:"mb-2",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-phone"}),Object(x.jsx)("span",{className:"mx-1 text-muted",children:R.join(" ")})]}):Object(x.jsxs)("h6",{className:"mb-2",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-phone"}),Object(x.jsx)("span",{className:"text-muted",children:"Telefonos no registrado"})]}),"admin"===z?Object(x.jsxs)("span",{className:"mailbox-read-time",children:["Fecha de nacimiento:"," ",U?Object(x.jsxs)(x.Fragment,{children:[U.format("LL"),Object(x.jsxs)("label",{className:"ml-1",children:["(",D()().diff(U,"years")," a\xf1os)"]})]}):"NO REGISTRADO"]}):null]}),Object(x.jsxs)("div",{className:"col-lg-6 d-flex flex-column justify-content-center align-items-center",children:[Object(x.jsx)("div",{className:"w-75 d-flex flex-column justify-content-center align-items-center",children:Object(x.jsx)("div",{className:"btn-group",children:l.nota&&!l.nota.id?Object(x.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Eliminar",onClick:function(){window.Swal.fire({title:"\xbfEst\xe1s seguro de eliminar la orden?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar"}).then((function(e){e.dismiss||(T.deleteOrder(y),window.Swal.fire({icon:"success",title:"Orden eliminada correctamente",showConfirmButton:!1,timer:3e3}),A.set(Object(r.a)(Object(r.a)({},A),{},{panel:"inbox"})))}))},children:Object(x.jsx)("i",{className:"far fa-trash-alt"})}):null})}),Object(x.jsx)("div",{className:"w-75 d-flex flex-column justify-content-center align-items-center",children:Object(x.jsxs)("div",{className:"mt-3 ",children:[Object(x.jsxs)("button",{className:"btn btn-info mr-1",onClick:function(){return h(!0)},disabled:!Object.keys(I).length,children:[Object.keys(I).length?"Ver examen":"Sin examen asignado",Object(x.jsx)("i",{className:"fas fa-eye ml-1"})]}),Object(x.jsxs)("button",{className:"btn btn-primary mr-1",onClick:function(){return N(!0)},children:["Ver Nota",Object(x.jsx)("i",{className:"fas fa-money-bill ml-1"})]}),Object(x.jsxs)("button",{className:"btn btn-secondary",onClick:function(){return o(Object(r.a)(Object(r.a)({},l),{},{print:!0}))},children:["Imprimir",Object(x.jsx)("i",{className:"fas fa-print ml-1"})]})]})})]})]})]}),Object(x.jsxs)("div",{className:"row mt-4 mb-4",children:[Object(x.jsxs)("div",{className:"col-lg-4 col-md-6 col-sm-12 d-print-none",children:[Object(x.jsx)("h6",{className:"w-100 d-block font-weight-bold",children:"Estado"}),Object(x.jsxs)("div",{className:"card mt-2",children:[Object(x.jsx)("div",{className:"btn-group-vertical",children:qe.getStatusType.map((function(e,t){return Object(x.jsx)("button",{type:"button",className:L===t?"btn btn-primary btn-sm text-capitalize text-bold":"btn btn-default btn-sm text-capitalize",onClick:function(e){o(Object(r.a)(Object(r.a)({},l),{},{status:t}))},children:e},t)}))}),M?Object(x.jsx)("div",{className:"overlay dark",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]}),Object(x.jsxs)("div",{className:"mt-3 d-flex justify-content-center",children:[Object(x.jsxs)("button",{className:"btn btn-secondary mr-2",onClick:function(e){return A.set(Object(r.a)(Object(r.a)({},A),{},{panel:"inbox"})),void V.push("/pedidos")},children:["Cerrar",Object(x.jsx)("i",{className:"mr-1 fas fa-door-open ml-2"})]}),Object(x.jsxs)("button",{className:"btn btn-warning",onClick:function(){var e=l.id,t=l.lab_order,a=l.bi_box,c=l.status,n=l.lab_id,s=l.bi_details;return 0===c?null:1===c&&!n&&toString(t).length?(window.Swal.fire("Verificaci\xf3n","Verifique los campos de laboratorio","error"),!1):(1===c&&q({id:e,status:c,lab_id:n,lab_order:t}),2!==c||a?(2===c&&q({id:e,status:c,bi_box:a,bi_details:s}),void(c>=3&&q({id:e,status:c}))):(window.Swal.fire("Verificaci\xf3n","El numero de caja esta vacio","error"),!1))},children:["Guardar",Object(x.jsx)("i",{className:"mr-1 fas fa-save ml-2"})]})]})]}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("div",{className:"card h-100 m-0",children:[Object(x.jsx)("div",{className:"card-header d-print-none",children:Object(x.jsxs)("h5",{className:"card-title w-100 d-block mb-2 text-capitalize text-bold",children:[Object(x.jsx)("i",{className:"fas fa-shield-alt mr-1"}),qe.handleStatusString(L)]})}),Object(x.jsx)("div",{className:"card-body p-0",children:Object(x.jsxs)("div",{className:"p-0 mailbox-read-message m-0",children:[!Boolean(L)&&Object(x.jsx)(Na,{items:E}),1===L?Object(x.jsx)(Pa,{lab_id:C,lab_order:_,status:L,handleChange:Y}):null,2===L?Object(x.jsx)(Fa,{bi_box:S,bi_details:k,status:L,handleChange:Y}):null,L>=3?Object(x.jsx)("div",{className:"px-2",children:Object(x.jsx)("div",{className:"my-2 border rounded card border-warning d-print-none",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:"Estado de la entrega"}),Object(x.jsxs)("div",{className:"ml-1 icheck-success d-inline",children:[Object(x.jsx)("input",{type:"checkbox",checked:3!==L,id:"checkboxSuccess1",onChange:function(e){return Y("status",3===L?4:3)}}),Object(x.jsx)("label",{htmlFor:"checkboxSuccess1"})]})]})})}):null]})}),M?Object(x.jsx)("div",{className:"overlay dark d-print-none",children:Object(x.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})})]}),m?Object(x.jsx)(za,{handleClose:function(){return h(!1)},exam:l.exam}):null,v?Object(x.jsx)(Va,{handleClose:function(){return N(!1)},sale:l.sale}):null]}):null,l.print&&Object(x.jsx)(Mt,{data:Object(r.a)(Object(r.a)({},l.sale),{},{items:l.items,order_id:l.id,created_at:l.created_at}),setPrint:function(){return o(Object(r.a)(Object(r.a)({},l),{},{print:!1}))}}),Object(x.jsx)(F,{data:null!==(c=l.activitys)&&void 0!==c?c:[]})]})}function Ma(e){var t=e.table,a=e.idRow,c=function(){var e=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O("messengers",null,t),e.next=3,h(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return a=O("messengers"),e.next=4,h(a,"POST",t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getMessages:e,sendMessenger:t}}(),n=Object(d.useContext)(p).idUser,l=Object(d.useState)({messages:[],user:"",load:!0,message:""}),j=Object(i.a)(l,2),u=j[0],b=j[1],m=function(){var e=u.message,n={table:t,idRow:a,message:e};b(Object(r.a)(Object(r.a)({},u),{},{load:!0,message:""})),c.sendMessenger(n).then((function(t){b(t?Object(r.a)(Object(r.a)({},u),{},{messages:[t.data].concat(Object(ue.a)(u.messages)),message:"",load:!1}):Object(r.a)(Object(r.a)({},u),{},{load:!1,message:e}))})).catch((function(t){b(Object(r.a)(Object(r.a)({},u),{},{load:!1,message:e}))}))};return Object(d.useEffect)((function(){!function(){var e={table:t,idRow:a};c.getMessages(e).then((function(e){e.data&&b(Object(r.a)(Object(r.a)({},u),{},{messages:e.data,user:n,load:!1}))}))}()}),[]),Object(x.jsxs)("div",{className:"card direct-chat direct-chat-primary d-print-none",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("h3",{className:"card-title",children:[Object(x.jsx)("i",{className:"fas fa-comments mr-1"}),"Chat",Object(x.jsx)("span",{className:"badge badge-pill badge-secondary ml-1",children:a})]})}),u.load?Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)("div",{className:"card-text text-center p-4",children:Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})})})}):u.messages.length?Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)("div",{className:"direct-chat-messages",id:"boxchat",children:u.messages.map((function(e){var t="/img/avatars/avatar5.png";return 1===e.created_user.rol&&(t="/img/avatars/avatar2.png"),e.created_user.rol||(t="/img/avatars/avatar3.png"),2===e.created_user.id&&(t="/img/avatars/avatar4.png"),Object(x.jsxs)("div",{className:e.created_user.id===u.user?"direct-chat-msg right":"direct-chat-msg",children:[Object(x.jsxs)("div",{className:"direct-chat-infos clearfix",children:[Object(x.jsx)("span",{className:e.created_user.id===u.user?"direct-chat-name float-right":"direct-chat-name float-left",children:e.created_user.name}),Object(x.jsx)("span",{className:e.created_user.id===u.user?"direct-chat-timestamp float-left":"direct-chat-timestamp float-right",children:D()(e.updated_at).format("lll")})]}),Object(x.jsx)("img",{className:"direct-chat-img",src:1===e.created_user.id?"/img/avatars/OrusBot.png":t,alt:"message user image1"}),Object(x.jsx)("div",{className:"direct-chat-text",children:e.mensaje})]},e.id)}))})})}):Object(x.jsx)("div",{className:"card-body",children:Object(x.jsx)("div",{className:"card-text text-center p-4",children:Object(x.jsxs)("h5",{children:[Object(x.jsx)("i",{className:"fas fa-comment-slash mr-1"}),"No hay mensajes aun"]})})}),Object(x.jsx)("div",{className:"card-footer",children:Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("input",{type:"text",name:"message",placeholder:"Escriba un mensaje ...",className:"form-control",value:u.message,onChange:function(e){b(Object(r.a)(Object(r.a)({},u),{},{message:e.target.value}))},onKeyPress:function(e){"Enter"===e.key&&m()}}),Object(x.jsx)("span",{className:"input-group-append",children:Object(x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:m,disabled:!(u.message.length>1),children:"Enviar"})})]})})]})}function Ua(){var e=Object(d.useContext)(Oa),t=e.options,a=Object(u.h)().id,c=function(a){var c=a.target,n=c.value,s=c.name;e.set(Object(r.a)(Object(r.a)({},e),{},{options:Object(r.a)(Object(r.a)({},t),{},Object(g.a)({},s,n))}))};return Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col-md-12 col-sm-12 d-print-none",children:[Object(x.jsxs)("a",{href:"#new",className:["edit","newOrder"].includes(e.panel)?"disabled mb-3 btn btn-secondary btn-block":"mb-3 btn btn-warning btn-block",onClick:function(t){t.preventDefault(),e.set(Object(r.a)(Object(r.a)({},e),{},{panel:"newOrder"}))},disabled:!!["edit","newOrder"].includes(e.panel),children:[Object(x.jsx)("i",{className:"mr-2 fas fa-plus"}),"Pedido nuevo"]}),"inbox"===e.panel&&Object(x.jsx)(M,{title:"Filtros",children:"inbox"===e.panel?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item",children:"\xa0"}),Object(x.jsxs)("li",{className:"p-2 nav-item",children:[Object(x.jsx)("label",{htmlFor:"status",children:"Estado del pedido"}),Object(x.jsxs)("select",{className:"form-control",name:"status",id:"status",value:t.status,onChange:c,children:[Object(x.jsx)("option",{value:"",children:"-- Todos --"}),Object(x.jsx)("option",{value:"0",children:"En proceso"}),Object(x.jsx)("option",{value:"1",children:"Laboratorio"}),Object(x.jsx)("option",{value:"2",children:"Bicelaci\xf3n"}),Object(x.jsx)("option",{value:"3",children:"Terminado"}),Object(x.jsx)("option",{value:"4",children:"Entregado"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:t.orderby,onChange:c,children:[Object(x.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(x.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(x.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:t.order,onChange:c,children:[Object(x.jsx)("option",{value:"asc",children:"Antiguos"}),Object(x.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(x.jsxs)("li",{className:"nav-item p-2",children:[Object(x.jsx)("label",{htmlFor:"itemsPage",children:"Numero de pedidos"}),Object(x.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:t.itemsPage,onChange:c,children:[Object(x.jsx)("option",{value:"25",children:"ver 25"}),Object(x.jsx)("option",{value:"50",children:"ver 50"}),Object(x.jsx)("option",{value:"75",children:"ver 75"}),Object(x.jsx)("option",{value:"100",children:"ver 100"})]})]})]}):null}),"edit"===e.panel&&Object(x.jsx)(Ma,{table:"orders",idRow:a})]})})}var Ra={page:1,orderby:"created_at",order:"desc",itemsPage:25,status:"",search:""};function qa(e){var t=Object(d.useState)({panel:null,options:Ra,order:{}}),a=Object(i.a)(t,2),c=a[0],n=a[1],s=e.match.params.id;return Object(d.useEffect)((function(){n(Object(r.a)(Object(r.a)({},c),{},{panel:s?"edit":"inbox"}))}),[s]),Object(x.jsx)(Oa.Provider,{value:Object(r.a)(Object(r.a)({},c),{},{set:n}),children:Object(x.jsxs)("div",{className:"row",style:{minHeight:"100vh"},children:[Object(x.jsx)("div",{className:"col-sm-12 col-md-2",children:Object(x.jsx)(Ua,{})}),Object(x.jsxs)("div",{className:"col-sm-12 col-md-10",children:["inbox"===c.panel&&Object(x.jsx)(pa,{}),"newOrder"===c.panel&&Object(x.jsx)(La,Object(r.a)({},e)),"edit"===c.panel&&Object(x.jsx)(Aa,Object(r.a)({},e))]})]})})}function Ya(){var e,t=Object(d.useContext)(p),a=t.auth,c=t.getNotifications,s=t.setNotifications,l=Object(d.useState)({notifications:[],loading:!0,mainRole:a.roles}),o=Object(i.a)(l,2),j=o[0],u=o[1],b=j.notifications,m=j.loading,h=j.mainRole,O=b?b.length:0,f=b.slice(0,10),v=function(){c().then((function(e){u(Object(r.a)(Object(r.a)({},j),{},{notifications:e,loading:!1}))})).catch((function(){u(Object(r.a)(Object(r.a)({},j),{},{loading:!1}))}))},g=function(e,t){-1===t&&e.preventDefault(),s({id:t})};return Object(d.useEffect)((function(){return v(),e=setInterval((function(){console.log("[Orus system] check notifications"),u(Object(r.a)(Object(r.a)({},j),{},{loading:!0})),v()}),6e4),function(){clearInterval(e)}}),[]),Object(x.jsxs)("li",{className:"nav-item dropdown",children:[Object(x.jsx)("a",{className:"nav-link","data-toggle":"dropdown",href:"#end",children:m?Object(x.jsx)("i",{className:"fas fa-spinner fa-spin"}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("i",{className:"far fa-bell"}),O?Object(x.jsx)("span",{className:"badge badge-warning navbar-badge",children:O}):null]})}),Object(x.jsxs)("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right",children:[Object(x.jsxs)("span",{className:"dropdown-header",children:[O," Notificaciones"]}),Object(x.jsx)("div",{className:"dropdown-divider"}),f.map((function(e){var t=e.type.split("\\",3),a="general",c="fa-file",s=D()(e.created_at).fromNow(),r="#end";return"ExamNotification"===t[2]&&("doctor"===h?(a="Examen creado",r="/consultorio/registro/"+e.data.id):(a="Examen actualizado",r="/pedidos/registro"),c="fa-file-alt"),Object(x.jsxs)(n.b,{to:r,className:"dropdown-item",onClick:function(t){g(t,e.id)},children:[Object(x.jsx)("i",{className:"fas "+c+" mr-1"})," ",a,Object(x.jsx)("span",{className:"float-right text-sm text-muted",children:s})]},e.id)})),O?Object(x.jsxs)(d.Fragment,{children:[Object(x.jsx)("div",{className:"dropdown-divider"}),Object(x.jsx)("a",{href:"#end",className:"dropdown-item dropdown-footer",onClick:function(e){e.preventDefault(),g(e,-1)},children:"Marcar todas."})]}):null]})]})}function Ga(){return Object(x.jsxs)("nav",{className:"main-header navbar navbar-expand navbar-dark navbar-lightblue",children:[Object(x.jsx)("ul",{className:"navbar-nav",children:Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)("a",{className:"nav-link","data-widget":"pushmenu",href:"#navbar",role:"button",onClick:function(e){e.preventDefault(),window.$("#body").toggleClass("sidebar-open"),window.$("#body").toggleClass("sidebar-collapse")},children:Object(x.jsx)("i",{className:"fas fa-bars"})})})}),Object(x.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(x.jsxs)("li",{className:"nav-item dropdown",children:[Object(x.jsx)("a",{href:"#end",className:"nav-link","data-toggle":"dropdown",children:Object(x.jsx)("i",{className:"far fa-comments"})}),Object(x.jsxs)("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right",children:[Object(x.jsx)("span",{className:"dropdown-header",children:"Sin comentarios"}),Object(x.jsx)("div",{className:"dropdown-divider"})]})]}),Object(x.jsx)(Ya,{})]})]})}function $a(){var e,t,a,c,n,s,l,o=Object(d.useContext)(p),j=o.auth,b=o.setBranch,m=Object(d.useContext)(y),h=Object(u.g)().pathname.split("/"),O=(h&&h.length?h:["dashboard"]).filter((function(e){return![""].includes(e)}))[0],f=j.branch,v=Object(d.useState)({showChangeBranchs:!1,date:D()().format("LLLL"),branchSelect:f.id}),g=Object(i.a)(v,2),N=g[0],w=g[1],C=null!==(e=null===(t=m.data)||void 0===t?void 0:t.filter((function(e){return"branches"===e.name})))&&void 0!==e?e:[],_=function(){w(Object(r.a)(Object(r.a)({},N),{},{showChangeBranchs:!1}))},S=function(){var e=N.branchSelect;if(_(),!e)return console.error("[Orus System][ERROR] branch id is empty"),void window.location.reload();window.Swal.fire({text:"\xbfRealmente desea cambiarse de sucursal?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(t){t.dismiss||b(e).then((function(e){e?window.location.reload():window.Swal.fire({icon:"error",text:"Lo sentimos, hay un problema de comunicacion con el servidor. Comfirme el IP.",showConfirmButton:!1,timer:3e3,position:"top center"})})).catch((function(e){e&&console.error("[Orus System] When change branch:",e.message)}))}))};return Object(x.jsxs)("div",{className:"content-header",children:[Object(x.jsx)("div",{className:"container-fluid",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("h1",{className:"m-0 text-dark text-capitalize",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-file"})," ",O]})}),Object(x.jsxs)("div",{className:"text-center col",children:[Object(x.jsxs)("small",{className:"p-2 badge badge-secondary text-capitalize",alt:"conectado a",title:"conectado a",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-wifi text-success"}),null===(a=m.server)||void 0===a?void 0:a.host,null!==(c=m.server)&&void 0!==c&&c.port&&"80"!==(null===(n=m.server)||void 0===n?void 0:n.port)?":".concat(null===(s=m.server)||void 0===s?void 0:s.port):null]}),Object(x.jsxs)("small",{className:"p-2 mt-1 ml-1 badge badge-secondary text-capitalize",alt:"Almacenando en",title:"Almacenando en",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-server text-success"}),null!==(l=j.permissions)&&void 0!==l&&l.includes("auth.changeBranch")?Object(x.jsx)("a",{href:"#link",className:"text-white",onClick:function(e){e.preventDefault(),w(Object(r.a)(Object(r.a)({},N),{},{showChangeBranchs:!0}))},children:f.name}):f.name]}),Object(x.jsxs)("small",{className:"p-2 mt-1 ml-2 badge badge-secondary text-capitalize",alt:"Usuario conectado",title:"Usuario conectado",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-user text-info"})," ",j.username]}),N.showChangeBranchs?Object(x.jsx)(He,{title:"Cambiar de sucursal",body:function(){var e=N.branchSelect;return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Seleccione la sucursal"}),Object(x.jsx)("select",{className:"form-control text-capitalize",onChange:function(e){var t=e.target;return w(Object(r.a)(Object(r.a)({},N),{},{branchSelect:parseInt(t.value)}))},defaultValue:null===f||void 0===f?void 0:f.id,children:C.map((function(e){return Object(x.jsx)("option",{value:e.id,children:e.data.name},e.id)}))}),Object(x.jsx)("div",{className:"mt-2 text-right",children:Object(x.jsx)("button",{className:"btn btn-default",type:"button",onClick:S,disabled:e===(null===f||void 0===f?void 0:f.id),children:"Cambiar"})})]})}(),handleCancel:_}):null]}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("h6",{className:"text-right text-muted",children:[Object(x.jsx)("i",{className:"mr-1 fas fa-calendar"})," ",N.date]})})]})}),Object(x.jsx)("hr",{})]})}function Ha(){var e=Object(d.useContext)(p),t=e.auth,a=e.outSession,c="Optica Madero",s=Object(u.g)().pathname.replace("/",""),r="/img/avatars/avatar5.png";return"ventas"===t.roles&&(r="/img/avatars/avatar2.png"),"admin"===t.roles&&(r="/img/avatars/avatar3.png"),2===t.idUser&&(r="/img/avatars/avatar4.png"),Object(x.jsxs)("aside",{className:"main-sidebar sidebar-dark-primary",children:[Object(x.jsxs)(n.b,{to:"/",className:"brand-link",children:[Object(x.jsx)("img",{src:"/img/logo.png",alt:c+" logo ",className:"brand-image img-circle elevation-2",style:{opacity:.8,maxHeight:16}}),Object(x.jsx)("span",{className:"brand-text font-weight-light text-uppercase",children:c})]}),Object(x.jsxs)("div",{className:"sidebar",children:[Object(x.jsxs)("div",{className:"pb-3 mt-3 mb-3 user-panel d-flex",children:[Object(x.jsx)("div",{className:"image",children:Object(x.jsx)("img",{src:r,className:"img-circle elevation-2",alt:t.name})}),Object(x.jsx)("div",{className:"info",children:Object(x.jsxs)("a",{href:"#end",className:"d-block text-capitalize",children:[t.name,Object(x.jsxs)("small",{className:"text-lowercase",children:["(",t.username,")"]}),Object(x.jsx)("br",{}),Object(x.jsx)("span",{className:"badge badge-light",children:"admin"!==t.roles?"ventas"===t.roles?"Ventas":"Optometrista":"Administrador"})]})})]}),Object(x.jsx)("nav",{className:"mt-2",children:Object(x.jsxs)("ul",{className:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false",children:["admin"===t.roles?Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/",className:""===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-tachometer-alt"}),Object(x.jsxs)("p",{children:["Dashboard",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}):null,Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/contactos",className:"contactos"===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-address-book"}),Object(x.jsxs)("p",{children:["Contactos",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/consultorio",className:"consultorio"===s||""===s&&"doctor"===t.roles?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-notes-medical"}),Object(x.jsxs)("p",{children:["Examenes",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),"doctor"!==t.roles?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/pedidos",className:"pedidos"===s||""===s&&"ventas"===t.roles?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-clipboard-list"}),Object(x.jsxs)("p",{children:["Pedidos",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/notas",className:"notas"===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-cash-register"}),Object(x.jsxs)("p",{children:["Ventas",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})})]}):null,"admin"===t.roles?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"almacen"===s?"nav-item has-treeview menu-open":"nav-item has-treeview ",children:Object(x.jsxs)(n.b,{to:"/almacen",className:"almacen"===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-database"}),Object(x.jsxs)("p",{children:["Almacen",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/usuarios",className:"usuarios"===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-user"}),Object(x.jsxs)("p",{children:["Usuarios",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/configuraciones",className:"configuraciones"===s?"nav-link active":"nav-link",children:[Object(x.jsx)("i",{className:"nav-icon fas fa-tools"}),Object(x.jsxs)("p",{children:["Configuraciones",Object(x.jsx)("i",{className:"right fas fa-angle-left"})]})]})})]}):null,Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsxs)(n.b,{to:"/",className:"nav-link",onClick:function(e){e.preventDefault(),window.Swal.fire({title:"Session",text:"\xbfEsta seguro de cerrar la sesion?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Si",cancelButtonText:"Cancelar"}).then((function(e){e.dismiss||(a(),setTimeout((function(){window.location.reload()}),2e3))}))},children:[Object(x.jsx)("i",{className:"nav-icon fas fa-sign-out-alt"}),Object(x.jsx)("p",{children:"Cerrar sesion"})]})})]})})]})]})}function Za(e){var t=e.children,a={};return Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)(Ga,{logOut:function(){},data:a,page:function(){}}),Object(x.jsx)(Ha,{companyName:"company",user:a,page:function(){},logOut:function(){},active:"active"}),Object(x.jsxs)("div",{className:"content-wrapper",children:[Object(x.jsx)($a,{}),Object(x.jsx)("div",{className:"content",children:Object(x.jsx)("div",{className:"container-fluid",children:Object(x.jsx)("div",{className:"row",style:{minHeight:"100vh"},children:Object(x.jsx)("div",{className:"col-lg-12",children:t})})})})]})]})}function Ja(e){var t=e.auth;return Object(x.jsx)(_,{children:Object(x.jsxs)(Za,{children:[Object(x.jsx)(u.a,{exact:!0,path:"/",render:function(e){switch(t.roles){case"doctor":return Object(x.jsx)(Et,Object(r.a)({},e));case"ventas":return Object(x.jsx)(qa,Object(r.a)({},e));default:return Object(x.jsx)(oa,Object(r.a)({},e))}}}),Object(x.jsx)(u.a,{path:"/usuarios/registro/:id?",render:function(e){return Object(x.jsx)(z,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}}),Object(x.jsx)(u.a,{path:"/usuarios/:id?",render:function(e){return Object(x.jsx)(ha,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}}),Object(x.jsx)(u.a,{path:"/almacen/:id?",render:function(e){return Object(x.jsx)(ye,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}}),Object(x.jsx)(u.a,{path:"/contactos/:id?",render:function(e){return Object(x.jsx)(We,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}}),Object(x.jsx)(u.a,{path:"/consultorio/:id?",render:function(e){return Object(x.jsx)(Et,Object(r.a)({},e))}}),Object(x.jsx)(u.a,{path:"/configuraciones",render:function(e){return Object(x.jsx)(Qe,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}}),Object(x.jsx)(u.a,{path:"/pedidos/:id?",render:function(e){return Object(x.jsx)(qa,Object(r.a)({},e))}}),Object(x.jsx)(u.a,{path:"/notas/:id?",render:function(e){return Object(x.jsx)(aa,Object(r.a)(Object(r.a)({},e),{},{page:function(){}}))}})]})})}function Ka(){return Object(x.jsxs)("div",{className:"mx-auto p-4 mt-5 w-50",children:[Object(x.jsx)("h1",{children:"Portal Optica Madero"}),Object(x.jsx)("p",{children:"Para accesar al portal inicia session aqui: "}),Object(x.jsx)("button",{onClick:function(){window.location.href="/login"},type:"button",children:"Acceder"})]})}function Wa(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(u.a,{exact:!0,path:"/",render:function(e){return Object(x.jsx)(Ka,{})}})})}function Xa(){return Object(x.jsx)("div",{className:"container text-center font-weight-bold d-flex justify-content-center mt-5",children:Object(x.jsx)("h1",{children:"404 Not Found"})})}function Qa(){var e,t,a,c=Object(u.f)(),n=Object(d.useContext)(p),s=localStorage.getItem("OrusSystem"),l={protocol:window.location.protocol.replace(":",""),host:window.location.hostname,port:window.location.port},o=s?JSON.parse(s):l,j="".concat(null!==(e=o.protocol+"://")&&void 0!==e?e:"").concat(null!==(t=o.host)&&void 0!==t?t:"").concat(null!==(a=":"+o.port)&&void 0!==a?a:""),b=Object(d.useState)({load:!1,email:"",password:"",txtHost:j,hostShow:!j}),m=Object(i.a)(b,2),h=m[0],O=m[1],f=Object(d.useRef)(),v=Object(d.useRef)(),g=function(){if(!h.email)return window.Swal.fire({icon:"error",text:"El campo de correo electronico es requerido",showConfirmButton:!1,timer:2500,position:"top center"}).then((function(){f.current.focus()}));if(/^@./.test(h.email)){var e=h.email.replace("@","");h.email="".concat(e,"@domain.com")}else if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(h.email))return window.Swal.fire({icon:"error",text:"El usuario debe de ser un correo valido",showConfirmButton:!1,timer:2500,position:"top center"}).then((function(){f.current.focus()}));return["domain.com","opticamadero.com"].includes(h.email.split("@")[1])?h.password?h.password.length<8?window.Swal.fire({icon:"error",text:"El password debe de tener al menos 8 caracteres",showConfirmButton:!1,timer:2500,position:"top center"}).then((function(){v.current.focus()})):(O(Object(r.a)(Object(r.a)({},h),{},{load:!0})),void n.setSession({email:h.email,password:h.password}).then((function(e){if(O(Object(r.a)(Object(r.a)({},h),{},{load:!1})),!e.status){var t,a,n=e.message;if(null!==(t=e.data)&&void 0!==t&&t.errors)n=null===(a=e.data)||void 0===a?void 0:a.errors[Object.keys(e.data.errors)[0]][0];return!n&&e.data&&(n=e.data.message),window.Swal.fire({icon:"error",text:n,showConfirmButton:!1,timer:2500,position:"top center"})}c.push("/")}))):window.Swal.fire({icon:"error",text:"El campo de constrase\xf1a es requerido",showConfirmButton:!1,timer:2500,position:"top center"}).then((function(){v.current.focus()})):window.Swal.fire({icon:"error",text:"El dominio de este correo no es aceptado",showConfirmButton:!1,timer:2500,position:"top center"}).then((function(){O(Object(r.a)(Object(r.a)({},h),{},{email:""}))}))},N=function(e,t){"Enter"===e&&t()},y=function(){var e=h.txtHost;if(!e)return window.Swal.fire({icon:"error",text:"El campo de servidor no puede estar vacio",showConfirmButton:!1,timer:2500,position:"top center"});var t,a,c,n=e.split(":");2===n.length?(c=window.location.protocol.replace(":",""),t=n[0].replace("//",""),a=n[1]):3===n.length?(c=n[0],t=n[1].replace("//",""),a=n[2]):(c=window.location.protocol.replace(":",""),t=window.location.hostname,a=window.location.port),localStorage.setItem("OrusSystem",JSON.stringify(Object(r.a)(Object(r.a)({},o),{},{protocol:c,host:t,port:a,token:""}))),O(Object(r.a)(Object(r.a)({},h),{},{hostShow:!1})),window.Swal.fire({icon:"success",text:"Cambio de servidor exitoso",showConfirmButton:!1,timer:2500,position:"top center"})},w=function(){h.email&&v.current.focus()};return Object(d.useEffect)((function(){var e;null!==(e=n.auth)&&void 0!==e&&e.isLogged&&c.push("/")}),[]),Object(x.jsx)("div",{className:"login-page",children:Object(x.jsxs)("div",{className:"login-box",children:[Object(x.jsx)("div",{className:"login-logo",children:Object(x.jsxs)("a",{href:"#logo",onClick:function(e){return e.preventDefault()},children:[Object(x.jsx)("b",{className:"text-primary",children:"Orus"})," LTE"]})}),Object(x.jsx)("div",{className:"rounded shadow-lg card",children:Object(x.jsxs)("div",{className:"card-body login-card-body",children:[Object(x.jsxs)("p",{className:"login-box-msg text-uppercase",children:[Object(x.jsx)("span",{className:"p-2 badge badge-secondary",children:"Optica Madero"}),Object(x.jsx)("br",{}),Object(x.jsx)("small",{className:"text-muted text-lowercase",children:"<".concat(h.txtHost,">")})]}),Object(x.jsxs)("form",{autoComplete:"off",children:[Object(x.jsxs)("div",{className:"mb-0 input-group",children:[Object(x.jsx)("input",{type:"email",className:"form-control text-lowercase",placeholder:"Correo electonico",onChange:function(e){var t=e.target;return O(Object(r.a)(Object(r.a)({},h),{},{email:t.value.toLowerCase()}))},onKeyPress:function(e){var t=e.key;return N(t,w)},defaultValue:h.email,autoComplete:"false",ref:f,autoFocus:!h.email}),Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("div",{className:"input-group-text",children:Object(x.jsx)("span",{className:"fas fa-user"})})})]}),Object(x.jsxs)("div",{className:"mt-3 input-group",children:[Object(x.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",onChange:function(e){var t=e.target;return O(Object(r.a)(Object(r.a)({},h),{},{password:t.value}))},onKeyPress:function(e){var t=e.key;return N(t,g)},defaultValue:h.password,autoComplete:"false",ref:v,autoFocus:!!h.email&&!h.password}),Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("div",{className:"input-group-text",children:Object(x.jsx)("span",{className:"fas fa-lock"})})})]}),Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"my-3 col-12",children:[Object(x.jsxs)("a",{href:"#tools",onClick:function(e){e.preventDefault(),O(Object(r.a)(Object(r.a)({},h),{},{hostShow:!h.hostShow}))},className:"text-muted",children:[Object(x.jsx)("i",{className:"mx-1 fas fa-wifi"})," Servidor"]}),h.hostShow?Object(x.jsxs)("div",{className:"mb-3 input-group",children:[Object(x.jsx)("input",{type:"text",className:"form-control",placeholder:"Servidor",autoComplete:"off",onChange:function(e){var t=e.target;return O(Object(r.a)(Object(r.a)({},h),{},{txtHost:t.value.toLowerCase()}))},defaultValue:h.txtHost,onKeyPress:function(e){var t=e.key;return N(t,y)}}),Object(x.jsx)("div",{className:"input-group-append",children:Object(x.jsx)("div",{className:"input-group-text",children:Object(x.jsx)("span",{className:"fas fa-server"})})})]}):null]})}),Object(x.jsx)("div",{className:"row",children:Object(x.jsx)("div",{className:"text-center col-12",children:Object(x.jsx)("button",{type:"button",className:h.load?"btn btn-outline-secondary btn-block":"btn btn-primary btn-block",onClick:g,disabled:!!h.load,children:h.load?Object(x.jsx)("div",{className:"spinner-border text-secondary",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})}):"Iniciar session"})})})]})]})})]})})}function ec(){var e=Object(d.useContext)(p).auth;return Object(x.jsxs)(u.c,{children:[Object(x.jsx)(u.a,{path:"/login",render:function(){return Object(x.jsx)(Qa,{})}}),null!==e&&void 0!==e&&e.isLogged?Object(x.jsx)(Ja,{auth:e}):Object(x.jsx)(Wa,{}),Object(x.jsx)(u.a,{component:Xa})]})}function tc(){var e=localStorage.getItem("OrusSystem"),t={protocol:window.location.protocol.replace(":",""),host:window.location.hostname,port:window.location.port},a=e?JSON.parse(e):t;return Object(d.useEffect)((function(){localStorage.setItem("OrusSystem",JSON.stringify(a))}),[]),Object(x.jsx)(n.a,{children:Object(x.jsx)(v,{children:Object(x.jsx)(ec,{})})})}Object(c.render)(Object(x.jsx)(tc,{}),document.getElementById("root"))},30:function(e,t){e.exports={dollarUS:Intl.NumberFormat("en-US",{style:"currency",currency:"USD"})}}},[[163,1,2]]]);
//# sourceMappingURL=main.239f8609.chunk.js.map