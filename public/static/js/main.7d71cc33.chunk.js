(this["webpackJsonporus system"]=this["webpackJsonporus system"]||[]).push([[0],{53:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),c=a(29),r=a(24),o=a(36),i=a(2),l="SAGA_TRY_LOGING",d="SAGA_CHECK_LOGING",j="LOGING_SUCCESS",u="LOGING_ERROR",m="LOGING_DELETE",h="SAGA_GET_NOTIFY",b="SAGA_READ_NOTIFYS",p="GET_NOTIFYS",x=localStorage.getItem("OrusSystem"),O=JSON.parse(x||"{}"),g=O.isLogged,f=void 0!==g&&g,v=O.idUser,N=void 0===v?0:v,y=O.username,w=void 0===y?null:y,S=O.name,C=void 0===S?null:S,_=O.rol,k=void 0===_?null:_,E=O.email,I=void 0===E?null:E,A=O.token,T={isLogged:f,idUser:N,username:w,name:C,rol:k,email:I,token:void 0===A?null:A,errors:{},notifications:[]},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:var a=localStorage.getItem("OrusSystem"),s=t.payload,n=s.data,c=s.token,r={ls:JSON.parse(a||"{}")},o=r.ls,l=void 0===o?{}:o;return l.isLogged=!0,l.idUser=n.id,l.username=n.username,l.name=n.name,l.rol=n.rol,l.email=n.email,l.token=c,localStorage.setItem("OrusSystem",JSON.stringify(l)),console.log("[Orus System] Acceso a sistema exitoso"),Object(i.a)(Object(i.a)({},e),{},{isLogged:!0,idUser:n.id,username:n.username,name:n.name,rol:n.rol,email:n.email,token:c,errors:{}});case m:var d=localStorage.getItem("OrusSystem"),h={ls:JSON.parse(d||"{}")},b=h.ls,x=void 0===b?{}:b;return delete x.isLogged,delete x.idUser,delete x.username,delete x.name,delete x.rol,delete x.email,delete x.token,localStorage.setItem("OrusSystem",JSON.stringify(x)),console.log("[Orus System] Cierre de sistema exitoso"),Object(i.a)(Object(i.a)({},e),{},{isLogged:!1,idUser:0,username:null,name:null,rol:null,email:null,token:null,errors:{}});case u:var O=t.payload;return Object(i.a)(Object(i.a)({},e),{},{errors:O});case p:var g=t.payload;return Object(i.a)(Object(i.a)({},e),{},{notifications:g});default:return Object(i.a)(Object(i.a)({},e),{},{errors:{}})}},L="CHANGE_HOST",F=localStorage.getItem("OrusSystem"),P=JSON.parse(F||"{}"),B=P.port,z=void 0===B?window.location.protocol.toString().replace(":",""):B,M=P.host,U=void 0===M?window.location.hostname:M,G=P.company,R={port:z,host:U,company:void 0===G?"optica madero":G,success:void 0},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:var a=localStorage.getItem("OrusSystem"),s=t.payload,n=s.host,c=void 0===n?window.location.hostname:n,r=s.port,o=void 0===r?window.location.protocol.toString().replace(":",""):r,l={ls:JSON.parse(a||"{}")},d=l.ls,j=void 0===d?{}:d;return console.log("[Orus System] cambiando datos de host:",o,c),j.port=o,j.host=c,localStorage.setItem("OrusSystem",JSON.stringify(j)),Object(i.a)(Object(i.a)({},e),{},{port:o,host:c,success:!0});default:var u=localStorage.getItem("OrusSystem"),m={ls:JSON.parse(u||"{}")},h=m.ls,b=void 0===h?{}:h;return b.port=e.port,b.host=e.host,b.company=e.company,localStorage.setItem("OrusSystem",JSON.stringify(b)),Object(i.a)(Object(i.a)({},e),{},{success:void 0})}},J=a(10),q="SAGA_GET_LIST",$="DELETE_ORDER",H="SAGA_SAVE_ORDER",Z="SAGA_GET_ORDER",X="SET_LIST",W="SET_MESSAGE",Y="SET_ORDER",K="SET_OPTIONS",Q={list:[],metaList:{},order:{id:0},options:{page:1,orderby:"created_at",order:"desc",search:"",status:"",itemsPage:10},messages:[],loading:!1},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(i.a)(Object(i.a)({},e),{},{list:[],metaList:{},order:{id:0},loading:!0});case $:case H:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});case Z:return Object(i.a)(Object(i.a)({},e),{},{list:[],metaList:{},order:{id:0},loading:!0});case X:var a=t.payload;return Object(i.a)(Object(i.a)(Object(i.a)({},e),a.result),{},{order:{id:0},messages:[],loading:!1});case W:var s=t.payload;return Object(i.a)(Object(i.a)({},e),{},{loading:!1,messages:s});case Y:var n=t.payload;return Object(i.a)(Object(i.a)({},e),{},{order:n,messages:[],loading:!1});case K:var c=t.payload;return Object(i.a)(Object(i.a)({},e),{},{options:Object(i.a)(Object(i.a)({},e.options),{},Object(J.a)({page:1},c.key,c.value))});default:return Object(i.a)({},e)}},te={getListOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:q,payload:e}},deleteOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:$,payload:e}},saveOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:H,payload:e}},getOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Z,payload:e}},setListOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:X,payload:e}},setMessageOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:W,payload:e}},setOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Y,payload:e}},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:K,payload:e}}},ae=a(3),se=a.n(ae),ne=a(8),ce=a(13);function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,s=localStorage.getItem("OrusSystem"),n=JSON.parse(s||"{}"),c=n.port,r=void 0===c?window.location.protocol.toString().replace(":",""):c,o=n.host,i=void 0===o?window.location.hostname.toString():o,l=n.token,d=void 0===l?"":l;return fetch("".concat(r,"://").concat(i,"/api/").concat(e),{method:t,body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+d}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function oe(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e,n=null;return t&&(s+="/".concat(t)),Object.keys(a).length&&(n=a=new URLSearchParams(a),s+="?".concat(n)),s}var ie=se.a.mark(le);function le(e){var t,a,s;return se.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,a=oe("orders",null,t),n.next=5,Object(ne.b)(re,a);case 5:return s=n.sent,n.next=8,Object(ne.c)(te.setListOrder({result:{list:s.data,metaList:s.meta}}));case 8:n.next=15;break;case 10:return n.prev=10,n.t0=n.catch(1),console.error("[Orus System] Error en saga/order handleGetList:",n.t0),n.next=15,Object(ne.c)(te.setMessageOrder([]));case 15:case"end":return n.stop()}}),ie,null,[[1,10]])}var de=se.a.mark(je);function je(e){var t,a,s,n,c;return se.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,a=t.id,s=t.options,n="orders/".concat(a),r.next=7,Object(ne.b)(re,n,"DELETE");case 7:if(c=r.sent){r.next=16;break}return console.log("[Orus System] Pedido eliminado con exito",a),r.next=12,Object(ne.c)(te.setMessageOrder([{type:"success",text:"Pedido eliminado con exito"}]));case 12:return r.next=14,Object(ne.c)(te.getListOrder(s));case 14:r.next=20;break;case 16:if(console.error("[Orus System] Fallo al eliminar pedido",c.message),!c.message.indexOf("[SQLSTATE[23000]]")){r.next=20;break}return r.next=20,Object(ne.c)(te.setMessageOrder([{type:"error",text:"No se puede eliminar un pedido que tiene asignada una nota de venta",errnum:"SQL23000"}]));case 20:r.next=27;break;case 22:return r.prev=22,r.t0=r.catch(1),console.error("[Orus System] Error en handledDeleteOrder",r.t0),r.next=27,Object(ne.c)(te.setMessageOrder([{type:"error",text:"al eliminar el pedidos, intentelo mas tarde"}]));case 27:case"end":return r.stop()}}),de,null,[[1,22]])}var ue=se.a.mark(me);function me(e){var t,a,s,n,c,r,o,i,l,d;return se.a.wrap((function(j){for(;;)switch(j.prev=j.next){case 0:return t=e.payload,j.prev=1,a=t.data,s=void 0===a?{}:a,n=t.id,c=void 0===n?null:n,r=t.options,o=void 0===r?{}:r,i=oe("orders",c),l=c?"PUT":"POST",j.next=12,Object(ne.b)(re,i,l,s);case 12:if(!(d=j.sent).message){j.next=15;break}throw new Error(d.message);case 15:return c?console.log("[Orus System] Pedido actualizado con exito: "+c):console.log("[Orus system] Pedido creado con exito",d.data.id),j.next=18,Object(ne.c)(te.setMessageOrder([{type:"success",text:c?"Pedido actualizado con exito":"Pedido almacenado con exito"}]));case 18:return j.next=20,Object(ne.c)(te.getListOrder(o));case 20:j.next=27;break;case 22:return j.prev=22,j.t0=j.catch(1),console.error("[Orus System] Error in handleSaveOrder",j.t0),j.next=27,Object(ne.c)(te.setMessageOrder([{type:"error",text:"al almacenar el pedido, intentelo mas tarde"}]));case 27:case"end":return j.stop()}}),ue,null,[[1,22]])}var he=se.a.mark(be);function be(e){var t,a;return se.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,s.prev=1,s.next=4,Object(ne.b)(re,"orders/".concat(t));case 4:if(!(a=s.sent).data){s.next=10;break}return s.next=8,Object(ne.c)(te.setOrder(a.data));case 8:s.next=11;break;case 10:console.error("[OrusSystem] Error en handleGetOrder",a);case 11:s.next=18;break;case 13:return s.prev=13,s.t0=s.catch(1),console.error("[OrusSystem] Error en saga/order handleGetOrder:",s.t0),s.next=18,Object(ne.c)(te.setMessageOrder([]));case 18:case"end":return s.stop()}}),he,null,[[1,13]])}var pe=se.a.mark(xe);function xe(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de ordenes"),e.next=3,Object(ne.d)(q,le);case 3:return e.next=5,Object(ne.d)($,je);case 5:return e.next=7,Object(ne.d)(H,me);case 7:return e.next=9,Object(ne.d)(Z,be);case 9:case"end":return e.stop()}}),pe)}var Oe=ee,ge="SAGA_GET_LIST_CATEGORIES",fe="SAGA_GET_CATEGORY",ve="SET_LIST_CATEGORY",Ne="SET_MESSAGE_CATEGORY",ye="SET_CATEGORY",we={list:[],metaList:{},messages:[],category:{id:0},loading:!1},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ge:case fe:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});case ve:var a=t.payload;return Object(i.a)(Object(i.a)(Object(i.a)({},e),a.result),{},{messages:[],loading:!1});case Ne:var s=t.payload;return Object(i.a)(Object(i.a)({},e),{},{loading:!1,messages:s});case ye:var n=t.payload;return Object(i.a)(Object(i.a)({},e),{},{loading:!1,category:n});default:return Object(i.a)({},e)}},Ce={getListCategories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ge,payload:e}},getCategory:function(e){return{type:fe,payload:e}},setListCategories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:ve,payload:e}},setCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ye,payload:e}},setMessageCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ne,payload:e}}},_e=se.a.mark(ke);function ke(e){var t,a,s,n,c;return se.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,a=t.options,s=t.id,n=oe("categories",s,a),r.next=7,Object(ne.b)(re,n);case 7:return c=r.sent,r.next=10,Object(ne.c)(Ce.setListCategories({result:{list:c.data,metaList:c.meta}}));case 10:r.next=17;break;case 12:return r.prev=12,r.t0=r.catch(1),console.error("[Orus System] Error en saga/exam getList:",r.t0),r.next=17,Object(ne.c)(Ce.setMessageCategory([]));case 17:case"end":return r.stop()}}),_e,null,[[1,12]])}var Ee=se.a.mark(Ie);function Ie(e){var t,a,s,n,c;return se.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,a=t.id,s=t.title,r.next=6,Object(ne.b)(re,"categories/".concat(a),"GET");case 6:if(!(n=r.sent).data){r.next=14;break}return c=n.data.length?n.data:{},console.log("[DEBUG] in saga [".concat(s,"][").concat(a,"]"),c),r.next=12,Object(ne.c)(Ce.setCategory(c));case 12:r.next=17;break;case 14:return console.error("[Orus System] Error in handle GET Contact",n),r.next=17,Object(ne.c)(Ce.setMessageCategory([{type:"error",text:"al traer datos de contacto en la API"}]));case 17:r.next=24;break;case 19:return r.prev=19,r.t0=r.catch(1),console.error("[Orus System] Error in handle GET Contact",r.t0),r.next=24,Object(ne.c)(Ce.setMessageCategory([{type:"error",text:"al traer datos de contacto, intentelo mas tarde"}]));case 24:case"end":return r.stop()}}),Ee,null,[[1,19]])}var Ae=se.a.mark(Te);function Te(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de categorias"),e.next=3,Object(ne.d)(ge,ke);case 3:return e.next=5,Object(ne.d)(fe,Ie);case 5:case"end":return e.stop()}}),Ae)}var De=Se,Le="SAGA_GET_LIST_STORE",Fe="SET_LIST_STORE",Pe="SET_MESSAGE_STORE",Be={list:[],metaList:{},orderId:0,orderby:"created_at",order:"desc",search:"",page:1,messages:[],loading:!1},ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case Le:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});case Fe:return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},e),a.result),a.options),{},{messages:[],loading:!1});case Pe:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,messages:a});default:return Object(i.a)({},e)}},Me={getListStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Le,payload:e}},setListStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Fe,payload:e}},setMessagesStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Pe,payload:e}}},Ue=se.a.mark(Ge);function Ge(e){var t,a,s;return se.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,a=oe("store",null,t),n.next=5,Object(ne.b)(re,a);case 5:return s=n.sent,n.next=8,Object(ne.c)(Me.setListStore({result:{list:s.data,metaList:s.meta}}));case 8:n.next=15;break;case 10:return n.prev=10,n.t0=n.catch(1),console.error("[Orus System] Error en saga/store handleGetList:",n.t0),n.next=15,Object(ne.c)(Me.setMessagesStore([]));case 15:case"end":return n.stop()}}),Ue,null,[[1,10]])}var Re=se.a.mark(Ve);function Ve(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de store"),e.next=3,Object(ne.d)(Le,Ge);case 3:case"end":return e.stop()}}),Re)}var Je=ze,qe="SET_LIST_CONTACT",$e="SET_MESSAGE_CONTACT",He="SET_CONTACT",Ze="SAGA_GET_LIST_CONTACTS",Xe="SAGA_DELETE_CONTACT",We="SAGA_SAVE_CONTACT",Ye="SAGA_GET_CONTACT",Ke={list:[],metaList:{},contact:{id:0},messages:[],loading:!1},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ze:return Object(i.a)(Object(i.a)({},e),{},{list:[],metaList:{},loading:!0});case Xe:case We:return Object(i.a)(Object(i.a)({},e),{},{contact:{},loading:!0});case Ye:return Object(i.a)(Object(i.a)({},e),{},{loading:!0,contact:{}});case qe:var a=t.payload;return Object(i.a)(Object(i.a)(Object(i.a)({},e),{},{contact:{id:0}},a.result),{},{messages:[],loading:!1});case $e:var s=t.payload;return Object(i.a)(Object(i.a)({},e),{},{loading:!1,messages:s});case He:var n=t.payload;return Object(i.a)(Object(i.a)({},e),{},{loading:!1,contact:n,list:[],metaList:{},messages:[]});default:return Object(i.a)({},e)}},et={getListContacts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ze,payload:e}},deleteContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Xe,payload:e}},saveContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:We,payload:e}},setListContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:qe,payload:e}},setMessageContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:$e,payload:e}},getContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Ye,payload:e}},setContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:He,payload:e}}},tt=se.a.mark(at);function at(e){var t,a,s;return se.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,a=oe("contacts",null,t),n.next=5,Object(ne.b)(re,a,"GET");case 5:if(!(s=n.sent).data){n.next=11;break}return n.next=9,Object(ne.c)(et.setListContact({result:{list:s.data,metaList:s.meta},options:t}));case 9:n.next=13;break;case 11:return n.next=13,Object(ne.c)(et.setMessageContact([{type:"error",text:"al traer datos de contactos en la API"}]));case 13:n.next=20;break;case 15:return n.prev=15,n.t0=n.catch(1),console.error("[Orus System] Error in handle getListOrder",n.t0),n.next=20,Object(ne.c)(et.setMessageContact([{type:"error",text:"al traer datos de contactos, intentelo mas tarde"}]));case 20:case"end":return n.stop()}}),tt,null,[[1,15]])}var st=se.a.mark(nt);function nt(e){var t,a,s,n;return se.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,c.prev=1,a=t.id,s=oe("contacts",a),c.next=6,Object(ne.b)(re,s,"DELETE");case 6:if(n=c.sent){c.next=13;break}return console.log("[Orus System] Contacto eliminado con exito",a),c.next=11,Object(ne.c)(et.setMessageContact([{type:"success",text:"Contacto eliminado con exito"}]));case 11:c.next=21;break;case 13:if(console.error("[Orus System] Fallo al eliminar el contacto",n.message),!n.message.indexOf("[SQLSTATE[23000]]")){c.next=19;break}return c.next=17,Object(ne.c)(et.setMessageContact([{type:"error",text:"No se puede eliminar un contacto que tiene registros",errnum:"SQL23000"}]));case 17:c.next=21;break;case 19:return c.next=21,Object(ne.c)(et.setMessageContact([{type:"error",text:"No se puede eliminar el contacto"}]));case 21:c.next=28;break;case 23:return c.prev=23,c.t0=c.catch(1),console.error("[Orus System] Error in handle delete contact",c.t0),c.next=28,Object(ne.c)(et.setMessageContact([{type:"error",text:"al eliminar el contacto, intentelo mas tarde"}]));case 28:case"end":return c.stop()}}),st,null,[[1,23]])}var ct=se.a.mark(rt);function rt(e){var t,a,s,n,c,r,o,i;return se.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload,l.prev=1,a=t.data,s=void 0===a?{}:a,n=t.id,r=oe("contacts",c=void 0===n?null:n),o=c?"PUT":"POST",l.next=10,Object(ne.b)(re,r,o,s);case 10:if(!(i=l.sent).message||!i.errors){l.next=22;break}if(!i.errors.name){l.next=17;break}return l.next=15,Object(ne.c)(et.setMessageContact([{type:"error",text:i.errors.name[0].replace("name","Nombre")}]));case 15:l.next=20;break;case 17:if(!i.errors.email){l.next=20;break}return l.next=20,Object(ne.c)(et.setMessageContact([{type:"error",text:i.errors.email[0]}]));case 20:l.next=33;break;case 22:if(!i.message){l.next=27;break}return l.next=25,Object(ne.c)(et.setMessageContact([{type:"error",text:"Error en servidor, contacte al administrador: \nResponse [".concat(i.message,"]")}]));case 25:l.next=33;break;case 27:if(!i.data){l.next=33;break}return c?console.log("[Orus System] Contacto actualizado con exito",c):console.log("[Orus system] Contacto creado con exito",i.data.id),l.next=31,Object(ne.c)(et.setMessageContact([{type:"success",text:c?"Contacto actualizado con exito":"Contacto almacenado con exito"}]));case 31:return l.next=33,Object(ne.c)(et.setContact(i.data));case 33:l.next=40;break;case 35:return l.prev=35,l.t0=l.catch(1),console.error("[OrusSystem] Error in handle save contact --",l.t0),l.next=40,Object(ne.c)(et.setMessageContact([{type:"error",text:"En el servidor al almacenar el contacto, intentelo mas tarde"}]));case 40:case"end":return l.stop()}}),ct,null,[[1,35]])}var ot=se.a.mark(it);function it(e){var t,a;return se.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,s.prev=1,s.next=4,Object(ne.b)(re,"contacts/".concat(t),"GET");case 4:if(!(a=s.sent).data){s.next=10;break}return s.next=8,Object(ne.c)(et.setContact(a.data));case 8:s.next=13;break;case 10:return console.error("[Orus System] Error in handle GET Contact",a),s.next=13,Object(ne.c)(et.setMessageContact([{type:"error",text:"al traer datos de contacto en la API"}]));case 13:s.next=20;break;case 15:return s.prev=15,s.t0=s.catch(1),console.error("[Orus System] Error in handle GET Contact",s.t0),s.next=20,Object(ne.c)(et.setMessageContact([{type:"error",text:"al traer datos de contacto, intentelo mas tarde"}]));case 20:case"end":return s.stop()}}),ot,null,[[1,15]])}var lt=se.a.mark(dt);function dt(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de contacto"),e.next=3,Object(ne.d)(Ze,at);case 3:return e.next=5,Object(ne.d)(Xe,nt);case 5:return e.next=7,Object(ne.d)(We,rt);case 7:return e.next=9,Object(ne.d)(Ye,it);case 9:case"end":return e.stop()}}),lt)}var jt=Qe,ut="SAGA_GET_LIST_EXAM",mt="SAGA_DELETE_EXAM",ht="SAGA_SAVE_EXAM",bt="SAGA_GET_EXAM",pt="SET_LIST_EXAM",xt="SET_EXAM",Ot="SET_MESSAGE_EXAM",gt={list:[],metaList:{},messages:[],exam:{id:0},loading:!1},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case ut:case bt:case mt:case ht:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});case pt:return Object(i.a)(Object(i.a)(Object(i.a)({},e),{},{exam:{id:0}},a.result),{},{messages:[],loading:!1});case Ot:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,messages:a});case xt:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,exam:a});default:return Object(i.a)({},e)}},vt={getListExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ut,payload:e}},setListExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:pt,payload:e}},setMessagesExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:Ot,payload:e}},deleteExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:mt,payload:e}},saveExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ht,payload:e}},getExam:function(e){return{type:bt,payload:e}},setExam:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:xt,payload:e}}},Nt=se.a.mark(yt);function yt(e){var t,a,s;return se.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,a=oe("exams",null,t),n.next=5,Object(ne.b)(re,a);case 5:return s=n.sent,n.next=8,Object(ne.c)(vt.setListExam({result:{list:s.data,metaList:s.meta}}));case 8:n.next=15;break;case 10:return n.prev=10,n.t0=n.catch(1),console.error("[Orus System] Error en saga/exam getList:",n.t0),n.next=15,Object(ne.c)(vt.setMessagesExam([]));case 15:case"end":return n.stop()}}),Nt,null,[[1,10]])}var wt=se.a.mark(St);function St(e){var t,a,s,n;return se.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,c.prev=1,a=t.id,s=oe("exams",a),c.next=6,Object(ne.b)(re,s,"DELETE");case 6:if(n=c.sent){c.next=13;break}return console.log("[Orus System] Examen eliminado con exito",a),c.next=11,Object(ne.c)(vt.setMessagesExam([{type:"success",text:"Examen eliminado con exito"}]));case 11:c.next=21;break;case 13:if(console.error("[Orus System] Fallo al eliminar el examen",n.message),!n.message.indexOf("[SQLSTATE[23000]]")){c.next=19;break}return c.next=17,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"No se puede eliminar un examen que esta asignado",errnum:"SQL23000"}]));case 17:c.next=21;break;case 19:return c.next=21,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"No se puede eliminar el examen"}]));case 21:c.next=28;break;case 23:return c.prev=23,c.t0=c.catch(1),console.error("[Orus System] Error in handle deleteOrder",c.t0),c.next=28,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"al eliminar el examen, intentelo mas tarde"}]));case 28:case"end":return c.stop()}}),wt,null,[[1,23]])}var Ct=se.a.mark(_t);function _t(e){var t,a,s,n,c,r;return se.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,o.prev=1,a=t.id,s=t.data,n=oe("exams",a),c=a?"PUT":"POST",o.next=8,Object(ne.b)(re,n,c,s);case 8:if((r=o.sent).message){o.next=15;break}return console.log("[Orus System] Examen almacenado con exito",r.data.id),o.next=13,Object(ne.c)(vt.setMessagesExam([{type:"success",text:a?"Examen actualizado con exito":"Examen almacenado con exito"}]));case 13:o.next=18;break;case 15:return console.error("[Orus System] Fallo al almacenar el examen",r.message),o.next=18,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"No se puede almacenar el examen"}]));case 18:o.next=25;break;case 20:return o.prev=20,o.t0=o.catch(1),console.error("[Orus System] Error in handle deleteOrder",o.t0),o.next=25,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"al almacenar el examen, intentelo mas tarde"}]));case 25:case"end":return o.stop()}}),Ct,null,[[1,20]])}var kt=se.a.mark(Et);function Et(e){var t,a;return se.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,s.prev=1,s.next=4,Object(ne.b)(re,"exams/".concat(t),"GET");case 4:if(!(a=s.sent).data){s.next=10;break}return s.next=8,Object(ne.c)(vt.setExam(a.data));case 8:s.next=11;break;case 10:console.error("[OrusSystem] Error en handleGetExam",a);case 11:s.next=18;break;case 13:return s.prev=13,s.t0=s.catch(1),console.error("[OrusSystem] Error en saga/Exam handleGetExam",s.t0),s.next=18,Object(ne.c)(vt.setMessagesExam([{type:"error",text:"al traer datos de contacto, intentelo mas tarde"}]));case 18:case"end":return s.stop()}}),kt,null,[[1,13]])}var It=se.a.mark(At);function At(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de exam"),e.next=3,Object(ne.d)(ut,yt);case 3:return e.next=5,Object(ne.d)(mt,St);case 5:return e.next=7,Object(ne.d)(ht,_t);case 7:return e.next=9,Object(ne.d)(bt,Et);case 9:case"end":return e.stop()}}),It)}var Tt=ft,Dt=Object(r.b)({logging:D,default:V,order:Oe,category:De,storeItem:Je,contact:jt,exam:Tt}),Lt=se.a.mark(Ft);function Ft(e){var t;return se.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,console.log("[Orus System] Consultando credenciales en la API"),!e.payload.email||!e.payload.password){a.next=17;break}return a.next=5,Object(ne.b)(re,"users/login","POST",e.payload);case 5:if(!(t=a.sent).data){a.next=12;break}return console.log("[Orus System] Servidor:",t.message),a.next=10,Object(ne.c)({type:j,payload:t});case 10:a.next=15;break;case 12:return console.error("[Orus System] Fallo la validacion de credenciales en servidor",t),a.next=15,Object(ne.c)({type:u,payload:{errors:"Error de procesamiento, llame al administrador",result:t}});case 15:a.next=19;break;case 17:return a.next=19,Object(ne.c)({type:m,payload:null});case 19:a.next=26;break;case 21:return a.prev=21,a.t0=a.catch(0),console.error("[Orus System] Error in handle loggin",a.t0),a.next=26,Object(ne.c)({type:u,payload:{errors:"Error al conectarse al servidor, compruebe que tiene internet",errornum:500}});case 26:case"end":return a.stop()}}),Lt,null,[[0,21]])}var Pt=se.a.mark(Bt);function Bt(){var e,t;return se.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,console.log("[Orus System] Consultando notificaciones en la API"),a.next=4,Object(ne.b)(re,"user","GET");case 4:if(!(e=a.sent).data||!e.data.id){a.next=12;break}return t=e.data.unreadNotifications,console.log("[Orus System] Notificaciones encontradas:",t.length),a.next=10,Object(ne.c)({type:p,payload:t});case 10:a.next=18;break;case 12:if("Unauthenticated."!==e.message){a.next=17;break}return a.next=15,Object(ne.c)({type:m,payload:null});case 15:a.next=18;break;case 17:console.error("[Orus System] Error en notificaciones",e);case 18:a.next=23;break;case 20:a.prev=20,a.t0=a.catch(0),console.error("[Orus System] Error in handle notify user",a.t0);case 23:case"end":return a.stop()}}),Pt,null,[[0,20]])}var zt=se.a.mark(Mt);function Mt(e){var t,a,s;return se.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,console.log("[Orus System] Enviando notificaciones a la API"),n.next=5,Object(ne.b)(re,"user/readAllNotifications","POST",t);case 5:if(a=n.sent,s=parseInt(t.id)<0?"Todas":1,!a.success){n.next=11;break}return console.log("[Orus System] Notificaciones marcadas leidas:",s),n.next=11,Object(ne.c)({type:h,payload:{}});case 11:n.next=16;break;case 13:n.prev=13,n.t0=n.catch(1),console.error("[Orus System] Error in handle read notify user",n.t0);case 16:case"end":return n.stop()}}),zt,null,[[1,13]])}var Ut=se.a.mark(Gt);function Gt(e){var t;return se.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,console.log("[Orus System] Consultando loggin en la API"),!e.payload){a.next=15;break}return a.next=5,Object(ne.b)(re,"user");case 5:if(!(t=a.sent).message||"Unauthenticated."!==t.message){a.next=12;break}return console.log("[Orus System] Token de usuario no valido"),a.next=10,Object(ne.c)({type:m,payload:null});case 10:a.next=13;break;case 12:console.log("[Orus System] Verificacion de usuario correcta",t.data.username);case 13:a.next=18;break;case 15:return console.error("[Orus System] Error en el token de usuario:",e.payload),a.next=18,Object(ne.c)({type:m,payload:null});case 18:a.next=23;break;case 20:a.prev=20,a.t0=a.catch(0),console.error("[Orus System] Error in handle check loggin",a.t0);case 23:case"end":return a.stop()}}),Ut,null,[[0,20]])}var Rt=se.a.mark(Vt);function Vt(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Orus System] Escuchando eventos de usuario"),e.next=3,Object(ne.d)(l,Ft);case 3:return e.next=5,Object(ne.d)(d,Gt);case 5:return e.next=7,Object(ne.d)(h,Bt);case 7:return e.next=9,Object(ne.d)(b,Mt);case 9:case"end":return e.stop()}}),Rt)}var Jt=se.a.mark(qt);function qt(){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Vt(),xe(),Te(),Ve(),dt(),At()]);case 2:case"end":return e.stop()}}),Jt)}var $t=Object(o.a)(),Ht="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||r.c,Zt=Object(r.d)(Dt,Ht(r.a.apply(void 0,[$t])));$t.run(qt);var Xt=Zt,Wt=a(14),Yt=a(4),Kt=a(5),Qt=a(7),ea=a(6),ta=a(15),aa=a(19),sa=a(11),na=a.n(sa),ca=function(e){return{type:l,payload:e}},ra=a(0),oa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleClickRead=function(e,t){var a=s.props.readNotifyUser;-1===t&&e.preventDefault(),a({id:t})};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={rol:n.rol},s.timerNotify=null,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.isLogged&&(this.props.getNotifyUser(),this.timerNotify=setInterval((function(){e.props.getNotifyUser()}),6e4))}},{key:"componentWillUnmount",value:function(){this.timerNotify&&clearInterval(this.timerNotify)}},{key:"render",value:function(){var e=this,t=this.props.notifications,a=this.state.rol,s=t?t.length:0;return Object(ra.jsxs)("li",{className:"nav-item dropdown",children:[Object(ra.jsxs)("a",{className:"nav-link","data-toggle":"dropdown",href:"#end",children:[Object(ra.jsx)("i",{className:"far fa-bell"}),s?Object(ra.jsx)("span",{className:"badge badge-warning navbar-badge",children:s}):null]}),Object(ra.jsxs)("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right",children:[Object(ra.jsxs)("span",{className:"dropdown-header",children:[s," Notificaciones"]}),Object(ra.jsx)("div",{className:"dropdown-divider"}),t.map((function(t,s){var n=t.type.split("\\",3),c="general",r="fa-file",o=na()(t.created_at).fromNow(),i="#end";return!(s>10)&&("ExamNotification"===n[2]&&(2===a?(c="Examen creado",i="/consultorio/registro/"+t.data.id):(c="Examen actualizado",i="/pedidos/registro"),r="fa-file-alt"),Object(ra.jsxs)(ta.b,{to:i,className:"dropdown-item",onClick:function(a){e.handleClickRead(a,t.id)},children:[Object(ra.jsx)("i",{className:"fas "+r+" mr-1"})," ",c,Object(ra.jsx)("span",{className:"float-right text-sm text-muted",children:o})]},t.id))})),s?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("div",{className:"dropdown-divider"}),Object(ra.jsx)("a",{href:"#end",className:"dropdown-item dropdown-footer",onClick:function(t){t.preventDefault(),e.handleClickRead(t,-1)},children:"Marcar como le\xeddo."})]}):null,Object(ra.jsx)(ta.b,{to:"/notificaciones",className:"dropdown-item dropdown-footer",onClick:function(e){},children:"Ver todas"})]})]})}}]),a}(s.Component),ia={getNotifyUser:function(e){return{type:h,payload:e}},readNotifyUser:function(e){return{type:b,payload:e}}},la=Object(Wt.b)((function(e){return{notifications:e.logging.notifications,isLogged:e.logging.isLogged}}),ia)(oa),da=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)("nav",{className:"main-header navbar navbar-expand navbar-dark navbar-lightblue",children:[Object(ra.jsx)("ul",{className:"navbar-nav",children:Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsx)("a",{className:"nav-link","data-widget":"pushmenu",href:"#navbar",role:"button",onClick:function(e){e.preventDefault(),window.$("#body").toggleClass("sidebar-open"),window.$("#body").toggleClass("sidebar-collapse")},children:Object(ra.jsx)("i",{className:"fas fa-bars"})})})}),Object(ra.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(ra.jsxs)("li",{className:"nav-item dropdown",children:[Object(ra.jsx)("a",{href:"#end",className:"nav-link","data-toggle":"dropdown",children:Object(ra.jsx)("i",{className:"far fa-comments"})}),Object(ra.jsxs)("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right",children:[Object(ra.jsx)("span",{className:"dropdown-header",children:"Sin comentarios"}),Object(ra.jsx)("div",{className:"dropdown-divider"})]})]}),Object(ra.jsx)(la,{})]})]})}}]),a}(s.Component),ja={loggin:ca},ua=Object(Wt.b)((function(e){return{user:{rol:e.logging.rol,name:e.logging.name,username:e.logging.username},companyName:e.default.company,active:""}}),ja)((function(e){var t=e.companyName,a=e.user,s=Object(aa.f)().pathname.replace("/",""),c="/img/avatars/avatar5.png";return 1===a.rol&&(c="/img/avatars/avatar2.png"),a.rol||(c="/img/avatars/avatar3.png"),2===a.idUser&&(c="/img/avatars/avatar4.png"),Object(ra.jsxs)("aside",{className:"main-sidebar sidebar-dark-primary",children:[Object(ra.jsxs)(ta.b,{to:"/",className:"brand-link",children:[Object(ra.jsx)("img",{src:"/img/logo.png",alt:t+" logo ",className:"brand-image img-circle elevation-2",style:{opacity:.8,maxHeight:16}}),Object(ra.jsx)("span",{className:"brand-text font-weight-light text-uppercase",children:t})]}),Object(ra.jsxs)("div",{className:"sidebar",children:[Object(ra.jsxs)("div",{className:"pb-3 mt-3 mb-3 user-panel d-flex",children:[Object(ra.jsx)("div",{className:"image",children:Object(ra.jsx)("img",{src:c,className:"img-circle elevation-2",alt:a.name})}),Object(ra.jsx)("div",{className:"info",children:Object(ra.jsxs)("a",{href:"#end",className:"d-block text-capitalize",children:[a.name,Object(ra.jsxs)("small",{className:"text-lowercase",children:["(",a.username,")"]}),Object(ra.jsx)("br",{}),Object(ra.jsx)("span",{className:"badge badge-light",children:a.rol>0?1===a.rol?"Ventas":"Optometrista":"Administrador"})]})})]}),Object(ra.jsx)("nav",{className:"mt-2",children:Object(ra.jsxs)("ul",{className:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false",children:[2!==a.rol?Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/",className:""===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-tachometer-alt"}),Object(ra.jsxs)("p",{children:["Dashboard",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}):null,Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/contactos",className:"contactos"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-address-book"}),Object(ra.jsxs)("p",{children:["Contactos",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/consultorio",className:"consultorio"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-notes-medical"}),Object(ra.jsxs)("p",{children:["Examenes",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),a.rol<=1?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/pedidos",className:"pedidos"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-clipboard-list"}),Object(ra.jsxs)("p",{children:["Pedidos",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/notas",className:"notas"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-cash-register"}),Object(ra.jsxs)("p",{children:["Ventas",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})})]}):null,a.rol?null:Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("li",{className:"almacen"===s?"nav-item has-treeview menu-open":"nav-item has-treeview ",children:Object(ra.jsxs)(ta.b,{to:"/almacen",className:"almacen"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-database"}),Object(ra.jsxs)("p",{children:["Almacen",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/usuarios",className:"usuarios"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-user"}),Object(ra.jsxs)("p",{children:["Usuarios",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/configuraciones",className:"configuraciones"===s?"nav-link active":"nav-link",children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-tools"}),Object(ra.jsxs)("p",{children:["Configuraciones",Object(ra.jsx)("i",{className:"right fas fa-angle-left"})]})]})})]}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)(ta.b,{to:"/",className:"nav-link",onClick:function(t){t.preventDefault();var a=e.loggin;window.Swal.fire({title:"Session",text:"\xbfEsta seguro de cerrar la sesion?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Si",cancelButtonText:"Cancelar"}).then((function(e){e&&!e.dismiss&&e.value&&a({})}))},children:[Object(ra.jsx)("i",{className:"nav-icon fas fa-sign-out-alt"}),Object(ra.jsx)("p",{children:"Cerrar sesion"})]})})]})})]})]})})),ma=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).state={date:na()().format("LLLL")},s.timerNotify=null,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.timerNotify=setInterval((function(){console.log("[Orus System] Actualizando hora de sistema"),e.setState({date:na()().format("LLLL")})}),6e4)}},{key:"componentWillUnmount",value:function(){this.timerNotify&&clearInterval(this.timerNotify)}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.host,s=e.company,n=e.name,c=this.state.date;return Object(ra.jsxs)("div",{className:"content-header",children:[Object(ra.jsx)("div",{className:"container-fluid",children:Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("h1",{className:"m-0 text-dark text-capitalize",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-file"})," ",t]})}),Object(ra.jsxs)("div",{className:"text-center col",children:[Object(ra.jsxs)("small",{className:"p-2 badge badge-secondary text-capitalize",alt:"conectado a",title:"conectado a",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-wifi text-success"}),a]}),Object(ra.jsxs)("small",{className:"p-2 mt-1 ml-1 badge badge-secondary text-capitalize",alt:"Almacenando en",title:"Almacenando en",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-server text-success"})," ",s]}),Object(ra.jsxs)("small",{className:"p-2 mt-1 ml-2 badge badge-secondary text-capitalize",alt:"Usuario conectado",title:"Usuario conectado",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-user text-info"})," ",n]})]}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("h6",{className:"text-right text-muted",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-calendar"})," ",c]})})]})}),Object(ra.jsx)("hr",{})]})}}]),a}(s.Component),ha=Object(Wt.b)((function(e){return{company:e.default.company,host:e.default.host,name:e.logging.username}}))(ma),ba=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)("footer",{className:"main-footer d-print-none",children:[Object(ra.jsx)("div",{className:"float-right d-none d-sm-inline",children:"V2.0"}),Object(ra.jsxs)("strong",{children:["Copyright \xa9 2015-2020 ",Object(ra.jsx)("a",{href:"#end",children:"Orus"}),"."]})," ","Todos los derechos reservados."]})}}]),a}(s.Component),pa=(a(27),function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleOrder=function(t){e.props.handleOrder(t)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,s=t.order,n=t.orderby,c=t.actions;return a.length?Object(ra.jsx)("thead",{className:"thead-light",children:Object(ra.jsxs)("tr",{children:[a.map((function(t,a){return t.filter?Object(ra.jsxs)("th",{scope:"col",onClick:function(){e.handleOrder(t.type)},style:{cursor:"desc"===s?"n-resize":"s-resize"},children:[t.name,n===t.type?Object(ra.jsx)("span",{className:"ml-2",children:Object(ra.jsx)("i",{className:"fas fa-sort text-primary"})}):""]},a):Object(ra.jsx)("th",{scope:"col",children:t.name},a)})),c?Object(ra.jsx)("th",{className:"text-center",children:"Acciones"}):""]})}):Object(ra.jsx)("thead",{children:Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{scope:"col",className:"text-center",children:"No hay datos de columnas"})})})}}]),a}(s.Component)),xa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleChangePage=function(t){e.props.handleChangePage(t)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.props.meta;return t.total>10&&Object(ra.jsx)("div",{className:"btn-group",children:Object(ra.jsxs)("ul",{className:"pagination pagination-sm",children:[Object(ra.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:1===t.current_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(t){t.preventDefault(),e.handleChangePage(1)},children:"Primero"})}),Object(ra.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:1===t.current_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(a){a.preventDefault(),e.handleChangePage(t.current_page-1)},children:Object(ra.jsx)("i",{className:"fas fa-step-backward"})})}),Object(ra.jsx)("li",{className:"page-item",children:Object(ra.jsxs)("span",{className:"page-link",children:[t.current_page," /"," ",Math.ceil(t.total/t.per_page).toFixed(0)]})}),Object(ra.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:t.current_page===t.last_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(a){a.preventDefault(),e.handleChangePage(t.current_page+1)},children:Object(ra.jsx)("i",{className:"fas fa-step-forward"})})}),Object(ra.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:t.current_page===t.last_page?"page-link text-dark":"page-link text-primary",href:"#pageBefore",onClick:function(a){a.preventDefault(),e.handleChangePage(t.last_page)},children:"Ultimo"})})]})})}}]),a}(s.Component),Oa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).onKeyPressSearch=function(t){"Enter"===t.key&&(t.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("rol",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(t){var a=t.target,s=a.name,n=a.value;e.props.changeFilters(s,n)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.search,a=e.rol;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("div",{className:"btn-group",children:Object(ra.jsx)("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters",children:Object(ra.jsx)("i",{className:"fas fa-filter"})})}),Object(ra.jsx)("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters",children:Object(ra.jsx)("div",{className:"modal-dialog",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsx)("h5",{className:"modal-title",children:"Busquedas"}),Object(ra.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsxs)("form",{className:"modal-body",children:[Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-search"})})}),Object(ra.jsx)("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: nombre, usuario o email",value:t,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("label",{children:"Rol"}),Object(ra.jsx)("div",{className:"input-group-prepend ml-4",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-address-book"})})}),Object(ra.jsxs)("select",{className:"form-control",name:"rol",value:a,onChange:this.changeFilters,children:[Object(ra.jsx)("option",{value:"",children:"Todos"}),Object(ra.jsx)("option",{value:"0",children:"Administrador"}),Object(ra.jsx)("option",{value:"1",children:"Ventas"}),Object(ra.jsx)("option",{value:"2",children:"Optometrista"})]})]})]}),Object(ra.jsx)("div",{className:"modal-footer",children:Object(ra.jsxs)("div",{className:"btn-group btn-group-lg",role:"group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal",children:[Object(ra.jsx)("i",{className:"fas fa-window-close mr-2"}),"Cancelar"]}),Object(ra.jsxs)("button",{type:"button",className:this.props.search||this.props.rol?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean,children:[Object(ra.jsx)("i",{className:"fas fa-eraser mr-2"}),"Limpiar"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal",children:[Object(ra.jsx)("i",{className:"fas fa-search mr-2"}),"Buscar"]})]})})]})})})]})}}]),a}(s.Component),ga=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleDelete=function(t,a){e.props.delete(t,a)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.item,s=t.edit,n=t.id;return Object(ra.jsxs)("td",{className:"text-right",children:[this.props.delete?Object(ra.jsx)("a",{className:"btn-flat text-dark mr-4",href:"#delete",onClick:function(t){t.preventDefault(),e.handleDelete(n,a)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})}):"",s?Object(ra.jsx)(ta.b,{className:"btn-flat text-dark",to:s+n,children:Object(ra.jsx)("i",{className:"fas fa-pencil-alt"})}):""]})}}]),a}(s.Component),fa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changeFilters=function(e,t){s.setState(Object(J.a)({},e,t))},s.handleOrder=function(e){s.setState({orderby:e,order:"desc"===s.state.order?"asc":"desc",load:!0})},s.handleChangePage=function(e){s.setState({page:e,load:!0})},s.handleDelete=function(e,t){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el usuario "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t){var a=s.state,n=a.host,c=a.token;return console.log("Solicitud de eliminaci\xf3n de usuario por API"),fetch("http://"+n+"/api/users/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Usuario eliminado"),window.Swal.fire({icon:"success",title:"Usuario eliminado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.getUsers()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.getUsers=function(){var e=s.state,t=e.load,a=e.host,n=e.token,c="http://"+a+"/api/users",r="&orderby=".concat(s.state.orderby,"&order=").concat(s.state.order),o=s.state.search?"&search=".concat(s.state.search):"",i=s.state.rol.length>0?"&rol=".concat(s.state.rol):"",l=s.state.page>0?"?page="+s.state.page:"?page=1";t||s.setState({load:!0}),console.log("Solicitando usuarios a la API"),fetch(c+l+r+o+i,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data?(console.log("Descargando usuarios"),s.setState({users:e,load:!1})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Al descargar usuarios","error"),s.setState({load:!1}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusUsers")),c=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={users:{data:[],meta:{}},load:!0,page:n?n.page:1,orderby:n?n.orderby:"created_at",order:n?n.order:"asc",search:n?n.search:"",rol:n?n.rol:"",host:c.host,token:c.token},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getUsers(),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol})),console.log("[Users] Eliminando datos de contacto en uso"),localStorage.setItem("OrusContactInUse",JSON.stringify({}))}},{key:"componentDidUpdate",value:function(e,t){!1===t.load&&!0===this.state.load&&(console.log("Recargando usuarios y almacenando configuracion"),localStorage.setItem("OrusUsers",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,rol:this.state.rol})),this.getUsers())}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,s=t.load;return Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-header",children:[Object(ra.jsxs)("h2",{className:"card-title text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-user mr-1"}),"Usuarios registrados"]}),Object(ra.jsxs)("div",{className:"card-tools",children:[Object(ra.jsx)(Oa,{search:this.state.search,rol:this.state.rol,changeFilters:this.changeFilters,handleChangePage:this.handleChangePage}),Object(ra.jsx)(xa,{meta:a.meta,handleChangePage:this.handleChangePage})]})]}),Object(ra.jsx)("div",{className:"card-body table-responsive p-0",children:Object(ra.jsxs)("table",{className:"table table-sm table-bordered table-hover",children:[Object(ra.jsx)(pa,{orderby:this.state.orderby,order:this.state.order,data:[{name:"usuario",type:"username",filter:!0},{name:"nombre",type:"name",filter:!0},{name:"e-mail",type:"email",filter:!0},{name:"Rol",type:"rol",filter:!0},{name:"Actividad",type:"session"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),Object(ra.jsx)("tbody",{children:s?Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"9",className:"alert alert-light text-center p-4",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})})}):Object.keys(a.data).length?a.data.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{scope:"row",children:Object(ra.jsx)("span",{className:"text-capitalize text-primary",children:t.username})}),Object(ra.jsx)("td",{children:Object(ra.jsx)(ta.b,{to:"/usuarios/registro/"+t.id,children:Object(ra.jsxs)("span",{className:"badge badge-primary text-capitalize p-1",children:[t.name,Object(ra.jsx)("i",{className:"fas fa-pencil-alt ml-1"})]})})}),Object(ra.jsx)("td",{children:t.email}),Object(ra.jsx)("td",{children:t.rol>0?1===t.rol?Object(ra.jsxs)("span",{className:"text-capitalize text-success",children:[Object(ra.jsx)("i",{className:"fas fa-user-tag mr-2"}),"Ventas"]}):Object(ra.jsxs)("span",{className:"text-capitalize text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-user-tie mr-2"}),"Optometrista"]}):Object(ra.jsxs)("span",{className:"text-capitalize text-danger",children:[Object(ra.jsx)("i",{className:"fas fa-user-shield mr-2"}),"Administrador"]})}),Object(ra.jsx)("td",{children:t.session?na()(t.session.last_activity).fromNow():"--"}),Object(ra.jsx)("td",{children:na()(t.updated_at).fromNow()}),Object(ra.jsx)("td",{className:"text-right",children:na()(t.created_at).format("ll")}),Object(ra.jsx)(ga,{id:t.id,item:t.username,delete:e.handleDelete,edit:"/usuarios/registro/"})]},t.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsxs)("th",{colSpan:"8",className:"alert alert-info text-center",children:[Object(ra.jsx)("i",{className:"fas fa-info mr-2"}),"No hay datos para mostrar"]})})})]})}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsxs)(ta.b,{to:"/usuarios/registro",className:"btn btn-outline-primary btn-lg",children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-2"}),"Nuevo usuario"]})})]})}}]),a}(s.Component),va=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleChange=function(e){var t=e.target.value,a={target:{name:"validUserName",value:""}};e.target.value=t.replace(/ /g,"").toLowerCase(),/^[\w]{4,16}$/.test(t)?s.validUser(e.target.value,a):t.length>4?(s.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de usuario"}),a.target.value=!1,s.props.onChange(a)):t.length||(s.setState({bgColor:"bg-blue",validate:" border border-danger",text:"Debe de tener de 4 a 16 caracteres alfanumericos."}),a.target.value=!1,s.props.onChange(a)),s.props.onChange(e)},s.validUser=function(e,t){var a=JSON.parse(localStorage.getItem("OrusSystem")),n="http://"+a.host+"/api/users",c="?username="+e;s.timeFetch&&clearTimeout(s.timeFetch),s.timeFetch=setTimeout((function(){s.setState({searchUser:!0}),fetch(n+c,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(a){a.message?console.error("Error en la descarga de usuarios",a.message):a.data.length&&a.data[0].username.toLowerCase()===e?(s.setState({bgColor:"bg-red",validate:" border border-danger",text:"El usuario ya esta registrado.",searchUser:!1}),t.target.value=!1,s.props.onChange(t)):(s.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),t.target.value=!0,s.props.onChange(t))})).catch((function(e){console.error(e)}))}),1e3)},s.state={bgColor:"bg-blue",validate:"",text:"Debe de tener al menos 4 caracteres.",searchUser:!1},s.controller=new AbortController,s.signal=s.controller.signal,s.timeFetch=null,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,t=e.col,a=e.username,s=this.state,n=s.bgColor,c=s.validate,r=s.text,o=s.searchUser;return Object(ra.jsxs)("div",{className:"col-"+t,children:[a.length?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Usuario"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text "+n,children:o?Object(ra.jsx)("i",{className:"fas fa-spinner"}):Object(ra.jsx)("i",{className:"fas fa-user-check"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control"+c,placeholder:"Usuario",name:"username",autoComplete:"off",autoFocus:"autofocus",value:a,onChange:this.handleChange,required:"required",minLength:"4",maxLength:"16",pattern:"^[\\w]{4,16}$"})]}),c?Object(ra.jsx)("small",{className:"text-muted",children:r}):""]})}}]),a}(s.Component),Na=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleChange=function(e){var t=e.target.value,a={target:{name:"validUserEmail",value:!0}};e.target.value=t.replace(/\s/g,"").toLowerCase(),/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?s.validEmail(e.target.value,a):t.length>8?(s.setState({bgColor:"bg-red",validate:" border border-danger",text:"No tiene el formato de un email"}),a.target.value=!1,s.props.onChange(a)):t.length||(s.setState({bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email"}),a.target.value=!1,s.props.onChange(a)),s.props.onChange(e)},s.validEmail=function(e,t){var a=JSON.parse(localStorage.getItem("OrusSystem")),n="http://"+a.host+"/api/users",c="?email="+e;s.timeFetch&&clearTimeout(s.timeFetch),s.timeFetch=setTimeout((function(){s.setState({searchUser:!0}),fetch(n+c,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.error(e)),e.json()})).then((function(a){a.message?(console.error("Error en la descarga de usuarios",a.message),s.setState({bgColor:"bg-red",validate:" border border-danger",text:"Error en la consulta",searchUser:!1})):a.data.length&&a.data[0].email.toLowerCase()===e?(s.setState({bgColor:"bg-red",validate:" border border-danger",text:"El email ya esta registrado.",searchUser:!1}),t.target.value=!1,s.props.onChange(t)):(s.setState({bgColor:"bg-blue",validate:"",searchUser:!1}),t.target.value=!0,s.props.onChange(t))})).catch((function(e){console.error(e)}))}),1e3)},s.state={bgColor:"bg-blue",validate:"",text:"No tiene el formato de un email",searchUser:!1},s.controller=new AbortController,s.signal=s.controller.signal,s.timeFetch=null,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props,t=e.col,a=e.email,s=this.state,n=s.bgColor,c=s.validate,r=s.text;return Object(ra.jsxs)("div",{className:"col-"+t,children:[a.length?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Usuario"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text "+n,children:Object(ra.jsx)("i",{className:"fas fa-at"})})}),Object(ra.jsx)("input",{type:"email",className:"form-control"+c,placeholder:"email",name:"email",autoComplete:"off",value:a,onChange:this.handleChange,required:"required"})]}),c?Object(ra.jsx)("small",{className:"text-muted",children:r}):""]})}}]),a}(s.Component),ya=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changePage=function(e){s.props.page(e.target.id)},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value;s.setState(Object(J.a)({},a,n))},s.handleSave=function(e){e.preventDefault();var t=s.state,a=t.id,n=t.validUserName,c=t.validUserEmail;return n?c?void window.Swal.fire({title:"Almacenamiento",text:a?"\xbfEsta seguro de actualizar el usuario?":"\xbfEsta seguro de crear un nuevo usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:a?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=s.state,a=t.host,n=t.token,c=t.id,r=t.name,o=t.username,i=t.rol,l=t.password,d={name:r,username:o,rol:i,email:t.email},j=c?"http://"+a+"/api/users/"+c:"http://"+a+"/api/users",u=c?"PUT":"POST";return l.length>8&&(d.password=l),console.log("Enviando datos del usuario a API"),fetch(j,{method:u,body:JSON.stringify(d),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("Usuario almacenado"),window.Swal.fire({icon:"success",title:a?"Usuario actualizado con exito":"Usuario almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.props.history.goBack()}))):(window.Swal.fire("Error","al almacenar el usuario","error"),console.error("Orus res: ",t.message))}})):(window.Swal.fire({icon:"error",title:"El correo ya esta en uso",showConfirmButton:!1,timer:1500}),!1):(window.Swal.fire({icon:"error",title:"El nombre de usuario ya esta en uso",showConfirmButton:!1,timer:1500}),!1)},s.getUser=function(e){var t=s.state,a=t.host,n=t.token;e>0?fetch("http://"+a+"/api/users/"+e,{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data?(console.log("Cargando datos de usuario"),s.setState({id:e.data.id,rol:e.data.rol,username:e.data.username,name:e.data.name,email:e.data.email,updated_at:e.data.updated_at,created_at:e.data.created_at,session:e.data.session,load:!1,validUserName:!0,validUserEmail:!0})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error en el sistema, comuniquese con el administrador de sistema","error"),s.setState({load:!1}))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})})):s.setState({load:!1})};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={id:0,rol:1,username:"",validUserName:!1,name:"",email:"",validUserEmail:!1,password:"",updated_at:"",created_at:"",session:{},load:!1,host:n.host,token:n.token},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.props.match.params.id;e&&this.getUser(e)}},{key:"render",value:function(){var e=this.state,t=e.load,a=e.id,s=e.rol,c=e.username,r=e.name,o=e.email,i=e.password,l=e.updated_at,d=e.created_at,j=e.session,u=e.validUserName,m=e.validUserEmail,h=!(!t&&u&&r.length&&m);return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("form",{className:"card card-primary card-outline",onSubmit:this.handleSave,children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h1",{className:"card-title text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-user mr-2"}),a?"Editar usuario":"Registrar nuevo usuario"]})}),Object(ra.jsx)("div",{className:"card-body was-validated",children:t?Object(ra.jsx)("div",{className:"alert alert-light text-center p-4",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})}):Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("div",{className:"row mb-3",children:[Object(ra.jsx)(va,{username:c,col:6,onChange:this.catchInputs}),Object(ra.jsxs)("div",{className:"col-6",children:[r.length?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Nombre completo"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text bg-blue",children:Object(ra.jsx)("i",{className:"fas fa-user-tag"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",autoComplete:"off",value:r,onChange:this.catchInputs,required:"required",minLength:"8",pattern:"^[a-zA-Z]{2,20}[\\s]{1}[a-zA-Z]{2,20}.*"})]})]})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-6",children:[i.length||a?Object(ra.jsxs)("small",{children:[Object(ra.jsx)("label",{children:"Contrase\xf1a"}),a?"":Object(ra.jsx)("span",{className:"ml-2",children:"De 8 a 16 caracteres, por lo menos una mayuscula, un numero y un caracter especial"})]}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text bg-blue",children:Object(ra.jsx)("i",{className:"fas fa-lock"})})}),Object(ra.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",value:i,onChange:this.catchInputs,required:!a,minLength:"8",maxLength:"16",pattern:"^(?=.*[A-Z])(?=.*[!@#$&.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$"})]})]}),Object(ra.jsx)(Na,{email:o,col:6,onChange:this.catchInputs})]}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-md-6",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Rol"})}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text bg-blue",children:Object(ra.jsx)("i",{className:"fas fa-id-card"})})}),Object(ra.jsxs)("select",{className:"custom-select",name:"rol",value:s,onChange:this.catchInputs,children:[Object(ra.jsx)("option",{value:"0",children:"Administrador"}),Object(ra.jsx)("option",{value:"1",children:"Ventas"}),Object(ra.jsx)("option",{value:"2",children:"Optometrista"})]})]})]})})]})}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-12 text-right",children:Object(ra.jsxs)("div",{className:"btn-group btn-group-lg",role:"group",children:[Object(ra.jsxs)(ta.b,{to:"/usuarios",className:"btn btn-dark",onClick:this.changePage,id:"/usuarios",children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(ra.jsxs)("button",{type:"submit",className:t?"btn btn-primary disabled":"btn btn-primary",disabled:!!h,children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"}),"Guardar"]})]})})})})]})}),a?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-database mr-2"}),"Metadata"]})}),Object(ra.jsx)("div",{className:"card-body",children:j?Object(ra.jsxs)("ul",{className:"list-group",children:[Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("h6",{children:"Datos del usuario"}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Registrado"}),Object(ra.jsx)("p",{children:na()(d).fromNow()})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Ultima actualizacion"}),Object(ra.jsx)("p",{children:na()(l).fromNow()})]})]})]}),Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("h6",{children:"Actividad"}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("span",{className:"text-primary",children:"IP"}),Object(ra.jsx)("p",{children:j.ip_address})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Ultima actividad"}),Object(ra.jsx)("p",{children:na()(j.last_activity).fromNow()})]})]})]}),Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Navegador y OS"}),Object(ra.jsx)("p",{children:j.user_agent})]}),Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Token"}),Object(ra.jsx)("p",{children:j.user_data})]})]}):Object(ra.jsx)("p",{children:"Usuario no ha registrado actividad."})})]})}):null]})}}]),a}(s.Component),wa=a(18),Sa=function(e){var t=e.meta,a=e.handlePagination,s=e.color,n=function(e){a?a(e):console.error("[OrusSystem] Funcion de paginador no definida")};return Object(ra.jsx)("div",{className:"btn-group",children:Object(ra.jsxs)("ul",{className:"pagination pagination-sm m-0 mb-1",children:[Object(ra.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item test-",children:Object(ra.jsx)("a",{className:1===t.current_page?"page-link text-secondary":"page-link text-"+s,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(1)},children:"Primero"})}),Object(ra.jsx)("li",{className:1===t.current_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:1===t.current_page?"page-link text-secondary":"page-link text-"+s,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.current_page-1)},children:Object(ra.jsx)("i",{className:"fas fa-caret-left"})})}),Object(ra.jsx)("li",{className:"page-item",children:Object(ra.jsxs)("span",{className:"page-link text-dark",children:[t.current_page," /",Math.ceil(t.total/t.per_page).toFixed(0)]})}),Object(ra.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:t.current_page===t.last_page?"page-link text-secondary":"page-link text-"+s,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.current_page+1)},children:Object(ra.jsx)("i",{className:"fas fa-caret-right"})})}),Object(ra.jsx)("li",{className:t.current_page===t.last_page?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{className:t.current_page===t.last_page?"page-link text-secondary":"page-link text-"+s,href:"#pageBefore",onClick:function(e){e.preventDefault(),n(t.last_page)},children:"Ultimo"})})]})})},Ca=function(e){var t=e.defaultSearch,a=void 0===t?"":t,n=Object(s.useState)(a),c=Object(wa.a)(n,2),r=c[0],o=c[1],i=Object(s.useState)(""),l=Object(wa.a)(i,2),d=l[0],j=l[1];return Object(s.useEffect)((function(){var t=null;e.handleSearch&&(r.length?(d&&clearTimeout(d),t=setTimeout((function(){e.handleSearch(r)}),1e3),j(t)):e.handleSearch(""))}),[r]),Object(ra.jsxs)("div",{className:"card card-"+e.color+" card-outline",children:[Object(ra.jsxs)("div",{className:"card-header",children:[Object(ra.jsxs)("h3",{className:"card-title text-"+e.color,children:[Object(ra.jsx)("i",{className:e.icon?"mr-1 fas fa-"+e.icon:"mr-1 fas fa-user"}),e.title]}),Object(ra.jsx)("div",{className:"card-tools",children:e.handleSearch?Object(ra.jsxs)("div",{className:"input-group input-group-sm position-relative",children:[Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Buscar",value:r,onChange:function(e){var t=e.target.value;o(t)},onKeyPress:function(e){"Enter"===e.key&&console.log("[DEBUG] press enter")}}),Object(ra.jsx)("div",{className:"position-absolute",style:{top:5,left:-20,color:"#ced4da"},children:Object(ra.jsx)("i",{className:"fas fa-search"})}),r.length>2?Object(ra.jsx)("div",{className:"input-group-append",children:Object(ra.jsx)("div",{className:"btn btn-secondary",onClick:function(e){return o("")},children:Object(ra.jsx)("i",{className:"fas fa-window-close"})})}):null]}):null})]}),Object(ra.jsxs)("div",{className:"p-0 card-body",children:[e.handleDeleteItem||e.handleEditItem||e.handleStatus||e.handleSync||e.meta?Object(ra.jsxs)("div",{className:"mailbox-controls",children:[Object(ra.jsxs)("div",{className:"btn-group",children:[e.handleDeleteItem?Object(ra.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Eliminar",disabled:!e.itemSelected,onClick:function(t){return e.handleDeleteItem()},children:Object(ra.jsx)("i",{className:"fas fa-trash-alt"})}):null,e.handleEditItem?Object(ra.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Editar",disabled:!e.itemSelected,onClick:function(t){return e.handleEditItem()},children:Object(ra.jsx)("i",{className:"fas fa-edit"})}):null,e.handleStatus?Object(ra.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Estado",disabled:!e.itemSelected,onClick:function(t){return e.handleStatus()},children:Object(ra.jsx)("i",{className:"fas fa-check-circle"})}):null,e.handleSync?Object(ra.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Recargar",onClick:function(t){return e.handleSync()},children:Object(ra.jsx)("i",{className:"fas fa-sync-alt"})}):null]}),Object(ra.jsx)("div",{className:"float-right",children:e.meta?Object(ra.jsx)(Sa,{meta:e.meta,color:e.color,handlePagination:e.handlePagination}):null})]}):null,Object(ra.jsx)("div",{className:"table-responsive mailbox-messages",children:e.children})]}),e.loading?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})},_a=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleToPrice=function(){var e=s.state,t=e.price,a=e.catid_3,n=e.load;if(t&&a){console.log("Send data to API",t,a);var c=JSON.parse(localStorage.getItem("OrusSystem")),r="http://"+c.host+"/api/store/prices?cat="+a+"&price="+t;n||s.setState({load:!0}),fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then((function(e){return e.json()})).then((function(e){console.log("[Orus System] Item actualizados",e),s.setState({load:!1})}))}},s.handelChangePrice=function(e){var t=e.target.value;s.setState({price:parseInt(t)})},s.getItems=function(e){var t=JSON.parse(localStorage.getItem("OrusSystem")),a=s.state.load,n="http://"+t.host+"/api/store?cat="+e+"&itemsPage=500";a||s.setState({load:!0}),fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){console.log("[Orus System] Descarga de producto exitosa"),s.setState({items:e.data&&e.data.length?e.data:[],load:!1})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))},s.handleClickCat=function(e){var t=e.target,a=t.name,n=t.value,c=s.state,r=c.catData_1,o=c.catData_2,i=[],l={};"catid_1"===a?(r.map((function(e){return e.id===parseInt(n)&&(i=e.hijos,l=e.meta,!0)})),s.setState({catid_1:parseInt(n),catid_2:0,catid_3:0,catData_2:i,catData_3:[],meta:l})):"catid_2"===a&&(o.map((function(e){return e.id===parseInt(n)&&(i=e.hijos,!0)})),s.setState({catid_2:parseInt(n),catid_3:0,catData_3:i}))},s.getCategories=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),t="http://"+e.host+"/api/categories/1";fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&e.data.hijos.length&&(console.log("Descarga de categoria exitos"),s.setState({catData_1:e.data.hijos}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},s.state={catData_1:[],catData_2:[],catData_3:[],catid_1:0,catid_2:0,catid_3:0,load:!1,items:[],meta:{},price:0},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,t){t.catid_3!==this.state.catid_3&&this.getItems(this.state.catid_3)}},{key:"render",value:function(){var e=this,t=this.state,a=t.catid_1,s=t.catData_1,c=t.catid_2,r=t.catData_2,o=t.catid_3,i=t.catData_3,l=t.load,d=t.items,j=t.meta,u=t.price,m=[],h=[],b=0;do{m.push(Object(ra.jsx)("th",{children:b.toFixed(2)},b)),b-=.25}while(b>parseFloat(j.cil)-.25);b=parseFloat(j.rangoInf);do{0===b?h.push(Object(ra.jsx)("td",{children:Object(ra.jsx)("label",{children:"0.00"})})):h.push(Object(ra.jsx)("td",{children:b.toFixed(2)})),b+=.25}while(b<parseFloat(j.rangoSup)+.25);return Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("select",{className:"custom-select",name:"catid_1",value:a,onChange:this.handleClickCat,children:[Object(ra.jsx)("option",{value:"0",children:"Seleccione un tipo"}),s.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria},e.id)}))]})}),a&&r.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("select",{className:"custom-select",name:"catid_2",value:c,onChange:this.handleClickCat,children:[Object(ra.jsx)("option",{value:"0",children:"Seleccione un material"}),r.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria},e.id)}))]})}):null,c&&i.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"btn-group",role:"group","aria-label":"Basic example",children:i.map((function(t){return Object(ra.jsx)("button",{className:o===t.id?"btn btn-primary":"btn btn-secondary",onClick:function(a){e.setState({catid_3:t.id,load:!0})},children:t.categoria},t.id)}))})}):null]})}),Object(ra.jsx)("div",{className:"card-body",children:o?Object(ra.jsx)(n.a.Fragment,{children:l?Object(ra.jsxs)("div",{className:"text-center",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Cargando productos"}),Object(ra.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})]}):Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("div",{className:"row mb-2",children:[Object(ra.jsxs)("div",{className:"col",children:["Total de productos: ",Object(ra.jsx)("label",{children:d.length})]}),Object(ra.jsx)("div",{className:"col-6",children:Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("label",{className:"col-4 text-right",children:"Precio"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("input",{type:"number",className:"form-control",value:u,onChange:this.handelChangePrice})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.handleToPrice,children:"Cambiar"})})]})})]}),Object(ra.jsx)("div",{className:"table-responsive",children:Object(ra.jsxs)("table",{className:"table table-sm table-bordered table-hover",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"/"}),m]})}),Object(ra.jsx)("tbody",{children:h.map((function(e,t){var a="label"===e.props.children.type;return Object(ra.jsxs)("tr",{className:a?"table-secondary":"",children:[e,m.map((function(t,s){var c=a?parseFloat(e.props.children.props.children).toFixed(2).replace(".",""):parseFloat(e.props.children).toFixed(2).replace(".","");return parseInt(c)>=0&&(c="+"+c),c+=parseFloat(t.props.children).toFixed(2).replace(/[-.]/g,""),Object(ra.jsx)("td",{className:"text-center",children:d.length?d.map((function(e,t){return c===e.graduacion?Object(ra.jsx)(n.a.Fragment,{children:e.cantidades?Object(ra.jsx)("span",{className:e.cantidades>0?"badge badge-success":"badge badge-danger",children:Object(ra.jsx)(ta.b,{to:"/almacen/registro/"+e.id,className:"text-light",children:e.cantidades})},e.id+t):null}):null})):Object(ra.jsx)(ta.b,{to:"/almacen/registro",children:Object(ra.jsx)("i",{className:"fas fa-plus text-secondary"})})},c+s)}))]},t)}))})]})})]})}):Object(ra.jsxs)("div",{className:"alert alert-warning text-light",role:"alert",children:[Object(ra.jsxs)("h4",{className:"alert-heading",children:[Object(ra.jsx)("i",{className:"fas fa-exclamation"})," Seleccion."]}),Object(ra.jsx)("hr",{}),Object(ra.jsxs)("ul",{children:[a?null:Object(ra.jsx)("li",{children:"Selecciones primero el tipo de lente"}),c?null:Object(ra.jsx)("li",{children:"Despues el material"}),Object(ra.jsx)("li",{children:"Por ultimo el tratamiento"})]})]})})]})})})}}]),a}(s.Component),ka=function(e){var t;return Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h5",{className:"card-title",children:[Object(ra.jsx)("i",{className:e.icon?"mr-2 fas fa-"+e.icon:"mr-2 fas fa-ellipsis-v"}),null!==(t=e.title)&&void 0!==t?t:"Menu"]})}),Object(ra.jsx)("div",{className:"card-body p-0",children:Object(ra.jsx)("ul",{className:"list-group nav list-group-flush",children:e.children})})]})},Ea=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleSetSelectOptions=function(e){var t=e.target,a=t.name,n=t.value,c=s.state.options,r=n;"itemsPage"===a&&(r=parseInt(n)),console.log("[DEBUG] manejando filtros",a,n,r),s.setState({options:Object(i.a)(Object(i.a)({},c),{},Object(J.a)({},a,r)),load:!0})},s.handleSaveContact=function(e,t){(0,s.props._saveContact)({data:t,id:e,options:s.state.options}),s.handleCloseEdit()},s.handleCloseEdit=function(){s.props.history.push("/almacen"),s.setState({newOrEdit:!1,contact:{},contactSelected:""})},s.handleSync=function(){s.getContacts()},s.handleEditTemp=function(e){s.props.history.push("/almacen/registro/".concat(e))},s.handleEditItem=function(e){var t=s.state.storeSelected,a=s.props.list,n=null!==e&&void 0!==e?e:t,c=a.filter((function(e){return e.id===n}));c.length?(console.log("[Orus System] Editar producto",n),s.setState({item:c[0],newOrEdit:!0,storeSelected:n}),s.props.history.push("/almacen/registro/".concat(n))):(s.setState({newOrEdit:!1,item:{},storeSelected:"",load:!0}),s.props.history.push("/almacen"))},s.handleChangeCheckbox=function(e){var t=e.target,a=t.value;t.checked?s.setState({storeSelected:parseInt(a)}):s.setState({storeSelected:""})},s.handleSearch=function(e){var t=s.state.options;console.log("[DEBUG] handle search",e),s.setState({options:Object(i.a)(Object(i.a)({},t),{},{search:e}),load:!0})},s.handleChangePage=function(e){var t=s.state.options;s.setState({options:Object(i.a)(Object(i.a)({},t),{},{page:e}),load:!0})},s.handleDelete=function(){var e=s.state,t=e.storeSelected,a=e.options,n=s.props._deleteContact;if(!t)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un producto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el producto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",t),n({id:t,options:a})),s.setState({storeSelected:""})}))},s.state={load:!1,item:{},newOrEdit:!1,storeSelected:"",panel:"inbox",options:{page:1,orderby:"created_at",order:"desc",search:"",itemsPage:10,supplier:""}},s.timeInterval=0,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({load:!0}),t&&(this.timeInterval=setInterval((function(){var a=e.props.list;a.length&&(clearInterval(e.timeInterval),a.every((function(a){return a.id!==parseInt(t)||(e.handleEditItem(a),!1)})))}),1e3)),this.getSuppliers()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.load,s=this.props.messages;t.load!==a&&!0===a&&(console.log("[Orus System] Recargando productos"),this.getContacts()),e.messages.length!==s.length&&s.length&&s.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,s=t.loading,n=t.meta,c=t.suppliers,r=this.state,o=r.newOrEdit,i=r.storeSelected,l=r.options,d=r.panel;return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-sm-12 col-md-2",children:[Object(ra.jsxs)("button",{className:"btn bg-primary btn-block mb-3",type:"button",disabled:o,onClick:function(t){t.preventDefault(),e.props.history.push("/almacen/registro")},children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo producto"]}),o?null:Object(ra.jsxs)(ka,{title:"Menu y filtros",children:[Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsx)("a",{href:"#item",className:"nav-link",onClick:function(t){t.preventDefault(),e.props.history.push("/almacen/categorias")},children:"Categorias"})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsx)("a",{href:"#item",className:"nav-link",onClick:function(t){t.preventDefault(),e.props.history.push("/almacen/marcas")},children:"Marcas"})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsx)("a",{href:"#item",className:"nav-link",onClick:function(t){t.preventDefault(),e.setState({panel:"inventory"})},children:"Inventario"})}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"supplier",children:"Proveedor"}),Object(ra.jsxs)("select",{className:"form-control ",name:"supplier",id:"supplier",value:l.supplier,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"",children:"-- Todos --"}),c.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.nombre})}))]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:l.orderby,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(ra.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:l.order,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"asc",children:"Antiguos"}),Object(ra.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"itemsPage",children:"Numero de productos"}),Object(ra.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:l.itemsPage,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"10",children:"ver 10"}),Object(ra.jsx)("option",{value:"20",children:"ver 20"}),Object(ra.jsx)("option",{value:"50",children:"ver 50"}),Object(ra.jsx)("option",{value:"100",children:"ver 100"})]})]})]})]}),Object(ra.jsx)("div",{className:"col-sm-12 col-md-10",children:"inventory"===d?Object(ra.jsx)(_a,{}):Object(ra.jsx)(Ca,{title:"Lista de productos",icon:"id-badge",color:"primary",loading:s,meta:n,itemSelected:i,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync,children:Object(ra.jsxs)("table",{className:"table table-hover table-striped",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{}),Object(ra.jsx)("th",{children:"Codigo"}),Object(ra.jsx)("th",{children:"Describci\xf3n"}),Object(ra.jsx)("th",{children:"Marca"}),Object(ra.jsx)("th",{children:"Proveedor"}),Object(ra.jsx)("th",{children:"Cant"})]})}),Object(ra.jsx)("tbody",{children:a.length?Object(ra.jsx)(ra.Fragment,{children:a.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(ra.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:t.id,id:"contact_"+t.id,checked:i===t.id,onChange:e.handleChangeCheckbox}),Object(ra.jsx)("label",{htmlFor:"contact_"+t.id,className:"sr-only"})]}),Object(ra.jsx)("td",{className:"icheck-primary",children:Object(ra.jsx)("div",{className:"badge badge-primary text-uppercase",children:t.codigo})}),Object(ra.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",onClick:function(a){return e.handleEditTemp(t.id)},children:Object(ra.jsx)("label",{style:{cursor:"pointer"},children:t.producto})}),Object(ra.jsx)("td",{className:"mailbox-attachment text-uppercase text-truncate text-muted",children:Object(ra.jsx)("span",{children:t.marca?t.marca.marca:"--"})}),Object(ra.jsx)("td",{className:"mailbox-attachment text-capitalize text-truncate text-muted",children:Object(ra.jsx)("span",{children:t.proveedor?t.proveedor.nombre:"--"})}),Object(ra.jsx)("td",{className:"mailbox-date text-muted text-truncate text-right",children:Object(ra.jsx)("span",{children:t.cantidades})})]},t.id)}))}):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{className:"text-center text-muted",colSpan:"6",children:"No hay productos registrados"})})})]})})})]})}},{key:"getContacts",value:function(){(0,this.props._getList)(this.state.options),this.setState({load:!1})}},{key:"getSuppliers",value:function(){(0,this.props._getContacts)({type:1,business:0})}}]),a}(s.Component),Ia={_getList:Me.getListStore,_getContacts:et.getListContacts},Aa=Object(Wt.b)((function(e){var t=e.storeItem,a=e.contact;return{list:t.list,messages:t.messages,meta:t.metaList,loading:t.loading,suppliers:a.list}}),Ia)(Ea),Ta=a(25),Da=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleDelete=function(e,t,a){e.preventDefault(),window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el lote "+a.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(a){if(a&&t){var n=e.target.parentNode.parentNode.parentNode;n.classList.add("bg-danger");var c=JSON.parse(localStorage.getItem("OrusSystem")),r=setInterval((function(){clearInterval(r),n.classList.remove("bg-danger")}),6500);return console.log("Solicitud de eliminaci\xf3n de lote por API"),fetch("http://"+c.host+"/api/items/"+t,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c.token}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Producto eliminado"),s.setState({load:!0,loteNew:!1}),window.Swal.fire("Lote eliminado con exito","","success").then((function(e){s.handelGetLots(s.state.page),s.props.refresh()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.state={id:0,bill:"",cost:0,price:s.props.price,amount:0,lote:{data:[],meta:{}},loteNew:!1,load:!0,page:1},s.handleNewLote=s.handleNewLote.bind(Object(Ta.a)(s)),s.handleSave=s.handleSave.bind(Object(Ta.a)(s)),s.catchInputs=s.catchInputs.bind(Object(Ta.a)(s)),s.handelGetLots=s.handelGetLots.bind(Object(Ta.a)(s)),s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.handelGetLots(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,a=t.lote,s=t.load,n=[];if(this.state.lote.meta.total>10)for(var c=1;c<=this.state.lote.meta.last_page;c++)n.push(Object(ra.jsx)("li",{className:this.state.lote.meta.current_page===c?"page-item disabled":"page-item",children:Object(ra.jsx)("a",{href:"#e",id:c,className:"page-link",onClick:this.handleChangePage.bind(this),children:c})},c));return Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-header",children:[Object(ra.jsxs)("h3",{className:"card-title text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-list"}),"Listado de lotes"]}),Object(ra.jsx)("div",{className:"card-tools",children:this.state.lote.meta.total>10?Object(ra.jsx)("div",{className:"btn-group",children:Object(ra.jsx)("ul",{className:"pagination pagination-sm",children:n})}):""})]}),Object(ra.jsx)("div",{className:"card-body table-responsive p-0",children:Object(ra.jsxs)("table",{className:"table table-hover table-nowrap",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Registrado"}),Object(ra.jsx)("th",{style:{width:140},children:"Factura"}),Object(ra.jsx)("th",{className:"text-right",style:{width:90},children:"Unidades"}),Object(ra.jsx)("th",{className:"text-right",style:{width:110},children:"Costo"}),Object(ra.jsx)("th",{className:"text-right",style:{width:110},children:"Precio"}),Object(ra.jsx)("th",{children:"Acciones"})]})}),Object(ra.jsxs)("tbody",{children:[s?Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{colSpan:"6",className:"text-center",children:[Object(ra.jsx)("span",{className:"text-primary mr-4",children:"Cargando lotes"}),Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})]})}):Object.keys(a.data).length?a.data.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:t.created_at}),Object(ra.jsx)("td",{className:"text-uppercase",children:t.factura?t.factura:"XXXX"}),Object(ra.jsx)("td",{className:"text-right",children:t.cantidades}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.costo?t.costo:0]}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.precio?t.precio:0]}),Object(ra.jsx)("td",{className:"text-right",children:Object(ra.jsx)("a",{className:"btn-flat text-dark",href:"#delete",onClick:function(a){e.handleDelete(a,t.id,t.factura)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})})]},t.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{colSpan:"6",className:"text-center",children:"No hay datos para mostrar"})}),this.state.loteNew?Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Nuevo"}),Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{className:"form-control text-uppercase",type:"text",name:"bill",value:this.state.bill,onChange:this.catchInputs})}),Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{className:"form-control text-right",type:"number",name:"amount",min:"1",value:this.state.amount,onChange:this.catchInputs})}),Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{className:"form-control text-right",type:"number",name:"cost",value:this.state.cost,onChange:this.catchInputs})}),Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{className:"form-control text-right",type:"number",name:"price",value:this.state.price,onChange:this.catchInputs})}),Object(ra.jsx)("td",{className:"text-right",children:Object(ra.jsxs)("div",{className:"btn-group",role:"group",children:[Object(ra.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:this.handleSave,children:Object(ra.jsx)("i",{className:"fas fa-save"})}),Object(ra.jsx)("button",{className:"btn btn-outline-dark btn-sm",onClick:this.handleNewLote,children:Object(ra.jsx)("i",{className:"fas fa-undo"})})]})})]}):Object(ra.jsx)("tr",{})]})]})}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-12",children:Object(ra.jsx)("div",{className:"btn-group float-right",role:"group",children:Object(ra.jsx)("button",{className:"btn btn-primary",onClick:this.handleNewLote,children:"Nuevo lote"})})})})})]})}},{key:"handleChangePage",value:function(e){e.preventDefault(),this.setState({page:e.target.id}),this.handelGetLots(e.target.id)}},{key:"handleNewLote",value:function(){this.setState({loteNew:!this.state.loteNew})}},{key:"catchInputs",value:function(e){var t=e.target,a=t.name,s=t.value;this.setState(Object(J.a)({},a,s.toLowerCase()))}},{key:"validInputs",value:function(){var e=this.state,t=e.bill,a=e.price,s=e.amount;return t.length||(t="XXXX"),a||(a=1e3),!!s||(window.alert("La cantidad de articulos no puede ser cero"),!1)}},{key:"handleSave",value:function(e){var t=this;if(e.preventDefault(),!this.validInputs())return!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de almacenar un nuevo lote?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a=JSON.parse(localStorage.getItem("OrusSystem")),s=t.state,n=s.id,c={bill:s.bill,cost:s.cost,price:s.price,amount:s.amount,store_items_id:n};return console.log("Enviando datos del producto a API"),fetch("http://"+a.host+"/api/items",{method:"POST",body:JSON.stringify(c),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Lote almacenada"),t.setState({load:!0,loteNew:!1}),window.Swal.fire("Lote guardado con exito","","success").then((function(e){t.handelGetLots(t.state.page),t.props.refresh()}))):(window.Swal.fire("Error","al almacenar el lote","error"),console.error("Orus res: ",a.message))}}))}},{key:"handelGetLots",value:function(e){var t=this,a=JSON.parse(localStorage.getItem("OrusSystem")),s=this.props.id,n="http://"+a.host+"/api/items?store_items_id="+s;fetch(n+"&page="+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){console.log("Descargando lotes"),t.setState({id:s,lote:e,load:!1})})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),t.setState({load:!1})}))}}]),a}(s.Component),La=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).handleChangeCategory=function(t){var a=t.target.value,s=e.props,n=s.categoryData,c=s.handleChangeCategory,r=parseInt(a),o=n.find((function(e){return e.id===r}));r||(o={id:0}),c(o)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.categoryData,a=e.categoryName,s=e.category,n=e.textSelect,c=e.categoryRef;return Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:s?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-sort-amount-down"})})}),Object(ra.jsxs)("select",{className:"custom-select text-uppercase",name:a,value:s,onChange:this.handleChangeCategory,ref:c,children:[Object(ra.jsx)("option",{value:"0",children:n}),t.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria?e.categoria:e.name},e.id)}))]})]})}}]),a}(s.Component),Fa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).getSuppliers=function(){var e=s.state,t=e.host,a=e.token;console.log("solicitando proveedores al API"),fetch("http://"+t+"/api/contacts?type=1",{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){null!==e.data?(console.log("Cargando proveedores"),s.setState({suppliers_data:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar los proveedores","error"))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={suppliers_data:[],text:"",load:!1,host:n.host,token:n.token},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.setState({suppliers_data:[]}),this.getSuppliers()}},{key:"render",value:function(){var e=this.state.suppliers_data,t=this.props,a=t.supplier,s=t.handleChangeSupplier,n=t.supplierRef;return Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Proveedor"})}),e.length?Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:a?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-address-book"})})}),Object(ra.jsxs)("select",{className:"custom-select text-uppercase",name:"supplier",value:a,ref:n,onChange:function(e){var t=e.target.value;s(parseInt(t))},children:[Object(ra.jsx)("option",{value:"0",children:"Seleccione un Proveedor"}),e.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.nombre},e.id)}))]})]}):Object(ra.jsxs)("div",{className:"text-left",children:[Object(ra.jsx)("span",{className:"text-dark",children:"Descargando proveedores"}),Object(ra.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})]})]})})}}]),a}(s.Component),Pa=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleChangeCategory=function(e){var t=e.target.value;(0,s.props.handleChangeBrand)(parseInt(t))},s.getBrands=function(){var e=s.state,t=e.host,a=e.token,n=s.props.supplier;console.log("solicitando marcas al API"),fetch("http://"+t+"/api/brands?supplier="+n,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){null!==e.data?(console.log("descargando marcas"),s.setState({brands:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las marcas","error"))})).catch((function(e){console.error("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={brands:[],host:n.host,token:n.token},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getBrands()}},{key:"componentDidUpdate",value:function(e,t){e.supplier!==this.props.supplier&&(this.setState({brands:[]}),this.getBrands())}},{key:"render",value:function(){var e=this.props,t=e.brandsName,a=e.brand,s=e.textSelect,n=e.brandRef,c=this.state.brands;return Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Marca"})}),c.length?Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:a?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-copyright"})})}),Object(ra.jsxs)("select",{className:"custom-select text-uppercase",name:t,value:a,ref:n,onChange:this.handleChangeCategory,children:[Object(ra.jsx)("option",{value:"0",children:s}),c.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.nombre},e.id)}))]})]}):Object(ra.jsxs)("div",{className:"text-left",children:[Object(ra.jsx)("span",{className:"text-dark",children:"Descargando marcas"}),Object(ra.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})]})]})})}}]),a}(s.Component);function Ba(e){switch(e){case"monofocales":return"MF";case"bifocales":return"BF";case"progresivo basico":case"progresivo-basico":return"PB";case"progresivo digital":case"progresivo-digital":return"PD";case"plastico":return"CR";case"policarbonato":return"PL";case"hi-index":case"hi index":return"HI";case"antirreflejantes":return"AR";case"photo":return"PH";case"ar & photo":case"antirreflejante-photo":return"ARPH";case"blanco":return"BL";case"polarizado":return"PO";case"bifocal invisible":case"bifocal-invisible":return"BI";case"monofocal drivesafe":case"monofocal-drivesafe":case"monofocal digital drivesafe":case"monofocal digital DriveSafe":return"MDSF";case"monofocal superb":case"monofocal-superb":case"monofocal digital superb":return"MDSU";case"monofocal individual":case"monofocal-individual":case"monofocal digital individual":return"MDIN";default:return"XX"}}var za=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleNameLent=function(e){var t="";return t+=null!==s.category2.current?s.category2.current.options[s.category2.current.selectedIndex].text.trim():"",t+=null!==s.category3.current?" "+s.category3.current.options[s.category3.current.selectedIndex].text.trim():"",t+=null!==s.category4.current?" "+s.category4.current.options[s.category4.current.selectedIndex].text.trim():"",(t+=" "+e.toString()).toLowerCase()},s.handleCodeLent=function(e){var t=null!==s.category2.current?Ba(s.category2.current.options[s.category2.current.selectedIndex].text):"";return t+=null!==s.category3.current?Ba(s.category3.current.options[s.category3.current.selectedIndex].text):"",(t+=null!==s.category4.current?Ba(s.category4.current.options[s.category4.current.selectedIndex].text):"")+e.toString()},s.handleCodeString=function(e){var t="armazon";return t+=null!==s.category2.current?" "+s.category2.current.options[s.category2.current.selectedIndex].text.trim():"",t+=null!==s.brandRef.current?" "+s.brandRef.current.options[s.brandRef.current.selectedIndex].text.trim().replace(" ",""):"",(t+=" "+e.toString()).toLowerCase()},s.setNew=function(e){s.setState({id:0,code:"",codebar:"",grad:"",brand_id:0,name:"",unit:"PZ",cant:1,price:1,supplier:0,brand:0,category_id:0,category_id1:0,category_id2:0,category_id3:0,category_id4:0,category_list2:[],category_list3:[],category_list4:[],load:!1})},s.changePage=function(e){s.props.page(e)},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.type,c=e.target.value;"text"===n&&(c=c.toLowerCase()),"number"===n&&(c=parseInt(c)),s.setState(Object(J.a)({},a,c))},s.getCategory=function(){var e=s.state,t=e.host,a=e.token;console.log("solicitando categorias al API"),fetch("http://"+t+"/api/categories?categoryid=raiz",{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){null!==e.data?(console.log("[DEBUG] Almacenando categorias"),s.setState({category_list1:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las categorias","error"))})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},s.handleSave=function(){var e=Object(ce.a)(se.a.mark((function e(t){var a,n,c,r,o,i,l,d,j;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=s.state,n=a.id,c=a.category_id,r=a.category_id1,o=a.category_id2,i=a.category_id4,l=a.supplier,d=a.brand_id,j=a.code,c){e.next=7;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria primero","warning"),e.abrupt("return",!1);case 7:if(1!==r||i===c){e.next=12;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para lentes","warning"),e.abrupt("return",!1);case 12:if(2!==r||o===c){e.next=15;break}return window.Swal.fire("Verificaci\xf3n","Selecione una categoria valida para armazones","warning"),e.abrupt("return",!1);case 15:if(2!==r||l){e.next=18;break}return window.Swal.fire("Verificaci\xf3n","Selecione un PROVEEDOR valido primero","warning"),e.abrupt("return",!1);case 18:if(2!==r||d){e.next=21;break}return window.Swal.fire("Verificaci\xf3n","Selecione una MARCA valida primero","warning"),e.abrupt("return",!1);case 21:if(j||s.codeRef.current.value){e.next=24;break}return window.Swal.fire("Verificaci\xf3n","Escriba una CODIGO para este producto","warning"),e.abrupt("return",!1);case 24:window.Swal.fire({title:"Almacenamiento",text:n?"\xbfEsta seguro de actualizar el producto?":"\xbfEsta seguro de crear un nuevo producto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:n?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=s.state,a=t.id,n=t.code,c=t.codebar,r=t.brand_id,o=t.name,i=t.unit,l=t.cant,d=t.price,j=t.category_id,u=t.token,m=t.host,h=t.supplier,b=t.grad,p=a?"http://"+m+"/api/store/"+a:"http://"+m+"/api/store",x=a?"PUT":"POST",O={code:n||s.codeRef.current.value,codebar:c,name:o||s.nameRef.current.value,unit:i,cant:l,price:d,category_id:j,grad:b||"+000000",brand_id:r||"",contact_id:h||""};return console.log("Enviando datos del producto a API"),fetch(p,{method:x,body:JSON.stringify(O),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+u}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:return t.ok||(console.error("Orus res: ",a.message,a.errors),a.errors&&a.errors.code?window.Swal.fire("Validacion","El CODIGO ya esta registrado","warning"):a.errors&&a.errors.name?window.Swal.fire("Validacion","El nombre del PRODUCTO ya esta registrado","warning"):window.Swal.fire("Error","al almacenar el producto","error")),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data&&(console.log("Producto almacenado",t.data),window.Swal.fire({icon:"success",title:n?"Producto actualizado con exito":"Producto almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){n?s.props.history.push("/almacen"):(s.setState({id:t.data.id}),s.props.history.push("/almacen/registro/".concat(t.data.id)))})))}}));case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.getItem=function(e){if(e>0){var t=s.state,a=t.host,n=t.token;console.log("Solicitando datos de producto a la API"),fetch("http://"+a+"/api/store/"+e,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a,n,c,r,o,i,l;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data?(a=0,n=[],c=[],r=[],o=0,i=0,l=0,t.data.categoria&&t.data.categoria.depende_de?t.data.categoria.depende_de&&t.data.categoria.depende_de.depende_de?t.data.categoria.depende_de.depende_de&&t.data.categoria.depende_de.depende_de.depende_de?(a=t.data.categoria.depende_de.depende_de.depende_de.id,o=t.data.categoria.depende_de.depende_de.id,i=t.data.categoria.depende_de.id,l=t.data.categoria.id,n=t.data.categoria.depende_de.depende_de.depende_de.hijos,c=t.data.categoria.depende_de.depende_de.hijos,r=t.data.categoria.depende_de.hijos):(a=t.data.categoria.depende_de.depende_de.id,o=t.data.categoria.depende_de.id,i=t.data.categoria.id,n=t.data.categoria.depende_de.depende_de.hijos,c=t.data.categoria.depende_de.hijos):(a=t.data.categoria.depende_de.id,o=t.data.categoria.id,n=t.data.categoria.depende_de.hijos):(a=t.data.categoria.id,n=t.data.categoria.hijos),s.setState({id:t.data.id,code:t.data.codigo,codebar:t.data.c_barra,brand_id:t.data.marca?t.data.marca.id:0,grad:t.data.graduacion?t.data.graduacion:"",name:t.data.producto,unit:t.data.unidad,cant:t.data.cantidades,price:t.data.precio,category_id:t.data.categoria.id,category_id1:a,category_list2:n,category_list3:c,category_list4:r,category_id2:o,category_id3:i,category_id4:l,category_data:t.data.categoria,supplier:t.data.proveedor?t.data.proveedor.id:0,load:!1})):(console.error("[Store] add - ",t.message),window.Swal.fire("Error","Error en el sistema, comuniquese con el administrador de sistema","error"),s.setState({load:!1}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))}else s.setState({load:!1})};var c=s.props.match.params.id,r=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={id:c||0,code:"",codebar:"",grad:"",brand_id:0,name:"",unit:"PZ",cant:1,price:1,supplier:0,category_id:0,category_data:{},category_id1:0,category_id2:0,category_id3:0,category_id4:0,category_list1:[],category_list2:[],category_list3:[],category_list4:[],load:!1,host:r.host,token:r.token},s.controller=new AbortController,s.signal=s.controller.signal,s.category1=n.a.createRef(),s.category2=n.a.createRef(),s.category3=n.a.createRef(),s.category4=n.a.createRef(),s.supplierRef=n.a.createRef(),s.brandRef=n.a.createRef(),s.codeRef=n.a.createRef(),s.nameRef=n.a.createRef(),s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.state.id;this.getItem(e),this.getCategory()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state,s=a.category_list1,n=a.category_id,c=a.category_id1,r=a.category_id2,o=a.category_id3;if(t.category_id!==n){if(t.category_id1!==c&&0!==c){var i=s.find((function(e){return e.id===c}));i&&this.setState({category_list2:i.hijos})}if(t.category_id2!==r&&0!==r){var l=s.find((function(e){return e.id===r}));l&&this.setState({category_list3:l.hijos})}if(t.category_id3!==o&&0!==o){var d=s.find((function(e){return e.id===o}));d&&this.setState({category_list4:d.hijos})}}}},{key:"render",value:function(){var e=this,t=this.state,a=t.id,s=t.load,c=t.supplier,r=t.category_id,o=t.category_id1,i=t.category_id2,l=t.category_id3,d=t.category_id4,j=t.category_list1,u=t.category_list2,m=t.category_list3,h=t.category_list4,b=t.brand_id,p=t.code,x=t.name,O=t.grad,g=t.unit,f=t.cant,v=t.price,N=p,y=x;return null!==this.category1.current&&2===parseInt(this.category1.current.value)?x.length<=3&&(y=this.handleCodeString(N)):null!==this.category1.current&&1===parseInt(this.category1.current.value)&&(p.length<=3&&(N=this.handleCodeLent(O)),x.length<=3&&(y=this.handleNameLent(O))),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:a?"col-5":"col-6",children:Object(ra.jsxs)("form",{className:"card card-primary card-outline",onSubmit:this.handleSave,children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title text-primary",children:[Object(ra.jsx)("i",{className:"fas fa-database mr-1"}),a?"Editar producto":"Registrar nuevo producto"]})}),Object(ra.jsx)("div",{className:"card-body",children:j&&j.length&&!s?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("fieldset",{children:[Object(ra.jsx)("small",{className:"mr-2",children:Object(ra.jsx)("label",{children:"Categoria"})}),Object(ra.jsx)(La,{data:this.props.data,category:o,categoryName:"category_id1",categoryData:j,textSelect:"Seleciona la categoria",categoryRef:this.category1,handleChangeCategory:function(t){e.setState({category_id:t.id,category_id1:t.id,category_id2:0,category_list2:t.hijos,category_id3:0,category_list3:[],category_id4:0,category_list4:[],supplier:0})}}),o&&u&&u.length?Object(ra.jsx)(La,{data:this.props.data,category:i,categoryName:"category_id2",categoryData:u,textSelect:"Seleciona el tipo",categoryRef:this.category2,handleChangeCategory:function(t){e.setState({category_id:t.id,category_id2:t.id,category_id3:0,category_list3:t.hijos,category_id4:0,category_list4:[]})}}):null,i&&m&&m.length?Object(ra.jsx)(La,{data:this.props.data,category:l,categoryName:"category_id3",categoryData:m,textSelect:"Seleciona el material",categoryRef:this.category3,handleChangeCategory:function(t){e.setState({category_id:t.id,category_id3:t.id,category_id4:0,category_list4:t.hijos})}}):null,l&&h&&h.length?Object(ra.jsx)(La,{data:this.props.data,category:d,categoryName:"category_id4",categoryData:h,textSelect:"Seleciona el tratamiento",categoryRef:this.category4,handleChangeCategory:function(t){e.setState({category_id:t.id,category_id4:t.id})}}):null]})})}),o&&1!==o?Object(ra.jsx)(Fa,{data:this.props.data,supplier:c,textSelect:"Selecione el proveedor",supplierRef:this.supplierRef,handleChangeSupplier:function(t){e.setState({supplier:t})}}):null,o&&1!==o&&c?Object(ra.jsx)(Pa,{data:this.props.data,brand:b,supplier:c,textSelect:"Selecione la marca",brandRef:this.brandRef,handleChangeBrand:function(t){e.setState({brand_id:t})}}):null,r?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-5",children:[N?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Codigo"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:N?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-code"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Codigo",name:"code",ref:this.codeRef,value:N,onChange:this.catchInputs,autoComplete:"off"})]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Codigo de barras"})}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text bg-primary",children:Object(ra.jsx)("i",{className:"fas fa-barcode"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Codigo de barras",name:"codebar",value:this.state.codebar,onChange:this.catchInputs,autoComplete:"off"})]})]})]}),Object(ra.jsxs)("div",{className:"row",children:[1===o?Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Graduacion"})}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:O?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-glasses"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"+100100",name:"grad",value:O,onChange:this.catchInputs,autoComplete:"off"})]})]}):null,Object(ra.jsxs)("div",{className:"col",children:[y?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Nombre del producto"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:y?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-archive"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre del producto",name:"name",ref:this.nameRef,value:y,onChange:this.catchInputs,autoComplete:"off"})]})]})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[this.state.unit?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Unidad de presentacion"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:g?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-balance-scale"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Unidad de presentaci\xf3n",name:"unit",value:g,onChange:this.catchInputs})]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Cantidad en existencia"})}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:f?"input-group-text bg-primary":"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-database"})})}),Object(ra.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Cantidades en existencia",name:"cant",value:f,onChange:this.catchInputs})]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Precio"})}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:v?"input-group-text bg-primary":"input-group-text bg-warning",children:Object(ra.jsx)("i",{className:"fas fa-money-bill"})})}),Object(ra.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Precio",name:"price",value:v,onChange:this.catchInputs})]})]})]})]}):Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("h6",{className:"text-warning",children:"Seleccione primero una categor\xeda."})})})]}):Object(ra.jsxs)("div",{className:"text-center",children:[Object(ra.jsx)("span",{className:"text-primary",children:"Cargando formulario"}),Object(ra.jsx)("div",{className:"spinner-border text-primary ml-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})]})}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-12",children:Object(ra.jsxs)("div",{className:"btn-group",role:"group",children:[Object(ra.jsxs)(ta.b,{to:"/almacen/registro",className:"btn btn-dark",onClick:this.setNew,children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo"]}),Object(ra.jsxs)(ta.b,{to:"/almacen",className:"btn btn-dark",onClick:function(t){e.changePage("/almacen")},children:[Object(ra.jsx)("i",{className:a?"fas fa-ban mr-1":"fas fa-undo mr-1"}),a?"Cerrar":"Cancelar"]}),Object(ra.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"}),"Guardar"]})]})})})})]})}),a?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(Da,{id:a,price:this.state.price,refresh:this.getItem})}):null]})}}]),a}(s.Component),Ma=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleChangePage=function(e){s.setState({page:e})},s.handleClickDelete=function(e,t){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la categoria "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t&&e){var a=s.state,n=a.host,c=a.token;return console.log("Solicitud de eliminaci\xf3n de categoria por API"),fetch("http://"+n+"/api/categories/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(t){t&&!t.dismiss&&t.value?(console.log("Categoria eliminado"),window.Swal.fire({icon:"success",title:"Categoria eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(t){var a=s.props.category,n=s.state.category_raiz,c=0;n.length&&(n.filter((function(t,a){return t.id===e&&(c=a),!1})),n.splice(c,1),s.setState({category_raiz:n,category_id:a}))}))):t&&!t.dismiss&&(console.log("Orus res: ",t),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.handleClickSave=function(){if(s.state.name.length<4)return window.Swal.fire("Verificaci\xf3n","Debe de escribir el nombre de la categoria","warning"),s.nameInput.focus(),!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva categoria?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=s.state,a=t.host,n=t.token,c=t.category_id,r=t.name,o=s.props.category,i={name:r,category_id:parseInt(c)?parseInt(c):parseInt(o)?parseInt(o):""};return console.log("Enviando datos a API para almacenar"),fetch("http://"+a+"/api/categories",{method:"POST",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value,a=s.state,n=a.category_raiz,c=a.category_id,r=s.props.category;t.data?(console.log("Categoria almacenada"),window.Swal.fire({icon:"success",title:"Categoria almacenada con exito",showConfirmButton:!1,timer:1500}).then(function(){var e=Object(ce.a)(se.a.mark((function e(a){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(parseInt(r)!==c){e.next=4;break}n.push(t.data),e.next=6;break;case 4:return e.next=6,n.find((function(e){return e.id===c&&(e.hijos.push(t.data),e)}));case 6:s.setState({category_raiz:n,name:"",add:!s.state.add,category_id:t.data.id});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):(window.Swal.fire("Error","al almacenar la categoria","error"),console.error("Orus res: ",t.message))}}))},s.getCategoriesMain=function(){var e=s.props,t=e.category,a=e.CategoryData;if(void 0!==a&&a.length)s.setState({category_raiz:a||[],category_id:t,load:!1});else{var n=s.state,c=n.host,r=n.token,o=n.page,i=n.load,l="http://"+c+"/api/categories",d=t?"&categoryid="+t:"&categoryid=raiz",j=o>0?"?page="+o:"?page=1";i||s.setState({load:!0}),fetch(l+j+d,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){s.setState({category_raiz:null!==e.data?e.data:[],category_id:t,load:!1})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}},s.handleClickAdd=function(){s.setState({add:!s.state.add,name:""})},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value;s.setState(Object(J.a)({},a,n.toLowerCase()))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={meta:{},add:!1,name:"",category_raiz:[],category_id:e.category,page:1,host:n.host,token:n.token,load:!0},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getCategoriesMain()}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.category;e.category!==a&&this.getCategoriesMain()}},{key:"render",value:function(){var e=this,t=this.state,a=t.category_raiz,s=t.category_id,c=t.name,r=t.add,o=t.meta,i=t.load,l=this.props,d=l.categoryName,j=l.categoryDataName,u=l.categorySelect,m=l.category,h=l.last;return Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsxs)("table",{className:"table",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Nombre"}),Object(ra.jsx)("th",{style:{width:16},className:"text-center",children:"E"})]})}),Object(ra.jsx)("tbody",{children:!i&&a?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("tr",{className:s===m?"table-success":"",onClick:function(t){var a;e.setState({category_id:parseInt(m)?m:0}),u((a={},Object(J.a)(a,d,0),Object(J.a)(a,j,[]),Object(J.a)(a,"category_id",m),a))},children:Object(ra.jsx)("td",{colSpan:"2",className:"text-capitalize",style:{cursor:"pointer"},children:"Raiz"})}),a.map((function(t){return Object(ra.jsxs)("tr",{className:t.id===s?"table-success":"",style:{cursor:"pointer"},onClick:function(a){var s,n;h?(e.setState({category_id:parseInt(m)?m:0}),u((s={},Object(J.a)(s,d,0),Object(J.a)(s,j,[]),Object(J.a)(s,"category_id",m),s))):(u((n={},Object(J.a)(n,d,t.id),Object(J.a)(n,j,t.hijos),Object(J.a)(n,"category_id",t.id),n)),e.setState({category_id:t.id}))},children:[Object(ra.jsx)("td",{className:"text-capitalize",children:Object(ra.jsx)("a",{href:"#select!"+t.id,onClick:function(a){a.preventDefault(),e.setState({category_id:t.id})},children:t.categoria})}),Object(ra.jsx)("td",{children:t.hijos.length?null:Object(ra.jsx)("button",{className:"btn btn-outline-dark btn-sm",onClick:function(a){e.handleClickDelete(t.id,t.categoria)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})})]},t.id)}))]}):Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"8",className:"text-center",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})})})}),r&&!i?Object(ra.jsx)("tfoot",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{type:"text",name:"name",className:"form-control text-capitalize",autoComplete:"off",value:c,onChange:this.catchInputs,ref:function(t){e.nameInput=t}})}),Object(ra.jsx)("td",{children:Object(ra.jsx)("button",{className:"btn btn-dark btn-sm",onClick:this.handleClickSave,children:Object(ra.jsx)("i",{className:"fas fa-save"})})})]})}):Object(ra.jsx)("tfoot",{children:Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"3",children:Object(ra.jsx)(xa,{meta:o,handleChangePage:this.handleChangePage})})})})]})}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("button",{className:"btn btn-primary btn-sm",onClick:this.handleClickAdd,children:this.state.add?Object(ra.jsx)("i",{className:"fas fa-undo"}):Object(ra.jsx)("i",{className:"fas fa-plus"})})})]})}}]),a}(s.Component),Ua=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleChangeState=function(e){void 0!==e.category_id1&&e.category_id1?(e.category_id2=0,e.category_id3=0,e.category_id4=0):void 0!==e.category_id2&&e.category_id2?(e.category_id3=0,e.category_id4=0):void 0!==e.category_id3&&e.category_id3&&(e.category_id4=0),s.setState(e)},s.state={category_id:0,category_id1:0,category_hijos1:[],category_id2:0,category_hijos2:[],category_id3:0,category_hijos3:[],category_id4:0,category_hijos4:[]},s}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.state,t=e.category_id1,a=e.category_hijos1,s=e.category_id2,c=e.category_hijos2,r=e.category_id3,o=e.category_hijos3;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("h5",{children:"Categorias de productos"}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(Ma,{data:this.props.data,category:0,categoryName:"category_id1",categoryDataName:"category_hijos1",categorySelect:this.handleChangeState})}),t&&a.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(Ma,{data:this.props.data,category:t,CategoryData:a,categoryName:"category_id2",categoryDataName:"category_hijos2",categorySelect:this.handleChangeState,last:2===t})}):null,s&&c.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(Ma,{data:this.props.data,category:s,CategoryData:c,categoryName:"category_id3",categoryDataName:"category_hijos3",categorySelect:this.handleChangeState})}):null,r&&o.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(Ma,{data:this.props.data,category:r,CategoryData:o,categoryName:"category_id4",categoryDataName:"category_hijos4",categorySelect:this.handleChangeState,last:!0})}):null]})]})}}]),a}(s.Component),Ga=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).deleteBrand=function(e,t){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el producto "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t){var a=s.state,n=a.host,c=a.token;return console.log("Solicitud de eliminaci\xf3n de marca por API"),fetch("http://"+n+"/api/brands/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(t){t&&!t.dismiss&&t.value?(console.log("Marca eliminada"),window.Swal.fire({icon:"success",title:"Marca eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(t){var a=s.state.brands,n=0;a.length&&(a.filter((function(t,a){return t.id===e&&(n=a),!1})),a.splice(n,1),s.setState({brands:a}))}))):t&&!t.dismiss&&(console.log("Orus res: ",t),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.saveBrand=function(e){e.preventDefault();var t=s.state,a=t.name,n=t.supplier;return a.length<3?(window.Swal.fire("Error","El nombre de la marca debe de tener por lo menos 3 caracteres","error"),!1):n?void window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva marca?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=s.state,a=t.name,n=t.supplier,c=t.token,r=t.host,o={name:a,contact_id:n};return console.log("Enviando datos de la marca a API"),fetch("http://"+r+"/api/brands",{method:"POST",body:JSON.stringify(o),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("Marca almacenada"),window.Swal.fire({icon:"success",title:"Marca almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){var a=s.state.brands;a.push(t.data),s.setState({brands:a,name:""})}))):(window.Swal.fire("Error","al almacenar la marca","error"),console.error("Orus res: ",t.message))}})):(window.Swal.fire("Error","Debe de elegir a un proveedor primero","error"),!1)},s.changeInput=function(e){var t=e.target,a=t.name,n=t.value;s.setState(Object(J.a)({},a,n))},s.getBrands=function(){var e=s.state,t=e.supplier,a=e.host,n=e.token;console.log("solicitando marcas al API"),fetch("http://"+a+"/api/brands?supplier="+t,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){null!==e.data?(console.log("descargando marcas"),s.setState({brands:e.data})):(console.error("Orus: ",e.message),window.Swal.fire("Error","Error al descargar las marcas","error"))})).catch((function(e){console.error("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={supplier:0,brands:[],name:"",load:!1,host:n.host,token:n.token},s}return Object(Kt.a)(a,[{key:"componentDidUpdate",value:function(e,t){t.supplier!==this.state.supplier&&this.state.supplier&&this.getBrands()}},{key:"render",value:function(){var e=this,t=this.state,a=t.supplier,s=t.name,c=t.brands;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("h5",{children:"Marcas para productos"}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card card-primary card-outline",children:Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsx)(Fa,{data:this.props.data,supplier:a,handleChangeSupplier:function(t){e.setState({supplier:t})}})})})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h5",{className:"card-title text-primary mb-4",children:a?"Listado de marcas":"Primero seleccione a un proveedor"}),a?Object(ra.jsx)("ul",{className:"card-text list-group",children:c.length?c.map((function(t){return Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("span",{className:"text-primary",children:t.nombre}),Object(ra.jsx)("span",{className:"badge badge-dark badge-pill",style:{cursor:"pointer"},onClick:function(a){e.deleteBrand(t.id,t.nombre)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})]},t.id)})):Object(ra.jsx)("li",{className:"list-group-item",children:"No hay marcas registradas para este proveedor"})}):null]}),a?Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("form",{onSubmit:this.saveBrand,children:Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("input",{type:"text",className:"form-control mr-1",name:"name",value:s,onChange:this.changeInput}),Object(ra.jsx)("button",{className:"btn btn-dark",children:Object(ra.jsx)("i",{className:"fas fa-save"})})]})})}):null]})})]})]})}}]),a}(s.Component),Ra={_getList:et.getListContacts,_setList:et.setListContact},Va=Object(Wt.b)((function(e){return{contacts:e.contact.list}}),Ra)((function(e){var t=e.id,a=e.type,n=e.business,c=e.name,r=e.rfc,o=e.email,i=e.birthday,l=e.handleChangeData,d=e.verification,j=e.contacts,u=e._getList,m=e._setList,h=function(e){var t=e.target,a=t.name,s=t.value,n=t.checked,c=s;"type"===a&&(c=parseInt(s)),"business"===a&&(c=n),"name"!==a&&j.length&&(console.log("[DEBUG] add_personal catch input",a),m({result:{list:[],metaList:{}}})),l(a,c)},b=Object(s.useState)(null),p=Object(wa.a)(b,2),x=p[0],O=p[1];return Object(s.useEffect)((function(){if(!t){var e=null;c.length>2?(x&&clearTimeout(x),e=setTimeout((function(){u({search:c})}),1e3),O(e)):1===c.length&&(console.log("[DEBUG] add_personal effect:",c.length),m({result:{list:[],metaList:{}}}))}}),[c]),Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Tipo de contacto"}),Object(ra.jsxs)("select",{className:"custom-select",name:"type",value:null!==a&&void 0!==a?a:"",onChange:h,children:[Object(ra.jsx)("option",{value:"0",children:"Cliente"}),Object(ra.jsx)("option",{value:"1",children:"Proveedor"})]})]}),a?Object(ra.jsxs)("div",{className:"form-group custom-control custom-checkbox",children:[Object(ra.jsx)("input",{type:"checkbox",name:"business",className:"custom-control-input",checked:null!==n&&void 0!==n?n:"",onChange:h,id:"business_checkbox"}),Object(ra.jsx)("label",{htmlFor:"business_checkbox",className:"custom-control-label cursor-pointer",children:Object(ra.jsx)("small",{children:"\xbfEs un laboratorio?"})})]}):null,Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"RFC"}),Object(ra.jsx)("input",{type:"text",className:"form-control text-uppercase text-truncate",placeholder:"facturas",name:"rfc",value:null!==r&&void 0!==r?r:"",onChange:h,minLength:"10"})]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("div",{className:"form-group position-relative",children:[Object(ra.jsxs)("label",{children:["Nombre completo ",Object(ra.jsx)("span",{className:"text-orange",children:"*"})]}),Object(ra.jsx)("input",{type:"text",className:j.length&&!t?"form-control text-capitalize text-truncate text-danger":"form-control text-capitalize text-truncate",placeholder:"Ej: Juan Perez G",name:"name",value:null!==c&&void 0!==c?c:"",onChange:h}),!c|!d.name?Object(ra.jsx)("small",{children:Object(ra.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})}):null,j.length&&c.length>2&&!t?Object(ra.jsx)("div",{className:"position-absolute border rounded p-0 bg-white overflow-auto ",style:{zIndex:"50",top:"4.1rem",width:"100%",maxHeight:"8rem"},children:Object(ra.jsx)("ul",{className:"list-group",children:j.map((function(e){return Object(ra.jsxs)("li",{className:"list-group-item text-truncate",children:[Object(ra.jsx)("i",{className:"fas fa-minus mr-1 text-danger"}),Object(ra.jsx)("span",{className:"text-capitalize text-muted text-monospace text-sm",children:e.nombre})]},e.id)}))})}):null]}),Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsxs)("label",{children:["Correo electr\xf3nico ",Object(ra.jsx)("span",{className:"text-orange",children:"*"})]}),Object(ra.jsx)("input",{type:"email",className:"form-control text-lowercase text-truncate",placeholder:"Ej: correo@domain.com",name:"email",value:null!==o&&void 0!==o?o:"",onChange:h}),!o|!d.email?Object(ra.jsx)("small",{children:Object(ra.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})}):null]}),a?null:Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsxs)("label",{children:["Fecha de nacimiento ",Object(ra.jsx)("span",{className:"text-orange",children:"*"})]}),Object(ra.jsx)("input",{type:"date",className:"form-control text-truncate",placeholder:"","data-inputmask-alias":"datetime","data-inputmask-inputformat":"dd/mm/yyyy","data-mask":"","im-insert":"false",name:"birthday",value:null!==i&&void 0!==i?i:"",onChange:h}),!i|!d.birthday?Object(ra.jsx)("small",{children:Object(ra.jsx)("span",{className:"text-orange",children:"Este campo es requerido"})}):null]})]})]})})),Ja=function(e){var t=e.domicilios,a=e.handleChangeData,s=t.calle,n=t.colonia,c=t.municipio,r=t.estado,o=t.cp,i=function(e){var s=e.target,n=s.name,c=s.value,r=t;"calle"===n&&(r.calle=c),"colonia"===n&&(r.colonia=c),"municipio"===n&&(r.municipio=c),"estado"===n&&(r.estado=c),"cp"===n&&(r.cp=c),a("domicilios",r)};return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"col",children:[s?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Calle y numero"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-1",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-road"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Calle y numero",name:"calle",value:s,onChange:i})]}),n?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Colonia"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-1",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-location-arrow"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Colonia",name:"colonia",value:n,onChange:i})]}),c?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Municipio"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-1",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-location-arrow"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Municipio",name:"municipio",value:c,onChange:i})]})]}),Object(ra.jsxs)("div",{className:"col",children:[r?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Estado"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-1",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-map-marker"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Estado",name:"estado",value:r,onChange:i})]}),o?Object(ra.jsx)("small",{children:Object(ra.jsx)("label",{children:"Codigo postal"})}):Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"input-group mb-1",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-map-marker"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Codigo Postal",name:"cp",value:o,onChange:i})]})]})]})},qa=function(e){var t=e.telefonos,a=e.handleChangeData,s=t.t_casa,n=void 0===s?"":s,c=t.t_oficina,r=void 0===c?"":c,o=t.t_movil,i=void 0===o?"":o,l=function(e){var s=e.target,n=s.name,c=s.value,r=/^\d+$/gim,o=t;"t_casa"===n&&r.test(c)&&(o.t_casa=c,o.t_movil.length<10&&(o.t_movil=c)),"t_oficina"===n&&r.test(c)&&(o.t_oficina=c),"t_movil"===n&&r.test(c)&&(o.t_movil=c),a("telefonos",o)};return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Telefono personal"}),Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-phone"})})}),Object(ra.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_casa",value:n,onChange:l})]})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Telefono para recados"}),Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-phone"})})}),Object(ra.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_oficina",value:r,onChange:l})]})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Numero de whatsApp"}),Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-phone"})})}),Object(ra.jsx)("input",{type:"tel",className:"form-control",placeholder:"(999) 999 9999",maxLength:"10",name:"t_movil",value:i,onChange:l})]})]})})]})},$a=function(e){var t=e.sales;return Object(ra.jsxs)("table",{className:"table m-0",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"ID"}),Object(ra.jsx)("th",{children:"Total"}),Object(ra.jsx)("th",{children:"Orden"}),Object(ra.jsx)("th",{children:"Registrado"})]})}),Object(ra.jsx)("tbody",{children:t.map((function(e){return Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("th",{children:["#",e.id]}),Object(ra.jsxs)("td",{children:["$ ",e.total.toFixed(2)]}),Object(ra.jsxs)("td",{children:["#",e.pedido]}),Object(ra.jsxs)("td",{className:"text-truncate",children:[Object(ra.jsx)("i",{className:"fas fa-clock mr-2"}),na()(e.created_at).fromNow()]})]},e.id)}))})]})},Ha=function(e){var t=e.purchases,a=e.exams,s=e.register,n=e.created,c=e.updated,r=e.updated_at,o=e.brands,i=e.orders,l=e.suppliers;return Object(ra.jsxs)("div",{className:"row",children:[o?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-orange",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:o}),Object(ra.jsx)("p",{children:"Marcas"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-shopping-bag"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(ra.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,l?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-indigo",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:l}),Object(ra.jsx)("p",{children:"Laboratorio"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-building"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(ra.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,t?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-success",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:t}),Object(ra.jsx)("p",{children:"Compras"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-money-bill"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(ra.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,a?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-info",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:a}),Object(ra.jsx)("p",{children:"Examenes"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-notes-medical"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(ra.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,i?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-warning",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:i}),Object(ra.jsx)("p",{children:"Pedidos"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-shopping-basket"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Mas ",Object(ra.jsx)("i",{className:"fas fa-arrow-circle-right"})]})]})}):null,s?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-primary",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{children:na()(s).format("L")}),Object(ra.jsx)("p",{children:"Registrado"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-calendar"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs",children:["Modificado: ",r?na()(r).format("L"):"--"]})]})}):null,n?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"small-box bg-primary",children:[Object(ra.jsxs)("div",{className:"inner",children:[Object(ra.jsx)("h5",{className:"text-truncate",children:n}),Object(ra.jsx)("p",{children:"Registrado por"})]}),Object(ra.jsx)("div",{className:"icon",children:Object(ra.jsx)("i",{className:"fas fa-user"})}),Object(ra.jsxs)("a",{href:"#details",className:"small-box-footer text-xs text-truncate",children:["Modificado: ",c||"--"]})]})}):null]})},Za=function(e){var t=e.brands;return Object(ra.jsxs)("table",{className:"table m-0",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Nombre"}),Object(ra.jsx)("th",{children:"Registrado"})]})}),Object(ra.jsx)("tbody",{children:t.map((function(e){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{className:"text-uppercase",children:e.name}),Object(ra.jsxs)("td",{className:"text-truncate",children:[Object(ra.jsx)("i",{className:"fas fa-clock mr-2"}),na()(e.created_at).fromNow()]})]},e.id)}))})]})},Xa=function(e){var t,a=JSON.parse(null!==(t=localStorage.getItem("OrusSystem"))&&void 0!==t?t:"");return a.orders||(a.orders=[]),e?a.orders:a},Wa=function(e,t){var a=Xa(),s=Object(i.a)(Object(i.a)({},a),{},{orders:a.orders.filter((function(t){return t.id!==e}))});localStorage.setItem("OrusSystem",JSON.stringify(s)),t&&t()},Ya={handleStatusString:function(e){switch(e){case 0:return"procesando";case 1:return"laboratorio";case 2:return"bicelacion";case 3:return"terminado";case 4:return"entregado";default:return"garantia"}},handleDeleteOrder:function(e,t,a){if(e.id)return e.estado?(window.Swal.fire({title:"Verificacion",text:"El pedido tiene un proceso avanzado",icon:"warning"}),!1):e.nota?(window.Swal.fire({title:"Verificacion",text:"No se puede eliminar un pedido con una venta activa",icon:"warning"}),!1):(window.Swal.fire({text:"\xbfEsta seguro de eliminar el pedido ".concat(e.id,"?"),icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(s){if(!s.dismiss&&a)return a({id:e.id,options:t}),console.log("[Orus System] Eliminando pedido: "+e.id),!0})),!1)},handleSaveOrder:function(e,t,a,s,n){console.log("[DEBUG] save item",e,t),window.Swal.fire({title:"Almacenamiento",text:e?"\xbfEsta seguro de actualizar el pedido ".concat(e,"?"):"\xbfEsta seguro de crear un nuevo pedido?",icon:"question",showCancelButton:!0,confirmButtonText:e?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(c){!c.dismiss&&s&&(s({data:t,id:e,options:a}),n&&n(),Wa(t.contact_id))}))},getDataTemporary:Xa,addDataTemporary:function(e){var t=Xa(),a=Object(i.a)(Object(i.a)({},t),{},{orders:t.orders.filter((function(t){return t.id!==e.id}))});a.orders.push(e),localStorage.setItem("OrusSystem",JSON.stringify(a))},removeDataTemporary:Wa,getDataOneItem:function(e){var t;return null!==(t=Xa().orders.filter((function(t){return t.id===e}))[0])&&void 0!==t?t:{}},getStatusType:["procesando","laboratorio","bicelacion","terminado","entregado"]},Ka=function(e){var t=e.orders;return Object(ra.jsxs)("table",{className:"table m-0",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"ID"}),Object(ra.jsx)("th",{children:"Folio LAB"}),Object(ra.jsx)("th",{children:"Nota"}),Object(ra.jsx)("th",{children:"Estado"}),Object(ra.jsx)("th",{children:"Registrado"})]})}),Object(ra.jsx)("tbody",{children:t.map((function(e){return Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("th",{children:["#",e.id]}),Object(ra.jsx)("td",{children:e.order_foreing?"#".concat(e.order_foreing):"--"}),Object(ra.jsx)("td",{children:e.nota?"#".concat(e.nota):"--"}),Object(ra.jsx)("td",{className:"text-uppercase",children:Object(ra.jsx)("span",{className:"badge badge-secondary",children:Ya.handleStatusString(e.status)})}),Object(ra.jsxs)("td",{className:"text-truncate",children:[Object(ra.jsx)("i",{className:"fas fa-clock mr-2"}),na()(e.created_at).fromNow()]})]},e.id)}))})]})},Qa=function(e){var t=e.exams,a=void 0===t?[]:t,n=e.allSelect,c=void 0!==n&&n,r=e.handleSelectedExam,o=Object(s.useState)(""),i=Object(wa.a)(o,2),l=i[0],d=i[1];return Object(ra.jsxs)("table",{className:"table m-0",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{scope:"col"}),Object(ra.jsx)("th",{scope:"col",children:"Folio"}),Object(ra.jsx)("th",{scope:"col",children:"Registrado"}),Object(ra.jsx)("th",{scope:"col",children:"Estado"})]})}),Object(ra.jsxs)("tbody",{children:[a.length?null:Object(ra.jsx)("tr",{children:Object(ra.jsxs)("th",{colSpan:"4",className:"text-center",children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"No hay registros"]})}),a.map((function(e){return Object(ra.jsxs)("tr",{className:na()(new Date).isSame(na()(e.created_at),"day")?"text-primary":"",children:[Object(ra.jsx)("td",{children:Object(ra.jsx)("div",{className:"icheck-primary",children:r?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("input",{type:"checkbox",name:"exam_"+e.id,id:"exam_"+e.id,value:l,onChange:function(t){return d((a=e).id),void r(a);var a},disabled:!c&&!e.estado,checked:l===e.id}),Object(ra.jsx)("label",{htmlFor:"exam_"+e.id})]}):null})}),Object(ra.jsx)("th",{scope:"row",children:Object(ra.jsxs)("span",{className:"text",children:["#",e.id]})}),Object(ra.jsxs)("td",{className:"text-truncate",children:[Object(ra.jsx)("i",{className:"fas fa-clock mr-2"}),na()(e.created_at).fromNow()]}),Object(ra.jsx)("td",{children:e.estado?Object(ra.jsxs)("span",{className:"badge badge-success",children:[Object(ra.jsx)("i",{className:"fas fa-check"})," Terminado"]}):Object(ra.jsxs)("span",{className:"badge badge-secondary",children:[Object(ra.jsx)("i",{className:"fas fa-hourglass"})," Activo"]})})]},e.id)}))]})]})},es=function(e){var t="";return e.parent?e.parent.parent?(t=e.parent.parent.meta.code,t+=e.parent.meta.code,t+=e.meta.code):(t=e.parent.meta.code,t+=e.meta.code):t=e.meta.code,t},ts={handleTypeInput:function(e){return"pc"===e||"tablet"===e||"movil"===e||"lap"===e||"pc_time"===e||"tablet_time"===e||"movil_time"===e||"lap_time"===e||"frontal"===e||"occipital"===e||"generality"===e||"cefalea"===e||"temporaod"===e||"temporaoi"===e||"c_frecuencia"===e||"c_intensidad"===e?"generales":"interrogatorio"===e||"coa"===e||"aopp"===e||"aopf"===e?"interrogatorios":"keratometriaod"===e||"keratometriaoi"===e||"rsod"===e||"rsoi"===e?"keraRet":"d_time"===e||"d_media"===e||"d_test"===e||"d_fclod"===e||"d_fclod_time"===e||"d_fcloi"===e||"d_fcloi_time"===e?"diabetes":"cvod"===e||"cvoi"===e||"avslod"===e||"avsloi"===e||"avcgaod"===e||"avcgaoi"===e||"avfod"===e||"avfoi"===e||"avf2o"===e?"agudeza":"diagnostico"===e||"presbicie"===e||"piod"===e||"pioi"===e||"txoftalmico"===e?"diagnostico":"esferaod"===e||"esferaoi"===e||"cilindrod"===e||"cilindroi"===e||"ejeod"===e||"ejeoi"===e||"adiciond"===e||"adicioni"===e||"adicion_media_od"===e||"adicion_media_oi"===e||"dpod"===e||"dpoi"===e||"alturaod"===e||"alturaoi"===e||"lcmarca"===e||"lcgod"===e||"lcgoi"===e?"graduacion":"observaciones"===e?"observaciones":null},handleCodeName:es,getCodeGrad:function(e,t,a,s,n){var c=Object.keys(e).length?es(e):null;if(!c)return{};var r="+000000",o="+000000";return(s||t)&&(r=t>0?"+":"",r+=t.toFixed(2).toString().replace(".","")+s.toFixed(2).toString().replace("-","").replace(".","")),(n||a)&&(o=a>0?"+":"",o+=a.toFixed(2).toString().replace(".","")+n.toFixed(2).toString().replace("-","").replace(".","")),{code:c,od:r,oi:o}},handleSaveExam:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,s=e.examenes.filter((function(e){return 0===na()(e.created_at).diff(na()(),"days")||!e.estado}));if(s.length&&!t)return window.Swal.fire({title:"Examenes",text:"Existe un examen activo o del dia",icon:"error"}),console.error("[OrusSystem] Examenes activos:",s.length),!1;window.Swal.fire({title:"Almacenamiento",text:t?"\xbfEsta seguro de actualizar este examen?":"\xbfEsta seguro de crear un nuevo examen?",icon:"question",showCancelButton:!0,confirmButtonText:t?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(t){!t.dismiss&&a&&a({id:0,data:{edad:e.edad,contact_id:e.id}})}))}},as={_saveExam:vt.saveExam,_setMsgExam:vt.setMessagesExam},ss=Object(Wt.b)((function(e){var t=e.contact;return{msg_exams:e.exam.messages,contact:t.contact}}),as)((function(e){var t=e.contact,a=void 0===t?{}:t,s=e.showBottons,n=void 0===s||s,c=e.showNew,r=void 0===c||c,o=e.handeleChangePage,i=a.examenes,l=void 0===i?[]:i;return Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title text-indigo text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-notes-medical mr-1"}),"Examenes"]}),l.length?Object(ra.jsx)(Qa,{allSelect:!0,exams:l,handleSelectedExam:function(e){o(e)}}):Object(ra.jsx)("div",{className:"alert alert-info mt-5",children:Object(ra.jsxs)("h5",{children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Aun no hay examenes para este contacto"]})})]}),!a.deleted_at&&n?Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("div",{className:"btn-group",children:r?Object(ra.jsx)("button",{className:"btn btn-secondary",onClick:function(t){return ts.handleSaveExam(e.contact,0,e._saveExam)},children:"Nuevo"}):null})}):null]})}));var ns=function(e){var t=e.title,a=void 0===t?"confirmaci\xf3n":t,s=e.body,n=e.handleCancel;return Object(ra.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(ra.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsx)("h5",{className:"modal-title text-dark text-bold text-capitalize",children:a}),Object(ra.jsx)("button",{type:"button",className:"close",onClick:function(){n&&n()},children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsx)("div",{className:"modal-body",children:s})]})})})},cs={dataPrimary:{name:"",telnumbers:{t_casa:"",t_oficina:"",t_movil:""},email:"",birthday:"",type:0,business:0},handleVerificationData:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=e.name,s=e.email,n=e.birthday,c=e.telnumbers,r=e.type,o=/^[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+\s[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]{2,}(\s?[A-Z\xc1\xc9\xcd\xd3\xda\xf1\xe1\xe9\xed\xf3\xfa\xd1]+){1,}/gim,i=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/gim,l=/^\d{10}$/gim;if(!r&&!o.test(a))return t&&window.Swal.fire({title:"Verificacion",text:"El nombre del contacto es erroneo",icon:"warning"}),{result:!1,name:"name"};if(!i.test(s))return t&&window.Swal.fire({title:"Verificacion",text:"El correo electr\xf3nico del contacto es erroneo",icon:"warning"}),{result:!1,name:"email"};var d=Object.values(c),j=!0;if(d.every((function(e){return!l.test(e)||(j=!1,!1)})),!r&&j)return t&&window.Swal.fire({title:"Verificacion",text:"El numero de contacto es erroneo",icon:"warning"}),{result:!1,name:"telnumbers"};var u=new Date(n),m=new Date,h=m.getFullYear()-u.getFullYear();return r||n&&!(h<1)?{result:!0}:(t&&window.Swal.fire({title:"Verificacion",text:"La fecha de nacimiento es erronea",icon:"warning"}),{result:!1,name:"bithday"})},saveContact:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"contacto",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;window.Swal.fire({title:"Almacenamiento",text:s?"\xbfEsta seguro de actualizar al ".concat(e,"?"):"\xbfEsta seguro de crear un nuevo ".concat(e,"?"),icon:"question",showCancelButton:!0,confirmButtonText:s?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){!e.dismiss&&a&&a({id:s,data:t})}))},changeDataInput:function(e,t,a){var s=e.name,n=e.value,c=n;"telnumbers"===s&&(c=Object(i.a)(Object(i.a)({},t.telnumbers),{},{t_movil:n})),a(Object(i.a)(Object(i.a)({},t),{},Object(J.a)({},s,c)))},handleGetDataObject:function(e,t,a){switch(e){case"name":return{name:t,verification:Object(i.a)(Object(i.a)({},a),{},{name:!0})};case"email":return{email:t,verification:Object(i.a)(Object(i.a)({},a),{},{email:!0})};case"birthday":return{birthday:t,verification:Object(i.a)(Object(i.a)({},a),{},{birthday:!0})};case"telefonos":return{telefonos:t,verification:Object(i.a)(Object(i.a)({},a),{},{telefonos:!0})};default:return Object(J.a)({},e,t)}}},rs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).dataBodyConfirm=function(e){return Object(ra.jsxs)("div",{children:[Object(ra.jsx)("p",{className:"text-center",children:"\xbfRealmente desea ver el examen?"}),Object(ra.jsx)("div",{className:"text-center",children:Object(ra.jsx)(ta.b,{to:"/consultorio/".concat(e),className:"btn btn-primary",children:"Confirmar"})})]})},s.handleCloseModal=function(){s.setState({showModal:!1})},s.handleSelectExam=function(e){var t=e.id;console.log("[DEBUG] select exam",t),s.setState({showModal:!0,idExamSelect:t})},s.handleChangeData=function(e,t){var a=s.state.verification,n=cs.handleGetDataObject(e,t,a);s.setState(n)},s.handleSave=function(e){e.preventDefault();var t=s.state,a=t.id,n=t.name,c=t.rfc,r=t.email,o=t.type,i=t.birthday,l=t.domicilios,d=t.telnumbers,j=t.business,u=s.props._saveContact;if(!cs.handleVerificationData(s.state))return!1;var m={calle:l.calle.trim(),colonia:l.colonia.trim(),municipio:l.municipio.trim(),estado:l.estado.trim(),cp:l.cp.trim()},h={name:n.trim().toLocaleLowerCase(),rfc:c.trim().toLocaleLowerCase(),email:r.trim().toLocaleLowerCase(),type:o,birthday:new Date(i),domicilio:JSON.stringify(m),telnumbers:JSON.stringify(d),business:j?1:0};cs.saveContact("contacto",h,u,a)},s.getUser=function(){var e,t,a,n=s.props.contact,c=n.id,r=n.domicilio,o=n.telefonos;c?s.setState({id:c,name:n.nombre,rfc:null!==(e=n.rfc)&&void 0!==e?e:"",email:null!==(t=n.email)&&void 0!==t?t:"",type:n.tipo,business:n.empresa,birthday:null!==(a=n.f_nacimiento)&&void 0!==a?a:"",domicilios:r||{calle:"",colonia:"",municipio:"",estado:"",cp:""},telnumbers:o||{t_casa:"",t_oficina:"",t_movil:""},load:!1}):s.setState({load:!1})},s.state={id:0,name:"",rfc:"",email:"",type:0,birthday:"",domicilios:{calle:"",colonia:"",municipio:"",estado:"",cp:""},telnumbers:{t_casa:"",t_oficina:"",t_movil:""},business:!1,verification:{name:!0,email:!0,birthday:!0,telefonos:!0},load:!1,showModal:!1,idExamSelect:0},s.timeSave=null,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.setState({load:!0})}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,s=a.msg_exams,n=a.msg_contact,c=a.contact,r=a._setMsgExam,o=a._getContact,i=this.state.load;e.msg_exams.length!==s.length&&s.length&&(s.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),r(),o(c.id),this.setState({load:!0})),e.msg_contact.length!==n.length&&n.length&&s.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),e.contact.id!==c.id&&c.id&&this.setState({load:!0}),e.load!==i&&i&&this.getUser()}},{key:"render",value:function(){var e=this.state,t=e.id,a=e.name,s=e.rfc,n=e.email,c=e.type,r=e.birthday,o=e.domicilios,i=e.telnumbers,l=e.business,d=e.load,j=e.verification,u=e.showModal,m=e.idExamSelect,h=this.props,b=h.handleClose,p=h.contact,x=p.compras,O=void 0===x?[]:x,g=p.purchases_count,f=p.exams_count,v=p.marcas,N=void 0===v?[]:v,y=p.brands_count,w=p.proveedor_de,S=void 0===w?[]:w,C=p.suppliers_count,_=p.orders,k=void 0===_?[]:_,E=p.orders_count,I=p.created_at,A=p.created,T=p.updated_at,D=p.updated,L=Object.values(i).filter((function(e){return 10===e.length}));return Object(ra.jsxs)(ra.Fragment,{children:[p.id?Object(ra.jsx)(Ha,{purchases:g,exams:f,brands:y,suppliers:C,orders:E,register:null!==I&&void 0!==I?I:"",created:A?A.name:"",updated:D?D.name:"",updated_at:null!==T&&void 0!==T?T:""}):null,Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-md-12",children:[p.deleted_at?Object(ra.jsxs)("div",{className:"alert alert-warning",children:[Object(ra.jsxs)("h4",{class:"alert-heading",children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Precaucion!"]}),Object(ra.jsxs)("p",{children:["Este contacto fue eliminado por ",p.updated.name," el"," ",na()(p.deleted_at).format("LLLL")]})]}):null,Object(ra.jsxs)("div",{className:"card card-indigo card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title text-indigo",children:[Object(ra.jsx)("i",{className:"fas fa-address-book mr-1"}),t?Object(ra.jsxs)("label",{children:["Editar contacto",Object(ra.jsx)("span",{className:"badge bg-indigo ml-2",children:t})]}):Object(ra.jsx)("label",{children:"Registrar nuevo contacto"})]})}),Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:"Datos personales"}),Object(ra.jsx)(Va,{id:t,name:a,rfc:s,email:n,type:c,birthday:r,business:l,verification:j,handleChangeData:this.handleChangeData})]}),Object(ra.jsxs)("div",{className:"row mt-5 border-top pt-5",children:[Object(ra.jsxs)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:["Medios de contacto ",Object(ra.jsx)("span",{className:"text-orange",children:"*"}),(!i.t_casa&&!i.t_oficina&&!i.t_movil)|!j.telefonos?Object(ra.jsx)("small",{className:"d-block w-100",children:Object(ra.jsx)("span",{className:"text-orange",children:"Ingrese por lo menos un telefono"})}):null]}),Object(ra.jsx)(qa,{telefonos:i,handleChangeData:this.handleChangeData})]}),c?null:Object(ra.jsxs)("div",{className:"row mt-5 border-top pt-5",children:[Object(ra.jsx)("h6",{className:"card-subtitle text-muted d-block w-100 mb-4 text-center",children:"Domicilios del contacto"}),Object(ra.jsx)(Ja,{domicilios:o,handleChangeData:this.handleChangeData})]})]}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-12",children:Object(ra.jsxs)("div",{className:"btn-group float-right",role:"group",children:[Object(ra.jsxs)("button",{className:"btn btn-default",type:"button",onClick:function(e){return b()},children:[Object(ra.jsx)("i",{className:t?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),Object(ra.jsx)("strong",{children:t?"Cerrar":"Cancelar"})]}),Object(ra.jsxs)("button",{type:"button",className:"btn bg-indigo",onClick:this.handleSave,disabled:p.deleted_at||!a.length||!n.length||!r.length&&!c||!L.length,children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"}),t?"Actualizar":"Guardar"]})]})})})}),d?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})]})}),t?Object(ra.jsx)("div",{className:"content",id:"details",children:Object(ra.jsxs)("div",{className:"row",children:[c?Object(ra.jsxs)("div",{children:["Type: ",c]}):Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(ss,{handeleChangePage:this.handleSelectExam})}),O.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(ra.jsx)("i",{className:"fas fa-money-bill mr-1"}),"Compras"]}),Object(ra.jsx)($a,{sales:O})]})})}):null,N.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(ra.jsx)("i",{className:"fas fa-copyright mr-1"}),"Marcas"]}),Object(ra.jsx)(Za,{brands:N})]})})}):null,S.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(ra.jsx)("i",{className:"fas fa-building mr-1"}),"Laboratorio"]}),Object(ra.jsx)(Ka,{orders:null!==S&&void 0!==S?S:[]})]})})}):null,k.length?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title text-indigo text-bold w-100 mb-2",children:[Object(ra.jsx)("i",{className:"fas fa-shopping-basket mr-1"}),"Pedidos"]}),Object(ra.jsx)(Ka,{orders:null!==k&&void 0!==k?k:[]})]})})}):null]})}):null,u&&Object(ra.jsx)(ns,{body:this.dataBodyConfirm(m),handleCancel:this.handleCloseModal})]})}}]),a}(s.Component),os={_getContact:et.getContact,_saveContact:et.saveContact,_saveExam:vt.saveExam,_setMsgExam:vt.setMessagesExam},is=Object(Wt.b)((function(e){var t=e.contact,a=e.exam;return{loading:t.loading,contact:t.contact,msg_contact:t.messages,msg_exams:a.messages}}),os)(rs),ls=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).openNew=function(){(0,s.props._setContact)(),s.setState({newOrEdit:!0})},s.handleSync=function(){s.getContacts()},s.handleCloseEdit=function(){s.setState({contact:{},contactSelected:"",newOrEdit:!1,load:!0}),s.props.history.push("/contactos")},s.handleEditItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=s.state.contactSelected,a=s.props._getContact,n=null!==e&&void 0!==e?e:t;n&&a(n)},s.handleChangeCheckbox=function(e){var t=e.target,a=t.value;t.checked?s.setState({contactSelected:parseInt(a)}):s.setState({contactSelected:""})},s.handleSetSelectOptions=function(e){var t=e.target,a=t.name,n=t.value,c=s.state.options,r=n;"itemsPage"===a&&(r=parseInt(n)),s.setState({options:Object(i.a)(Object(i.a)({},c),{},Object(J.a)({page:1},a,r)),load:!0})},s.handleSearch=function(e){var t=s.state.options;s.setState({options:Object(i.a)(Object(i.a)({},t),{},{search:e}),load:!0})},s.handleChangePage=function(e){var t=s.state.options;s.setState({options:Object(i.a)(Object(i.a)({},t),{},{page:e}),load:!0})},s.handleDelete=function(){var e=s.state,t=e.contactSelected,a=e.options,n=s.props._deleteContact;if(!t)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un contacto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el contacto?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",t),n({id:t,options:a})),s.setState({contactSelected:"",load:!0})}))},s.state={load:!1,contact:{},newOrEdit:!1,contactSelected:"",options:{page:1,orderby:"created_at",order:"desc",search:"",type:"",itemsPage:10}},s.timeInterval=0,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e._getContact,s=t.params.id;s?("new"===s&&this.setState({newOrEdit:!0}),parseInt(s)&&a(s)):this.setState({load:!0})}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.load,s=this.props,n=s.messages,c=s.contact,r=s._setMessage;t.load!==a&&a&&(console.log("[Orus System] Recargando contactos"),this.getContacts()),e.contact.id!==c.id&&c.id&&(console.log("[Orus System] Cargando nuevo contacto",c.id),this.setState({contact:c,newOrEdit:!0}),this.props.history.push("/contactos/".concat(c.id))),e.messages.length!==n.length&&n.length&&(n.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),r())}},{key:"render",value:function(){var e=this,t=this.props,a=t.contacts,s=t.loading,n=t.meta,c=this.state,r=c.contact,o=c.newOrEdit,i=c.contactSelected,l=c.options;return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-sm-12 col-md-2",children:[Object(ra.jsxs)("button",{className:"btn bg-indigo btn-block mb-3",type:"button",disabled:o,onClick:this.openNew,children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo contacto"]}),Object(ra.jsx)(ka,{title:o?"Menu":"Filtros",children:o?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("li",{className:"list-group-item",children:Object(ra.jsxs)("a",{href:"#back",className:"d-flex justify-content-between align-items-center",onClick:function(t){t.preventDefault(),e.handleCloseEdit()},children:["Ver listado",Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:Object(ra.jsx)("i",{className:"fas fa-chevron-left"})})]})}),r.id?Object(ra.jsx)("li",{className:"list-group-item",children:Object(ra.jsxs)("a",{href:"#details",className:"d-flex justify-content-between align-items-center",children:["Detalles",Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:Object(ra.jsx)("i",{className:"fas fa-chevron-right"})})]})}):null]}):Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"type",children:"Tipo"}),Object(ra.jsxs)("select",{className:"form-control ",name:"type",id:"type",value:l.type,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"",children:"-- Todos --"}),Object(ra.jsx)("option",{value:"0",children:"Clientes"}),Object(ra.jsx)("option",{value:"1",children:"Proveedores"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:l.orderby,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(ra.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:l.order,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"asc",children:"Antiguos"}),Object(ra.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"itemsPage",children:"Numero de contactos"}),Object(ra.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:l.itemsPage,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"10",children:"ver 10"}),Object(ra.jsx)("option",{value:"20",children:"ver 20"}),Object(ra.jsx)("option",{value:"50",children:"ver 50"}),Object(ra.jsx)("option",{value:"100",children:"ver 100"})]})]})]})})]}),Object(ra.jsx)("div",{className:"col-sm-12 col-md-10",children:o?Object(ra.jsx)(is,{handleClose:this.handleCloseEdit}):Object(ra.jsx)(Ca,{title:"Lista de contactos",icon:"id-badge",color:"indigo",loading:s,meta:n,itemSelected:i,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync,children:Object(ra.jsxs)("table",{className:"table table-hover table-striped",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{}),Object(ra.jsx)("th",{children:"Nombre"}),Object(ra.jsx)("th",{children:"Edad"}),Object(ra.jsx)("th",{children:"E-mail"}),Object(ra.jsx)("th",{children:"Telefono"}),Object(ra.jsx)("th",{children:"Creado por"}),Object(ra.jsx)("th",{children:"created_at"===l.orderby?"Registrado":"Actualizado"})]})}),Object(ra.jsx)("tbody",{children:a.length?Object(ra.jsx)(ra.Fragment,{children:a.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(ra.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:t.id,id:"contact_"+t.id,checked:i===t.id,onChange:e.handleChangeCheckbox}),Object(ra.jsx)("label",{htmlFor:"contact_"+t.id,className:"sr-only"})]}),Object(ra.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",style:{cursor:"pointer",maxWidth:180},onClick:function(a){return e.handleEditItem(t.id)},children:Object(ra.jsxs)("label",{style:{cursor:"pointer"},className:t.enUso?"text-indigo":"",children:[t.tipo?Object(ra.jsx)("i",{className:"fas fa-store text-sm mr-2"}):Object(ra.jsx)("i",{className:"fas fa-user text-sm mr-2"}),t.nombre]})}),Object(ra.jsx)("th",{children:t.edad?t.edad:"--"}),Object(ra.jsx)("td",{className:"mailbox-attachment text-lowercase text-truncate",style:{maxWidth:180},children:Object(ra.jsxs)("span",{children:[Object(ra.jsx)("i",{className:"fas fa-envelope text-sm mr-2"}),Object(ra.jsx)("a",{href:"mailto:"+t.email,className:"text-muted",children:t.email})]})}),Object(ra.jsx)("td",{className:"mailbox-date text-muted text-truncate text-right",children:Object(ra.jsxs)("span",{children:[Object(ra.jsx)("i",{className:"fas fa-phone text-sm mr-2"}),t.telefonos.t_movil?t.telefonos.t_movil:t.telefonos.t_casa?t.telefonos.t_casa:t.telefonos.t_oficina?t.telefonos.t_oficina:"--"]})}),Object(ra.jsx)("td",{children:t.created.name}),Object(ra.jsx)("td",{children:na()("created_at"===l.orderby?t.created_at:t.updated_at).fromNow()})]},t.id)}))}):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{className:"text-center text-muted",colSpan:"7",children:"No hay contactos registrados"})})})]})})})]})}},{key:"getContacts",value:function(){var e=this.props,t=e.loading,a=e._getListContacts,s=this.state.options;t||a(Object(i.a)({},s)),this.setState({load:!1})}}]),a}(s.Component),ds={_getListContacts:et.getListContacts,_deleteContact:et.deleteContact,_saveContact:et.saveContact,_getContact:et.getContact,_setMessage:et.setMessageContact,_setContact:et.setContact},js=Object(Wt.b)((function(e){var t=e.contact;return{contacts:t.list,messages:t.messages,meta:t.metaList,loading:t.loading,contact:t.contact}}),ds)(ls),us=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleCategoryChange=function(e){var t=e.target,a=t.name,n=t.value;"category_id"===a&&n&&s.state.category_select.map((function(e){return e.id===1*n&&s.setState({category_hijos:e.hijos}),null})),"category_id_2"===a&&n&&s.state.category_hijos.map((function(e){return e.id===1*n&&s.setState({category_hijos_3:e.hijos}),null})),s.setState(Object(J.a)({},a,n))},s.handleChangePage=function(e){s.setState({page:e})},s.handleClickDelete=function(e,t){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la categoria "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t&&e){var a=s.state,n=a.host,c=a.token;return console.log("Solicitud de eliminaci\xf3n de categoria por API"),fetch("http://"+n+"/api/categories/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Categoria eliminado"),window.Swal.fire({icon:"success",title:"Categoria eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.getCategories()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.handleClickSave=function(){if(s.state.name.length<4)return window.Swal.fire("Verificaci\xf3n","Debe de escribir el nombre de la categoria","warning"),s.nameInput.focus(),!1;window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de crear una nueva categoria?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t=s.state,a=t.host,n=t.token,c={name:s.state.name,category_id:s.state.category_id_3?s.state.category_id_3:s.state.category_id_2?s.state.category_id_2:s.state.category_id};return console.log("Enviando datos a API para almacenar"),fetch("http://"+a+"/api/categories",{method:"POST",body:JSON.stringify(c),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("Categoria almacenada"),window.Swal.fire({icon:"success",title:"Categoria almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){s.setState({newItem:t.data.id}),s.getCategories()}))):(window.Swal.fire("Error","al almacenar la categoria","error"),console.error("Orus res: ",t.message))}}))},s.getCategories=function(){var e=s.state,t=e.host,a=e.token,n=e.load,c="http://"+t+"/api/categories",r=s.state.page>0?"?page="+s.state.page:"?page=1";n||s.setState({load:!0}),console.log("Descargando lista de categorias"),fetch(c+r,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&(console.log("Lista de categorias descargadas"),s.setState({category_list:e.data,meta:e.meta,newItem:0,add:!1,category_id:0,name:"",load:!1}))})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")})),fetch(c+r+"&categoryid=raiz",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){e.data&&s.setState({category_select:e.data})})).catch((function(e){console.error("Orus: "+e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},s.handleClickAdd=function(){s.setState({add:!s.state.add,name:"",category_id:0,category_id_2:0,category_id_3:0,category_hijos:[],category_hijos_3:[]})},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value;s.setState(Object(J.a)({},a,n.toLowerCase()))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={category_list:[],category_select:[],category_hijos:[],category_hijos_3:[],meta:{},add:!1,name:"",category_id:0,category_id_2:0,category_id_3:0,newItem:0,page:1,host:n.host,token:n.token,load:!0},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getCategories()}},{key:"componentDidUpdate",value:function(e,t){t.page!==this.state.page&&(console.log("Recargando categorias"),this.getCategories())}},{key:"render",value:function(){var e=this,t=this.state,a=t.category_list,s=t.meta,n=t.load,c=this.state.category_hijos,r=this.state.category_hijos_3;return Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h5",{className:"card-title",children:"Categorias"}),Object(ra.jsxs)("table",{className:"table",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Nombre"}),Object(ra.jsx)("th",{children:"Padre"}),Object(ra.jsx)("th",{children:"Eliminar"})]})}),Object(ra.jsx)("tbody",{children:n?Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"8",className:"text-center",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})})}):a.map((function(t){var a="";return null!=t.depende_de&&(null!=t.depende_de.depende_de&&(a=t.depende_de.depende_de.categoria),a=a?a+"/"+t.depende_de.categoria:t.depende_de.categoria),a=a||"--",Object(ra.jsxs)("tr",{className:t.id===e.state.newItem?"table-success":"",children:[Object(ra.jsx)("td",{className:"text-capitalize",children:t.categoria}),Object(ra.jsx)("td",{className:"text-capitalize",children:a}),Object(ra.jsx)("td",{children:Object(ra.jsx)("button",{className:"btn btn-outline-light btn-sm",onClick:function(a){e.handleClickDelete(t.id,t.categoria)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})})]},t.id)}))}),this.state.add&&!n?Object(ra.jsx)("tfoot",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:Object(ra.jsx)("input",{type:"text",name:"name",className:"form-control",autoComplete:"off",value:this.state.name,onChange:this.catchInputs,ref:function(t){e.nameInput=t}})}),Object(ra.jsxs)("td",{children:[Object(ra.jsxs)("select",{name:"category_id",className:"form-control",value:this.state.category_id,onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"Inicial"}),this.state.category_select.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria},e.id)}))]}),c.length?Object(ra.jsxs)("select",{name:"category_id_2",className:"form-control mt-2",value:this.state.category_id_2,onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"Raiz"}),this.state.category_hijos.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria},e.id)}))]}):"",r.length?Object(ra.jsxs)("select",{name:"category_id_3",className:"form-control mt-2",value:this.state.category_id_3,onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"Raiz"}),this.state.category_hijos_3.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.categoria},e.id)}))]}):""]}),Object(ra.jsx)("td",{children:Object(ra.jsx)("button",{className:"btn btn-dark btn-sm",onClick:this.handleClickSave,children:Object(ra.jsx)("i",{className:"fas fa-save"})})})]})}):Object(ra.jsx)("tfoot",{children:Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"3",children:Object(ra.jsx)(xa,{meta:s,handleChangePage:this.handleChangePage})})})})]})]}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("button",{className:"btn btn-primary btn-sm",onClick:this.handleClickAdd,children:this.state.add?Object(ra.jsx)("i",{className:"fas fa-undo"}):Object(ra.jsx)("i",{className:"fas fa-plus"})})})]})}}]),a}(s.Component),ms=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).clickSave=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.company=s.state.company,e.host=s.state.server,localStorage.setItem("OrusSystem",JSON.stringify(e))},s.clickSaveUser=function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));e.email=s.state.email,e.name=s.state.name,e.username=s.state.username,localStorage.setItem("OrusSystem",JSON.stringify(e))},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value;s.setState(Object(J.a)({},a,n.toLowerCase()))},s.state={server:"",company:"",email:"",name:"",username:"",password:"",category_list:[]},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("OrusSystem"));this.setState({server:e.host?e.host:window.location.host.split(":")[0],company:e.company?e.company:"",email:e.email?e.email:"",name:e.name?e.name:"",username:e.username?e.username:""})}},{key:"render",value:function(){var e=this.props.data;return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-6",children:[Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h5",{className:"card-title",children:"Generales"}),Object(ra.jsx)("p",{children:"\xa0"}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-server"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"server",value:this.state.server,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-building"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre de la empresa",name:"company",value:this.state.company,onChange:this.catchInputs})]})]}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.clickSave,children:"Guardar"})})]}),Object(ra.jsx)(us,{data:e})]}),Object(ra.jsx)("div",{className:"col-6",children:Object(ra.jsxs)("div",{className:"card card-primary card-outline",children:[Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h5",{className:"card-title",children:"Usuario"}),Object(ra.jsx)("p",{children:"\xa0"}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-at"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Email",name:"email",value:this.state.email,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-user-tag"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre completo",name:"name",value:this.state.name,onChange:this.catchInputs})]}),Object(ra.jsx)("hr",{}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-user-check"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Usuario",name:"username",value:this.state.username,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-lock"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Contrase\xf1a",name:"password",value:this.state.password,onChange:this.catchInputs})]})]}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.clickSaveUser,children:"Guardar"})})]})})]})}}]),a}(s.Component),hs=function(e){var t=function(t){var a=t.target,s=a.name,n=a.type,c=a.checked,r=a.value,o="checkbox"===n?c:r.toLowerCase();e.handleGetData(s,o)};return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"pc",type:"checkbox",className:"custom-control-input",id:"pc",checked:e.pc,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"pc",children:[Object(ra.jsx)("i",{className:"fas fa-desktop"})," PC"]})]}),Object(ra.jsx)("input",{type:"text",name:"pc_time",className:"form-control input-xs",value:e.pc_time,onChange:t,readOnly:e.pc?"":"readonly"})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"tablet",type:"checkbox",className:"custom-control-input",id:"tablet",checked:e.tablet,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"tablet",children:[Object(ra.jsx)("i",{className:"fas fa-tablet-alt"})," Tablet"]})]}),Object(ra.jsx)("input",{type:"text",name:"tablet_time",className:"form-control input-xs",value:e.tablet_time,onChange:t,readOnly:e.tablet?"":"readonly"})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"movil",type:"checkbox",className:"custom-control-input",id:"movil",checked:e.movil,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"movil",children:[Object(ra.jsx)("i",{className:"fas fa-mobile-alt"})," Telefono"]})]}),Object(ra.jsx)("input",{type:"text",name:"movil_time",className:"form-control input-xs",value:e.movil_time,onChange:t,readOnly:e.movil?"":"readonly"})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"lap",type:"checkbox",className:"custom-control-input",id:"lap",checked:e.lap,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"lap",children:[Object(ra.jsx)("i",{className:"fas fa-laptop"})," Laptop"]})]}),Object(ra.jsx)("input",{type:"text",name:"lap_time",className:"form-control input-xs",value:e.lap_time,onChange:t,readOnly:e.lap?"":"readonly"})]})]}),Object(ra.jsxs)("div",{className:"row mt-1",children:[Object(ra.jsx)("div",{className:"col-md-6",children:Object(ra.jsxs)("ul",{className:"list-group",children:[Object(ra.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"frontal",type:"checkbox",className:"custom-control-input",id:"frontal",checked:e.frontal,onChange:t}),Object(ra.jsx)("label",{className:"custom-control-label",htmlFor:"frontal",children:"Frontal"})]})}),Object(ra.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"occipital",type:"checkbox",className:"custom-control-input",id:"occipital",checked:e.occipital,onChange:t}),Object(ra.jsx)("label",{className:"custom-control-label",htmlFor:"occipital",children:"Occipital"})]})}),Object(ra.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"generality",type:"checkbox",className:"custom-control-input",id:"generality",checked:e.generality,onChange:t}),Object(ra.jsx)("label",{className:"custom-control-label",htmlFor:"generality",children:"General"})]})}),Object(ra.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"cefalea",type:"checkbox",className:"custom-control-input",id:"cefalea",checked:e.cefalea,onChange:t}),Object(ra.jsx)("label",{className:"custom-control-label",htmlFor:"cefalea",children:"Cefalea"})]})})]})}),Object(ra.jsx)("div",{className:"col-md-6",children:Object(ra.jsxs)("ul",{className:"list-group",children:[Object(ra.jsxs)("li",{className:"list-group-item",children:["Temporal",Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"row mt-2",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"temporaod",type:"checkbox",className:"custom-control-input",id:"temporaod",checked:e.temporaod,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"temporaod",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," Derecho"]})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"temporaoi",type:"checkbox",className:"custom-control-input",id:"temporaoi",checked:e.temporaoi,onChange:t}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"temporaoi",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," Izquierdo"]})]})})]})]}),Object(ra.jsxs)("li",{className:"list-group-item",children:["Frecuencia",Object(ra.jsx)("span",{className:"badge badge-pill",children:Object(ra.jsx)("input",{type:"text",name:"c_frecuencia",maxLength:"60",className:"form-control input-xs",value:e.c_frecuencia,onChange:t})})]}),Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("label",{htmlFor:"c_intensidad",children:"Intensidad"}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-11",children:Object(ra.jsx)("input",{type:"range",name:"c_intensidad",className:"custom-range custom-range-info",id:"c_intensidad",min:"0",max:"4",value:e.c_intensidad,onChange:t})}),Object(ra.jsx)("div",{className:"col-1",children:Object(ra.jsx)("h6",{children:e.c_intensidad})})]})]})]})})]})]})},bs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,s)},e}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Interrogatorio inicial"}),Object(ra.jsx)("textarea",{name:"interrogatorio",className:"form-control",value:this.props.interrogatorio,onChange:this.catchInputs})]})}),Object(ra.jsx)("div",{className:"row mt-2",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Cirugias oculares"}),Object(ra.jsx)("textarea",{name:"coa",className:"form-control",value:this.props.coa,onChange:this.catchInputs})]})}),Object(ra.jsx)("div",{className:"row mt-2",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Antecedentes oculares patologicas personales"}),Object(ra.jsx)("textarea",{name:"aopp",className:"form-control",rows:"2",value:this.props.aopp,onChange:this.catchInputs})]})}),Object(ra.jsx)("div",{className:"row mt-2",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Antecedentes oculares patologicas familiares"}),Object(ra.jsx)("textarea",{name:"aopf",className:"form-control",rows:"2",value:this.props.aopf,onChange:this.catchInputs})]})})]})}}]),a}(s.Component),ps=function(e){var t=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.onChangeInput(a,s)};return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-6",children:"Keratometria"}),Object(ra.jsx)("div",{className:"col-6",children:"Retinoscopia"})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fas fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"keratometriaod",maxLength:"12",className:"form-control input-xs",value:e.keratometriaod,onChange:t})]}),Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("i",{className:"fas fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"keratometriaoi",maxLength:"12",className:"form-control input-xs",value:e.keratometriaoi,onChange:t})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"rsod",maxLength:"16",className:"form-control",value:e.rsod,onChange:t})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"rsoi",maxLength:"16",className:"form-control",value:e.rsoi,onChange:t})]})]})]})},xs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,s)},e}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-md-8",children:Object(ra.jsx)("label",{children:"Diab\xe9tico"})}),Object(ra.jsx)("div",{className:"col-md-4",children:Object(ra.jsx)("label",{children:"Fotocoagulaci\xf3n laser"})})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-3",children:"Fecha"}),Object(ra.jsx)("div",{className:"col-2",children:"Rango de glucosa"}),Object(ra.jsx)("div",{className:"col-3",children:"Ultimo examen"}),Object(ra.jsx)("div",{className:"col-2",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"d_fclod",type:"checkbox",className:"custom-control-input",id:"d_fclod",checked:this.props.d_fclod,onChange:this.catchInputs}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"d_fclod",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," Derecho"]})]})}),Object(ra.jsx)("div",{className:"col-2",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"d_fcloi",type:"checkbox",className:"custom-control-input",id:"d_fcloi",checked:this.props.d_fcloi,onChange:this.catchInputs}),Object(ra.jsxs)("label",{className:"custom-control-label",htmlFor:"d_fcloi",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," Izquierdo"]})]})})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-md-3",children:Object(ra.jsx)("input",{type:"date",name:"d_time",className:"form-control",value:this.props.d_time,onChange:this.catchInputs})}),Object(ra.jsx)("div",{className:"col-md-2",children:Object(ra.jsx)("input",{type:"text",name:"d_media",className:"form-control",value:this.props.d_media,onChange:this.catchInputs})}),Object(ra.jsx)("div",{className:"col-md-3",children:Object(ra.jsx)("input",{type:"date",name:"d_test",className:"form-control",value:this.props.d_test,onChange:this.catchInputs})}),Object(ra.jsx)("div",{className:"col-md-2",children:Object(ra.jsx)("input",{type:"text",name:"d_fclod_time",className:"form-control",value:this.props.d_fclod_time,onChange:this.catchInputs,readOnly:this.props.d_fclod?"":"readonly"})}),Object(ra.jsx)("div",{className:"col-md-2",children:Object(ra.jsx)("input",{type:"text",name:"d_fcloi_time",className:"form-control",value:this.props.d_fcloi_time,onChange:this.catchInputs,readOnly:this.props.d_fcloi?"":"readonly"})})]}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Oftalmoscopia"}),Object(ra.jsx)("textarea",{name:"oftalmoscopia",className:"form-control",value:this.props.oftalmoscopia,onChange:this.catchInputs})]})})]})}}]),a}(s.Component),Os=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,s)},e}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-6",children:"Capacidad visual"})}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"cvod",maxLength:"12",className:"form-control",value:this.props.cvod,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"cvoi",maxLength:"12",className:"form-control",value:this.props.cvoi,onChange:this.catchInputs})]})]}),Object(ra.jsxs)("div",{className:"row mt-2",children:[Object(ra.jsx)("div",{className:"col-md-6",children:"Agudeza visual (Sin lentes)"}),Object(ra.jsx)("div",{className:"col-md-6",children:"Agudeza visual (con la graduaci\xf3n anterior)"})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"avslod",maxLength:"12",className:"form-control",value:this.props.avslod,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"avsloi",maxLength:"12",className:"form-control",value:this.props.avsloi,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"avcgaod",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaod,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"avcgaoi",maxLength:"12",className:"form-control input-xs",value:this.props.avcgaoi,onChange:this.catchInputs})]})]}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-md-6",children:"Agudeza visual final"})}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("br",{}),Object(ra.jsx)("input",{type:"text",name:"avfod",maxLength:"12",className:"form-control",value:this.props.avfod,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("br",{}),Object(ra.jsx)("input",{type:"text",name:"avfoi",maxLength:"12",className:"form-control",value:this.props.avfoi,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-md-4",children:[Object(ra.jsx)("i",{className:"fa fa-eye"}),Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Ambos"}),Object(ra.jsx)("br",{}),Object(ra.jsx)("input",{type:"text",name:"avf2o",maxLength:"25",className:"form-control",value:this.props.avf2o,onChange:this.catchInputs})]})]})]})}}]),a}(s.Component),gs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,s)},e}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-md-6"}),Object(ra.jsx)("div",{className:"col-md-6",children:"Tensi\xf3n ocular"})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-3",children:["Diagnostico",Object(ra.jsxs)("select",{name:"diagnostico",className:"form-control",value:this.props.diagnostico,onChange:this.catchInputs,children:[Object(ra.jsx)("option",{value:"Emetrope",children:"Em\xe9trope"}),Object(ra.jsx)("option",{value:"hipermetropia",children:"Hipermetrop\xeda"}),Object(ra.jsx)("option",{value:"hipermetropia-astigmatismo",children:"Hipermetrop\xeda y astigmatismo"}),Object(ra.jsx)("option",{value:"hipermetropia-miopia",children:"Hipermetrop\xeda y miop\xeda"}),Object(ra.jsx)("option",{value:"astigmatismo-regla",children:"Astigmatismo con la regla"}),Object(ra.jsx)("option",{value:"astigmatismo-contra-regla",children:"Astigmatismo contra la regla"}),Object(ra.jsx)("option",{value:"astigmatismo-oblicuo",children:"Astigmatismo oblicuo"}),Object(ra.jsx)("option",{value:"astigmatismo-miopia",children:"Astigmatismo/m\xedopico"}),Object(ra.jsx)("option",{value:"miopia",children:"Miop\xeda"})]})]}),Object(ra.jsx)("div",{className:"col-md-3",children:Object(ra.jsxs)("div",{className:"custom-control custom-switch",children:[Object(ra.jsx)("input",{name:"presbicie",type:"checkbox",className:"custom-control-input",id:"presbicie",checked:this.props.presbicie,onChange:this.catchInputs}),Object(ra.jsx)("label",{className:"custom-control-label",htmlFor:"presbicie",children:"Presbicie"})]})}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"number",name:"piod",min:"0",max:"40",step:"1",className:"form-control",value:this.props.piod,onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col-md-3",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"number",name:"pioi",min:"0",max:"40",step:"1",className:"form-control",value:this.props.pioi,onChange:this.catchInputs})]})]}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-12",children:[Object(ra.jsx)("label",{children:"Tratamiento oftalmico"}),Object(ra.jsx)("textarea",{name:"txoftalmico",className:"form-control",value:this.props.txoftalmico,onChange:this.catchInputs})]})})]})}}]),a}(s.Component),fs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target,s=a.name,n=a.type,c=a.value,r=a.checked,o=c;"checkbox"===n&&(o=r),"text"===n&&(o=c.toLowerCase()),"number"===n&&("ejeod"===s||"ejeoi"===s?o=parseInt(c):(o=(o=parseFloat(c)).toFixed(2),o=parseFloat(o))),e.props.onChangeInput(s,o)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.readOnly,a=e.cilindrod,s=e.cilindroi,c=e.esferaod,r=e.esferaoi,o=e.ejeod,i=e.ejeoi,l=e.adiciond,d=e.adicioni,j=e.adicion_media_od,u=e.adicion_media_oi,m=e.dpod,h=e.dpoi,b=e.alturaod,p=e.alturaoi,x=e.lcmarca,O=e.lcgod,g=e.lcgoi;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("table",{className:"table table-bordered",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"#"}),Object(ra.jsx)("th",{children:"Esfera"}),Object(ra.jsx)("th",{children:"Cilindro"}),Object(ra.jsx)("th",{children:"Eje"}),Object(ra.jsx)("th",{children:"Adici\xf3n"}),Object(ra.jsx)("th",{children:"Adici\xf3n media"}),Object(ra.jsx)("th",{children:"D/P"}),Object(ra.jsx)("th",{children:"Altura"})]})}),Object(ra.jsxs)("tbody",{children:[Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("td",{children:[Object(ra.jsx)("label",{children:"D"}),Object(ra.jsx)("i",{className:"fa fa-eye"})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"esferaod",min:"-20",max:"20",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==c&&void 0!==c?c:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==c&&void 0!==c?c:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"cilindrod",min:"-20",max:"0",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==a&&void 0!==a?a:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==a&&void 0!==a?a:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"ejeod",min:"0",max:"180",step:"1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,placeholder:"\xb0",value:o?parseInt(o):"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==o&&void 0!==o?o:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"adiciond",min:"0",max:"3",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==l&&void 0!==l?l:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==l&&void 0!==l?l:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"adicion_media_od",min:"0",max:"3",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==j&&void 0!==j?j:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==j&&void 0!==j?j:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"dpod",min:"40",max:"80",step:".1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==m&&void 0!==m?m:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==m&&void 0!==m?m:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"alturaod",min:"0",max:"35",step:".1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==b&&void 0!==b?b:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==b&&void 0!==b?b:""})]})]}),Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("td",{children:[Object(ra.jsx)("label",{children:"I"}),Object(ra.jsx)("i",{className:"fa fa-eye"})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"esferaoi",min:"-20",max:"20",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==r&&void 0!==r?r:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==r&&void 0!==r?r:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"cilindroi",min:"-20",max:"0",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==s&&void 0!==s?s:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==s&&void 0!==s?s:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"ejeoi",min:"0",max:"180",step:"1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,placeholder:"\xb0",value:i?parseInt(i):"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==i&&void 0!==i?i:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"adicioni",min:"0",max:"3",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==d&&void 0!==d?d:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==d&&void 0!==d?d:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"adicion_media_oi",min:"0",max:"3",step:".25",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==u&&void 0!==u?u:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==u&&void 0!==u?u:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"dpoi",min:"40",max:"80",step:".1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==h&&void 0!==h?h:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==h&&void 0!==h?h:""})]}),Object(ra.jsxs)("td",{className:"text-right",children:[Object(ra.jsx)("input",{type:"number",name:"alturaoi",min:"0",max:"35",step:".1",className:t?"form-control d-print-none disabled":"form-control d-print-none",disabled:!!t,value:null!==p&&void 0!==p?p:"",onChange:this.catchInputs}),Object(ra.jsx)("h5",{className:"d-none d-print-block",children:null!==p&&void 0!==p?p:""})]})]})]})]}),Object(ra.jsx)("ul",{className:"list-group d-print-none mt-4",children:Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col-md-12",children:["Lente de contacto",Object(ra.jsx)("input",{type:"text",name:"lcmarca",maxLength:"70",className:t?"form-control disabled":"form-control",disabled:!!t,value:x,onChange:this.catchInputs})]})}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Derecho"}),Object(ra.jsx)("input",{type:"text",name:"lcgod",maxLength:"30",className:t?"form-control disabled":"form-control",disabled:!!t,value:O||"",onChange:this.catchInputs})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("i",{className:"fa fa-eye"})," ",Object(ra.jsx)("label",{children:"Izquierdo"}),Object(ra.jsx)("input",{type:"text",name:"lcgoi",maxLength:"30",className:t?"form-control disabled":"form-control",disabled:!!t,value:g||"",onChange:this.catchInputs})]})]})]})})]})}}]),a}(s.Component),vs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){var a=t.target.name,s="checkbox"===t.target.type?t.target.checked:t.target.value.toLowerCase();e.props.onChangeInput(a,s)},e}return Object(Kt.a)(a,[{key:"render",value:function(){return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("label",{htmlFor:"observaciones",children:"Observaciones"}),Object(ra.jsx)("textarea",{name:"observaciones",id:"observaciones",className:"form-control",value:this.props.observaciones,onChange:this.catchInputs})]})}}]),a}(s.Component),Ns=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).getCategory=function(e){var t=JSON.parse(localStorage.getItem("OrusSystem"));return e&&fetch("http://"+t.host+"/api/categories/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then((function(e){return e.json()})).then((function(e){var t=e.data;t&&s.setState({category:t})})),{}},s.handleClickCategory=function(e){e.preventDefault();var t=s.props,a=t.onChangeInput,n=t.nameCategory;s.setState({category_id_1:0,category_id_2:0,category_id_3:0,category_list_2:[],category_list_3:[],codesItems:{},category:{}}),a(Object(J.a)({},n,null))},s.handleCategoryChange=function(e){var t=e.target,a=t.name,n=t.value,c=s.props,r=c.onChangeInput,o=c.nameCategory,i=s.state.category_list;switch(a){case"category_id_1":for(var l in i)if(i[l].id===parseInt(n)){s.setState({category_id_1:parseInt(n),category_id_3:0,category_list_2:i[l].sons,category_list_3:[]});break}break;case"category_id_2":n&&s.state.category_list_2.map((function(e){return e.id===1*n&&s.setState({category_id_2:parseInt(n),category_list_3:e.sons}),null}));break;case"category_id_3":r(Object(J.a)({},o,parseInt(n)));break;default:s.setState(Object(J.a)({},a,parseInt(n)))}},s.state={category_list:[],category_list_2:[],category_list_3:[],category_id_1:0,category_id_2:0,category_id_3:0,category:{},codesItems:{}},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.category_id,a=e.categories,s=e._getList;a.length?this.setState({category_list:a[0].sons}):s({options:{categoryid:"raiz",search:"lentes"},id:null}),t&&this.getCategory(t)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,s=a.category_id,n=a.esferaod,c=a.esferaoi,r=a.cilindrod,o=a.cilindroi,i=a.categories,l=this.state.category;if(e.categories.length!==i.length&&i.length&&this.setState({category_list:i[0].sons}),e.category_id!==s&&s&&this.getCategory(s),t.category.id!==l.id&&l.id){var d=ts.getCodeGrad(l,n,c,r,o);this.setState({category:l,codesItems:d})}}},{key:"render",value:function(){var e=this.props,t=e.category_id,a=e.title,n=e.esferaod,c=e.esferaoi,r=e.cilindrod,o=e.cilindroi,i=e.handleCodesItems,l=this.state,d=l.codesItems,j=l.category_id_1,u=l.category_id_2,m=l.category_id_3,h=l.category_list_2,b=l.category_list_3,p=l.category_list;return Object(ra.jsx)("div",{className:"card border border-info rounded d-print-none",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h3",{className:"card-title text-success m-2",children:a}),t?Object(ra.jsxs)(s.Fragment,{children:[d.code+d.od===d.code+d.oi?Object(ra.jsxs)("p",{className:"card-text",children:[Object(ra.jsx)("label",{children:"Lente"}),": ",d.code+d.od]}):Object(ra.jsxs)("div",{className:"row card-text",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Lente Derecho"}),Object(ra.jsx)("br",{})," ",d.code+d.od]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Lente Izquierdo"}),Object(ra.jsx)("br",{})," ",d.code+d.oi]})]}),i?Object(ra.jsx)("p",{className:"card-text text-right",children:Object(ra.jsxs)("button",{className:"btn btn-info",onClick:function(e){e.preventDefault(),i({code:d.code,od:d.od,oi:d.oi})},children:[Object(ra.jsx)("i",{className:"fas fa-check mr-2"}),"Siguiente"]})}):null,this.props.update?Object(ra.jsx)("p",{className:"card-text text-right",children:Object(ra.jsx)("button",{className:"btn btn-outline-info btn-sm card-link mt-2",onClick:this.handleClickCategory,children:"Cambiar"})}):null]}):Object(ra.jsxs)(s.Fragment,{children:[p.length?Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:"Tipo"})}),Object(ra.jsxs)("select",{name:"category_id_1",className:"custom-select",value:null!==j&&void 0!==j?j:"",onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"-- Seleccione el tipo --"}),p.map((function(e){return e.meta&&e.meta.rangoInf<=n&&n<=e.meta.rangoSup&&e.meta.rangoInf<=c&&c<=e.meta.rangoSup&&e.meta.cil<=r&&e.meta.cil<=o?Object(ra.jsx)("option",{value:e.id,children:e.name},e.id):null}))]})]}):null,j&&h.length?Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:"Material"})}),Object(ra.jsxs)("select",{name:"category_id_2",className:"custom-select",value:u,onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"-- Seleccione el material --"}),h.map((function(e){return!!(e.meta&&e.meta.rangoInf<=n&&n<=e.meta.rangoSup&&e.meta.rangoInf<=c&&c<=e.meta.rangoSup)&&Object(ra.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}):null,j&&u&&b.length?Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:"Tratamiento"})}),Object(ra.jsxs)("select",{name:"category_id_3",className:"custom-select",value:m,onChange:this.handleCategoryChange,children:[Object(ra.jsx)("option",{value:"0",children:"-- Seleccione el tratamiento --"}),b.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}):null]})]})})}}]),a}(s.Component),ys={_getList:Ce.getListCategories},ws=Object(Wt.b)((function(e){return{categories:e.category.list}}),ys)(Ns),Ss={_save:et.saveContact},Cs=Object(Wt.b)((function(e){return{messages:e.contact.messages}}),Ss)((function(e){var t=e.title,a=void 0===t?"contacto":t,n=e.name,c=e.messages,r=e.handleCancel,o=e._save,l=Object(s.useState)(cs.dataPrimary),d=Object(wa.a)(l,2),j=d[0],u=d[1],m=j.name,h=j.telnumbers,b=j.birthday,p=j.email,x=Object(s.useState)(!1),O=Object(wa.a)(x,2),g=O[0],f=O[1],v=function(e){cs.changeDataInput(e.target,j,u),f(N)},N=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=cs.handleVerificationData(j,e);return t.result};return Object(s.useEffect)((function(){u(Object(i.a)(Object(i.a)({},j),{},{name:n}))}),[n]),Object(ra.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(ra.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsxs)("h5",{className:"modal-title text-primary text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Crear nuevo ",a]}),Object(ra.jsx)("button",{type:"button",className:"close",onClick:r,children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsxs)("div",{className:"modal-body",children:[c.length?Object(ra.jsx)(ra.Fragment,{children:c.map((function(e,t){var a=e.type,s=e.text;return Object(ra.jsxs)("div",{className:"alert alert-".concat("error"===a?"danger":"success"===a?a:"warning"),children:[Object(ra.jsx)("i",{className:"fas fa-info mr-1"}),s]},t)}))}):null,Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsxs)("label",{children:["Nombre del ",a]}),Object(ra.jsx)("input",{type:"text",className:"form-control text-uppercase",placeholder:"Nombre del paciente",name:"name",autoComplete:"off",required:"required",pattern:"^[a-zA-Z.]{2,20}[\\s]{1}[a-zA-Z.]{2,20}.*",minLength:"8",value:m,onChange:v})]}),Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"E-mail"}),Object(ra.jsx)("input",{type:"email",className:"form-control",name:"email",value:p,onChange:v})]}),Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Telefono celular"}),Object(ra.jsx)("input",{type:"tel",placeholder:"Telefono celular",className:"form-control",name:"telnumbers",pattern:"^[\\d]{10}$",maxLength:"10",value:h.t_movil,onChange:v})]}),Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)("label",{children:"Fecha de naciemiento"}),Object(ra.jsx)("input",{type:"date",className:"form-control",name:"birthday",value:b,onChange:v})]})]}),Object(ra.jsx)("div",{className:"modal-footer",children:Object(ra.jsxs)("div",{className:"btn-group",children:[r?Object(ra.jsxs)("button",{type:"button",className:"btn btn-default",onClick:r,children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-1"}),"cancelar"]}):null,Object(ra.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){var e=N(!0),t=Object(i.a)(Object(i.a)({},j),{},{telnumbers:JSON.stringify(j.telnumbers)});if(!e)return!1;console.log("[DEBUG] Save data",t),cs.saveContact(a,t,o)},disabled:!g,children:[Object(ra.jsx)("i",{className:"fas fa-save"}),"Guardar"]})]})})]})})})})),_s=function(e){var t=e.contacts,a=void 0===t?[]:t,s=e.title,n=e.text,c=e.left,r=void 0===c?"5.9rem":c,o=e.showNew,i=void 0!==o&&o,l=e.meta,d=e.perPage,j=void 0===d?10:d,u=e.handleSelected,m=e.handleNew;return Object(ra.jsx)("div",{className:"position-absolute overflow-auto",style:{left:r,height:i?"0rem":"12rem",zIndex:"10",width:"100%",maxWidth:"30rem"},children:Object(ra.jsx)("ul",{className:"list-group",children:a.length?Object(ra.jsxs)(ra.Fragment,{children:[a.map((function(e){return Object(ra.jsx)("li",{className:"list-group-item text-capitalize",children:Object(ra.jsxs)("a",{href:"#selecte",className:"text-indigo",onClick:function(t){return function(e,t){e.preventDefault(),u(t)}(t,e)},children:[Object(ra.jsx)("i",{className:"fas fa-user mr-1"}),e.nombre]})},e.id)})),l.total>j?Object(ra.jsxs)("li",{className:"list-group-item text-muted",children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Existen mas registros, sea mas espesifico"]}):null]}):!i&&m?Object(ra.jsx)("li",{className:"list-group-item",children:Object(ra.jsxs)("a",{href:"\xb7create",onClick:function(e){return function(e){e.preventDefault(),m()}(e)},children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1 text-dark"}),Object(ra.jsxs)("label",{children:["El ",s,":"]}),Object(ra.jsx)("span",{className:"text-uppercase text-dark font-weight-bold ml-1",children:n}),", no existe.",Object(ra.jsx)("span",{className:"badge badge-dark ml-2",children:"Registrar"})]})}):null})})},ks={_getListContacts:et.getListContacts,_setListContact:et.setListContact,_getContact:et.getContact},Es=Object(Wt.b)((function(e){var t=e.contact;return{contacts:t.list,contact:t.contact,meta:t.metaList}}),ks)((function(e){var t=e.contact,a=e.readOnly,n=void 0!==a&&a,c=e.title,r=void 0===c?"contacto":c,o=e.contacts,i=e.left,l=e.legend,d=e.meta,j=e._getListContacts,u=e._setListContact,m=e._getContact,h=Object(s.useState)(""),b=Object(wa.a)(h,2),p=b[0],x=b[1],O=Object(s.useState)(!1),g=Object(wa.a)(O,2),f=g[0],v=g[1],N=Object(s.useState)(""),y=Object(wa.a)(N,2),w=y[0],S=y[1],C=function(e){u({result:{list:[],metaList:{}}}),m(e.id),x(""),v(!1)};return Object(s.useEffect)((function(){var e=null;p.length>2&&(w&&clearTimeout(w),e=setTimeout((function(){j({type:0,search:p,itemsPage:10}),S("")}),1e3),S(e))}),[p]),Object(ra.jsxs)("div",{className:"w-100 d-block",children:[l?Object(ra.jsxs)("span",{className:"text-sm text-muted ml-4 w-100 d-block",children:[Object(ra.jsx)("label",{children:"Primero:"})," ",l]}):null,Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsxs)("span",{className:"input-group-text text-capitalize",children:[Object(ra.jsx)("i",{className:"fas fa-user mr-2"})," ",r]})}),t.id?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("span",{className:"form-control text-capitalize bg-light",children:[t.nombre,t.email&&!/.*@domain(.com)?/gim.exec(t.email)?Object(ra.jsxs)("span",{className:"badge badge-secondary mx-1",children:[Object(ra.jsx)("i",{className:"fas fa-envelope mr-1"}),t.email]}):null,t.edad?Object(ra.jsxs)("span",{className:"badge badge-secondary ml-1",children:[Object(ra.jsx)("i",{className:"fas fa-calendar mr-1"}),t.edad," a\xf1os"]}):null]}),n?null:Object(ra.jsx)("div",{className:"float-right",children:Object(ra.jsxs)("div",{className:"btn-group btn-sm d-print-none",children:[Object(ra.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(){return C({})},title:"Cambiar",children:Object(ra.jsx)("i",{className:"fas fa-exchange-alt"})}),Object(ra.jsx)(ta.b,{to:"/contactos/"+t.id,className:"btn bg-indigo btn-sm",title:"Editar",children:Object(ra.jsx)("i",{className:"fas fa-edit"})})]})})]}):Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",value:p,disabled:!!t.id,onChange:function(e){var t=e.target.value;x(t),v(!1)}}),w?Object(ra.jsx)("div",{className:"float-right px-4",children:Object(ra.jsx)("div",{className:"spinner-border text-indigo"})}):null,p&&!o.length&&f?Object(ra.jsx)("div",{className:"w-100 mt-4",children:Object(ra.jsx)("div",{className:"row justify-content-center",children:Object(ra.jsxs)("div",{className:"col-12 col-md-8 col-lg-5",children:[Object(ra.jsxs)("h4",{className:"mb-4 text-center",children:[Object(ra.jsx)("i",{className:"fas fa-user mr-1"}),"Registrar nuevo",r]}),Object(ra.jsx)(Cs,{title:r,name:p,handleCancel:function(e){return C({})}})]})})}):p.length>2&&!w?Object(ra.jsx)("div",{className:"w-100 d-block position-static",children:Object(ra.jsx)(_s,{contacts:o,title:r,text:p,showNew:f,left:i,meta:d,perPage:10,handleNew:function(e){return v(!0)},handleSelected:C})}):null]})]})]})})),Is=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.esferaod,a=e.esferaoi,s=e.cilindrod,n=e.cilindroi,c=e.ejeod,r=e.ejeoi,o=e.adiciond,i=e.adicioni,l=e.adicion_media_od,d=e.adicion_media_oi,j=e.dpod,u=e.dpoi,m=e.alturaod,h=e.alturaoi,b=e.diagnostico,p=e.presbicie,x=e.paciente;return Object(ra.jsxs)("div",{className:"card d-none d-print-block",children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("h4",{children:["Optica Madero",Object(ra.jsx)("br",{}),Object(ra.jsx)("small",{children:"312 312 5353"})]})}),Object(ra.jsx)("div",{className:"col-3 text-right",children:na()().format("LLL")})]}),Object(ra.jsxs)("div",{className:"row pt-4",children:[Object(ra.jsxs)("div",{className:"col text-left",children:[Object(ra.jsx)("label",{className:"mr-2",children:"Nombre del paciente"}),Object(ra.jsx)("span",{className:"text-uppercase",children:x.nombre})]}),Object(ra.jsxs)("div",{className:"col left",children:[Object(ra.jsx)("label",{className:"mr-2",children:"Diagnostico:"}),b]}),Object(ra.jsxs)("div",{className:"col-2 text-right",children:[Object(ra.jsx)("label",{className:"mr-2",children:"Presbicie:"}),p?"SI":"NO"]})]}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(fs,{esferaod:null!==t&&void 0!==t?t:"",esferaoi:null!==a&&void 0!==a?a:"",cilindrod:null!==s&&void 0!==s?s:"",cilindroi:null!==n&&void 0!==n?n:"",ejeod:null!==c&&void 0!==c?c:"",ejeoi:null!==r&&void 0!==r?r:"",adiciond:null!==o&&void 0!==o?o:"",adicioni:null!==i&&void 0!==i?i:"",adicion_media_od:null!==l&&void 0!==l?l:"",adicion_media_oi:null!==d&&void 0!==d?d:"",dpod:null!==j&&void 0!==j?j:"",dpoi:null!==u&&void 0!==u?u:"",alturaod:null!==m&&void 0!==m?m:"",alturaoi:null!==h&&void 0!==h?h:""})})}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"card-text text-center mt-4 pt-4",children:[Object(ra.jsx)("h4",{children:"Julio C\xe1rdenas Martinez"}),"Optometrista contactologo",Object(ra.jsx)("br",{}),"UAG",Object(ra.jsx)("br",{}),"CED PROF. 2413419"]})})})]})}}]),a}(s.Component),As=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleChangeRecomendations=function(e){var t=s.state,a=t.exam,n=t.used,c=Object.keys(e);"object"===typeof e&&s.setState({exam:Object(i.a)(Object(i.a)({},a),{},{category_ii:"category_id"===c[0]?null:a.category_ii},e),used:Object(i.a)(Object(i.a)({},n),{},{recomendaciones:!0})})},s.changeStatus=function(e){var t=e.target.checked;s.handleChangeInput("estado",t)},s.handleChangeInput=function(e,t){var a=s.state,n=a.exam,c=a.used,r=ts.handleTypeInput(e);s.setState({exam:Object(i.a)(Object(i.a)({},n),{},Object(J.a)({},e,t)),used:r?Object(i.a)(Object(i.a)({},c),{},Object(J.a)({},r,!0)):c})},s.handleStatus=function(){s.setState({status:!s.state.status})},s.handleSave=function(e){e.preventDefault();var t=s.state,a=t.cilindrod,n=t.cilindroi,c=t.ejeod,r=t.ejeoi,o=t.exam.id,i=s.props,l=i.contact,d=i.handleClose,j=i._saveExam;if(a<0&&!c||n<0&&!r)return window.Swal.fire("Verificaci\xf3n","El campo CILINDRO esta vacio","error"),!1;window.Swal.fire({title:"Almacenamiento",text:o?"\xbfEsta seguro de actualizar el examen?":"\xbfEsta seguro de crear un nuevo examen?",icon:"question",showCancelButton:!0,confirmButtonText:o?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){if(!e.dismiss){var t=s.state.exam,a=l.f_nacimiento?na()().diff(l.f_nacimiento,"years"):0,n=a<1||!a?0:a;t.contact_id=l.id,t.edad=t.edad?t.edad:n,t.status=t.estado,delete t.estado,t.category_id||(t.category_id=null),t.category_ii||(t.category_ii=null),j({id:o,data:t}),d(!0)}}))},s.getExam=function(){var e,t=s.props,a=t.exam,n=t._setContact;a.id&&(console.log("[Orus System] Procesando examen",a.id),s.setState({exam:Object(i.a)(Object(i.a)({},a),{},{category_id:a.category_primary?a.category_primary.id:null,category_ii:a.category_secondary?a.category_secondary.id:null}),load:!1,panel:0,used:{generales:!0,interrogatorios:!0,keraRet:!0,diabetes:!0,agudeza:!0,diagnostico:!0,graduacion:!0,observaciones:!0,recomendaciones:!0}}),n(null!==(e=a.paciente)&&void 0!==e?e:{id:0}))},s.state={exam:{id:0,edad:20},panel:0,used:{generales:!1,interrogatorios:!1,keraRet:!1,diabetes:!1,agudeza:!1,diagnostico:!1,graduacion:!1,observaciones:!1,recomendaciones:!1}},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getExam()}},{key:"componentDidUpdate",value:function(e){var t=this.props.contact,a=this.state.exam;e.contact.id===t.id||a.id||this.setState({exam:Object(i.a)(Object(i.a)({},a),{},{edad:t.edad})})}},{key:"render",value:function(){var e,t,a,s,n,c,r,o,i,l,d,j,u,m,h,b,p,x,O,g,f,v,N,y,w,S,C,_,k,E,I,A,T,D,L,F,P,B,z,M,U,G,R,V,J,q,$,H,Z,X,W,Y,K,Q,ee,te,ae,se,ne,ce,re,oe,ie,le,de,je,ue,me,he,be,pe,xe,Oe,ge,fe,ve,Ne,ye,we,Se,Ce,_e,ke,Ee,Ie,Ae,Te,De,Le,Fe,Pe,Be,ze,Me,Ue=this,Ge=this.state,Re=Ge.exam,Ve=Ge.panel,Je=Ge.used,qe=this.props,$e=qe.contact,He=qe.handleClose;return Object(ra.jsxs)("div",{className:"card card-info card-outline",children:[Object(ra.jsx)("div",{className:"card-header d-print-none",children:Object(ra.jsxs)("h3",{className:"card-title text-info",children:[Object(ra.jsx)("i",{className:"fas fa-notes-medical mr-1"}),Re.id?Object(ra.jsxs)("label",{children:["Examen ",Object(ra.jsxs)("span",{className:"badge badge-info",children:["#",Re.id]})]}):"Nuevo examen"]})}),Object(ra.jsxs)("div",{className:"card-body d-print-none",children:[Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)(Es,{readOnly:!!Re.id,title:"paciente",legend:"Busque el paciente por nombre para crear un nuevo examen",left:"6.5rem",edad:Re.edad,handleChangeContact:function(e){return Ue.setState({paciente:e})}}),$e.id?Object(ra.jsxs)("div",{className:"row my-4",children:[Object(ra.jsx)("div",{className:"col",children:Re.id?Object(ra.jsxs)("div",{className:"custom-control custom-switch ",children:[Object(ra.jsx)("input",{name:"estado",type:"checkbox",className:"custom-control-input",id:"estado",checked:Re.estado,onChange:this.changeStatus}),Object(ra.jsxs)("label",{className:Re.estado?"custom-control-label text-muted":"custom-control-label text-info",htmlFor:"estado",children:[Object(ra.jsx)("i",{className:Re.estado?"fas fa-folder":"fas fa-folder-open"}),Re.estado?"Examen terminado":"Examen en proceso"]})]}):null}),Re.edad!==$e.edad||!$e.edad&&!Re.id?Object(ra.jsxs)("div",{className:"col-12 col-sm-3 input-group",children:[Object(ra.jsx)("label",{className:"input-group-prepend mr-2",children:"Edad"}),Object(ra.jsx)("input",{type:"number",className:Re.edad?"form-control text-right mr-2":"form-control text-right mr-2 bg-info",value:Re.edad,placeholder:"Escriba la edad actual",onChange:function(e){var t=e.target.value,a=parseInt(t);a&&Ue.handleChangeInput("edad",a)},min:"1",max:"120"})]}):null]}):null]}),$e.id?Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col-2",children:Object(ra.jsxs)("div",{className:"nav flex-column nav-tabs",children:[Object(ra.jsxs)("a",{className:Ve?"nav-link":"nav-link text-bold active",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:0})},children:[Object(ra.jsx)("i",{className:Je.generales?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Generales ",Je.generales?"T":"F"]}),Object(ra.jsxs)("a",{className:1===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:1})},children:[Object(ra.jsx)("i",{className:Je.interrogatorios?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Interrogatorio"]}),Object(ra.jsxs)("a",{className:2===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:2})},children:[Object(ra.jsx)("i",{className:Je.keraRet?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Keratometria"]}),Object(ra.jsxs)("a",{className:3===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:3})},children:[Object(ra.jsx)("i",{className:Je.diabetes?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Diabetes"]}),Object(ra.jsxs)("a",{className:4===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:4})},children:[Object(ra.jsx)("i",{className:Je.agudeza?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Agudeza"]}),Object(ra.jsxs)("a",{className:5===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:5})},children:[Object(ra.jsx)("i",{className:Je.diagnostico?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Diagnostico"]}),Object(ra.jsxs)("a",{className:6===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:6})},children:[Object(ra.jsx)("i",{className:Je.graduacion?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Graduaci\xf3n"]}),Object(ra.jsxs)("a",{className:7===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:7})},children:[Object(ra.jsx)("i",{className:Je.observaciones?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Observaciones"]}),Object(ra.jsxs)("a",{className:8===Ve?"nav-link text-bold active":"nav-link",href:"#general",onClick:function(e){e.preventDefault(),Ue.setState({panel:8})},children:[Object(ra.jsx)("i",{className:Je.recomendaciones?"fas fa-check-circle mr-1 text-success":"fas fa-circle mr-1"}),"Recomendaciones"]})]})}),Object(ra.jsxs)("div",{className:"col-10",children:[Ve?null:Object(ra.jsx)(hs,{pc:null!==(e=Re.pc)&&void 0!==e?e:"",tablet:null!==(t=Re.tablet)&&void 0!==t?t:"",movil:null!==(a=Re.movil)&&void 0!==a?a:"",lap:null!==(s=Re.lap)&&void 0!==s?s:"",lap_time:null!==(n=Re.lap_time)&&void 0!==n?n:"",pc_time:null!==(c=Re.pc_time)&&void 0!==c?c:"",tablet_time:null!==(r=Re.tablet_time)&&void 0!==r?r:"",movil_time:null!==(o=Re.movil_time)&&void 0!==o?o:"",cefalea:null!==(i=Re.cefalea)&&void 0!==i?i:"",c_frecuencia:null!==(l=Re.c_frecuencia)&&void 0!==l?l:"",c_intensidad:null!==(d=Re.c_intensidad)&&void 0!==d?d:"",frontal:null!==(j=Re.frontal)&&void 0!==j?j:"",temporal:null!==(u=Re.temporal)&&void 0!==u?u:"",occipital:null!==(m=Re.occipital)&&void 0!==m?m:"",generality:null!==(h=Re.generality)&&void 0!==h?h:"",temporaoi:null!==(b=Re.temporaoi)&&void 0!==b?b:"",temporaod:null!==(p=Re.temporaod)&&void 0!==p?p:"",handleGetData:this.handleChangeInput}),1===Ve?Object(ra.jsx)(bs,{interrogatorio:null!==(x=Re.interrogatorio)&&void 0!==x?x:"",coa:null!==(O=Re.coa)&&void 0!==O?O:"",aopp:null!==(g=Re.aopp)&&void 0!==g?g:"",aopf:null!==(f=Re.aopf)&&void 0!==f?f:"",onChangeInput:this.handleChangeInput}):null,2===Ve?Object(ra.jsx)(ps,{keratometriaoi:null!==(v=Re.keratometriaoi)&&void 0!==v?v:"",keratometriaod:null!==(N=Re.keratometriaod)&&void 0!==N?N:"",rsoi:null!==(y=Re.rsoi)&&void 0!==y?y:"",rsod:null!==(w=Re.rsod)&&void 0!==w?w:"",onChangeInput:this.handleChangeInput}):null,3===Ve?Object(ra.jsx)(xs,{d_time:null!==(S=Re.d_time)&&void 0!==S?S:"",d_media:null!==(C=Re.d_media)&&void 0!==C?C:"",d_test:null!==(_=Re.d_test)&&void 0!==_?_:"",d_fclod:null!==(k=Re.d_fclod)&&void 0!==k?k:"",d_fclod_time:null!==(E=Re.d_fclod_time)&&void 0!==E?E:"",d_fcloi:null!==(I=Re.d_fcloi)&&void 0!==I?I:"",d_fcloi_time:null!==(A=Re.d_fcloi_time)&&void 0!==A?A:"",oftalmoscopia:null!==(T=Re.oftalmoscopia)&&void 0!==T?T:"",onChangeInput:this.handleChangeInput}):null,4===Ve?Object(ra.jsx)(Os,{cvod:null!==(D=Re.cvod)&&void 0!==D?D:"",cvoi:null!==(L=Re.cvoi)&&void 0!==L?L:"",avslod:null!==(F=Re.avslod)&&void 0!==F?F:"",avsloi:null!==(P=Re.avsloi)&&void 0!==P?P:"",avcgaod:null!==(B=Re.avcgaod)&&void 0!==B?B:"",avcgaoi:null!==(z=Re.avcgaoi)&&void 0!==z?z:"",avfod:null!==(M=Re.avfod)&&void 0!==M?M:"",avfoi:null!==(U=Re.avfoi)&&void 0!==U?U:"",avf2o:null!==(G=Re.avf2o)&&void 0!==G?G:"",onChangeInput:this.handleChangeInput}):null,5===Ve?Object(ra.jsx)(gs,{diagnostico:null!==(R=Re.diagnostico)&&void 0!==R?R:"",presbicie:null!==(V=Re.presbicie)&&void 0!==V?V:"",piod:null!==(J=Re.piod)&&void 0!==J?J:"",pioi:null!==(q=Re.pioi)&&void 0!==q?q:"",txoftalmico:null!==($=Re.txoftalmico)&&void 0!==$?$:"",onChangeInput:this.handleChangeInput}):null,6===Ve?Object(ra.jsx)(fs,{esferaod:null!==(H=Re.esferaod)&&void 0!==H?H:0,esferaoi:null!==(Z=Re.esferaoi)&&void 0!==Z?Z:0,cilindrod:null!==(X=Re.cilindrod)&&void 0!==X?X:0,cilindroi:null!==(W=Re.cilindroi)&&void 0!==W?W:0,ejeod:null!==(Y=Re.ejeod)&&void 0!==Y?Y:0,ejeoi:null!==(K=Re.ejeoi)&&void 0!==K?K:0,adiciond:null!==(Q=Re.adiciond)&&void 0!==Q?Q:0,adicioni:null!==(ee=Re.adicioni)&&void 0!==ee?ee:0,adicion_media_od:null!==(te=Re.adicion_media_od)&&void 0!==te?te:0,adicion_media_oi:null!==(ae=Re.adicion_media_oi)&&void 0!==ae?ae:0,dpod:null!==(se=Re.dpod)&&void 0!==se?se:0,dpoi:null!==(ne=Re.dpoi)&&void 0!==ne?ne:0,alturaod:null!==(ce=Re.alturaod)&&void 0!==ce?ce:0,alturaoi:null!==(re=Re.alturaoi)&&void 0!==re?re:0,lcmarca:null!==(oe=Re.lcmarca)&&void 0!==oe?oe:0,lcgod:null!==(ie=Re.lcgod)&&void 0!==ie?ie:0,lcgoi:null!==(le=Re.lcgoi)&&void 0!==le?le:0,onChangeInput:this.handleChangeInput}):null,7===Ve?Object(ra.jsx)(vs,{observaciones:null!==(de=Re.observaciones)&&void 0!==de?de:"",onChangeInput:this.handleChangeInput}):null,8===Ve?Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(ws,{category_id:null!==(je=Re.category_id)&&void 0!==je?je:null,esferaod:null!==(ue=Re.esferaod)&&void 0!==ue?ue:"",esferaoi:null!==(me=Re.esferaoi)&&void 0!==me?me:"",cilindrod:null!==(he=Re.cilindrod)&&void 0!==he?he:"",cilindroi:null!==(be=Re.cilindroi)&&void 0!==be?be:"",nameCategory:"category_id",nameItem:"item1",title:"Recomendacion principal",onChangeInput:this.handleChangeRecomendations,update:!0})}),Re.category_id?Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(ws,{category_id:null!==(pe=Re.category_ii)&&void 0!==pe?pe:null,esferaod:null!==(xe=Re.esferaod)&&void 0!==xe?xe:"",esferaoi:null!==(Oe=Re.esferaoi)&&void 0!==Oe?Oe:"",cilindrod:null!==(ge=Re.cilindrod)&&void 0!==ge?ge:"",cilindroi:null!==(fe=Re.cilindroi)&&void 0!==fe?fe:"",nameCategory:"category_ii",nameItem:"item2",title:"Recomendacion adicional",onChangeInput:this.handleChangeRecomendations,update:!0})}):null]}):null]})]}):null]}),Object(ra.jsxs)("div",{className:"card-footer text-right",children:[Object(ra.jsxs)("div",{className:"btn-group d-print-none",role:"group",children:[Object(ra.jsxs)("a",{href:"#close",className:"btn btn-default",onClick:function(e){e.preventDefault(),He()},children:[Object(ra.jsx)("i",{className:Re.id?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),Object(ra.jsx)("strong",{children:Re.id?"Cancelar":"Cerrar"})]}),Re.id?Object(ra.jsxs)("button",{className:"btn btn-default",onClick:function(e){e.preventDefault(),window.print()},children:[Object(ra.jsx)("i",{className:"fas fa-print mr-2"}),"Imprimir"]}):null,Object(ra.jsxs)("button",{type:"button",className:$e.id?"btn btn-info":"btn btn-info disabled",onClick:this.handleSave,disabled:!$e.id,children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"}),Object(ra.jsx)("strong",{children:Re.id?"Actualizar":"Guardar"})]})]}),Object(ra.jsx)(Is,{esferaod:null!==(ve=Re.esferaod)&&void 0!==ve?ve:"",esferaoi:null!==(Ne=Re.esferaoi)&&void 0!==Ne?Ne:"",cilindrod:null!==(ye=Re.cilindrod)&&void 0!==ye?ye:"",cilindroi:null!==(we=Re.cilindroi)&&void 0!==we?we:"",ejeod:null!==(Se=Re.ejeod)&&void 0!==Se?Se:"",ejeoi:null!==(Ce=Re.ejeoi)&&void 0!==Ce?Ce:"",adiciond:null!==(_e=Re.adiciond)&&void 0!==_e?_e:"",adicioni:null!==(ke=Re.adicioni)&&void 0!==ke?ke:"",adicion_media_od:null!==(Ee=Re.adicion_media_od)&&void 0!==Ee?Ee:"",adicion_media_oi:null!==(Ie=Re.adicion_media_oi)&&void 0!==Ie?Ie:"",dpod:null!==(Ae=Re.dpod)&&void 0!==Ae?Ae:"",dpoi:null!==(Te=Re.dpoi)&&void 0!==Te?Te:"",alturaod:null!==(De=Re.alturaod)&&void 0!==De?De:"",alturaoi:null!==(Le=Re.alturaoi)&&void 0!==Le?Le:"",lcmarca:null!==(Fe=Re.lcmarca)&&void 0!==Fe?Fe:"",lcgod:null!==(Pe=Re.lcgod)&&void 0!==Pe?Pe:"",lcgoi:null!==(Be=Re.lcgoi)&&void 0!==Be?Be:"",diagnostico:null!==(ze=Re.diagnostico)&&void 0!==ze?ze:"",paciente:null!==$e&&void 0!==$e?$e:"",presbicie:null!==(Me=Re.presbicie)&&void 0!==Me?Me:""})]})]})}}]),a}(s.Component),Ts={_deleteExam:vt.deleteExam,_saveExam:vt.saveExam,_setContact:et.setContact},Ds=Object(Wt.b)((function(e){var t=e.exam,a=e.contact;return{messages:t.messages,contact:a.contact}}),Ts)(As),Ls=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).newExam=function(){var e=s.props,t=e._setListContact,a=e._setContact,n=e.history;s.setState({newOrEdit:!0}),t({result:{list:[],metaList:{}}}),a({}),n.push("/consultorio/new")},s.changeStatus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.id)s.handleSaveExam(e.id,{status:e.estado?0:1});else{var t=s.state,a=t.examSelected,n=t.exam;a&&(s.handleSaveExam(n.id,{status:n.estado?0:1}),s.setState({examSelected:"",exam:{}}))}},s.handleSaveExam=function(e,t){(0,s.props._saveExam)({id:e,data:t,options:s.state.options}),s.setState({load:!0})},s.handleCloseEdit=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=s.state.options,a=Object(i.a)(Object(i.a)({},t),{},{page:1}),n=s.props,c=n.history,r=n._setContact;s.setState({newOrEdit:!1,exam:{},examSelected:"",options:e?a:t,load:!0}),r({}),c.push("/consultorio")},s.handleEditItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=s.state.examSelected,a=s.props,n=a.exams,c=a.history,r=null!==e&&void 0!==e?e:t,o=n.filter((function(e){return e.id===r}));o.length?(console.log("[Orus System] Editar usuario",r),s.setState({exam:o[0],newOrEdit:!0,examSelected:r,load:!1}),c.push("/consultorio/".concat(r))):(s.setState({newOrEdit:!1,exam:{},examSelected:"",load:!0}),c.push("/consultorio"))},s.handleSetSelectOptions=function(e){var t,a=e.target,n=a.name,c=a.value,r=s.state.options,o=c;"itemsPage"===n&&(o=parseInt(c)),"date"===n&&(o=c||""),s.setState({options:Object(i.a)(Object(i.a)({},r),{},(t={},Object(J.a)(t,n,o),Object(J.a)(t,"page",1),t)),load:!0})},s.handleChangeCheckbox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.target,n=a.value,c=a.checked;c?s.setState({examSelected:parseInt(n),exam:t}):s.setState({examSelected:"",exam:{}})},s.handleSearch=function(e){var t=s.state.options;s.setState({options:Object(i.a)(Object(i.a)({},t),{},{search:e}),load:!0})},s.handleChangePage=function(e){var t=s.state.options;s.setState({options:Object(i.a)(Object(i.a)({},t),{},{page:e}),load:!0})},s.handleSync=function(){s.setState({load:!0})},s.handleDelete=function(e,t){var a=s.state.examSelected,n=s.props._deleteExam;if(!a)return window.Swal.fire({title:"Verificacion",text:"Debe de selecionar al menos un contacto para eliminar",icon:"warning"}),!1;window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){"cancel"!==e.dismiss&&(console.log("[Orus System] Enviando datos para eliminar",a),n({id:a})),s.setState({examSelected:"",exam:{}})}))},s.state={newOrEdit:!1,load:!1,options:{page:1,orderby:"created_at",order:"desc",search:"",status:"",itemsPage:10,date:""},examSelected:"",exam:{}},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e._getExam,s=t.params.id;s?a(s):this.setState({load:!0})}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.load,s=this.props,n=s.messages,c=s.exam,r=s._setMessages;t.load!==a&&!0===a&&(console.log("[OrusSystem] Cargando examenes",a),this.getExams()),e.exam.id!==c.id&&c.id&&(console.log("[OrusSystem] Exam en URL",c.id),this.setState({newOrEdit:!0,exam:c,examSelected:c.id,load:!1})),e.messages.length!==n.length&&n.length&&(n.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),r())}},{key:"render",value:function(){var e=this,t=this.props,a=t.meta,s=t.loading,n=t.exams,c=this.state,r=c.newOrEdit,o=c.options,l=c.examSelected,d=c.exam;return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-sm-12 col-md-4 col-lg-2 d-print-none",children:[Object(ra.jsxs)("button",{className:"btn bg-info btn-block mb-3",type:"button",disabled:r,onClick:this.newExam,children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Nuevo examen"]}),r?null:Object(ra.jsxs)(ka,{title:"Filtros",children:[Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:o.orderby,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(ra.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"date",children:"Fecha"}),Object(ra.jsx)("input",{type:"date",id:"date",name:"date",value:o.date?na()(o.date).format("YYYY-MM-DD"):"",className:"form-control",onChange:this.handleSetSelectOptions}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-info btn-block text-bold",onClick:function(t){var a=e.state.options;e.setState({options:Object(i.a)(Object(i.a)({},a),{},{date:""}),load:!0})},children:[Object(ra.jsx)("i",{className:"fas fa-trash mr-1"}),"Borrar fecha"]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:o.order,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"asc",children:"Antiguos"}),Object(ra.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"itemsPage",children:"Numero de examenes"}),Object(ra.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:o.itemsPage,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"10",children:"ver 10"}),Object(ra.jsx)("option",{value:"20",children:"ver 20"}),Object(ra.jsx)("option",{value:"50",children:"ver 50"}),Object(ra.jsx)("option",{value:"100",children:"ver 100"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"status",children:"Estado"}),Object(ra.jsxs)("select",{className:"form-control ",name:"status",id:"status",value:o.status,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"",children:"-- Todos --"}),Object(ra.jsx)("option",{value:"1",children:"Solo terminados"}),Object(ra.jsx)("option",{value:"0",children:"En proceso"})]})]})]})]}),Object(ra.jsx)("div",{className:"col-sm-12 col-md-8 col-lg-10",children:r?Object(ra.jsx)(Ds,{exam:d,handleClose:this.handleCloseEdit}):Object(ra.jsx)(Ca,{title:"Lista de examenes",icon:"notes-medical",color:"info",loading:s,meta:a,itemSelected:l,handlePagination:this.handleChangePage,handleSearch:this.handleSearch,handleDeleteItem:this.handleDelete,handleEditItem:this.handleEditItem,handleSync:this.handleSync,handleStatus:this.changeStatus,children:Object(ra.jsxs)("table",{className:"table table-hover table-striped",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{}),Object(ra.jsx)("th",{children:"Nombre"}),Object(ra.jsx)("th",{children:"Estado"}),Object(ra.jsx)("th",{children:"ESF"}),Object(ra.jsx)("th",{children:"CIL"}),Object(ra.jsx)("th",{children:"EJE"}),Object(ra.jsx)("th",{children:"ADC"}),Object(ra.jsx)("th",{children:"MED"}),Object(ra.jsx)("th",{children:"DP"}),Object(ra.jsx)("th",{children:"ALT"}),Object(ra.jsx)("th",{children:"created_at"===o.orderby?"Registrado":"Actualizado"})]})}),Object(ra.jsx)("tbody",{children:n.length?Object(ra.jsx)(ra.Fragment,{children:n.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("td",{className:"icheck-primary pl-2",children:[Object(ra.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:t.id,id:"exam_"+t.id,checked:l===t.id,onChange:function(a){console.log("[DEBUG] exam change",t),e.handleChangeCheckbox(a,t)},disabled:t.estado||t.orders.length}),Object(ra.jsx)("label",{htmlFor:"exam_"+t.id,className:"sr-only"})]}),Object(ra.jsx)("td",{className:"mailbox-name text-capitalize text-truncate",children:Object(ra.jsx)("a",{href:"#edit",onClick:function(a){a.preventDefault(),e.handleEditItem(t.id)},children:Object(ra.jsxs)("span",{className:t.estado||t.orders.length?"text-muted":"text-dark text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-user text-sm mr-2"}),t.paciente.nombre]})})}),Object(ra.jsx)("td",{className:"text-center",style:{cursor:"pointer"},onClick:function(a){return e.changeStatus(t)},children:t.estado?Object(ra.jsx)("i",{className:"fas fa-clipboard-check text-muted",title:"Terminado"}):Object(ra.jsx)("i",{className:"fas fa-clipboard text-info",title:"En proceso"})}),Object(ra.jsxs)("td",{children:[t.esferaod,"/",t.esferaoi]}),Object(ra.jsxs)("td",{children:[t.cilindrod,"/",t.cilindroi]}),Object(ra.jsxs)("td",{children:[t.ejeod,"/",t.ejeoi]}),Object(ra.jsxs)("td",{children:[t.adiciond,"/",t.adicioni]}),Object(ra.jsxs)("td",{children:[t.adicion_media_od,"/",t.adicion_media_oi]}),Object(ra.jsxs)("td",{children:[t.dpod,"/",t.dpoi]}),Object(ra.jsxs)("td",{children:[t.alturaod,"/",t.alturaoi]}),Object(ra.jsx)("td",{children:na()("created_at"===o.orderby?t.created_at:t.updated_at).fromNow()})]},t.id)}))}):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{className:"text-center text-muted",colSpan:"12",children:"No hay examenes registrados"})})})]})})})]})}},{key:"getExams",value:function(){(0,this.props._getListExams)(this.state.options),this.setState({load:!1})}}]),a}(s.Component),Fs={_getListExams:vt.getListExam,_deleteExam:vt.deleteExam,_setListContact:et.setListContact,_saveExam:vt.saveExam,_getExam:vt.getExam,_setContact:et.setContact,_setMessages:vt.setMessagesExam},Ps=Object(Wt.b)((function(e){var t=e.exam;return{exams:t.list,messages:t.messages,meta:t.metaList,loading:t.loading,exam:t.exam}}),Fs)(Ls),Bs={_getList:te.getListOrder,_getOrder:te.getOrder,_setOrder:te.setOrder,_setOptions:te.setOptions,_deleteOrder:te.deleteOrder,_saveOrder:te.saveOrder},zs=Object(Wt.b)((function(e){var t=e.order;return{orders:t.list,options:t.options,meta:t.metaList,loading:t.loading}}),Bs)((function(e){var t=e.orders,a=void 0===t?[]:t,n=e.meta,c=e.options,r=e.loading,o=e._getList,i=e._getOrder,l=e._setOrder,d=e._setOptions,j=e._deleteOrder,u=e._saveOrder,m=Object(s.useState)({id:0}),h=Object(wa.a)(m,2),b=h[0],p=h[1],x=function(e,t){d({key:e,value:t})},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:0};e&&e.preventDefault(),t.id?l(t):b.id&&i(b.id)};return Object(s.useEffect)((function(){o(c)}),[c]),Object(ra.jsx)(Ca,{title:"Listado de pedidos",icon:"clipboard-list",color:"warning",meta:n,itemSelected:b.id,loading:r,defaultSearch:c.search,handlePagination:function(e){return x("page",e)},handleSearch:function(e){return x("search",e)},handleEditItem:O,handleDeleteItem:function(){Ya.handleDeleteOrder(b,c,j),p({id:0})},handleSync:function(){return o(c)},handleStatus:function(){b.id&&b.estado<3&&Ya.handleSaveOrder(b.id,{status:3},c,u),p({id:0})},children:Object(ra.jsxs)("table",{className:"table table-hover table-striped",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{}),Object(ra.jsx)("th",{children:"Folio"}),Object(ra.jsx)("th",{children:"Cliente"}),Object(ra.jsx)("th",{children:"Estado"}),Object(ra.jsx)("th",{children:"Nota"}),Object(ra.jsx)("th",{children:"created_at"===c.orderby?"Registrado":"Modificado"})]})}),Object(ra.jsx)("tbody",{children:a.length?a.map((function(e){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:Object(ra.jsxs)("div",{className:"icheck-primary",children:[Object(ra.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",value:e.id,id:"exam_"+e.id,checked:b.id===e.id,disabled:e.estado>2,onChange:function(t){return function(e,t){e.checked||(t={id:0}),p(t)}(t.target,e)}}),Object(ra.jsx)("label",{htmlFor:"exam_"+e.id,className:"sr-only"})]})}),Object(ra.jsxs)("td",{children:["#",e.id]}),Object(ra.jsx)("td",{className:"mailbox-name text-truncate text-capitalize text-bold",style:{cursor:"pointer"},children:Object(ra.jsx)("a",{href:"#edit",onClick:function(t){return O(t,e)},children:Object(ra.jsxs)("span",{className:e.estado>2?"text-muted":"text-dark text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-user text-sm mr-2"}),e.paciente.nombre]})})}),Object(ra.jsxs)("td",{className:"mailbox-subject",children:[Object(ra.jsx)("span",{className:"badge badge-".concat(e.estado<3?"primary":"secondary"," mr-2 text-uppercase"),children:Ya.handleStatusString(e.estado)}),1===e.estado?Object(ra.jsxs)("div",{children:[Object(ra.jsx)("span",{className:"mr-1 text-dark",children:e.laboratorio?e.laboratorio.nombre:"Sin asignar"}),e.laboratorio?"/ "+e.folio_lab:""]}):2===e.estado?Object(ra.jsx)("small",{children:e.caja?"CAJA: "+e.caja:"Caja no asignada"}):e.estado?3===e.estado?Object(ra.jsx)("small",{className:"text-dark",children:"Sin entregar"}):null:Object(ra.jsx)("small",{children:e.examen?1===e.examen.estado?"Examen completado":"Examen no realizado":"Examen no asignado"})]}),Object(ra.jsx)("td",{className:"mailbox-attachment",children:e.nota?Object(ra.jsx)(ta.b,{to:"/notas/registro/"+e.nota.id,children:Object(ra.jsx)("span",{className:"badge badge-success",children:e.nota.id})}):"--"}),Object(ra.jsx)("td",{className:"mailbox-date",children:"created_at"===c.orderby?na()(e.created_at).format("ll"):na()(e.updated_at).fromNow()})]},e.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{colSpan:"10",className:"text-center",children:"No hay datos para mostrar"})})})]})})})),Ms={_saveExam:vt.saveExam},Us=Object(Wt.b)((function(e){return{messages:e.exam.messages}}),Ms)((function(e){var t,a,n,c,r,o,l,d,j,u,m,h,b,p,x,O=e.exam,g=void 0===O?{}:O,f=e.examEdit,v=void 0!==f&&f,N=e.ChangeInput,y=e._saveExam,w=Object(s.useState)({esferaod:g.esferaod,esferaoi:g.esferaoi,cilindrod:g.cilindrod,cilindroi:g.cilindroi,ejeod:g.ejeod,ejeoi:g.ejeoi,adiciond:g.adiciond,adicioni:g.adicioni,adicion_media_od:g.adicion_media_od,adicion_media_oi:g.adicion_media_oi,dpod:g.dpod,dpoi:g.dpoi,alturaod:g.alturaod,alturaoi:g.alturaoi,lcmarca:g.lcmarca,lcgod:g.lcgod,lcgoi:g.lcgoi}),S=Object(wa.a)(w,2),C=S[0],_=S[1],k=function(){N("examEdit",!1)};return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("b",{children:["Folio ",Object(ra.jsx)("br",{}),"#",g.id]})}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("b",{children:"Fecha:"}),Object(ra.jsx)("br",{}),Object(ra.jsx)("i",{className:"fas fa-calendar mr-2"}),na()(g.created_at).format("L")]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("b",{children:"Estado:"}),Object(ra.jsx)("br",{}),g.estado?Object(ra.jsxs)("span",{className:"badge badge-success",children:[Object(ra.jsx)("i",{className:"fas fa-check"})," Terminado"]}):Object(ra.jsxs)("span",{className:"badge badge-secondary",children:[Object(ra.jsx)("i",{className:"fas fa-hourglass"})," Activo"]})]})]}),g.observaciones?Object(ra.jsx)("div",{className:"form-group mt-2",children:Object(ra.jsxs)("div",{className:"callout callout-info",children:[Object(ra.jsxs)("h5",{className:"text-info text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-info"})," Observaciones:"]}),g.observaciones]})}):null,Object(ra.jsx)("div",{className:"row mt-2",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(fs,{esferaod:null!==(t=C.esferaod)&&void 0!==t?t:0,esferaoi:null!==(a=C.esferaoi)&&void 0!==a?a:0,cilindrod:null!==(n=C.cilindrod)&&void 0!==n?n:0,cilindroi:null!==(c=C.cilindroi)&&void 0!==c?c:0,ejeod:null!==(r=C.ejeod)&&void 0!==r?r:0,ejeoi:null!==(o=C.ejeoi)&&void 0!==o?o:0,adiciond:null!==(l=C.adiciond)&&void 0!==l?l:0,adicioni:null!==(d=C.adicioni)&&void 0!==d?d:0,adicion_media_od:C.adicion_media_od,adicion_media_oi:C.adicion_media_oi,dpod:null!==(j=C.dpod)&&void 0!==j?j:0,dpoi:null!==(u=C.dpoi)&&void 0!==u?u:0,alturaod:null!==(m=C.alturaod)&&void 0!==m?m:0,alturaoi:null!==(h=C.alturaoi)&&void 0!==h?h:0,lcmarca:null!==(b=C.lcmarca)&&void 0!==b?b:0,lcgod:null!==(p=C.lcgod)&&void 0!==p?p:0,lcgoi:null!==(x=C.lcgoi)&&void 0!==x?x:0,readOnly:!v,onChangeInput:function(e,t){var a=Object(i.a)(Object(i.a)({},C),{},Object(J.a)({},e,parseFloat(t)));_(a),N("codes",{})}})})}),v?Object(ra.jsx)("div",{className:"text-right mt-2",children:Object(ra.jsxs)("div",{className:"btn-group",children:[Object(ra.jsxs)("button",{className:"btn btn-default",onClick:k,children:[Object(ra.jsx)("i",{className:"fas fa-times mr-1"})," Cerrar"]}),Object(ra.jsxs)("button",{className:"btn btn-info",onClick:function(){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de actualizar el examen?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Actualizar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0}).then((function(e){e.dismiss||(y({id:g.id,data:C}),k())}))},children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"})," Guardar"]})]})}):null]})}));var Gs={_getList:Me.getListStore,_setList:Me.setListStore},Rs=Object(Wt.b)((function(e){var t=e.storeItem;return{items:t.list,meta:t.metaList,loading:t.loading}}),Gs)((function(e){var t=e.items,a=e.meta,n=e.item,c=void 0===n?{producto:""}:n,r=e._getList,o=e._setList,i=e.handleItemSelect,l=Object(s.useState)(c.producto),d=Object(wa.a)(l,2),j=d[0],u=d[1],m=Object(s.useState)(""),h=Object(wa.a)(m,2),b=h[0],p=h[1],x=Object(s.useState)(!1),O=Object(wa.a)(x,2),g=O[0],f=O[1];return Object(s.useEffect)((function(){var e=null;j.length>2&&!c.store_items_id&&(b&&clearTimeout(b),e=setTimeout((function(){r({search:j,itemsPage:10}),p(""),f(!1)}),1e3),p(e)),!j.length&&t.length&&(b&&clearTimeout(b),o({result:{list:[],metaList:{}}}),f(!1))}),[j]),Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("label",{children:["Producto",g?Object(ra.jsx)("small",{className:"position-absolute text-primary ml-2",style:{zIndex:"101",top:"0"},children:"Buscando..."}):null]}),Object(ra.jsx)("input",{className:"form-control text-uppercase text-truncate",type:"text",placeholder:"Buscar producto",autoComplete:"off",value:j,onChange:function(e){var t=e.target.value;u(t.toLowerCase()),f(!0)}}),t.length?Object(ra.jsx)("div",{className:"position-absolute shadow p-0 pt-2 pl-1 bg-white rounded w-100 mh-50 overflow-auto",style:{maxHeight:"18rem",zIndex:"100"},children:Object(ra.jsxs)("div",{className:"list-group m-0 list-group-flush",children:[t.map((function(e){var t=e.cantidades>0?e.cantidades:0;return Object(ra.jsxs)("a",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",href:"#l",onClick:function(t){t.preventDefault(),function(e){o({result:{list:[],metaList:{}}}),i(e),u(e.producto.toUpperCase())}(e)},children:[Object(ra.jsx)("span",{className:t?"text-truncate text-uppercase text-primary text-bold":"text-truncate text-uppercase text-muted",children:e.producto}),Object(ra.jsx)("span",{className:t?"badge badge-primary badge-pill":"badge badge-dark badge-pill",children:t})]},e.id)})),a.total>10&&Object(ra.jsxs)("a",{href:"#more",className:"list-group-item text-center text-dark text-bold",onClick:function(e){return e.preventDefault()},children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Existen mas registros, sea m\xe1s espesifico"]})]})}):null]})})),Vs={verifyItem:function(e){return e.cantidad<=0?(window.Swal.fire({title:"Verificacion",text:"La cantidad debe de ser un valor valido",icon:"warning"}),!1):e.store_items_id?!!e.precio||(window.Swal.fire({title:"Verificacion",text:"El precio no es valido",icon:"warning"}),!1):(window.Swal.fire({title:"Verificacion",text:"No se selecciono un producto valido",icon:"warning"}),!1)}};var Js=function(e){var t=e.codeDefault,a=void 0===t?"":t,n=e.cantDefault,c=void 0===n?1:n,r=e.handleAddItem,o=e.handleCloseModal,l=Object(s.useState)({id:0,producto:a,cantidad:c,precio:0,out:0,inStorage:0,subtotal:0,store_items_id:0,descripcion:"",category:0}),d=Object(wa.a)(l,2),j=d[0],u=d[1],m=Object(s.useState)(!1),h=Object(wa.a)(m,2),b=h[0],p=h[1],x=function(){u({id:0,producto:"",precio:0,out:0,cantidad:1,inStorage:0,subtotal:0,store_items_id:0,descripcion:"",category:0}),o()},O=function(e,t){u(Object(i.a)(Object(i.a)({},j),{},Object(J.a)({},e,"descripcion"===e?t:parseInt(t))))};return Object(ra.jsx)("div",{className:"modal d-block",tabIndex:"-1",children:Object(ra.jsx)("div",{className:"modal-dialog modal-dialog-centered",role:"document",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsxs)("h5",{className:"modal-title text-primary text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"}),"Agregar producto"]}),Object(ra.jsx)("button",{type:"button",className:"close",onClick:function(){return x()},children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsx)("div",{className:"modal-body",children:Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col position-relative",children:Object(ra.jsx)(Rs,{item:j,handleItemSelect:function(e){u({id:0,producto:e.producto.toLowerCase(),precio:parseFloat(e.precio),out:e.cantidades,cantidad:1,inStorage:0,subtotal:0,store_items_id:e.id,descripcion:"",category:e.categoria?e.categoria.id:0})}})}),j.store_items_id?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"col-2",children:[Object(ra.jsx)("label",{children:"Cantidad"}),Object(ra.jsx)("input",{type:"number",className:"form-control",placeholder:"Cantidad",value:j.cantidad,min:"0",max:"100",onChange:function(e){var t=e.target;return O("cantidad",t.value)}})]}),Object(ra.jsxs)("div",{className:"col-3",children:[Object(ra.jsx)("label",{children:"Precio"}),Object(ra.jsx)("input",{type:"number",className:"form-control text-right",placeholder:"Precio",min:"0",value:j.precio,onChange:function(e){var t=e.target;return O("precio",t.value)}})]}),b?Object(ra.jsx)("div",{className:"col-12 mt-2",children:Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Agregue una descripcion",value:j.descripcion,onChange:function(e){var t=e.target;return O("descripcion",t.value)}})}):null]}):null]})}),Object(ra.jsx)("div",{className:"modal-footer",children:Object(ra.jsxs)("div",{className:"btn-group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:function(){return x()},children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-1"}),"Cancelar"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:function(){return p(!b)},disabled:!j.store_items_id,children:[Object(ra.jsx)("i",{className:"fas fa-sticky-note mr-1"}),b?"Cerrar nota":"Abrir nota"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-primary btn-sm text-bold",disabled:!(j.store_items_id&&j.cantidad&&j.precio),onClick:function(){return function(){if(!Vs.verifyItem(j))return!1;j.inStorage=j.out>=j.cantidad,j.out=j.out>=j.cantidad?0:j.cantidad-j.out,j.subtotal=parseFloat(j.cantidad*j.precio),r(j),x()}()},children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"}),"Agregar"]})]})})]})})})},qs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleSetCantItem=function(e,t){var a=s.props,n=a.items;(0,a.ChangeInput)("items",n.map((function(a){return a.store_items_id===e&&(a.cantidad=a.cantidad+t,a.subtotal=a.cantidad*a.precio),a})).filter((function(e){return e.cantidad>0})))},s.handleSetCode=function(e){var t=e.code,a=e.oi,n=e.od;s.setState({itemNew:!0,code:t,cant:a===n?2:1})},s.deleteItem=function(e){var t=s.props,a=t.items,n=t.status,c=void 0===n||n,r=t.ChangeInput,o=a.filter((function(t){return t.store_items_id!==e}));if(!c)return console.error("[Orus System] No se puede eliminar el producto, por estatus",e),!1;r("items",o)},s.handleAddItem=function(e){if(e){var t=s.props,a=t.items,n=t.ChangeInput,c=a.findIndex((function(t){return t.store_items_id===e.store_items_id}));if(-1!==c){var r=a[c].cantidad+e.cantidad,o=e.precio,i=a[c].precio*r;a[c].precio===o?(a[c].cantidad=r,a[c].subtotal=i):a.push(e)}else a.push(e);n("items",a)}},s.state={itemNew:!1,code:"",cant:1},s.total=0,s}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.itemNew,s=t.code,n=t.cant,c=this.props,r=c.items,o=c.codes,i=c.session,l=c.status,d=void 0===l||l,j=!c.noPrice;return this.total=0,Object(ra.jsxs)("div",{className:"card ",children:[Object(ra.jsxs)("div",{className:"card-header",children:[Object(ra.jsxs)("h3",{className:"card-title",children:[Object(ra.jsx)("i",{className:"fas fa-shopping-cart"})," Pedido"]}),Object(ra.jsx)("div",{className:"card-tools",children:i&&!a?Object(ra.jsxs)("button",{className:d?"btn btn-too btn-primary text-bold":"btn btn-too btn-outline-secondary disabled",disabled:!d,onClick:function(t){e.setState({itemNew:!e.state.itemNew,code:"",cant:1})},children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-1"})," Agregar"]}):null})]}),Object(ra.jsx)("div",{className:"card-body table-responsive p-0",children:Object(ra.jsxs)("table",{className:"table table-sm m-0",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[d?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("th",{style:{width:16}}),Object(ra.jsx)("th",{style:{width:16}})]}):null,Object(ra.jsx)("th",{scope:"col",style:{width:32},children:"cant"}),Object(ra.jsx)("th",{scope:"col",children:"Descripcion"}),j?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("th",{scope:"col",className:"text-right",style:{width:120},children:"Precio"}),Object(ra.jsx)("th",{scope:"col",className:"text-right",style:{width:120},children:"Subtotal"})]}):null,d?Object(ra.jsx)("th",{scope:"col",style:{minWidth:"4rem",maxWidth:"8rem"},children:Object(ra.jsx)("span",{className:"sr-only",children:"acciones"})}):null]})}),Object(ra.jsx)("tbody",{children:r.length?r.map((function(t){return e.total+=1*t.subtotal,Object(ra.jsxs)("tr",{children:[d?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsx)("td",{children:t.cantidad>1?Object(ra.jsx)("i",{className:"fas fa-minus mr-2 text-primary",title:"Quitar",style:{cursor:"pointer"},onClick:function(){return e.handleSetCantItem(t.store_items_id,-1)}}):Object(ra.jsx)("i",{className:"fas fa-minus mr-2 text-muted"})}),Object(ra.jsx)("td",{children:Object(ra.jsx)("i",{className:"fas fa-plus mr-2 text-primary",title:"Agregar",style:{cursor:"pointer"},onClick:function(){return e.handleSetCantItem(t.store_items_id,1)}})})]}):null,Object(ra.jsx)("th",{scope:"row",className:"text-right",children:t.cantidad}),Object(ra.jsxs)("td",{children:[t.inStorage?null:Object(ra.jsx)("i",{className:"text-warning fas fa-circle mr-1"}),Object(ra.jsx)("span",{className:"text-capitalize",children:t.producto}),t.descripcion?Object(ra.jsxs)("span",{className:"text-muted ml-2",children:["(",t.descripcion,")"]}):null]}),j?Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("td",{className:"text-right",children:["$ ",parseFloat(t.precio).toFixed(2)]}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.subtotal.toFixed(2)]})]}):null,d?Object(ra.jsx)("td",{className:"d-print-none text-right",children:Object(ra.jsx)("button",{type:"button",className:"btn btn-sm btn-muted",disabled:!d,onClick:function(){return e.deleteItem(t.store_items_id)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})}):null]},t.store_items_id)})):Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{className:"text-center",colSpan:d?7:4,children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),"Seleccione articulos primero"]})})}),r.length&&j?Object(ra.jsx)("tfoot",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{className:"text-right",colSpan:d?4:2}),Object(ra.jsx)("th",{scope:"row",className:"text-right text-lg",children:"Total"}),Object(ra.jsx)("td",{className:"text-right text-primary text-lg pr-3",children:Object(ra.jsxs)("label",{children:["$ ",this.total.toFixed(2)]})}),d?Object(ra.jsx)("td",{}):null]})}):null]})}),o&&o.code?Object(ra.jsx)("div",{className:"card-footer",children:o.od===o.oi?Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("label",{className:"m-2",children:[Object(ra.jsx)("i",{className:"fas fa-eye"})," Graduacion"]}),Object(ra.jsx)("span",{className:"text",style:{cursor:"pointer"},onClick:function(){return e.handleSetCode(o)},children:o.code+o.od})]})}):Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("label",{className:"m-2",children:[Object(ra.jsx)("i",{className:"fas fa-eye"})," Graduacion ojo derecho"]}),Object(ra.jsx)("span",{className:"text",style:{cursor:"pointer"},onClick:function(){return e.handleSetCode(o)},children:o.code+o.od})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("label",{className:"m-2",children:[Object(ra.jsx)("i",{className:"fas fa-eye"})," Graduacion ojo izquierdo"]}),Object(ra.jsx)("span",{className:"text",style:{cursor:"pointer"},onClick:function(){return e.handleSetCode(o)},children:o.code+o.oi})]})]})}):null,a?Object(ra.jsx)(Js,{codeDefault:s,cantDefault:n,handleAddItem:this.handleAddItem,handleCloseModal:function(){return e.setState({itemNew:!1})}}):null]})}}]),a}(s.Component),$s=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleSaveStorage=function(){var e=s.state,t=e.contact_id,a=e.exam_id,n=e.items,c=e.session,r=s.props.contact,o={id:t,contact:{id:r.id,name:r.nombre},exam_id:a,items:n,session:c,created_at:new Date};Ya.addDataTemporary(o),s.handleCancel()},s.handleCancel=function(){var e=s.props,t=e.handleClose,a=e._setContact;s.setState({contact_id:0,items:[],codes:{},exam_id:null,exam:{},examEdit:!1}),t(),a()},s.handleGetCategories=function(e){(0,s.props._getListCategories)({options:{},id:e})},s.handleChangeInput=function(e,t){"exam"===e&&(t.category_id&&s.handleGetCategories(t.category_id),t.id?s.setState({exam_id:t.id,exam:t,codes:{}}):s.setState({exam_id:0,exam:{},codes:{}})),"codes"===e?s.setState({codes:t}):s.setState(Object(J.a)({},e,t))},s.handleCodeName=function(e){var t="";return e.depende_de?e.depende_de.depende_de?(t=e.depende_de.depende_de.meta.code,t+=e.depende_de.meta.code,t+=e.meta.code):(t=e.depende_de.meta.code,t+=e.meta.code):t=e.meta.code,t},s.getCategories=function(e,t){var a=t.category_id,n=t.esferaod,c=t.esferaoi,r=t.cilindrod,o=t.cilindroi,i=t.id;console.log("[Asistent order] Recomendacion descargada");var l=a&&e.id?s.handleCodeName(e):"XX",d="+000000",j="+000000";(r||n)&&(d=n>0?"+":"",d+=n.toFixed(2).toString().replace(".","")+r.toFixed(2).toString().replace("-","").replace(".","")),(o||c)&&(j=c>0?"+":"",j+=c.toFixed(2).toString().replace(".","")+o.toFixed(2).toString().replace("-","").replace(".","")),s.setState({exam_id:i,exam:t,codes:{code:l,od:d,oi:j}})},s.handleSave=function(e){var t=0,a=s.props,n=a.options,c=a._saveOrder,r=a._setContact,o=s.state,i=o.items,l=o.exam_id,d=o.session,j=o.contact_id,u=i.map((function(e){return 4===e.category&&t++,{cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,session:e.session,out:e.out,descripcion:e.descripcion,store_items_id:e.store_items_id}}));if(u.length===t)return window.Swal.fire({title:"Verificacion",text:"No hay productos para procesar en un pedido",icon:"warning"}),!1;var m={session:d,contact_id:j,items:JSON.stringify(u),status:0};l&&(m.exam_id=parseInt(l)),Ya.handleSaveOrder(null,m,n,c,(function(){return r({})}))};var n=Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10);return s.state={session:n,contact_id:0,items:[],codes:{},exam_id:null,exam:{},examEdit:!1,load:!0},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.contact,a=e.exam;if(t.id){var s,n,c,r=Ya.getDataOneItem(t.id);if(r)this.setState({contact:t,contact_id:t.id,items:null!==(s=r.items)&&void 0!==s?s:[],session:null!==(n=r.session)&&void 0!==n?n:this.state.session,exam:null!==a&&void 0!==a?a:this.state.exam,exam_id:null!==(c=a.id)&&void 0!==c?c:this.state.exam_id})}}},{key:"componentDidUpdate",value:function(e){var t,a,s=this.props,n=s.categories,c=s.contact,r=s.exam,o=s.msg_exams,i=s._setMsgExam,l=s._getContact,d=Ya.getDataOneItem(c.id);(e.categories.id!==n.id&&this.getCategories(n,this.state.exam),e.msg_exams.length!==o.length&&o.length&&(o.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),i(),l(c.id),this.setState({load:!0})),e.contact.id!==c.id&&c.id)&&this.setState({contact:c,contact_id:c.id,items:null!==(t=d.items)&&void 0!==t?t:[],session:null!==(a=d.session)&&void 0!==a?a:this.state.session});e.exam.id!==r.id&&r.id&&this.setState({exam:r,exam_id:r.id})}},{key:"render",value:function(){var e=this,t=this.state,a=t.contact_id,s=t.items,c=t.exam,r=t.exam_id,o=t.examEdit,i=t.codes,l=t.session,d=this.props,j=d.contact,u=d.load_order,m=d._saveExam;return Object(ra.jsxs)("div",{className:"card card-warning card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title",children:[Object(ra.jsx)("i",{className:"fas fa-clipboard-list mr-1"}),"Nuevo pedido"]})}),Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("div",{className:"form-group d-print-none",children:Object(ra.jsx)(Es,{title:"cliente",legend:j.id?null:"Busque el paciente por nombre para crearun nuevo pedido",readOnly:null!==r})}),j.id?Object(ra.jsx)(n.a.Fragment,{children:null!==r?Object(ra.jsx)(n.a.Fragment,{children:o?Object(ra.jsx)("div",{className:"form-group",children:Object(ra.jsx)(Us,{id:r,examEdit:!0,exam:c,ChangeInput:this.handleChangeInput})}):Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("div",{className:"form-group",children:Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsxs)("span",{className:"input-group-text",children:[Object(ra.jsx)("i",{className:"fas fa-notes-medical mr-1"})," ","Examen:"]})}),Object(ra.jsx)("input",{type:"text",className:r?c.observaciones?"form-control text-right pr-2 bg-info text-bold":"form-control text-right pr-2":"form-control text-center",value:r?c.observaciones?r+" [Revise las observaciones]":r:"Sin examen",readOnly:!0}),Object(ra.jsx)("div",{className:"float-right",children:Object(ra.jsxs)("div",{className:"btn-group btn-sm",children:[Object(ra.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:function(t){return e.handleChangeInput("exam_id",null)},children:Object(ra.jsx)("i",{className:"fas fa-exchange-alt"})}),c.id?Object(ra.jsx)("button",{type:"button",className:"btn btn-info btn-sm",onClick:function(t){return e.handleChangeInput("examEdit",!0)},disabled:o,children:Object(ra.jsx)("i",{className:"fas fa-edit"})}):null]})})]})}),c.id>0&&c.estado||!c.id?Object(ra.jsx)(qs,{items:s,session:l,codes:i,ChangeInput:this.handleChangeInput}):Object(ra.jsx)("span",{className:"alert",children:Object(ra.jsxs)("h5",{className:"w-100 text-center",children:[Object(ra.jsx)("i",{className:"fas fa-info-circle mr-1"}),Object(ra.jsx)("span",{className:"text-muted",children:"Es necesario que el examen este terminado para continuar con el pedido"})]})})]})}):Object(ra.jsxs)("div",{className:"form-group",children:[Object(ra.jsx)(Qa,{exams:j.examenes,allSelect:!0,handleSelectedExam:function(t){return e.handleChangeInput("exam",t)}}),Object(ra.jsxs)("div",{className:"btn-group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-secondary",onClick:function(t){return e.handleChangeInput("exam",{id:0})},children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-1"}),"Sin examen"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-secondary",onClick:function(e){return ts.handleSaveExam(j,null,m)},children:[Object(ra.jsx)("i",{className:"fas fa-notes-medical mr-1"}),"Nuevo examen"]})]})]})}):null]}),o?null:Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("div",{className:"mailbox-controls text-right",children:Object(ra.jsxs)("div",{className:"btn-group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:this.handleCancel,children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-1"}),a?"Cancelar":"Cerrar"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-default btn-sm",onClick:this.handleSaveStorage,disabled:!a,children:[Object(ra.jsx)("i",{className:"fas fa-clock mr-1"}),"Temporal"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-warning btn-sm text-bold",onClick:this.handleSave,disabled:!a||null===r||!s.length,children:[Object(ra.jsx)("i",{className:"fas fa-save mr-1"})," Guardar"]})]})})}),u?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})}}]),a}(s.Component),Hs={_setContact:et.setContact,_getContact:et.getContact,_saveExam:vt.saveExam,_setMsgExam:vt.setMessagesExam,_saveOrder:te.saveOrder,_getListCategories:Ce.getListCategories},Zs=Object(Wt.b)((function(e){var t=e.contact,a=e.exam,s=e.order,n=e.category;return{load_contact:t.loading,contact:t.contact,exam:a.exam,msg_exams:a.messages,options:s.options,load_order:s.loading,categories:n.list}}),Hs)($s),Xs=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).changeInput=function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value;s.props.ChangeInput(a,n)},s.getContacts=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),t="http://"+e.host+"/api/contacts";console.log("Descargando proveedores de la API"),fetch(t+"?page=1&type=1&business=1",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data&&(console.log("Almacenado proveedores"),s.setState({supplies:e.data}))}))},s.state={supplies:[]},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getContacts()}},{key:"render",value:function(){var e=this.props.lab_id;return Object(ra.jsxs)("div",{className:"row m-2",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(ra.jsx)("label",{children:"Laboratorio"}),Object(ra.jsxs)("select",{className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"lab_id",value:e,onChange:this.changeInput,children:[Object(ra.jsx)("option",{value:"0",children:"Seleccione un proveedor"}),this.state.supplies.length?this.state.supplies.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.nombre},e.id)})):""]})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(ra.jsx)("label",{children:"Folio"}),Object(ra.jsx)("input",{type:"text",className:this.props.status>1?"form-control disabled":"form-control",disabled:this.props.status>1,name:"npedidolab",value:this.props.npedidolab?this.props.npedidolab:"",onChange:this.changeInput})]})})]})}}]),a}(s.Component),Ws=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).changeInput=function(t){t.preventDefault();var a=t.target,s=a.name,n=a.value;"caja"===s&&(n=parseInt(n)),e.props.ChangeInput(s,n)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.status,a=e.ncaja,s=e.observaciones;return Object(ra.jsxs)("div",{className:"row m-2",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(ra.jsx)("label",{htmlFor:"lab",children:"Caja"}),Object(ra.jsx)("input",{type:"text",className:t>2?"form-control disabled":"form-control",disabled:t>2,name:"ncaja",value:a||"",onChange:this.changeInput})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-warning rounded p-2",children:[Object(ra.jsx)("label",{children:"Observaciones"}),Object(ra.jsx)("textarea",{name:"observaciones",className:t>2?"form-control disabled":"form-control",disabled:t>2,value:s||"",onChange:this.changeInput})]})})]})}}]),a}(s.Component),Ys=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handleDeleteOrder=function(){var e=s.props,t=e.order,a=e.options,n=e._deleteOrder;Ya.handleDeleteOrder(t,a,n)},s.handleClose=function(e){var t=s.props._setOrder;e&&e.preventDefault(),t()},s.handleChangeInput=function(e,t){s.setState(Object(J.a)({},e,t))},s.handleSave=function(){var e=s.state,t=e.id,a=e.npedidolab,n=e.ncaja,c=e.status,r=e.lab_id,o=e.observaciones,l=e.items,d=s.props,j=d.options,u=d._saveOrder,m=l.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{cant:e.cantidad,price:e.precio})})),h={npedidolab:a,ncaja:n,status:c,observaciones:o,items:JSON.stringify(m)};return r&&(h.lab_id=r),1===c&&!r&&toString(a).length?(window.Swal.fire("Verificaci\xf3n","Los campos de laboratorio estan vacios","error"),!1):2!==c||n?void Ya.handleSaveOrder(t,h,j,u):(window.Swal.fire("Verificaci\xf3n","El numero de caja esta vacio","error"),!1)},s.state={id:0,paciente:{},session:null,lab_id:0,npedidolab:"",observaciones:"",ncaja:0,items:[],exam:{},codes:{},status:0,created:{},created_at:null,updated:{},updated_at:null,nota:0},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e,t,a,s=this.props.order;this.setState({id:s.id,paciente:s.paciente,session:s.session,lab_id:null!==(e=s.laboratorio&&s.laboratorio.id)&&void 0!==e?e:0,npedidolab:s.folio_lab,observaciones:s.observaciones,ncaja:s.caja,items:s.productos,exam:null!==(t=s.examen)&&void 0!==t?t:{},status:s.estado,created_at:s.created_at,created:s.created,updated:s.updated,updated_at:s.updated_at,nota:null!==(a=s.nota&&s.nota.id)&&void 0!==a?a:0})}},{key:"render",value:function(){var e,t,a=this,s=this.state,n=s.id,c=s.paciente,r=s.session,o=s.lab_id,i=s.npedidolab,l=s.ncaja,d=s.observaciones,j=s.items,u=s.exam,m=s.codes,h=s.nota,b=s.status,p=s.created,x=s.created_at,O=s.updated,g=s.updated_at,f=this.props,v=f.loading,N=f.userRole,y=new Date(null!==(e=c.f_nacimiento)&&void 0!==e?e:"")<new Date?na()(c.f_nacimiento):null,w=Object.values(null!==(t=c.telefonos)&&void 0!==t?t:{}).filter((function(e){return""!==e}));return Object(ra.jsxs)(ra.Fragment,{children:[Object(ra.jsxs)("div",{className:"card card-warning card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title",children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-clipboard-list"}),"Pedido",Object(ra.jsx)("span",{className:"ml-1 badge badge-pill badge-warning",children:n})]})}),Object(ra.jsx)("div",{className:"p-0 card-body",children:Object(ra.jsxs)("div",{className:"mailbox-read-info",children:[Object(ra.jsxs)("h5",{children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-user"}),Object(ra.jsx)("span",{className:"text-capitalize",children:c.nombre}),N?null:Object(ra.jsxs)("span",{className:"float-right mailbox-read-time",children:["Fecha de nacimiento:"," ",y?Object(ra.jsxs)(ra.Fragment,{children:[y.format("LL"),Object(ra.jsxs)("label",{className:"ml-1",children:["(",na()().diff(y,"years")," a\xf1os)"]})]}):"NO REGISTRADO"]})]}),Object(ra.jsxs)("h6",{children:[c.email?Object(ra.jsxs)("span",{children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-envelope"}),c.email]}):null,Object(ra.jsxs)("span",{className:"float-right mailbox-read-time",children:["Pedido registrado ",na()(x).fromNow()]})]}),w.length?Object(ra.jsxs)("h6",{children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-phone"}),Object(ra.jsx)("span",{className:"mx-1",children:w.map((function(e,t){return t?", ".concat(e):"".concat(e)}))})]}):null]})}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsx)("div",{className:"text-right mailbox-controls",children:Object(ra.jsxs)("div",{className:"btn-group",children:[Object(ra.jsxs)("a",{href:"#close",className:"btn btn-secondary btn-sm",onClick:function(e){return a.handleClose(e)},children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-ban"}),"Cerrar"]}),Object(ra.jsxs)("button",{className:"btn btn-warning btn-sm",onClick:this.handleSave,children:[Object(ra.jsx)("i",{className:"mr-1 fas fa-save"})," Guardar"]})]})})}),v?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]}),Object(ra.jsxs)("div",{className:"row mt-4",children:[Object(ra.jsxs)("div",{className:"col-lg-4 col-md-6 col-sm-12",children:[Object(ra.jsx)("h6",{className:"w-100 d-block",children:"Acciones"}),Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsx)("div",{className:"text-center mailbox-controls with-border",children:Object(ra.jsxs)("div",{className:"btn-group",children:[h?Object(ra.jsx)(ta.b,{to:"/notas/registro/"+h,type:"button",className:"btn btn-default btn-sm text-success",title:"Ver nota: "+h,children:Object(ra.jsx)("i",{className:"fas fa-cash-register"})}):Object(ra.jsx)("button",{type:"button",className:"btn btn-default btn-sm",title:"Eliminar",onClick:this.handleDeleteOrder,children:Object(ra.jsx)("i",{className:"far fa-trash-alt"})}),c.telefonos&&c.telefonos.t_movil?Object(ra.jsx)("a",{target:"_blank",href:"https://wa.me/52"+c.telefonos.t_movil.replace(" ",""),type:"button",className:"btn btn-default btn-sm",title:"Abrir WhatsApp",rel:"noopener noreferrer",children:Object(ra.jsx)("i",{className:"fas fa-mobile-alt"})}):null]})}),v?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]}),Object(ra.jsx)("h6",{className:"w-100 d-block",children:"Estado"}),Object(ra.jsxs)("div",{className:"card mt-2",children:[Object(ra.jsx)("div",{className:"btn-group-vertical",children:Ya.getStatusType.map((function(e,t){return Object(ra.jsx)("button",{type:"button",className:b===t?"btn btn-primary btn-sm text-capitalize text-bold":"btn btn-default btn-sm text-capitalize",onClick:function(e){a.setState({status:t})},children:e},t)}))}),v?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})]}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"card h-100 m-0",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h5",{className:"card-title w-100 d-block mb-2 text-capitalize text-bold",children:[Object(ra.jsx)("i",{className:"fas fa-shield-alt mr-1"}),Ya.handleStatusString(b)]})}),Object(ra.jsx)("div",{className:"card-body p-0",children:Object(ra.jsxs)("div",{className:"p-0 mailbox-read-message m-0",children:[0===b?Object(ra.jsx)(qs,{items:j,codes:m,session:r,status:!N,noPrice:!0,ChangeInput:this.handleChangeInput}):null,1===b?Object(ra.jsx)(Xs,{lab_id:o,npedidolab:i,status:b,ChangeInput:this.handleChangeInput}):null,2===b?Object(ra.jsx)(Ws,{ncaja:l,observaciones:d,status:b,ChangeInput:this.handleChangeInput}):null,b>=3?Object(ra.jsx)("div",{className:"m-2 border rounded card border-warning",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h5",{className:"card-title",children:"Estado de la entrega"}),Object(ra.jsxs)("div",{className:"ml-1 icheck-success d-inline",children:[Object(ra.jsx)("input",{type:"checkbox",checked:3!==b,id:"checkboxSuccess1",onChange:function(e){return a.handleChangeInput("status",3===b?4:3)}}),Object(ra.jsx)("label",{htmlFor:"checkboxSuccess1"})]})]})}):null]})}),v?Object(ra.jsx)("div",{className:"overlay dark",children:Object(ra.jsx)("i",{className:"fas fa-2x fa-sync-alt fa-spin"})}):null]})})]}),Object(ra.jsxs)("div",{className:"row mt-4",children:[u.id?Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("h6",{className:"w-100 d-block",children:"Examen"}),Object(ra.jsx)("div",{className:"card mt-2",children:Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsx)("div",{className:"p-0 mailbox-read-message",children:Object(ra.jsx)(Us,{id:u.id,examEdit:!1,exam:u})})})})]}):null,Object(ra.jsxs)("div",{className:"col-".concat(u.id?3:12),children:[Object(ra.jsx)("h6",{className:"w-100 d-block",children:"Meta data"}),Object(ra.jsx)(Ha,{register:null!==x&&void 0!==x?x:"",created:p?p.name:"",updated:O?O.name:"",updated_at:null!==g&&void 0!==g?g:""})]})]})]})}}]),a}(s.Component),Ks={_saveOrder:te.saveOrder,_deleteOrder:te.deleteOrder,_setOrder:te.setOrder},Qs=Object(Wt.b)((function(e){var t=e.order,a=e.logging;return{order:t.order,userRole:a.rol,options:t.options,loading:t.loading}}),Ks)(Ys),en=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleMessege=function(e){var t=e.target,a=t.value,n=t.name;s.setState(Object(J.a)({},n,a.toLowerCase()))},s.sendMessenger=function(){var e=s.state,t=e.message,a=e.load,n=e.host,c=e.token,r=s.props,o="http://"+n+"/api/messengers",i={table:r.table,idRow:r.idRow,user:"",message:t};a||s.setState({load:!0}),console.log("Enviando mensajes a la API"),fetch(o,{method:"POST",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Almacenado mensajes"),s.getMessengers()):(console.error(e.message),s.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),s.setState({load:!1})}))},s.getMessengers=function(){var e=s.state,t=e.load,a=e.host,n=e.token,c=s.props,r="http://"+a+"/api/messengers",o="&table="+c.table+"&idRow="+c.idRow;t||s.setState({load:!0}),console.log("Solicitando mensajes de la API"),fetch(r+"?page=1"+o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){return e.ok||window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),e.json()})).then((function(e){e.data?(console.log("Almacenado mensajes"),s.setState({messages:e.data,message:"",load:!1})):(console.error(e.message),s.setState({load:!1}))})).catch((function(e){console.error(e),window.alert("Ups!\n Algo salio mal, intentelo mas tarde."),s.setState({load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={messages:[],message:"",load:!0,host:n.host,token:n.token,user:n.idUser},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getMessengers()}},{key:"componentDidUpdate",value:function(e,t){e.pagado!==this.props.pagado&&(console.log("Recargando chat"),this.getMessengers())}},{key:"render",value:function(){var e=this.state,t=e.messages,a=e.load,s=e.message,c=e.user,r=this.props.idRow;return Object(ra.jsxs)("div",{className:"card direct-chat direct-chat-primary d-print-none",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h3",{className:"card-title",children:[Object(ra.jsx)("i",{className:"fas fa-comments mr-1"}),"Chat",Object(ra.jsx)("span",{className:"badge badge-pill badge-secondary ml-1",children:r})]})}),a?Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsx)("div",{className:"card-text text-center p-4",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})})}):t.length?Object(ra.jsx)(n.a.Fragment,{children:Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsx)("div",{className:"direct-chat-messages",id:"boxchat",children:t.map((function(e){var t="/img/avatars/avatar5.png";return 1===e.created_user.rol&&(t="/img/avatars/avatar2.png"),e.created_user.rol||(t="/img/avatars/avatar3.png"),2===e.created_user.id&&(t="/img/avatars/avatar4.png"),Object(ra.jsxs)("div",{className:e.created_user.id===c?"direct-chat-msg right":"direct-chat-msg",children:[Object(ra.jsxs)("div",{className:"direct-chat-infos clearfix",children:[Object(ra.jsx)("span",{className:e.created_user.id===c?"direct-chat-name float-right":"direct-chat-name float-left",children:e.created_user.name}),Object(ra.jsx)("span",{className:e.created_user.id===c?"direct-chat-timestamp float-left":"direct-chat-timestamp float-right",children:na()(e.updated_at).format("lll")})]}),Object(ra.jsx)("img",{className:"direct-chat-img",src:1===e.created_user.id?"/img/avatars/OrusBot.png":t,alt:"message user image1"}),Object(ra.jsx)("div",{className:"direct-chat-text",children:e.mensaje})]},e.id)}))})})}):Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsx)("div",{className:"card-text text-center p-4",children:Object(ra.jsxs)("h5",{children:[Object(ra.jsx)("i",{className:"fas fa-comment-slash mr-1"}),"No hay mensajes aun"]})})}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsxs)("div",{className:"input-group",children:[Object(ra.jsx)("input",{type:"text",name:"message",placeholder:"Escriba un mensaje ...",className:"form-control",value:s,onChange:this.handleMessege}),Object(ra.jsx)("span",{className:"input-group-append",children:Object(ra.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.sendMessenger,disabled:!(s.length>5),children:"Enviar"})})]})})]})}}]),a}(s.Component);var tn={_getContact:et.getContact,_setContact:et.setContact,_getExam:vt.getExam,_setExam:vt.setExam},an=Object(Wt.b)((function(e){var t=e.contact,a=e.exam;return{contact:t.contact,exam:a.exam}}),tn)((function(e){var t=e._getContact,a=e._getExam,n=e._setContact,c=e._setExam,r=e.handleChangePanel,o=Object(s.useState)([]),i=Object(wa.a)(o,2),l=i[0],d=i[1],j=Object(s.useState)(!0),u=Object(wa.a)(j,2),m=u[0],h=u[1],b=Object(s.useState)(0),p=Object(wa.a)(b,2),x=p[0],O=p[1];return Object(s.useEffect)((function(){m&&(d(Ya.getDataTemporary(!0)),h(!1),n(),c())}),[m]),Object(ra.jsx)(Ca,{title:"Examenes sin orden",icon:"notes-medical",color:"info",itemSelected:x,handleDeleteItem:function(){Ya.removeDataTemporary(x.id,(function(){return h(!0)})),O(0)},handleEditItem:function(){x.contact.id&&t(x.contact.id),x.exam_id&&a(x.exam_id),O(0),r(null,2)},children:Object(ra.jsxs)("table",{className:"table table-hover table-striped",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{}),Object(ra.jsx)("th",{children:"Paciente"}),Object(ra.jsx)("th",{children:"Examen"}),Object(ra.jsx)("th",{children:"Productos"}),Object(ra.jsx)("th",{children:"Session"}),Object(ra.jsx)("th",{children:"Creado"})]})}),Object(ra.jsx)("tbody",{children:l.map((function(e,s){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:Object(ra.jsxs)("div",{className:"icheck-primary",children:[Object(ra.jsx)("input",{type:"checkbox",className:"form-check-input mt-4",id:"exam_"+e.id,checked:e.id===x.id,onChange:function(t){return function(e,t){e.checked||(t={id:0}),O(t)}(t.target,e)}}),Object(ra.jsx)("label",{htmlFor:"exam_"+e.id,className:"sr-only"})]})}),Object(ra.jsx)("th",{className:"text-truncate",children:Object(ra.jsx)("a",{href:"#select",onClick:function(s){return function(e,s){e.preventDefault(),s.contact.id&&t(s.contact.id),s.exam_id&&a(s.exam_id),O(0),r(null,2)}(s,e)},children:Object(ra.jsx)("span",{className:"text-capitalize",children:e.contact.name})})}),Object(ra.jsxs)("td",{children:["# ",e.exam_id]}),Object(ra.jsx)("td",{className:"text-right",children:Object(ra.jsx)("span",{className:"badge badge-dark",children:e.items.length})}),Object(ra.jsx)("td",{style:{maxWidth:"250px"},children:Object(ra.jsx)("p",{className:"text-truncate",children:Object(ra.jsx)("span",{children:e.session})})}),Object(ra.jsx)("td",{children:na()(e.created_at).fromNow()})]},s)}))})]})})})),sn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).showPanel=function(e){switch(e){case 1:return Object(ra.jsx)(an,{handleChangePanel:s.handleShowPanel});case 2:return Object(ra.jsx)(Zs,{handleClose:function(){return s.handleChangeInput("panel",0)}});case 3:return Object(ra.jsx)(Qs,{});default:return Object(ra.jsx)(zs,{})}},s.handleSetSelectOptions=function(e){var t=e.target,a=s.props._setOptions,n=t.value,c=t.name,r=n;"itemsPage"===c&&(r=parseInt(r)),"status"===c&&""!==r&&(r=parseInt(r)),a({key:c,value:r})},s.handleChangeInput=function(e,t){s.setState(Object(J.a)({},e,t))},s.handleShowPanel=function(e,t){e&&e.preventDefault(),s.handleChangeInput("panel",t)},s.state={panel:0},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e._getOrder,s=t.params.id;s&&!isNaN(s)&&(console.log("[OrusSystem] cargando orden al inicio: "+s),a(s))}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,s=a.order,n=a.history,c=a.messages,r=a._setContact,o=this.state.panel;e.order.id!==s.id&&s.id&&(this.setState({panel:3}),r(),n.push("/pedidos/".concat(s.id))),e.order.id===s.id||s.id?t.panel===o||o||n.push("/pedidos"):(this.setState({panel:0}),n.push("/pedidos")),t.panel!==o&&2===o&&n.push("/pedidos/new"),t.panel!==o&&1===o&&n.push("/pedidos/pending"),e.messages.length!==c.length&&c.length&&(c.forEach((function(e){var t=e.type,a=e.text;window.Swal.fire({icon:t,title:a,showConfirmButton:"error"===t,timer:"error"!==t?1500:9e3})})),this.state.panel&&this.setState({panel:0}))}},{key:"render",value:function(){var e=this,t=this.state.panel,a=this.props,n=a.order,c=a.options,r=this.showPanel(t);return Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col-md-2 col-sm-12",children:[Object(ra.jsxs)("a",{href:"#new",className:2===t?"disabled mb-3 btn btn-secondary btn-block":"mb-3 btn btn-warning btn-block",onClick:function(t){t.preventDefault(),e.handleShowPanel(t,2)},disabled:2===t,children:[Object(ra.jsx)("i",{className:"mr-2 fas fa-plus"}),"Pedido nuevo"]}),Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h5",{className:"card-title text-dark",children:[Object(ra.jsx)("i",{className:"mr-2 fas fa-ellipsis-v"}),"Menu y filtros"]})}),Object(ra.jsx)("div",{className:"p-0 card-body",children:Object(ra.jsxs)("ul",{className:"nav nav-pills flex-column",children:[Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)("a",{href:"#item",className:1===t?"nav-link active":"nav-link",onClick:function(t){t.preventDefault(),e.handleShowPanel(t,1)},children:[Object(ra.jsx)("i",{className:"mr-2 fas fa-notes-medical"})," Pendientes"]})}),Object(ra.jsx)("li",{className:"nav-item",children:Object(ra.jsxs)("a",{href:"#item",className:t?"nav-link":"nav-link active",onClick:function(t){return e.handleShowPanel(t,0)},children:[Object(ra.jsx)("i",{className:"mr-2 fas fa-clipboard-list"})," Pedidos"]})}),t?null:Object(ra.jsxs)(s.Fragment,{children:[Object(ra.jsx)("li",{className:"nav-item",children:"\xa0"}),Object(ra.jsxs)("li",{className:"p-2 nav-item",children:[Object(ra.jsx)("label",{htmlFor:"status",children:"Estado del pedido"}),Object(ra.jsxs)("select",{className:"form-control ",name:"status",id:"status",value:c.status,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"",children:"-- Todos --"}),Object(ra.jsx)("option",{value:"0",children:"En proceso"}),Object(ra.jsx)("option",{value:"1",children:"Laboratorio"}),Object(ra.jsx)("option",{value:"2",children:"Bicelaci\xf3n"}),Object(ra.jsx)("option",{value:"3",children:"Terminado"}),Object(ra.jsx)("option",{value:"4",children:"Entregado"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"orderby",children:"Ordenar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"orderby",id:"orderby",value:c.orderby,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"created_at",children:"Fecha de registro"}),Object(ra.jsx)("option",{value:"updated_at",children:"Fecha de modificacion"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"order",children:"Mostrar por"}),Object(ra.jsxs)("select",{className:"form-control ",name:"order",id:"order",value:c.order,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"asc",children:"Antiguos"}),Object(ra.jsx)("option",{value:"desc",children:"Recientes"})]})]}),Object(ra.jsxs)("li",{className:"nav-item p-2",children:[Object(ra.jsx)("label",{htmlFor:"itemsPage",children:"Numero de pedidos"}),Object(ra.jsxs)("select",{className:"form-control ",name:"itemsPage",id:"itemsPage",value:c.itemsPage,onChange:this.handleSetSelectOptions,children:[Object(ra.jsx)("option",{value:"10",children:"ver 10"}),Object(ra.jsx)("option",{value:"20",children:"ver 20"}),Object(ra.jsx)("option",{value:"50",children:"ver 50"}),Object(ra.jsx)("option",{value:"100",children:"ver 100"})]})]})]})]})})]}),3===t?Object(ra.jsx)(en,{table:"orders",idRow:n.id}):null]}),Object(ra.jsx)("div",{className:"col-md-10 col-sm-12",children:r})]})}}]),a}(s.Component),nn={_getOrder:te.getOrder,_setOptions:te.setOptions,_setContact:et.setContact},cn=Object(Wt.b)((function(e){var t=e.order;e.category;return{order:t.order,options:t.options,messages:t.messages}}),nn)(sn),rn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).onKeyPressSearch=function(t){"Enter"===t.key&&(t.preventDefault(),e.setFilters())},e.onClickClean=function(){e.props.changeFilters("search",""),e.props.changeFilters("type",""),e.props.changeFilters("date",""),e.setFilters()},e.setFilters=function(){e.props.handleChangePage(1),window.$("#filters").modal("hide")},e.changeFilters=function(t){var a=t.target,s=a.name,n=a.value;e.props.changeFilters(s,n)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.search,a=e.type,s=e.date;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("div",{className:"btn-group",children:Object(ra.jsx)("a",{href:"#Filters",className:"btn btn-tool text-dark","data-toggle":"modal","data-target":"#filters",children:Object(ra.jsx)("i",{className:"fas fa-filter"})})}),Object(ra.jsx)("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"filters",children:Object(ra.jsx)("div",{className:"modal-dialog",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsx)("h5",{className:"modal-title",children:"Busquedas"}),Object(ra.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsxs)("form",{className:"modal-body",children:[Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-search"})})}),Object(ra.jsx)("input",{type:"text",name:"search",className:"form-control",placeholder:"Por: paciente o # de venta",value:t,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("label",{children:"Estado"}),Object(ra.jsx)("div",{className:"input-group-prepend ml-4",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-address-book"})})}),Object(ra.jsxs)("select",{className:"form-control",name:"type",value:a,onChange:this.changeFilters,children:[Object(ra.jsx)("option",{value:"",children:"Todos"}),Object(ra.jsx)("option",{value:"0",children:"Adeudos"}),Object(ra.jsx)("option",{value:"1",children:"Pagados"})]})]}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("label",{children:"Fecha"}),Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-search"})})}),Object(ra.jsx)("input",{type:"date",name:"date",className:"form-control",value:s,onChange:this.changeFilters,onKeyPress:this.onKeyPressSearch})]})]}),Object(ra.jsx)("div",{className:"modal-footer",children:Object(ra.jsxs)("div",{className:"btn-group btn-group-lg",role:"group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-outline-dark","data-dismiss":"modal",children:[Object(ra.jsx)("i",{className:"fas fa-window-close mr-2"}),"Cancelar"]}),Object(ra.jsxs)("button",{type:"button",className:t||a?"btn btn-outline-dark":"btn btn-outline-dark disabled",onClick:this.onClickClean,children:[Object(ra.jsx)("i",{className:"fas fa-eraser mr-2"}),"Limpiar"]}),Object(ra.jsxs)("button",{type:"button",className:"btn btn-outline-dark",onClick:this.setFilters,"data-dismiss":"modal",children:[Object(ra.jsx)("i",{className:"fas fa-search mr-2"}),"Buscar"]})]})})]})})})]})}}]),a}(s.Component),on=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleFilter=function(){s.setState({load:!0,page:1})},s.onchangeSearch=function(e,t){s.setState(Object(J.a)({},e,t))},s.handleOrder=function(e){s.setState({orderby:e,order:"desc"===s.state.order?"asc":"desc",load:!0})},s.handleChangePage=function(e){s.setState({page:e,load:!0})},s.changePage=function(e){s.props.page(e)},s.handleDelete=function(e,t){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar la venta de "+t.toUpperCase()+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t){var a=s.state,n=a.host,c=a.token;return console.log("Solicitud de eliminaci\xf3n de venta por API"),fetch("http://"+n+"/api/sales/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Venta eliminada"),window.Swal.fire({icon:"success",title:"Venta eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.getPedidos()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.getPedidos=function(){var e=s.state,t=e.host,a=e.token,n=e.order,c=e.orderby,r=e.search,o=e.page,i=e.type,l=e.date,d=e.load,j="http://"+t+"/api/sales",u="&orderby=".concat(c,"&order=").concat(n),m=r?"&search=".concat(r):"",h=o>0?"?page="+o:"?page=1",b=""===i?"":"&type="+i,p=""===l?"":"&date="+l;d||s.setState({load:!0}),console.log("Descargando ventas de API"),fetch(j+h+u+m+b+p,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){return e.ok||(window.alert("Ups!\n Hubo un error, intentelo mas tarde"),console.log(e)),e.json()})).then((function(e){console.log("Descargando ventas"),s.setState({ventas:e,load:!1})}))};var n=JSON.parse(localStorage.getItem("OrusSales")),c=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={ventas:{data:[],meta:{}},load:!0,page:n?n.page:1,orderby:n?n.orderby:"created_at",order:n?n.order:"desc",search:n?n.search:"",type:n?n.type:"",date:n?n.date:"",host:c.host,token:c.token},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getPedidos(),console.log("[Sales] Eliminando datos de contacto en uso"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date}))}},{key:"componentDidUpdate",value:function(e,t){!1===t.load&&!0===this.state.load&&(console.log("Recargando pedidos"),this.getPedidos(),localStorage.setItem("OrusSales",JSON.stringify({page:this.state.page,orderby:this.state.orderby,order:this.state.order,search:this.state.search,type:this.state.type,date:this.state.date})))}},{key:"render",value:function(){var e=this,t=this.state,a=t.ventas,s=t.load,n=t.search,c=t.type,r=t.date;return Object(ra.jsxs)("div",{className:"card card-success card-outline",children:[Object(ra.jsxs)("div",{className:"card-header",children:[Object(ra.jsxs)("h3",{className:"card-title text-success",children:[Object(ra.jsx)("i",{className:"fas fa-cash-register mr-1"}),"Listado de ventas"]}),Object(ra.jsxs)("div",{className:"card-tools",children:[Object(ra.jsx)(ta.b,{to:"/notas/registro",className:"btn btn-outline-dark",onClick:function(t){e.changePage("/notas/registro")},children:Object(ra.jsx)("i",{className:"fas fa-plus"})}),Object(ra.jsx)(rn,{search:n,type:c,date:r,changeFilters:this.onchangeSearch,handleChangePage:this.handleChangePage}),Object(ra.jsx)(xa,{meta:a.meta,handleChangePage:this.handleChangePage})]})]}),Object(ra.jsx)("div",{className:"card-body table-responsive p-0",children:Object(ra.jsxs)("table",{className:"table table-sm table-bordered table-hover",children:[Object(ra.jsx)(pa,{orderby:this.state.orderby,order:this.state.order,data:[{name:"Folio",type:"id",filter:!0},{name:"Pedido",type:"pedido",filter:!1},{name:"Cliente"},{name:"Total",type:"total",filter:!0},{name:"Abonado"},{name:"Por pagar"},{name:"Actualizado",type:"updated_at",filter:!0},{name:"Registrado",type:"created_at",filter:!0}],actions:!0,handleOrder:this.handleOrder}),Object(ra.jsx)("tbody",{children:s?Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{colSpan:"10",className:"text-center p-4",children:[Object(ra.jsx)("div",{className:"spinner-border text-primary mr-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(ra.jsx)("span",{className:"font-weight-light font-italic",children:"Espere cargando datos de la venta"})]})}):Object.keys(a.data).length?a.data.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:Object(ra.jsx)("span",{className:"badge badge-success text-capitalize",children:t.id})}),Object(ra.jsx)("td",{children:t.pedido?Object(ra.jsx)("span",{className:"badge badge-warning text-capitalize",children:t.pedido}):"--"}),Object(ra.jsx)("td",{className:"text-uppercase",children:Object(ra.jsx)(ta.b,{to:"/notas/registro/"+t.id,children:Object(ra.jsxs)("span",{className:"badge badge-danger text-capitalize p-1",children:[t.cliente.nombre,Object(ra.jsx)("i",{className:"fas fa-pencil-alt ml-1"})]})})}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.total.toFixed(2)]}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.pagado.toFixed(2)]}),Object(ra.jsx)("td",{className:"text-right",children:t.total-t.pagado<=0?Object(ra.jsx)("label",{className:"text-success",children:Object(ra.jsx)("i",{className:"fas fa-check"})}):"$ "+(t.total-t.pagado).toFixed(2)}),Object(ra.jsx)("td",{children:na()(t.updated_at).fromNow()}),Object(ra.jsx)("td",{children:na()(t.created_at).format("ll")}),Object(ra.jsx)(ga,{id:t.id,item:t.cliente.nombre,delete:t.pagado?null:e.handleDelete,edit:"/notas/registro/"})]},t.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{colSpan:"10",className:"text-center",children:"No hay datos para mostrar"})})})]})}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsxs)(ta.b,{to:"/notas/registro",className:"btn btn-outline-success",onClick:function(t){e.changePage("/notas/registro")},children:[Object(ra.jsx)("i",{className:"fas fa-plus mr-2"}),Object(ra.jsx)("strong",{children:"Nueva venta"})]})})]})}}]),a}(s.Component),ln=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).getContact=function(e){var t=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+t.host+"/api/contacts/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){console.log("Descargando contacto"),s.setState({dataContact:e.data,load:!1}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify(e.data))})).catch((function(e){console.log(e)}))},s.handleChangePage=function(e){s.props.changePage(e)},s.handleClickChange=function(e){e.preventDefault(),window.confirm("\xbfEsta seguro?")&&(s.setState({contacto:"",data:[],dataContact:{}}),console.log("[Contact][search] Eliminando datos local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),s.props.getIdContact(0))},s.handleClickContact=function(e,t){e&&e.preventDefault(),s.state.data.map((function(e){if(e.id===t){s.setState({contacto:"",data:[],dataContact:e});var a=1*na()(e.f_nacimiento).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");return s.props.getIdContact(t,a),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({id:t})),!1}return!0}))},s.getContacts=function(e){s.state.load||s.setState({load:!0}),s.timeSave&&clearTimeout(s.timeSave),s.timeSave=setTimeout((function(){var t=JSON.parse(localStorage.getItem("OrusSystem")),a="http://"+t.host+"/api/contacts",n=e?"&search=".concat(e):"";console.log("Descargando contactos de la API"),fetch(a+"?page=1&itemsPage=4"+n+"&type=0",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.token}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(t){t.data&&t.data.length?(console.log("Mostrando informaci\xf3n del contacto"),s.setState({data:t.data,load:!1})):(s.setState({data:[{id:0,nombre:"No hay contactos para: "+e}],load:!1}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({name:e.toLowerCase()})))})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}),1500)},s.handleSearcContact=function(e){var t=e.target,a=t.name,n=t.value,c=t.type,r=n;"number"===c&&(r=parseInt(n)),"text"===c&&(r=n.toLowerCase()),s.setState(Object(J.a)({},a,r))},s.state={contacto:"",data:[],dataContact:{},load:!1,edad:0},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.contact;e?this.getContact(e):this.contactInput.focus()}},{key:"componentDidUpdate",value:function(e,t){t.contacto!==this.state.contacto&&(this.state.contacto.length>2?this.getContacts(this.state.contacto):this.setState({data:[]})),e.contact!==this.props.contact&&this.props.contact&&(this.setState({load:!0}),this.getContact(this.props.contact))}},{key:"render",value:function(){var e=this,t=this.state.load;if(this.props.contact){if(t)return Object(ra.jsx)("div",{className:"card card-danger card-outline d-print-none",children:Object(ra.jsx)("div",{className:"card-body box-profile",children:Object(ra.jsx)("div",{className:"text-center",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})})})});if(Object.keys(this.state.dataContact).length){var a=this.state.dataContact,s=a.nombre,c=a.telefonos,r=a.domicilio,o=a.id,i=a.f_nacimiento,l=a.email,d=a.rfc,j=this.props.edad?this.props.edad+" a\xf1os":i?na()(i).fromNow():0;return console.log("[searchContactCard] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({id:o,nombre:s})),Object(ra.jsx)("div",{className:"card card-danger card-outline",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h3",{className:"profile-username text-center text-capitalize",children:s}),"XAXX010101000"!==d?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("h6",{className:"text-muted text-center",children:c.t_movil?Object(ra.jsxs)("span",{children:["Movil: ",c.t_movil]}):c.t_casa?Object(ra.jsxs)("span",{children:["Casa: ",c.t_casa]}):c.t_oficina?Object(ra.jsxs)("span",{children:["Oficina: ",c.t_oficina]}):Object(ra.jsx)("span",{className:"text-danger",children:"Capture el telefono"})}),Object(ra.jsx)("p",{className:"text-muted text-center",children:r&&r.calle.length>6?r.calle:null})]}):null,"XAXX010101000"!==d?Object(ra.jsxs)("ul",{className:"list-group list-group-unbordered mb-3",children:[Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("b",{className:"mr-4",children:"Edad:"}),j?Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:j.replace("hace","")}):Object(ra.jsxs)("span",{className:"badge badge-warning badge-pill",children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-2"})," No capturado"]})]}),i?Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("b",{children:"Fecha de nacimiento:"}),Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:na()(i).format("L")})]}):null,Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("b",{children:"E-mail:"}),l&&!/.*@domain(.com)?/gim.exec(l)?Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:l}):Object(ra.jsxs)("span",{className:"badge badge-warning badge-pill",children:[Object(ra.jsx)("i",{className:"fas fa-ban mr-2"})," No capturado"]})]}),d.length?Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("b",{children:"RFC:"}),Object(ra.jsx)("span",{className:"badge badge-primary badge-pill",children:d})]}):null]}):null,this.props.status?null:Object(ra.jsxs)("div",{className:"btn-group btn-block d-print-none",role:"group",children:[Object(ra.jsxs)("button",{type:"button",className:"btn btn-dark",onClick:this.handleClickChange,children:[Object(ra.jsx)("i",{className:"fas fa-exchange-alt mr-1"}),Object(ra.jsx)("b",{children:"Cambiar"})]}),Object(ra.jsxs)(ta.b,{to:"/contactos/registro/"+o,className:"btn btn-danger",onClick:function(t){e.handleChangePage("/contactos/registro/")},children:[Object(ra.jsx)("i",{className:"fas fa-edit mr-1"}),Object(ra.jsx)("b",{children:"Editar"})]})]})]})})}return null}return Object(ra.jsx)("div",{className:"card card-danger card-outline d-print-none",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("label",{children:"Buscar paciente"}),Object(ra.jsxs)("div",{className:"input-group mb-3",children:[Object(ra.jsx)("div",{className:"input-group-prepend",children:Object(ra.jsx)("span",{className:"input-group-text",children:Object(ra.jsx)("i",{className:"fas fa-user"})})}),Object(ra.jsx)("input",{type:"text",className:"form-control text-capitalize",placeholder:"Nombre del paciente",name:"contacto",autoComplete:"off",value:this.state.contacto,onChange:this.handleSearcContact,ref:function(t){e.contactInput=t}})]}),this.state.data.length?Object(ra.jsx)("ul",{className:"list-group",children:this.state.data.map((function(t){return Object(ra.jsxs)("li",{className:"list-group-item",children:[Object(ra.jsxs)("a",{href:"#contact",className:t.id?"text-muted text-capitalize":"text-danger text-capitalize",onClick:function(a){e.handleClickContact(a,t.id)},children:[Object(ra.jsx)("i",{className:"fas fa-user mr-1"}),t.nombre]}),t.id?null:Object(ra.jsx)(Cs,{name:e.state.contacto,setContac:function(t,a){var s=1*na()(a).fromNow(!0).replace(/[a-zA-Z\xf1\xd1]/gi,"");e.setState({contacto:"",data:[],dataContact:{}}),console.log("[Contact][search] Almacenando datos de contacto en local storage"),localStorage.setItem("OrusContactInUse",JSON.stringify({})),e.props.getIdContact(t,s)}})]},t.id)}))}):t?Object(ra.jsx)("div",{className:"text-center",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})}):null]})})}}]),a}(s.Component),dn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).getBaks=function(){var e=s.state,t=e.host,a=e.token;console.log("[Add pay]Descargando listado de bancos"),fetch("http://"+t+"/api/config?name=bank",{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e.meta&&e.meta.total&&(console.log("[Add pay] Listado de bancos descargado"),s.setState({listBank:e.data}))})).catch((function(e){console.error("[Orus system] ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))},s.handlePay=function(e){e.preventDefault(),window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de realizar el abono?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Guardar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var t={metodopago:s.state.metodopago,total:s.state.total,bank_id:s.state.bank_id,auth:s.state.auth,details:s.state.details,sale_id:s.props.saleId,contact_id:s.props.contactId,order_id:s.props.order},a=JSON.parse(localStorage.getItem("OrusSystem")),n="http://"+a.host+"/api/payments";return t.bank_id||delete t.bank_id,console.log("Enviando datos del pago a API para almacenar"),fetch(n,{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(t.statusText+"("+a.message+")");case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("[abonodAdd] Abono almacenado"),s.props.handleChange(s.state.total),s.setState({metodopago:1,total:0,bank_id:0,banco:"",auth:"",details:""}),window.Swal.fire({icon:"success",title:"Abono almacenado con exito",showConfirmButton:!1,timer:1500})):(window.Swal.fire("Error","al almacenar el abono","error"),console.error("Orus res: ",t.message))}}))},s.onChangeValue=function(e){var t=e.target,a=t.name,n=t.value,c=t.type;"total"===a&&((n=parseInt(n))>s.props.pay?n=s.props.pay:n<0&&(n=0)),"metodopago"!==a&&"number"!==c||(n=parseInt(n)),"metodopago"===a&&1===n?s.setState({metodopago:1,bank_id:0,auth:"",details:""}):s.setState(Object(J.a)({},a,n))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={metodopago:1,total:0,bank_id:0,auth:"",details:"",listBank:[],token:n.token,host:n.host},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getBaks()}},{key:"componentDidUpdate",value:function(e,t){void 0!==this.state.listBank&&this.state.listBank.length||this.getBaks()}},{key:"render",value:function(){var e=this.state,t=e.listBank,a=e.metodopago,s=e.total,c=e.bank_id,r=e.auth,o=e.details,i=this.props.user;return Object(ra.jsx)("div",{className:"modal",tabIndex:"-1",role:"dialog",id:"abonos",children:Object(ra.jsx)("div",{className:"modal-dialog",children:Object(ra.jsxs)("div",{className:"modal-content",children:[Object(ra.jsxs)("div",{className:"modal-header",children:[Object(ra.jsx)("h5",{className:"modal-title",children:"Abono"}),Object(ra.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(ra.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(ra.jsxs)("form",{className:"modal-body",children:[Object(ra.jsxs)("div",{className:"row mb-2",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Fecha"}),Object(ra.jsx)("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:na()().format("L")})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Usuario"}),Object(ra.jsx)("input",{type:"text",className:"form-control-plaintext",readOnly:!0,value:i})]})]}),Object(ra.jsxs)("div",{className:"row mb-2",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Metodo de pago"}),Object(ra.jsxs)("select",{name:"metodopago",className:"custom-select",value:a,onChange:this.onChangeValue,children:[Object(ra.jsx)("option",{value:"1",children:"Efectivo"}),Object(ra.jsx)("option",{value:"2",children:"Tarjeta de debito"}),Object(ra.jsx)("option",{value:"3",children:"Tarjeta de credito"}),Object(ra.jsx)("option",{value:"4",children:"La marina"}),Object(ra.jsx)("option",{value:"5",children:"Cheque"}),Object(ra.jsx)("option",{value:"6",children:"Transferencia"}),Object(ra.jsx)("option",{value:"0",children:"Otro"})]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Cantidad"}),Object(ra.jsx)("input",{type:"number",min:"0",max:this.props.pay,className:"form-control text-right",name:"total",value:s||"",onChange:this.onChangeValue})]})]}),1!==a?Object(ra.jsxs)("div",{className:"row mb-2",children:[Object(ra.jsx)("div",{className:"col",children:a&&4!==a&&t&&t.length?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("label",{children:"Banco"}),Object(ra.jsxs)("select",{name:"bank_id",className:"custom-select text-uppercase",value:c,onChange:this.onChangeValue,children:[Object(ra.jsx)("option",{value:"0",children:"Seleccione un banco"}),t.map((function(e){return Object(ra.jsx)("option",{value:e.id,className:"text-uppercase",children:e.name},e.id)}))]})]}):a?Object(ra.jsx)("h4",{children:"LA MARINA"}):Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsx)("label",{children:"Espesifique"}),Object(ra.jsx)("input",{type:"text",name:"details",className:"form-control",value:o,onChange:this.onChangeValue})]})}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"N. Autorizaci\xf3n"}),Object(ra.jsx)("input",{type:"text",name:"auth",className:"form-control",value:r,onChange:this.onChangeValue})]})]}):null]}),Object(ra.jsxs)("div",{className:"modal-footer",children:[Object(ra.jsx)("button",{type:"button",className:"btn btn-dark","data-dismiss":"modal",children:"Cancelar"}),Object(ra.jsx)("button",{type:"button",className:"btn btn-success",onClick:this.handlePay,"data-dismiss":"modal",children:"Abonar"})]})]})})})}}]),a}(s.Component),jn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.client;return Object(ra.jsxs)("div",{className:"d-none d-print-block",style:{width:340},id:t,children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card m-0",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h1",{className:"text-center",children:Object(ra.jsx)("center",{children:Object(ra.jsx)("strong",{children:"\xd3ptica Madero"})})}),Object(ra.jsx)("h3",{children:Object(ra.jsxs)("em",{children:["Julio Cesar Cardenas Martinez",Object(ra.jsx)("br",{}),"Tel: 312 312 5353",Object(ra.jsx)("br",{}),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col."]})}),Object(ra.jsx)("hr",{}),Object(ra.jsxs)("h4",{className:"text-uppercase",children:[a&&a.nombre?a.nombre.toUpperCase():null,Object(ra.jsx)("br",{}),a.telefonos?a.telefonos[0]?a.telefonos[0]:a.telefonos[2]:"--"]})]})})})}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("center",{children:Object(ra.jsx)("h2",{className:"text-center",children:"Abono"})})})})]})}}]),a}(s.Component),un=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).delete=function(e){window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar el abono?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){if(t&&e){var a=JSON.parse(localStorage.getItem("OrusSystem"));return console.log("[OrusSystem] Solicitud de eliminaci\xf3n de venta por API:",e),fetch("http://"+a.host+"/api/payments/"+e,{method:"DELETE",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("[OrusSystem] Abono eliminado"),window.Swal.fire({icon:"success",title:"Abono eliminado con exito",showConfirmButton:!1,timer:1500}).then((function(e){console.log("[DEBUG] abonos: getPayments"),s.getPayments()}))):e&&!e.dismiss&&(console.error("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.print=function(e,t,a){var s=document.getElementById("print_pay"),n=document.getElementById("ifmcontentstoprint").contentWindow;n.document.open(),n.document.write(s.innerHTML),n.document.write("<fieldset><h3>"),n.document.write("Fecha: "+t),n.document.write("<br/>Folio: "+a),n.document.write("<br/>Monto: $ "+e.toFixed(2)),n.document.write("</h3></fieldset>"),n.document.close(),n.focus(),n.print()},s.handleLoad=function(e){s.setState({load:e})},s.handleChange=function(e){s.setState({total:s.state.total+e}),s.getPayments()},s.SetMethodPayment=function(e){switch(e){case 1:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Efectivo"});case 2:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Tarjeta debito"});case 3:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Tarjeta Credito"});case 4:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"La marina"});case 5:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Cheque"});case 6:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Transferencia"});default:return Object(ra.jsx)("span",{className:"badge badge-success text-uppercase",children:"Otro"})}},s.getPayments=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),t="?sale="+s.props.sale;s.state.load||s.setState({load:!0}),console.log("[OrusSystem] Descargando datos de los abonos"),fetch("http://"+e.host+"/api/payments"+t+"&order=desc",{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.ok||console.error(e),e.json()})).then((function(e){if(e.meta&&e.meta.total){console.log("[OrusSystem] Almacenando abonos");for(var t=0,a=0;a<e.data.length;a++)t+=e.data[a].total;s.props.handleChange("pagado",parseInt(t)),s.setState({abonos:e.data,total:t,load:!1})}else s.props.handleChange("pagado",0),s.setState({load:!1,abonos:[],total:0})}))},s.state={abonos:[],total:0,load:!0},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getPayments()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this,t=this.state,a=t.abonos,s=t.total,c=t.load,r=this.props,o=r.id,i=r.date,l=r.contact,d=r.order,j=r.pay,u=r.user,m=r.sale,h=r.cliente,b=r.data;return Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("table",{className:"table",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{scope:"col",children:"Fecha"}),Object(ra.jsx)("th",{scope:"col",children:"Metodo de pago"}),Object(ra.jsx)("th",{scope:"col",children:"Cantidad"}),Object(ra.jsx)("th",{scope:"col",children:"Recibio"}),Object(ra.jsx)("th",{scope:"col",children:"Acciones"})]})}),Object(ra.jsx)("tbody",{children:a.length&&!c?Object(ra.jsx)(n.a.Fragment,{children:a.map((function(t){return Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{children:na()(t.created_at).format("L")}),Object(ra.jsxs)("td",{children:[e.SetMethodPayment(t.metodo),1!==t.metodo?Object(ra.jsxs)("span",{className:"ml-4",children:[t.banco?t.banco:"--"," /"," ",t.Autorizacion?t.Autorizacion:"--"]}):null]}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",t.total.toFixed(2)]}),Object(ra.jsx)("td",{children:t.created_user}),Object(ra.jsxs)("td",{className:"text-right",children:[na()(new Date).isSame(t.created_at,"day")?Object(ra.jsx)("button",{className:"btn btn-black btn-sm",onClick:function(){e.delete(t.id)},children:Object(ra.jsx)("i",{className:"fas fa-trash"})}):null,Object(ra.jsx)("button",{className:"btn btn-outline-light btn-sm",onClick:function(){e.print(t.total,na()(t.created_at).format("L"),t.id)},children:Object(ra.jsx)("i",{className:"fas fa-print"})})]})]},t.id)}))}):c?Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{colSpan:"5",className:"text-center p-4",children:[Object(ra.jsx)("div",{className:"spinner-border text-primary mr-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(ra.jsx)("span",{className:"font-weight-light font-italic",children:"Espere cargando datos de la venta"})]})}):Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"5",className:"text-center",children:"No hay abonos registrados"})})}),Object(ra.jsx)("tfoot",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsxs)("th",{scope:"row",colSpan:"3",className:"text-right",children:[this.props.pay?Object(ra.jsx)("a",{href:"#abonos",className:this.props.pay?"btn btn-outline-success btn-sm mr-2":"btn btn-outline-success btn-sm mr-2 disabled","data-toggle":"modal","data-target":"#abonos","aria-disabled":!this.props.pay,children:Object(ra.jsx)("i",{className:"fas fa-money-bill-wave-alt"})}):null,"Total: $ ",s.toFixed(2)]}),Object(ra.jsx)("td",{colSpan:"2"})]})})]}),Object(ra.jsx)(dn,{pay:j,user:u,saleId:m,contactId:l,order:d,data:b,handleChange:this.handleChange,handleLoad:this.handleLoad}),Object(ra.jsx)(jn,{folio:o,date:i,contact:l,client:h,id:"print_pay"})]})}}]),a}(s.Component),mn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).getContact=function(t){var a=JSON.parse(localStorage.getItem("OrusSystem"));fetch("http://"+a.host+"/api/contacts/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a.token}}).then((function(e){return e.json()})).then((function(t){console.log("Descargando contacto: data",t),e.setState({dataContact:t.data})})).catch((function(e){console.log(e)}))},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.items,a=e.descuento,s=e.total,c=e.saldo,r=e.abonado,o=e.folio,i=e.date,l=e.id,d=0,j=this.props.cliente;return Object(ra.jsxs)("div",{className:"d-none d-print-block",style:{width:340},id:l,children:[Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("div",{className:"card m-0",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("h4",{className:"text-right",style:{fontSize:28,fontFamily:"sans-serif"},children:Object(ra.jsxs)("i",{children:["Folio: ",Object(ra.jsx)("strong",{children:o})]})}),Object(ra.jsx)("h6",{className:"text-right mb-2",style:{fontSize:18,fontFamily:"sans-serif"},children:Object(ra.jsx)("strong",{children:na()(i).format("LL")})}),Object(ra.jsx)("h2",{className:"text-center",style:{fontSize:54,fontFamily:"sans-serif"},children:Object(ra.jsx)("center",{children:Object(ra.jsx)("strong",{children:"\xd3ptica Madero"})})}),Object(ra.jsx)("h4",{className:"text-center mb-4",style:{fontSize:22,fontFamily:"sans-serif"},children:Object(ra.jsxs)("em",{children:["Julio Cesar Cardenas Martinez",Object(ra.jsx)("br",{}),"Tel: 312 312 5353",Object(ra.jsx)("br",{}),"Av. Tecnologico 38-A, Vistahermosa, Colima, Col."]})}),Object(ra.jsxs)("h4",{className:"text-uppercase text-center mb-1",style:{fontSize:20,fontFamily:"sans-serif"},children:[j&&j.nombre?j.nombre:"Venta de mostrador",Object(ra.jsx)("br",{}),Object(ra.jsx)("strong",{children:Object(ra.jsx)("em",{style:{fontSize:24},children:j&&j.telefonos?j.telefonos.t_movil?j.telefonos.t_movil:j.telefonos.t_casa?j.telefonos.t_casa:j.telefonos.t_oficina:"--"})})]})]})})})}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col text-center",children:Object(ra.jsx)("h2",{style:{fontSize:36,fontFamily:"sans-serif"},children:Object(ra.jsx)("strong",{children:"Pedido"})})})}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("table",{className:"table",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{style:{fontSize:26,fontFamily:"sans-serif"},children:"Cant"}),Object(ra.jsx)("th",{style:{fontSize:26,fontFamily:"sans-serif"},children:"Descripcion"}),Object(ra.jsx)("th",{style:{fontSize:26,fontFamily:"sans-serif"},children:"Total"})]})}),Object(ra.jsx)("tbody",{children:t.map((function(e,t){var a=parseFloat(e.cantidad*e.precio);return d+=a,Object(ra.jsxs)("tr",{className:"text-capitalize",children:[Object(ra.jsx)("td",{style:{fontSize:22,fontFamily:"sans-serif"},children:e.cantidad}),Object(ra.jsx)("td",{style:{fontSize:22,fontFamily:"sans-serif"},children:e.producto}),Object(ra.jsx)("td",{className:"text-right",style:{fontSize:24,fontFamily:"sans-serif"},children:a.toFixed(2)})]},t)}))}),Object(ra.jsx)("tfoot",{children:Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{className:"text-right",colSpan:"3",children:[a?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("h4",{style:{fontSize:26,fontFamily:"sans-serif"},children:["Subtotal: ",Object(ra.jsxs)("label",{children:["$ ",d.toFixed(2)]})]}),Object(ra.jsxs)("h4",{style:{fontSize:26,fontFamily:"sans-serif"},children:["Descuento: ",Object(ra.jsxs)("label",{children:["$ ",a.toFixed(2)]})]})]}):null,Object(ra.jsxs)("h4",{style:{fontSize:26,fontFamily:"sans-serif"},children:["Total: ",Object(ra.jsxs)("label",{children:["$ ",s.toFixed(2)]})]}),r?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("h4",{style:{fontSize:26,fontFamily:"sans-serif"},children:["Abonado: ",Object(ra.jsxs)("label",{children:["$ ",r.toFixed(2)]})]}),Object(ra.jsxs)("h4",{style:{fontSize:26,fontFamily:"sans-serif"},children:["Saldo: ",Object(ra.jsxs)("label",{children:["$ ",c.toFixed(2)]})]})]}):null]})})})]})})}),Object(ra.jsx)("div",{className:"text-center",children:Object(ra.jsx)("em",{style:{fontSize:22,fontFamily:"sans-serif"},children:"Armazones usados, viejos y/o resecos son responsabilidad del cliente"})})]})}}]),a}(s.Component),hn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){var e;Object(Yt.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).catchInputs=function(t){e.props.catchInputs(t)},e}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.pay,a=e.descuento,s=e.subtotal,n=e.total,c=e.pagado;return Object(ra.jsx)("div",{className:"card card-success card-outline",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title mb-4",children:[Object(ra.jsx)("i",{className:"fas fa-shield-alt mr-2"}),"Estado de cuenta",t?"":Object(ra.jsx)("span",{className:"badge badge-success ml-2",children:"Cuenta liquidada"})]}),Object(ra.jsxs)("div",{className:"card-text form-group row",children:[Object(ra.jsx)("label",{className:"col-6",children:"Descuento"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("input",{className:c?"form-control text-right text-success disabled":"form-control text-right text-success",type:"number",name:"descuento",min:"0",max:s-a,readOnly:!(t&&!c),value:a?parseInt(a):"",onChange:this.catchInputs})})]}),Object(ra.jsxs)("div",{className:"card-text form-group row",children:[Object(ra.jsx)("label",{className:"col-6",children:"Total"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("input",{className:"form-control text-right text-success",type:"number",name:"total",value:n.toFixed(2),onChange:this.catchInputs,readOnly:!0})})]}),Object(ra.jsxs)("div",{className:"card-text row",children:[Object(ra.jsx)("label",{className:"col-6 p-2",children:"Abonado"}),Object(ra.jsxs)("h3",{className:"col text-success p-2 text-right",children:["$ ",c.toFixed(2)]})]}),Object(ra.jsxs)("div",{className:"card-text row",children:[Object(ra.jsx)("label",{className:"col-6 p-2",children:"Saldo"}),Object(ra.jsxs)("h3",{className:"col text-success p-2 text-right",children:["$ ",t.toFixed(2)]})]})]})})}}]),a}(s.Component),bn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleChangeInput=function(e,t){var a,n=0;if("items"===e)for(var c=0;c<t.length;c++)n+=t[c].cantidad*t[c].precio;else n=s.state.subtotal;s.setState((a={},Object(J.a)(a,e,t),Object(J.a)(a,"subtotal",n),a))},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value;"number"===t.type&&(n*=1),"descuento"===a&&n>=s.state.subtotal-s.state.descuento&&(n=s.state.subtotal-1),s.setState(Object(J.a)({},a,n))},s.getIdContact=function(e,t){s.setState({contact_id:e,edad:t})},s.changePage=function(e){s.props.page(e)},s.handleSave=function(e){e.preventDefault();var t=s.state.id;window.Swal.fire({title:"Almacenamiento",text:t?"\xbfEsta seguro de actualizar la venta?":"\xbfEsta seguro de crear una nueva venta?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:t?"Actualizar":"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){if(e){var a,n=s.state,c=n.host,r=n.token,o=t?"http://"+c+"/api/sales/"+t:"http://"+c+"/api/sales",i=t?"PUT":"POST",l=[];return s.state.items.map((function(e){return l.push({cant:e.cantidad,price:e.precio,subtotal:e.subtotal,inStorage:e.inStorage,out:e.out,session:e.session,store_items_id:e.store_items_id,descripcion:e.descripcion}),!1})),a={session:s.state.session,descuento:s.state.descuento,subtotal:s.state.subtotal,total:s.state.subtotal-s.state.descuento,contact_id:s.state.contact_id,order_id:s.state.order_id?s.state.order_id:"",pagado:s.state.pagado,items:JSON.stringify(l)},console.log("Enviando datos a API para almacenar"),fetch(o,{method:i,body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}}).then((function(e){if(e&&!e.dismiss&&e.value){var a=e.value;a.data?(console.log("Venta almacenada"),window.Swal.fire({icon:"success",title:t?"Venta actualizada con exito":"Venta almacenada con exito",showConfirmButton:!1,timer:1500}).then((function(e){s.setState({id:a.data.id}),s.props.history.push("/notas/registro/".concat(a.data.id))}))):(window.Swal.fire("Error","al almacenar la venta","error"),console.error("Orus res: ",a.message))}}))},s.getSales=function(e){if(e>0){var t=s.state,a=t.host,n=t.token;console.log("Solicitando datos de pedido a la API"),fetch("http://"+a+"/api/sales/"+e,{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){if(e.message)console.error("Orus: ",e.message),window.Swal.fire("Error",e.message,"error"),s.setState({load:!1});else{var t=s.props.data.rol;console.log("Mostrando datos del pedido",e),s.setState({id:e.data.id,session:e.data.session?e.data.session:s.state.session,items:e.data.productos,descuento:e.data.descuento,subtotal:e.data.subtotal,total:e.data.total,contact_id:e.data.cliente.id,cliente:e.data.cliente,usuario:e.data.created,date:e.data.created_at,status:t?1:0,order_id:e.data.pedido,pagado:e.data.pagado,load:!1})}})).catch((function(e){console.log("Orus:",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error"),s.setState({load:!1})}))}else s.setState({load:!1})};var n=JSON.parse(localStorage.getItem("OrusContactInUse")),c=s.props.match.params.id,r=c?0:2,o=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={id:c,session:Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)+Math.random().toString(10),descuento:0,subtotal:0,total:0,items:[],contact_id:n&&n.id?n.id:r,cliente:{},order_id:0,status:0,usuario:"",date:Date.now(),load:!0,pagado:0,host:o.host,token:o.token},s.total=0,s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this.state.id;this.getSales(e),localStorage.setItem("OrusContactInUse",JSON.stringify({}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.contact_id,s=t.cliente,c=t.subtotal,r=t.descuento,o=t.pagado,i=t.items,l=t.status,d=t.id,j=t.session,u=t.load,m=t.date,h=t.order_id,b=t.usuario,p=this.props.data,x=h?Object(ra.jsx)(en,{data:p,table:"orders",idRow:h,pagado:o}):Object(ra.jsx)(en,{data:p,table:"sales",idRow:d,pagado:o}),O=c-(r+o);return this.total=c-r,O=O>0?O:0,Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("div",{className:"row d-print-none",children:[Object(ra.jsx)("div",{className:"col-3",children:Object(ra.jsx)(ln,{contact:a,status:l,getIdContact:this.getIdContact,changePage:this.changePage})}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsxs)("div",{className:"card card-success card-outline",children:[Object(ra.jsx)("div",{className:"card-body p-0",children:a&&!u?Object(ra.jsxs)(n.a.Fragment,{children:[Object(ra.jsxs)("div",{className:"row mx-2 my-4",children:[Object(ra.jsx)("div",{className:"col-2",children:Object(ra.jsxs)("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("span",{className:"badge badge-pill badge-success mx-2",children:"Venta"}),Object(ra.jsx)("strong",{children:d||"Nuevo"})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("span",{className:"badge badge-pill badge-success mx-2",children:"Creador"}),Object(ra.jsx)("strong",{children:this.state.usuario?this.state.usuario:this.props.data.name})]})}),h?Object(ra.jsx)("div",{className:"col-2",children:Object(ra.jsxs)("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("span",{className:"badge badge-pill badge-warning mx-2",children:"Pedido"}),Object(ra.jsx)("strong",{children:h?Object(ra.jsx)(ta.b,{to:"/pedidos/"+h,onClick:function(t){e.changePage("/pedidos/registro")},children:h}):null})]})}):null,Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("div",{className:"border border-success rounded p-2 d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("span",{className:"badge badge-pill badge-success mx-2",children:"Fecha"}),Object(ra.jsx)("strong",{children:na()(m).format("ll")})]})})]}),Object(ra.jsx)(qs,{items:i,status:!1,session:j,ChangeInput:this.handleChangeInput,addCancel:!!h})]}):u?Object(ra.jsxs)("div",{className:"text-center p-4",children:[Object(ra.jsx)("div",{className:"spinner-border text-primary mr-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(ra.jsx)("span",{className:"font-weight-light font-italic",children:"Espere cargando datos de la venta"})]}):Object(ra.jsxs)("div",{className:"alert alert-light",children:[Object(ra.jsx)("h4",{className:"alert-heading",children:"Nueva nota"}),Object(ra.jsxs)("p",{children:[Object(ra.jsx)("i",{className:"fas fa-user mr-1"})," Primero seleccione al cliente!"]})]})}),Object(ra.jsx)("div",{className:"card-footer text-right",children:Object(ra.jsxs)("div",{className:"btn-group",role:"group",children:[Object(ra.jsxs)(ta.b,{to:"/notas",className:"btn btn-dark",onClick:function(t){e.changePage("/notas")},children:[Object(ra.jsx)("i",{className:d?"fas fa-arrow-left mr-2":"fas fa-ban mr-2"}),Object(ra.jsx)("strong",{children:d?"Regresar":"Cancelar"})]}),Object(ra.jsxs)("button",{className:a&&i.length?"btn btn-dark":"btn btn-dark disabled",onClick:function(e){window.print()},disabled:!a||!i.length,children:[Object(ra.jsx)("i",{className:"fas fa-print mr-2"}),Object(ra.jsx)("strong",{children:"Imprimir"})]}),Object(ra.jsxs)("button",{className:a&&i.length&&O?"btn btn-success":"btn btn-success disabled",onClick:this.handleSave,disabled:!(a&&i.length&&O),children:[Object(ra.jsx)("i",{className:"fas fa-save mr-2"}),Object(ra.jsx)("strong",{children:"Guardar"})]})]})})]}),a&&d&&i.length?Object(ra.jsx)("div",{className:"card card-success card-outline",children:Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsxs)("h5",{className:"card-title mb-4",children:[Object(ra.jsx)("i",{className:"fas fa-money-bill mr-2"}),"Ultimos Abonos"]}),Object(ra.jsx)(un,{abonos:parseInt(o),sale:parseInt(d),contact:a,cliente:s,pay:parseInt(O),order:parseInt(h),data:p,user:b,handleChange:this.handleChangeInput})]})}):null]}),d&&a?Object(ra.jsxs)("div",{className:"col-3 d-print-none",children:[i.length?Object(ra.jsx)(hn,{pay:O,descuento:r,subtotal:c,total:this.total,pagado:o,catchInputs:this.catchInputs}):null,x]}):null]}),Object(ra.jsx)(mn,{id:"print_sale",folio:h?"P-"+h:"V-"+d,date:m,items:i,descuento:r,total:this.total,saldo:O,abonado:o,contact:a,cliente:s})]})}}]),a}(s.Component),pn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).getSaleDay=function(){var e=s.state,t=e.host,a=e.token,n=e.page,c=s.props,r=c.date,o=c.user,i="http://"+t+"/api/payments",l="?date="+r,d=n>0?"&page="+n:"&page=1",j=o?"&user="+o:"";a&&t&&(console.log("[ReportPaymentsDetails] Solicitando datos a la API"),s.setState({load:!0}),fetch(i+l+j+"&itemsPage=10"+d,{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a}}).then((function(e){if(!e.ok)throw console.log(e),new Error(e);return e.json()})).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.message){e.next=5;break}console.log("[ReportPayments] Almacenando datos de la venta del dia"),t.data&&s.setState({payments:t.data,meta:t.meta,load:!1}),e.next=6;break;case 5:throw new Error(t.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de procesamiento, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"}),s.setState({load:!1})})))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={host:n.host,rol:n.rol,token:n.token,payments:[],meta:{},page:1,load:!1},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay()}},{key:"componentDidUpdate",value:function(e,t){e.date===this.props.date&&e.user===this.props.user&&t.page===this.state.page||(console.log("[reportPaymentsDetails] Recarga datos"),this.getSaleDay())}},{key:"render",value:function(){var e=this,t=this.props.data,a=this.state,s=a.payments,n=a.meta,c=a.page,r=a.load;return Object(ra.jsxs)("div",{className:"card card-success card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsx)("h3",{className:"card-title text-success",children:t.rol?"Mis pagos del dia [Detallado]":"Pagos del dia [Detallado]"})}),Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsxs)("table",{className:"table table-sm",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Metodo"}),Object(ra.jsx)("th",{children:"Cliente"}),Object(ra.jsx)("th",{children:"Nota"}),Object(ra.jsx)("th",{children:"Total"})]})}),Object(ra.jsx)("tbody",{children:r?Object(ra.jsx)("tr",{children:Object(ra.jsxs)("td",{colSpan:"4",className:"text-center p-4",children:[Object(ra.jsx)("div",{className:"spinner-border text-primary mr-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(ra.jsx)("span",{className:"font-weight-light font-italic",children:"Espere cargando datos de pagos"})]})}):s.length?s.map((function(e){return Object(ra.jsxs)("tr",{className:1===e.metodo?"text-success":"",children:[Object(ra.jsx)("th",{className:"text-uppercase",children:e.metodoname}),Object(ra.jsx)("td",{className:"text-capitalize",children:e.sale.cliente.nombre}),Object(ra.jsx)("td",{children:Object(ra.jsx)("span",{className:"badge badge-primary",alt:"Cobrado por: "+e.created_user,title:"Cobrado por: "+e.created_user,children:e.sale.id})}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",e.total.toFixed(2)]})]},e.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsx)("th",{colSpan:"4",className:"text-center",children:Object(ra.jsxs)("h6",{className:"text-warning",children:[Object(ra.jsx)("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia"]})})})})]})}),n.total?Object(ra.jsxs)("div",{className:"card-footer",children:[1===n.current_page?Object(ra.jsx)("a",{href:"#next",onClick:function(e){return e.preventDefault()},children:Object(ra.jsx)("i",{className:"fas fa-step-backward text-dark"})}):Object(ra.jsx)("a",{href:"#next",onClick:function(t){t.preventDefault(),e.setState({page:c-1})},children:Object(ra.jsx)("i",{className:"fas fa-step-backward"})})," "+c+" / "+n.last_page+" ",n.current_page===n.last_page?Object(ra.jsx)("a",{href:"#next",onClick:function(e){return e.preventDefault()},children:Object(ra.jsx)("i",{className:"fas fa-step-forward text-dark"})}):Object(ra.jsx)("a",{href:"#next",onClick:function(t){t.preventDefault(),e.setState({page:c+1})},children:Object(ra.jsx)("i",{className:"fas fa-step-forward"})})]}):null]})}}]),a}(s.Component),xn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changeState=function(e){var t=e.target,a=t.value,n=t.name;"user"===n&&(a*=1),s.setState(Object(J.a)({},n,a))},s.getSaleDay=function(){var e=s.state,t=e.host,a=e.token,n=s.props,c=n.date,r=n.user,o="http://"+t+"/api/saleday",i="?date="+c,l=r?"&user="+r:"";a&&t&&(console.log("[ReportPay] Solicitando datos a la API"),fetch(o+i+l,{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a}}).then((function(e){return e.ok||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error al descargar las ventas",icon:"error",confirmButtonText:"Ok"}),console.log(e)),e.json()})).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a,n,c,r,o,i,l;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=window.$("#donutChart").get(0).getContext("2d"),n={maintainAspectRatio:!0,responsive:!0},c=[],r=[],o=0,i=0,l={},s.char&&s.char.destroy(),t.message){e.next=14;break}if(console.log("[ReportPay] Almacenando datos de la venta del dia"),!t||!t.length){e.next=9;break}return e.next=7,t.map((function(e){return c.push(s.SetMethodPayment(e.metodopago)),r.push(e.total.toFixed(2)),1===e.metodopago&&(s.props.changeState("ventas",e.total),i=e.total),o+=e.total,null}));case 7:e.next=11;break;case 9:c=["No hay datos"],r=[100];case 11:s.setState({total:o,efectivo:i}),e.next=17;break;case 14:console.error("[ORUS] Error al cargar la venta del dia",t.message),c=["No hay datos"],r=[100];case 17:l={labels:c,datasets:[{data:r,backgroundColor:["#f56954","#00a65a","#f39c12","#00c0ef","#3c8dbc","#d2d6de","#000"]}]},s.char=new window.Chart(a,{type:"pie",data:l,options:n});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de usuario, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"})})))},s.SetMethodPayment=function(e){switch(e){case 1:return"Efectivo";case 2:return"Tarjeta debito";case 3:return"Tarjeta de credito";case 4:return"La marina";case 5:return"Cheque";case 6:return"Transferencia";default:return"Otro"}};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={host:n.host,rol:n.rol,token:n.token,total:0,efectivo:0},s.char=null,s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay()}},{key:"componentDidUpdate",value:function(e,t){e.date===this.props.date&&e.user===this.props.user||(console.log("[reportPays] Recarga datos de char"),this.getSaleDay())}},{key:"render",value:function(){var e=this.state,t=e.total,a=e.efectivo,s=e.rol,c=this.props.data;return Object(ra.jsxs)("div",{className:"card card-success card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsx)("h3",{className:"card-title text-success",children:c.rol?"Mis ventas del dia por metodo de pago":"Ventas del dia por metodo de pago"})}),Object(ra.jsxs)("div",{className:"card-body",children:[Object(ra.jsx)("canvas",{id:"donutChart"}),Object(ra.jsxs)("p",{children:[s?null:Object(ra.jsxs)(n.a.Fragment,{children:["Venta: ",Object(ra.jsxs)("strong",{children:["$ ",t.toFixed(2)]}),Object(ra.jsx)("br",{})]}),"Efectivo: ",Object(ra.jsxs)("strong",{children:["$ ",a.toFixed(2)]})]})]})]})}}]),a}(s.Component),On=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changeState=function(e){var t=e.target,a=t.value,n=t.name;"user"===n&&(a*=1),s.setState(Object(J.a)({},n,a))},s.getSaleDay=function(){var e=s.state,t=e.host,a=e.token,n=s.props,c=n.date,r=n.user,o="http://"+t+"/api/bankdetails",i="?date="+c,l=r?"&user="+r:"";a&&t&&(console.log("Solicitando datos a la API"),s.setState({load:!0}),fetch(o+i+l,{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.message){e.next=5;break}console.log("[reportBank] Almacenando detalles bancarios",t.data),s.setState({data:t,load:!1}),e.next=6;break;case 5:throw new Error(t.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("[reportBank] "+e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error en la consulta, revise la conexion",icon:"error",confirmButtonText:"Ok"}),s.setState({load:!1})})))},s.getBaks=function(){var e=s.state,t=e.host,a=e.token;console.log("[reportBank] Descargando listado de bancos"),fetch("http://"+t+"/api/config?name=bank",{method:"GET",signal:s.signal,headers:{Accept:"application/json",Authorization:"Bearer "+a}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e.meta&&e.meta.total&&(console.log("[reportBank] Listado de bancos descargado"),s.setState({listBank:e.data}))})).catch((function(e){console.error("[Orus system] ",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={host:n.host,token:n.token,listBank:[],data:[],load:!1},s.char=null,s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getSaleDay(),this.getBaks()}},{key:"componentDidUpdate",value:function(e,t){e.date===this.props.date&&e.user===this.props.user||(console.log("[ReportBank] Recarga datos de char"),this.getSaleDay())}},{key:"render",value:function(){var e=this.state,t=e.listBank,a=e.data,s=e.load;return Object(ra.jsxs)("div",{className:"card card-success card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsx)("h3",{className:"card-title text-success",children:"Detallado de pagos bancarios"})}),Object(ra.jsx)("div",{className:"card-body",children:s?Object(ra.jsxs)("div",{children:[Object(ra.jsx)("div",{className:"spinner-border text-primary mr-4",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}),Object(ra.jsx)("span",{className:"font-weight-light font-italic",children:"Espere cargando datos de banco"})]}):Object(ra.jsx)("ul",{className:"list-group",children:a.length?a.map((function(e){return Object(ra.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[Object(ra.jsx)("label",{className:"text-uppercase",children:t.map((function(t){return t.id===e.bank_id?t.name:null}))}),Object(ra.jsxs)("span",{className:"badge badge-primary badge-pill",children:["$ ",e.total.toFixed(2)]})]},e.bank_id)})):Object(ra.jsx)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:Object(ra.jsxs)("h6",{className:"text-warning",children:[Object(ra.jsx)("i",{className:"fas fa-info mr-2"}),"No hay datos para este dia"]})})})})]})}}]),a}(s.Component),gn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).deleteAtm=function(e,t,a){a=a>0?a:-1*a,t=t?"la ENTRADA":"el EGRESO",window.Swal.fire({title:"Eliminar",text:"\xbfEsta seguro de eliminar "+t+" de "+a+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(t){var n=s.state,c=n.host,r=n.token;if(t&&a)return console.log("Enviando datos ATM a API"),fetch("http://"+c+"/api/atms/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}).then((function(e){e&&!e.dismiss&&e.value?(console.log("Entrada eliminada"),window.Swal.fire({icon:"success",title:"Entrada eliminada con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.getAtms()}))):e&&!e.dismiss&&(console.log("Orus res: ",e),window.Swal.fire("Error","Se perdio la conexion con el servidor","error"))}))},s.changeState=function(e){var t=e.target,a=t.value,n=t.name;"tipo"===n&&(a*=1),s.setState(Object(J.a)({},n,a))},s.sendAtm=function(){window.Swal.fire({title:"Almacenamiento",text:"\xbfEsta seguro de agregar un movimiento a la caja?",icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",confirmButtonText:"Crear",cancelButtonText:"Cancelar",showLoaderOnConfirm:!0,preConfirm:function(e){var t=s.state,a=t.host,n=t.token,c=t.efectivo,r=t.tipo,o={efectivo:r?c:-1*c,type:r},i="http://"+a+"/api/atms";if(e&&c)return console.log("Enviando datos ATM a API"),fetch(i,{method:"POST",body:JSON.stringify(o),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.error("Orus fetch",e),window.Swal.fire("Fallo de conexion","Verifique la conexion al servidor","error")}))}}).then((function(e){if(e&&!e.dismiss&&e.value){var t=e.value;t.data?(console.log("ATM almacenado"),window.Swal.fire({icon:"success",title:"Movimiento almacenado con exito",showConfirmButton:!1,timer:1500}).then((function(e){return s.getAtms()}))):(window.Swal.fire("Error","al almacenar el movimiento","error"),console.error("Orus res: ",t.message))}}))},s.getAtms=function(){var e=s.state,t=e.host,a=e.token,n=s.props,c=n.date,r=n.user,o="http://"+t+"/api/atms",i="?date="+c,l=r?"&user="+r:"";console.log("Descargando datos de efectivo"),fetch(o+i+l,{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){return e.ok||401===e.status||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error, intentelo mas tarde",icon:"error"}),console.log(e)),e.json()})).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Almacenando datos de efectivo"),t.message){e.next=7;break}return a=0,e.next=5,t.data.map((function(e){return a+=e.efectivo,null}));case 5:s.props.changeState("caja",a),s.setState({atms:t.data,efectivo:0});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error, intentelo mas tarde",icon:"error"})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={atms:[],efectivo:0,tipo:1,host:n.host,token:n.token},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){this.getAtms()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidUpdate",value:function(e,t){e.date===this.props.date&&e.user===this.props.user||this.getAtms()}},{key:"render",value:function(){var e=this,t=this.state,a=t.atms,s=t.efectivo,n=t.tipo,c=0;return Object(ra.jsxs)("div",{className:"card card-dark card-outline",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsx)("h3",{className:"card-title text-dark",children:"Movimientos de caja"})}),Object(ra.jsx)("div",{className:"card-body",children:Object(ra.jsxs)("table",{className:"table table-sm",children:[Object(ra.jsx)("thead",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("th",{children:"Hora"}),Object(ra.jsx)("th",{children:"Usuario"}),Object(ra.jsx)("th",{children:"Tipo"}),Object(ra.jsx)("th",{children:"Monto"}),Object(ra.jsx)("th",{children:"D"})]})}),Object(ra.jsx)("tbody",{children:a.length?a.map((function(t){return c+=t.efectivo,Object(ra.jsxs)("tr",{className:t.efectivo>0?"text-success":"text-danger",children:[Object(ra.jsx)("td",{children:na()(t.created_at).format("LT")}),Object(ra.jsx)("td",{children:t.created_user}),Object(ra.jsx)("td",{children:t.tipo?"Ingreso":"Egreso"}),Object(ra.jsxs)("td",{children:["$",t.efectivo>0?t.efectivo.toFixed(2):(-1*t.efectivo).toFixed(2)]}),Object(ra.jsx)("th",{className:"text-right",children:Object(ra.jsx)("a",{href:"#delete",className:"text-dark",onClick:function(a){a.preventDefault(),e.deleteAtm(t.id,t.tipo,t.efectivo.toFixed(2))},children:Object(ra.jsx)("i",{className:"fas fa-trash"})})})]},t.id)})):Object(ra.jsx)("tr",{children:Object(ra.jsx)("td",{colSpan:"5",className:"text-center",children:"No hay datos"})})}),Object(ra.jsx)("tfoot",{children:Object(ra.jsxs)("tr",{children:[Object(ra.jsx)("td",{colSpan:"3",className:"text-right",children:Object(ra.jsx)("label",{children:"Total"})}),Object(ra.jsxs)("td",{className:"text-right",children:["$ ",c.toFixed(2)]}),Object(ra.jsx)("td",{})]})})]})}),Object(ra.jsx)("div",{className:"card-footer",children:Object(ra.jsxs)("div",{className:"form-group row",children:[Object(ra.jsx)("label",{className:"col-4 col-form-label",children:"Efectivo"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("select",{className:"form-control",name:"tipo",value:n,onChange:this.changeState,children:[Object(ra.jsx)("option",{value:"1",children:"Ingresos"}),Object(ra.jsx)("option",{value:"0",children:"Egreso"})]})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("input",{type:"number",name:"efectivo",className:"form-control text-right",min:"0",max:"10000",value:s,onChange:this.changeState})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("button",{className:"btn btn-dark",onClick:this.sendAtm,disabled:!(s>0),children:"Enviar"})})]})})]})}}]),a}(s.Component),fn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changeState=function(e){var t=e.target,a=t.value,n=t.name;s.setState(Object(J.a)({},n,a)),s.props.changeState(n,a)},s.getUsers=function(){var e=s.state,t=e.host,a=e.token,n="http://"+t+"/api/users";console.log("Descargando usuarios de API"),fetch(n+"?page=1&orderby=username&order=asc&rol=10",{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){return e.ok||(window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error al descargar usuarios de sistema",icon:"error",confirmButtonText:"Ok"}),console.error(e)),e.json()})).then((function(e){e.message?console.error("Error en la descarga de usuarios",e.message):(console.log("Almacenando usuarios"),s.setState({users:e.data}))})).catch((function(e){console.error(e),window.Swal.fire({title:"Error!",text:"Ups!\n Hubo un error de usuario, intentelo mas tarde",icon:"error",confirmButtonText:"Ok"})}))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={host:n.host,token:n.token,date:na()().format("YYYY-MM-DD"),user:e.data.rol?e.data.idUser:0,users:[]},s.controller=new AbortController,s.signal=s.controller.signal,s}return Object(Kt.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this.state,t=e.date,a=e.user,s=e.users;return Object(ra.jsx)("div",{className:"card border border-info rounded",children:Object(ra.jsxs)("div",{className:"card-body bg-light",children:[Object(ra.jsx)("div",{className:"row mb-4",children:Object(ra.jsx)("h5",{className:"card-title text-secondary",children:"Filtros"})}),Object(ra.jsxs)("div",{className:"form-group row",children:[Object(ra.jsx)("label",{className:"col col-form-label",children:"Fecha"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)("input",{type:"date",name:"date",className:"form-control",value:t,onChange:this.changeState})}),Object(ra.jsx)("label",{className:"col col-form-label",children:"Usuario"}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsxs)("select",{name:"user",className:"form-control",value:a,onChange:this.changeState,children:[Object(ra.jsx)("option",{value:"0",children:"Todos"}),s.map((function(e){return Object(ra.jsx)("option",{value:e.id,children:e.name},e.id)}))]})})]})]})})}}]),a}(s.Component),vn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.props,t=e.caja,a=e.ventas,s=t+a;return Object(ra.jsx)("div",{className:"card border border-info rounded",children:Object(ra.jsxs)("div",{className:"card-body bg-light text-right",children:[Object(ra.jsx)("h5",{className:"card-title text-secondary",children:"Corte de caja"}),Object(ra.jsx)("br",{}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"caja:"}),Object(ra.jsx)("br",{})," ",Object(ra.jsxs)("span",{className:"text-success",children:["$",t.toFixed(2)]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Efectivo:"}),Object(ra.jsx)("br",{})," ",Object(ra.jsxs)("span",{className:"text-success",children:["$",a.toFixed(2)]})]}),Object(ra.jsxs)("div",{className:"col",children:[Object(ra.jsx)("label",{children:"Total:"}),Object(ra.jsx)("br",{})," ",Object(ra.jsxs)("span",{className:"text-success",children:["$",s.toFixed(2)]})]})]})]})})}}]),a}(s.Component),Nn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).changeState=function(e,t){s.setState(Object(J.a)({},e,t))};var n=JSON.parse(localStorage.getItem("OrusSystem"));return s.state={host:n.host,token:n.token,user:e.data.rol?e.data.idUser:"",date:na()().format("YYYY-MM-DD"),caja:0,ventas:0},s}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this.state,t=e.user,a=e.date,s=e.caja,n=e.ventas,c=this.props.data;return Object(ra.jsxs)("div",{className:"content",children:[Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(gn,{data:c,user:t,date:a,changeState:this.changeState})}),Object(ra.jsx)("div",{className:"col col-md-3 col-lg-3",children:Object(ra.jsxs)("div",{className:"row",children:[c.rol?null:Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(fn,{data:c,changeState:this.changeState})}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(vn,{caja:s,ventas:n})})]})})]}),Object(ra.jsxs)("div",{className:"row",children:[Object(ra.jsxs)("div",{className:"col col-md-4 col-lg-4",children:[Object(ra.jsx)(On,{data:c,user:t,date:a,changeState:this.changeState}),Object(ra.jsx)(xn,{data:c,user:t,date:a,changeState:this.changeState})]}),Object(ra.jsx)("div",{className:"col",children:Object(ra.jsx)(pn,{data:c,user:t,date:a,changeState:this.changeState})})]})]})}}]),a}(s.Component),yn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;Object(Yt.a)(this,a),(s=t.call(this,e)).handleClickViewNotify=function(e,t,a){var n=s.props.page,c=t.split("/");e.preventDefault();var r=JSON.parse(localStorage.getItem("OrusSystem")),o=r.host,i=r.token;console.log("[Orus System] Enviando datos de leidos"),fetch("http://"+o+"/api/user/readAllNotifications",{method:"POST",body:JSON.stringify({id:a}),signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+i}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){e.success?console.log("[Orus] Notificaciones leeidas"):console.log("[Orus] Sin notificaciones"),n(c[1]),t&&s.props.history.push(t)})).catch((function(e){console.error("[Orus] Notify error \n",e),window.Swal.fire("Notificaciones","Verifique la conexion al servidor","error")}))},s.checkNotify=function(){var e=JSON.parse(localStorage.getItem("OrusSystem")),t=e.host,a=e.token;""!==a&&""!==t&&fetch("http://"+t+"/api/user",{method:"GET",signal:s.signal,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a}}).then(function(){var e=Object(ce.a)(se.a.mark((function e(t){var a;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},204===t.status){e.next=5;break}return e.next=4,t.json();case 4:a=e.sent;case 5:if(t.ok){e.next=7;break}throw new Error(a.message);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){s.setState({notifications:e.data?e.data.notifications:[],rol:e.data.rol,load:!1})})).catch((function(e){console.error("[Orus] User session in API error \n",e),s.setState({load:!1}),window.Swal.fire("Notificaciones","Verifique la conexion al servidor","error")}))};var n=JSON.parse(localStorage.getItem("OrusNotify"));return s.state={notifications:n.notifications.length?n.notifications:[],rol:n?n.rol:-1,count:n?n.count:0,load:!1},s}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.notifications,s=t.load;return Object(ra.jsxs)("div",{className:"card",children:[Object(ra.jsx)("div",{className:"card-header",children:Object(ra.jsxs)("h5",{className:"card-title",children:[Object(ra.jsx)("i",{className:"fas fa-bell mr-2"}),Object(ra.jsx)("label",{children:"Mis notificaciones"})]})}),Object(ra.jsx)("div",{className:"card-body",children:s?Object(ra.jsx)("div",{className:"card-text text-center",children:Object(ra.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})})}):Object(ra.jsx)(n.a.Fragment,{children:a.length?Object(ra.jsx)("div",{className:"list-group",children:a.map((function(t){var a=t.type.split("\\"),s="";return 3===a.length&&"ExamNotification"===a[2]&&(s="/consultorio/registro/"+t.data.id),Object(ra.jsxs)("a",{href:s,className:t.read_at?"list-group-item list-group-item-action flex-column align-items-start":"list-group-item list-group-item-action flex-column align-items-start active",onClick:function(a){return e.handleClickViewNotify(a,s,t.id)},children:[Object(ra.jsxs)("div",{className:"d-flex w-100 justify-content-between",children:[Object(ra.jsx)("h5",{className:"mb-1",children:(a[2],"")}),Object(ra.jsx)("small",{children:na()(t.created_at).fromNow()})]}),Object(ra.jsx)("p",{className:"mb-1 text-capitalize",children:Object(ra.jsx)("strong",{children:t.data.paciente})}),Object(ra.jsx)("small",{className:"text-capitalize",children:t.data.user})]},t.id)}))}):Object(ra.jsx)("p",{className:"card-text",children:"Sin notificaciones"})})})]})}}]),a}(s.Component),wn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).handlePage=function(e){var t=s.handleTitleSection(e);s.setState({page:t})},s.handleTitleSection=function(e){""!==(e=e||window.location.pathname)&&"undefined"!==typeof e&&"object"!==typeof e||(e="/");var t=e.split("/");return""===t[1]?"dashboard":t[1]},s.state={page:s.handleTitleSection(window.location.pathname),company:e.data.company},s}return Object(Kt.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,s=t.logOut,n=this.state.page;return Object(ra.jsx)(ta.a,{children:Object(ra.jsxs)("div",{className:"wrapper",children:[Object(ra.jsx)(da,{logOut:s,data:a,page:this.handlePage}),Object(ra.jsx)(ua,{companyName:this.state.company,user:a,page:this.handlePage,logOut:s,active:n}),Object(ra.jsxs)("div",{className:"content-wrapper",children:[Object(ra.jsx)(ha,{title:n}),Object(ra.jsx)("div",{className:"content",children:Object(ra.jsx)("div",{className:"container-fluid",children:Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"col-lg-12",children:Object(ra.jsxs)(aa.c,{children:[Object(ra.jsx)(aa.a,{path:"/usuarios/registro/:id?",render:function(t){return Object(ra.jsx)(ya,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/usuarios",render:function(t){return Object(ra.jsx)(fa,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{path:"/almacen/registro/:id?",render:function(t){return Object(ra.jsx)(za,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/almacen/categorias",render:function(t){return Object(ra.jsx)(Ua,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/almacen/marcas",render:function(t){return Object(ra.jsx)(Ga,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/almacen/inventario",render:function(t){return Object(ra.jsx)(_a,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/almacen",render:function(t){return Object(ra.jsx)(Aa,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/contactos/:id?",render:function(t){return Object(ra.jsx)(js,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/consultorio/:id?",render:function(e){return Object(ra.jsx)(Ps,Object(i.a)({},e))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/configuraciones",render:function(t){return Object(ra.jsx)(ms,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/pedidos/:id?",render:function(e){return Object(ra.jsx)(cn,Object(i.a)({},e))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/notas/registro/:id?",render:function(t){return Object(ra.jsx)(bn,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/notas",render:function(t){return Object(ra.jsx)(on,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/notificaciones",render:function(t){return Object(ra.jsx)(yn,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}}),Object(ra.jsx)(aa.a,{extric:!0,path:"/",render:function(t){return Object(ra.jsx)(Nn,Object(i.a)(Object(i.a)({},t),{},{data:a,page:e.handlePage}))}})]})})})})})]}),Object(ra.jsx)(ba,{})]})})}}]),a}(s.Component),Sn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(e){var s;return Object(Yt.a)(this,a),(s=t.call(this,e)).pressEnter=function(e){if(e.preventDefault(),"Enter"===e.key){var t=s.state.txtHost.split("://"),a=t[0],n=t[1],c=s.props.changeHost;s.setState({load:!0}),a&&n?c({host:n,port:a}):a&&!n&&c({host:a,port:void 0})}else e.target&&""!==e.target.name&&s.catchInputs(e)},s.catchInputs=function(e){var t=e.target,a=t.name,n=t.value,c=e.key,r="";c?("txtHost"===a&&(r=s.state.txtHost),r+=c):r=n,s.setState(Object(J.a)({},a,r))},s.showTools=function(e){e.preventDefault(),s.setState({hostShow:!s.state.hostShow})},s.handleLogin=function(e){e.preventDefault(),console.log("[Orus System] Validando integracion de credenciales");var t=s.state,a=t.username,n=t.password,c=t.load,r=s.props.loggin,o={email:a.toString().replace(/\s/g,"").trim().toLocaleLowerCase(),password:n.toString().trim()};c||s.setState({load:!0,error:{}});var i=s.validInputs(o);i.isValid?(console.log("[Orus System] enviando credenciales a _LOGGINGPROCESS"),r(o)):s.setState({load:!1,error:i})},s.state={username:"",password:"",txtHost:"",error:{},hostShow:!1,load:!1},s}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.host;e&&this.setState({txtHost:e})}},{key:"componentDidUpdate",value:function(e,t){var a=e.errors,s=void 0===a?{}:a,n=e.changeHostStatus,c=this.props,r=c.errors,o=void 0===r?{}:r,i=c.changeHostStatus;s.errors!==o.errors&&o.errors&&o.errors.toString().length&&this.setState({load:!1}),n!==i&&i&&this.setState({load:!1})}},{key:"render",value:function(){var e=this.state,t=e.load,a=e.username,s=e.password,n=e.txtHost,c=e.hostShow,r=e.error,o=this.props,i=o.company,l=o.errors,d=o.changeHostStatus,j=void 0===d?null:d,u=o.host;return Object(ra.jsx)("div",{className:"login-page",children:Object(ra.jsxs)("div",{className:"login-box",children:[Object(ra.jsx)("div",{className:"login-logo",children:Object(ra.jsxs)("a",{href:"#logo",onClick:function(e){return e.preventDefault()},children:[Object(ra.jsx)("b",{className:"text-primary",children:"Orus"})," LTE"]})}),l&&l.errors&&!t?Object(ra.jsx)("div",{className:"alert alert-danger",children:Object(ra.jsxs)("span",{children:[Object(ra.jsx)("i",{className:"mx-2 fas fa-info"})," ",l.errors.toString()]})}):j?Object(ra.jsx)("div",{className:"alert alert-success",children:Object(ra.jsxs)("span",{children:[Object(ra.jsx)("i",{className:"mx-2 fas fa-info"})," Direccion de servidor cambiada con exito [",u,"]"]})}):null,Object(ra.jsx)("div",{className:"rounded shadow-lg card",children:Object(ra.jsxs)("div",{className:"card-body login-card-body",children:[Object(ra.jsx)("p",{className:"login-box-msg text-uppercase",children:Object(ra.jsx)("span",{className:"p-2 badge badge-secondary",children:i})}),Object(ra.jsxs)("form",{onSubmit:this.handleLogin,children:[Object(ra.jsxs)("div",{className:r.input&&"email"===r.input?"mb-0 input-group":"mb-3 input-group",children:[Object(ra.jsx)("input",{type:"email",className:"form-control",placeholder:"Usuario",name:"username",autoFocus:!c,onChange:this.catchInputs,value:a}),Object(ra.jsx)("div",{className:"input-group-append",children:Object(ra.jsx)("div",{className:"input-group-text",children:Object(ra.jsx)("span",{className:"fas fa-user"})})}),r.input&&"email"===r.input?Object(ra.jsx)("span",{className:"text-center text-danger text-wrap font-weight-bold text-monospace",children:Object(ra.jsxs)("small",{children:[Object(ra.jsx)("i",{className:"mx-2 fas fa-info"}),"Los datos son errones"]})}):null]}),Object(ra.jsxs)("div",{className:r.input&&"password"===r.input?"mb-0 input-group":"mb-3 input-group",children:[Object(ra.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"password",autoComplete:"off",onChange:this.catchInputs,value:s}),Object(ra.jsx)("div",{className:"input-group-append",children:Object(ra.jsx)("div",{className:"input-group-text",children:Object(ra.jsx)("span",{className:"fas fa-lock"})})})]}),r.input&&"password"===r.input?Object(ra.jsx)("span",{className:"mb-3 text-center text-danger text-wrap font-weight-bold text-monospace",children:Object(ra.jsxs)("small",{children:[Object(ra.jsx)("i",{className:"mx-2 fas fa-info"}),"Los datos son errones"]})}):null,Object(ra.jsx)("div",{className:"row",children:Object(ra.jsxs)("div",{className:"mb-4 col-12",children:[Object(ra.jsxs)("a",{href:"#tools",onClick:this.showTools,className:"text-muted",children:[Object(ra.jsx)("i",{className:"mx-1 fas fa-wifi"})," Servidor"]}),c?Object(ra.jsxs)("div",{className:"mb-3 input-group",children:[Object(ra.jsx)("input",{type:"text",className:"form-control",placeholder:"Servidor",name:"txtHost",autoComplete:"off",autoFocus:!!c,onChange:this.catchInputs,value:n,onKeyPress:this.pressEnter}),Object(ra.jsx)("div",{className:"input-group-append",children:Object(ra.jsx)("div",{className:"input-group-text",children:Object(ra.jsx)("span",{className:"fas fa-server"})})})]}):null]})}),Object(ra.jsx)("div",{className:"row",children:Object(ra.jsx)("div",{className:"text-center col-12",children:Object(ra.jsx)("button",{type:t?"button":"submit",className:t?"btn btn-outline-secondary btn-block":"btn btn-primary btn-block",children:t?Object(ra.jsx)("div",{className:"spinner-border text-secondary",children:Object(ra.jsx)("span",{className:"sr-only",children:"Loading..."})}):"Iniciar session"})})})]})]})})]})})}},{key:"validInputs",value:function(e){var t=e.email,a=e.password;return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?/^(?=.*[A-Z])(?=.*[!@#$&.*])(?=.*[0-9])(?=.*[a-z]).{8,16}$/.test(a)?{isValid:!0}:(console.error("[Orus System] Fallo validacion de password"),{isValid:!1,msg:"Los datos introducidos no son validos",input:"password"}):(console.error("[Orus System] Fallo validacion de email"),{isValid:!1,msg:"Los datos introducidos no son validos",input:"email"})}}]),a}(s.Component),Cn={loggin:ca,changeHost:function(e){return{type:L,payload:e}}},_n=Object(Wt.b)((function(e){return{company:e.default.company,host:e.default.host,errors:e.logging.errors,changeHostStatus:e.default.success}}),Cn)(Sn),kn=function(e){Object(Qt.a)(a,e);var t=Object(ea.a)(a);function a(){return Object(Yt.a)(this,a),t.apply(this,arguments)}return Object(Kt.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.checkLogging,a=e.token;e.isLogged&&t(a)}},{key:"render",value:function(){var e=this.props.isLogged;return Object(ra.jsx)("main",{children:e?Object(ra.jsx)(wn,{data:this.props}):Object(ra.jsx)(_n,{})})}}]),a}(s.Component),En={checkLogging:function(e){return{type:d,payload:e}}},In=Object(Wt.b)((function(e){return{isLogged:e.logging.isLogged,token:e.logging.token}}),En)(kn),An=function(){return Object(ra.jsx)(Wt.a,{store:Xt,children:Object(ra.jsx)(In,{})})};Object(c.render)(Object(ra.jsx)(An,{}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.7d71cc33.chunk.js.map